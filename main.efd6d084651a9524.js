"use strict";(self.webpackChunkplease_take_your_turn=self.webpackChunkplease_take_your_turn||[]).push([[179],{58:(Gs,lr,je)=>{je.d(lr,{BH:()=>ps,DV:()=>ko,Dv:()=>dc,G6:()=>ic,GJ:()=>lc,L:()=>ut,LL:()=>ms,Pz:()=>Ge,Sg:()=>rc,UG:()=>dn,UI:()=>zs,US:()=>xt,Wj:()=>fr,Wl:()=>Hl,Yr:()=>ka,ZB:()=>ye,ZR:()=>Mo,aH:()=>Gn,b$:()=>gs,cI:()=>Oa,dS:()=>ql,eu:()=>qs,g5:()=>V,gK:()=>Ks,gQ:()=>K,h$:()=>Fn,hl:()=>sc,hu:()=>De,jU:()=>Vt,lb:()=>La,m9:()=>hc,ne:()=>_n,p$:()=>J,pd:()=>Va,r3:()=>ct,ru:()=>bi,tV:()=>L,uI:()=>Dn,ug:()=>Ua,vZ:()=>Ws,w1:()=>Ma,w9:()=>cc,xO:()=>Fa,xb:()=>Oo,z$:()=>Ke,zd:()=>Sr});const b={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},De=function(A,T){if(!A)throw V(T)},V=function(A){return new Error("Firebase Database ("+b.SDK_VERSION+") INTERNAL ASSERT FAILED: "+A)},Se=function(A){const T=[];let P=0;for(let U=0;U<A.length;U++){let x=A.charCodeAt(U);x<128?T[P++]=x:x<2048?(T[P++]=x>>6|192,T[P++]=63&x|128):55296==(64512&x)&&U+1<A.length&&56320==(64512&A.charCodeAt(U+1))?(x=65536+((1023&x)<<10)+(1023&A.charCodeAt(++U)),T[P++]=x>>18|240,T[P++]=x>>12&63|128,T[P++]=x>>6&63|128,T[P++]=63&x|128):(T[P++]=x>>12|224,T[P++]=x>>6&63|128,T[P++]=63&x|128)}return T},xt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(A,T){if(!Array.isArray(A))throw Error("encodeByteArray takes an array as a parameter");this.init_();const P=T?this.byteToCharMapWebSafe_:this.byteToCharMap_,U=[];for(let x=0;x<A.length;x+=3){const ge=A[x],ce=x+1<A.length,ae=ce?A[x+1]:0,Sn=x+2<A.length,Rn=Sn?A[x+2]:0;let q=(15&ae)<<2|Rn>>6,Ai=63&Rn;Sn||(Ai=64,ce||(q=64)),U.push(P[ge>>2],P[(3&ge)<<4|ae>>4],P[q],P[Ai])}return U.join("")},encodeString(A,T){return this.HAS_NATIVE_SUPPORT&&!T?btoa(A):this.encodeByteArray(Se(A),T)},decodeString(A,T){return this.HAS_NATIVE_SUPPORT&&!T?atob(A):function(A){const T=[];let P=0,U=0;for(;P<A.length;){const x=A[P++];if(x<128)T[U++]=String.fromCharCode(x);else if(x>191&&x<224){const ge=A[P++];T[U++]=String.fromCharCode((31&x)<<6|63&ge)}else if(x>239&&x<365){const Sn=((7&x)<<18|(63&A[P++])<<12|(63&A[P++])<<6|63&A[P++])-65536;T[U++]=String.fromCharCode(55296+(Sn>>10)),T[U++]=String.fromCharCode(56320+(1023&Sn))}else{const ge=A[P++],ce=A[P++];T[U++]=String.fromCharCode((15&x)<<12|(63&ge)<<6|63&ce)}}return T.join("")}(this.decodeStringToByteArray(A,T))},decodeStringToByteArray(A,T){this.init_();const P=T?this.charToByteMapWebSafe_:this.charToByteMap_,U=[];for(let x=0;x<A.length;){const ge=P[A.charAt(x++)],ae=x<A.length?P[A.charAt(x)]:0;++x;const Rn=x<A.length?P[A.charAt(x)]:64;++x;const it=x<A.length?P[A.charAt(x)]:64;if(++x,null==ge||null==ae||null==Rn||null==it)throw new mn;U.push(ge<<2|ae>>4),64!==Rn&&(U.push(ae<<4&240|Rn>>2),64!==it&&U.push(Rn<<6&192|it))}return U},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let A=0;A<this.ENCODED_VALS.length;A++)this.byteToCharMap_[A]=this.ENCODED_VALS.charAt(A),this.charToByteMap_[this.byteToCharMap_[A]]=A,this.byteToCharMapWebSafe_[A]=this.ENCODED_VALS_WEBSAFE.charAt(A),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[A]]=A,A>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(A)]=A,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(A)]=A)}}};class mn extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Fn=function(A){const T=Se(A);return xt.encodeByteArray(T,!0)},ut=function(A){return Fn(A).replace(/\./g,"")},L=function(A){try{return xt.decodeString(A,!0)}catch(T){console.error("base64Decode failed: ",T)}return null};function J(A){return ye(void 0,A)}function ye(A,T){if(!(T instanceof Object))return T;switch(T.constructor){case Date:return new Date(T.getTime());case Object:void 0===A&&(A={});break;case Array:A=[];break;default:return T}for(const P in T)!T.hasOwnProperty(P)||!rt(P)||(A[P]=ye(A[P],T[P]));return A}function rt(A){return"__proto__"!==A}const Ve=()=>{try{return function Ee(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const A=process.env.__FIREBASE_DEFAULTS__;return A?JSON.parse(A):void 0})()||(()=>{if(typeof document>"u")return;let A;try{A=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const T=A&&L(A[1]);return T&&JSON.parse(T)})()}catch(A){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${A}`)}},Gn=()=>{var A;return null===(A=Ve())||void 0===A?void 0:A.config},Ge=A=>{var T;return null===(T=Ve())||void 0===T?void 0:T[`_${A}`]};class ps{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((T,P)=>{this.resolve=T,this.reject=P})}wrapCallback(T){return(P,U)=>{P?this.reject(P):this.resolve(U),"function"==typeof T&&(this.promise.catch(()=>{}),1===T.length?T(P):T(P,U))}}}function rc(A,T){if(A.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const U=T||"demo-project",x=A.iat||0,ge=A.sub||A.user_id;if(!ge)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const ce=Object.assign({iss:`https://securetoken.google.com/${U}`,aud:U,iat:x,exp:x+3600,auth_time:x,sub:ge,user_id:ge,firebase:{sign_in_provider:"custom",identities:{}}},A);return[ut(JSON.stringify({alg:"none",type:"JWT"})),ut(JSON.stringify(ce)),""].join(".")}function Ke(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Dn(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ke())}function dn(){var A;const T=null===(A=Ve())||void 0===A?void 0:A.forceEnvironment;if("node"===T)return!0;if("browser"===T)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function Vt(){return"object"==typeof self&&self.self===self}function bi(){const A="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof A&&void 0!==A.id}function gs(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Ma(){const A=Ke();return A.indexOf("MSIE ")>=0||A.indexOf("Trident/")>=0}function ka(){return!0===b.NODE_CLIENT||!0===b.NODE_ADMIN}function ic(){return!dn()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sc(){try{return"object"==typeof indexedDB}catch{return!1}}function qs(){return new Promise((A,T)=>{try{let P=!0;const U="validate-browser-context-for-indexeddb-analytics-module",x=self.indexedDB.open(U);x.onsuccess=()=>{x.result.close(),P||self.indexedDB.deleteDatabase(U),A(!0)},x.onupgradeneeded=()=>{P=!1},x.onerror=()=>{var ge;T((null===(ge=x.error)||void 0===ge?void 0:ge.message)||"")}}catch(P){T(P)}})}class Mo extends Error{constructor(T,P,U){super(P),this.code=T,this.customData=U,this.name="FirebaseError",Object.setPrototypeOf(this,Mo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ms.prototype.create)}}class ms{constructor(T,P,U){this.service=T,this.serviceName=P,this.errors=U}create(T,...P){const U=P[0]||{},x=`${this.service}/${T}`,ge=this.errors[T],ce=ge?function ac(A,T){return A.replace(Di,(P,U)=>{const x=T[U];return null!=x?String(x):`<${U}?>`})}(ge,U):"Error";return new Mo(x,`${this.serviceName}: ${ce} (${x}).`,U)}}const Di=/\{\$([^}]+)}/g;function Oa(A){return JSON.parse(A)}function Hl(A){return JSON.stringify(A)}const hr=function(A){let T={},P={},U={},x="";try{const ge=A.split(".");T=Oa(L(ge[0])||""),P=Oa(L(ge[1])||""),x=ge[2],U=P.d||{},delete P.d}catch{}return{header:T,claims:P,data:U,signature:x}},cc=function(A){const P=hr(A).claims;return!!P&&"object"==typeof P&&P.hasOwnProperty("iat")},lc=function(A){const T=hr(A).claims;return"object"==typeof T&&!0===T.admin};function ct(A,T){return Object.prototype.hasOwnProperty.call(A,T)}function ko(A,T){if(Object.prototype.hasOwnProperty.call(A,T))return A[T]}function Oo(A){for(const T in A)if(Object.prototype.hasOwnProperty.call(A,T))return!1;return!0}function zs(A,T,P){const U={};for(const x in A)Object.prototype.hasOwnProperty.call(A,x)&&(U[x]=T.call(P,A[x],x,A));return U}function Ws(A,T){if(A===T)return!0;const P=Object.keys(A),U=Object.keys(T);for(const x of P){if(!U.includes(x))return!1;const ge=A[x],ce=T[x];if(St(ge)&&St(ce)){if(!Ws(ge,ce))return!1}else if(ge!==ce)return!1}for(const x of U)if(!P.includes(x))return!1;return!0}function St(A){return null!==A&&"object"==typeof A}function Fa(A){const T=[];for(const[P,U]of Object.entries(A))Array.isArray(U)?U.forEach(x=>{T.push(encodeURIComponent(P)+"="+encodeURIComponent(x))}):T.push(encodeURIComponent(P)+"="+encodeURIComponent(U));return T.length?"&"+T.join("&"):""}function Sr(A){const T={};return A.replace(/^\?/,"").split("&").forEach(U=>{if(U){const[x,ge]=U.split("=");T[decodeURIComponent(x)]=decodeURIComponent(ge)}}),T}function Va(A){const T=A.indexOf("?");if(!T)return"";const P=A.indexOf("#",T);return A.substring(T,P>0?P:void 0)}class K{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let T=1;T<this.blockSize;++T)this.pad_[T]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(T,P){P||(P=0);const U=this.W_;if("string"==typeof T)for(let it=0;it<16;it++)U[it]=T.charCodeAt(P)<<24|T.charCodeAt(P+1)<<16|T.charCodeAt(P+2)<<8|T.charCodeAt(P+3),P+=4;else for(let it=0;it<16;it++)U[it]=T[P]<<24|T[P+1]<<16|T[P+2]<<8|T[P+3],P+=4;for(let it=16;it<80;it++){const q=U[it-3]^U[it-8]^U[it-14]^U[it-16];U[it]=4294967295&(q<<1|q>>>31)}let Rn,jr,x=this.chain_[0],ge=this.chain_[1],ce=this.chain_[2],ae=this.chain_[3],Sn=this.chain_[4];for(let it=0;it<80;it++){it<40?it<20?(Rn=ae^ge&(ce^ae),jr=1518500249):(Rn=ge^ce^ae,jr=1859775393):it<60?(Rn=ge&ce|ae&(ge|ce),jr=2400959708):(Rn=ge^ce^ae,jr=3395469782);const q=(x<<5|x>>>27)+Rn+Sn+jr+U[it]&4294967295;Sn=ae,ae=ce,ce=4294967295&(ge<<30|ge>>>2),ge=x,x=q}this.chain_[0]=this.chain_[0]+x&4294967295,this.chain_[1]=this.chain_[1]+ge&4294967295,this.chain_[2]=this.chain_[2]+ce&4294967295,this.chain_[3]=this.chain_[3]+ae&4294967295,this.chain_[4]=this.chain_[4]+Sn&4294967295}update(T,P){if(null==T)return;void 0===P&&(P=T.length);const U=P-this.blockSize;let x=0;const ge=this.buf_;let ce=this.inbuf_;for(;x<P;){if(0===ce)for(;x<=U;)this.compress_(T,x),x+=this.blockSize;if("string"==typeof T){for(;x<P;)if(ge[ce]=T.charCodeAt(x),++ce,++x,ce===this.blockSize){this.compress_(ge),ce=0;break}}else for(;x<P;)if(ge[ce]=T[x],++ce,++x,ce===this.blockSize){this.compress_(ge),ce=0;break}}this.inbuf_=ce,this.total_+=P}digest(){const T=[];let P=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let x=this.blockSize-1;x>=56;x--)this.buf_[x]=255&P,P/=256;this.compress_(this.buf_);let U=0;for(let x=0;x<5;x++)for(let ge=24;ge>=0;ge-=8)T[U]=this.chain_[x]>>ge&255,++U;return T}}function _n(A,T){const P=new An(A,T);return P.subscribe.bind(P)}class An{constructor(T,P){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=P,this.task.then(()=>{T(this)}).catch(U=>{this.error(U)})}next(T){this.forEachObserver(P=>{P.next(T)})}error(T){this.forEachObserver(P=>{P.error(T)}),this.close(T)}complete(){this.forEachObserver(T=>{T.complete()}),this.close()}subscribe(T,P,U){let x;if(void 0===T&&void 0===P&&void 0===U)throw new Error("Missing Observer.");x=function fe(A,T){if("object"!=typeof A||null===A)return!1;for(const P of T)if(P in A&&"function"==typeof A[P])return!0;return!1}(T,["next","error","complete"])?T:{next:T,error:P,complete:U},void 0===x.next&&(x.next=ii),void 0===x.error&&(x.error=ii),void 0===x.complete&&(x.complete=ii);const ge=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?x.error(this.finalError):x.complete()}catch{}}),this.observers.push(x),ge}unsubscribeOne(T){void 0===this.observers||void 0===this.observers[T]||(delete this.observers[T],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(T){if(!this.finalized)for(let P=0;P<this.observers.length;P++)this.sendOne(P,T)}sendOne(T,P){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[T])try{P(this.observers[T])}catch(U){typeof console<"u"&&console.error&&console.error(U)}})}close(T){this.finalized||(this.finalized=!0,void 0!==T&&(this.finalError=T),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ii(){}const dc=function(A,T,P,U){let x;if(U<T?x="at least "+T:U>P&&(x=0===P?"none":"no more than "+P),x)throw new Error(A+" failed: Was called with "+U+(1===U?" argument.":" arguments.")+" Expects "+x+".")};function Ks(A,T){return`${A} failed: ${T} argument `}function fr(A,T,P,U){if((!U||P)&&"function"!=typeof P)throw new Error(Ks(A,T)+"must be a valid function.")}function La(A,T,P,U){if((!U||P)&&("object"!=typeof P||null===P))throw new Error(Ks(A,T)+"must be a valid context object.")}const ql=function(A){const T=[];let P=0;for(let U=0;U<A.length;U++){let x=A.charCodeAt(U);if(x>=55296&&x<=56319){const ge=x-55296;U++,De(U<A.length,"Surrogate pair missing trail surrogate."),x=65536+(ge<<10)+(A.charCodeAt(U)-56320)}x<128?T[P++]=x:x<2048?(T[P++]=x>>6|192,T[P++]=63&x|128):x<65536?(T[P++]=x>>12|224,T[P++]=x>>6&63|128,T[P++]=63&x|128):(T[P++]=x>>18|240,T[P++]=x>>12&63|128,T[P++]=x>>6&63|128,T[P++]=63&x|128)}return T},Ua=function(A){let T=0;for(let P=0;P<A.length;P++){const U=A.charCodeAt(P);U<128?T++:U<2048?T+=2:U>=55296&&U<=56319?(T+=4,P++):T+=3}return T};function hc(A){return A&&A._delegate?A._delegate:A}},749:(Gs,lr,je)=>{function b(t){return"function"==typeof t}let De=!1;const V={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else De&&console.log("RxJS: Back to a better error behavior. Thank you. <3");De=t},get useDeprecatedSynchronousErrorHandling(){return De}};function Se(t){setTimeout(()=>{throw t},0)}const ln={closed:!0,next(t){},error(t){if(V.useDeprecatedSynchronousErrorHandling)throw t;Se(t)},complete(){}},xt=Array.isArray||(t=>t&&"number"==typeof t.length);function mn(t){return null!==t&&"object"==typeof t}const ut=(()=>{function t(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((n,r)=>`${r+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return t.prototype=Object.create(Error.prototype),t})();class L{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_ctorUnsubscribe:r,_unsubscribe:i,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof L)n.remove(this);else if(null!==n)for(let o=0;o<n.length;++o)n[o].remove(this);if(b(i)){r&&(this._unsubscribe=void 0);try{i.call(this)}catch(o){e=o instanceof ut?J(o.errors):[o]}}if(xt(s)){let o=-1,a=s.length;for(;++o<a;){const u=s[o];if(mn(u))try{u.unsubscribe()}catch(d){e=e||[],d instanceof ut?e=e.concat(J(d.errors)):e.push(d)}}}if(e)throw new ut(e)}add(e){let n=e;if(!e)return L.EMPTY;switch(typeof e){case"function":n=new L(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof L)){const s=n;n=new L,n._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:r}=n;if(null===r)n._parentOrParents=this;else if(r instanceof L){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}const i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n}remove(e){const n=this._subscriptions;if(n){const r=n.indexOf(e);-1!==r&&n.splice(r,1)}}}var t;function J(t){return t.reduce((e,n)=>e.concat(n instanceof ut?n.errors:n),[])}L.EMPTY=((t=new L).closed=!0,t);const ye="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class Ee extends L{constructor(e,n,r){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=ln;break;case 1:if(!e){this.destination=ln;break}if("object"==typeof e){e instanceof Ee?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new dr(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new dr(this,e,n,r)}}[ye](){return this}static create(e,n,r){const i=new Ee(e,n,r);return i.syncErrorThrowable=!1,i}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class dr extends Ee{constructor(e,n,r,i){super(),this._parentSubscriber=e;let s,o=this;b(n)?s=n:n&&(s=n.next,r=n.error,i=n.complete,n!==ln&&(o=Object.create(n),b(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=r,this._complete=i}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:n}=this;V.useDeprecatedSynchronousErrorHandling&&n.syncErrorThrowable?this.__tryOrSetError(n,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:n}=this,{useDeprecatedSynchronousErrorHandling:r}=V;if(this._error)r&&n.syncErrorThrowable?(this.__tryOrSetError(n,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(n.syncErrorThrowable)r?(n.syncErrorValue=e,n.syncErrorThrown=!0):Se(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;Se(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const n=()=>this._complete.call(this._context);V.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,n){try{e.call(this._context,n)}catch(r){if(this.unsubscribe(),V.useDeprecatedSynchronousErrorHandling)throw r;Se(r)}}__tryOrSetError(e,n,r){if(!V.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{n.call(this._context,r)}catch(i){return V.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=i,e.syncErrorThrown=!0,!0):(Se(i),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const Ve="function"==typeof Symbol&&Symbol.observable||"@@observable";function Hn(t){return t}function Gn(t){return 0===t.length?Hn:1===t.length?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}let Ge=(()=>{class t{constructor(n){this._isScalar=!1,n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){const{operator:s}=this,o=function We(t,e,n){if(t){if(t instanceof Ee)return t;if(t[ye])return t[ye]()}return t||e||n?new Ee(t,e,n):new Ee(ln)}(n,r,i);if(o.add(s?s.call(o,this.source):this.source||V.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),V.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o}_trySubscribe(n){try{return this._subscribe(n)}catch(r){V.useDeprecatedSynchronousErrorHandling&&(n.syncErrorThrown=!0,n.syncErrorValue=r),function Mt(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof Ee?n:null}return!0}(n)?n.error(r):console.warn(r)}}forEach(n,r){return new(r=ps(r))((i,s)=>{let o;o=this.subscribe(a=>{try{n(a)}catch(u){s(u),o&&o.unsubscribe()}},s,i)})}_subscribe(n){const{source:r}=this;return r&&r.subscribe(n)}[Ve](){return this}pipe(...n){return 0===n.length?this:Gn(n)(this)}toPromise(n){return new(n=ps(n))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function ps(t){if(t||(t=V.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const Ke=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class Dn extends L{constructor(e,n){super(),this.subject=e,this.subscriber=n,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,n=e.observers;if(this.subject=null,!n||0===n.length||e.isStopped||e.closed)return;const r=n.indexOf(this.subscriber);-1!==r&&n.splice(r,1)}}class dn extends Ee{constructor(e){super(e),this.destination=e}}let Vt=(()=>{class t extends Ge{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[ye](){return new dn(this)}lift(n){const r=new bi(this,this);return r.operator=n,r}next(n){if(this.closed)throw new Ke;if(!this.isStopped){const{observers:r}=this,i=r.length,s=r.slice();for(let o=0;o<i;o++)s[o].next(n)}}error(n){if(this.closed)throw new Ke;this.hasError=!0,this.thrownError=n,this.isStopped=!0;const{observers:r}=this,i=r.length,s=r.slice();for(let o=0;o<i;o++)s[o].error(n);this.observers.length=0}complete(){if(this.closed)throw new Ke;this.isStopped=!0;const{observers:n}=this,r=n.length,i=n.slice();for(let s=0;s<r;s++)i[s].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(n){if(this.closed)throw new Ke;return super._trySubscribe(n)}_subscribe(n){if(this.closed)throw new Ke;return this.hasError?(n.error(this.thrownError),L.EMPTY):this.isStopped?(n.complete(),L.EMPTY):(this.observers.push(n),new Dn(this,n))}asObservable(){const n=new Ge;return n.source=this,n}}return t.create=(e,n)=>new bi(e,n),t})();class bi extends Vt{constructor(e,n){super(),this.destination=e,this.source=n}next(e){const{destination:n}=this;n&&n.next&&n.next(e)}error(e){const{destination:n}=this;n&&n.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:n}=this;return n?this.source.subscribe(e):L.EMPTY}}function gs(t){return t&&"function"==typeof t.schedule}function Ie(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new Ma(t,e))}}class Ma{constructor(e,n){this.project=e,this.thisArg=n}call(e,n){return n.subscribe(new Hi(e,this.project,this.thisArg))}}class Hi extends Ee{constructor(e,n,r){super(e),this.project=n,this.count=0,this.thisArg=r||this}_next(e){let n;try{n=this.project.call(this.thisArg,e,this.count++)}catch(r){return void this.destination.error(r)}this.destination.next(n)}}const ka=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()},qs=function sc(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}(),ms=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function ac(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const Di=t=>{if(t&&"function"==typeof t[Ve])return(t=>e=>{const n=t[Ve]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)})(t);if(ms(t))return ka(t);if(ac(t))return(t=>e=>(t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Se),e))(t);if(t&&"function"==typeof t[qs])return(t=>e=>{const n=t[qs]();for(;;){let r;try{r=n.next()}catch(i){return e.error(i),e}if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add(()=>{n.return&&n.return()}),e})(t);{const n=`You provided ${mn(t)?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(n)}};function hr(t,e){return new Ge(n=>{const r=new L;let i=0;return r.add(e.schedule(function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()})),r})}function ct(t,e){return e?function lc(t,e){if(null!=t){if(function uc(t){return t&&"function"==typeof t[Ve]}(t))return function Oa(t,e){return new Ge(n=>{const r=new L;return r.add(e.schedule(()=>{const i=t[Ve]();r.add(i.subscribe({next(s){r.add(e.schedule(()=>n.next(s)))},error(s){r.add(e.schedule(()=>n.error(s)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r})}(t,e);if(ac(t))return function Hl(t,e){return new Ge(n=>{const r=new L;return r.add(e.schedule(()=>t.then(i=>{r.add(e.schedule(()=>{n.next(i),r.add(e.schedule(()=>n.complete()))}))},i=>{r.add(e.schedule(()=>n.error(i)))}))),r})}(t,e);if(ms(t))return hr(t,e);if(function cc(t){return t&&"function"==typeof t[qs]}(t)||"string"==typeof t)return function Gl(t,e){if(!t)throw new Error("Iterable cannot be null");return new Ge(n=>{const r=new L;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(e.schedule(()=>{i=t[qs](),r.add(e.schedule(function(){if(n.closed)return;let s,o;try{const a=i.next();s=a.value,o=a.done}catch(a){return void n.error(a)}o?n.complete():(n.next(s),this.schedule())}))})),r})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof Ge?t:new Ge(Di(t))}class ko extends Ee{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class zs extends Ee{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function St(t,e){if(e.closed)return;if(t instanceof Ge)return t.subscribe(e);let n;try{n=Di(t)(e)}catch(r){e.error(r)}return n}function Ye(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?r=>r.pipe(Ye((i,s)=>ct(t(i,s)).pipe(Ie((o,a)=>e(i,o,s,a))),n)):("number"==typeof e&&(n=e),r=>r.lift(new Fa(t,n)))}class Fa{constructor(e,n=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=n}call(e,n){return n.subscribe(new Sr(e,this.project,this.concurrent))}}class Sr extends zs{constructor(e,n,r=Number.POSITIVE_INFINITY){super(e),this.project=n,this.concurrent=r,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let n;const r=this.index++;try{n=this.project(e,r)}catch(i){return void this.destination.error(i)}this.active++,this._innerSub(n)}_innerSub(e){const n=new ko(this),r=this.destination;r.add(n);const i=St(e,n);i!==n&&r.add(i)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function K(t=Number.POSITIVE_INFINITY){return Ye(Hn,t)}function _n(t,e){return e?hr(t,e):new Ge(ka(t))}function An(...t){let e=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return gs(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof r&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof Ge?t[0]:K(e)(_n(t,n))}class Wt extends Vt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return n&&!n.closed&&e.next(this._value),n}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Ke;return this._value}next(e){super.next(this._value=e)}}function fe(...t){let e=t[t.length-1];return gs(e)?(t.pop(),hr(t,e)):_n(t)}function ii(){return function(e){return e.lift(new dc(e))}}class dc{constructor(e){this.connectable=e}call(e,n){const{connectable:r}=this;r._refCount++;const i=new Ks(e,r),s=n.subscribe(i);return i.closed||(i.connection=r.connect()),s}}class Ks extends Ee{constructor(e,n){super(e),this.connectable=n}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const n=e._refCount;if(n<=0)return void(this.connection=null);if(e._refCount=n-1,n>1)return void(this.connection=null);const{connection:r}=this,i=e._connection;this.connection=null,i&&(!r||i===r)&&i.unsubscribe()}}class Gi extends Ge{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new L,e.add(this.source.subscribe(new La(this.getSubject(),this))),e.closed&&(this._connection=null,e=L.EMPTY)),e}refCount(){return ii()(this)}}const fr=(()=>{const t=Gi.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class La extends dn{constructor(e,n){super(e),this.connectable=n}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const n=e._connection;e._refCount=0,e._subject=null,e._connection=null,n&&n.unsubscribe()}}}class gt{constructor(e,n){this.subjectFactory=e,this.selector=n}call(e,n){const{selector:r}=this,i=this.subjectFactory(),s=r(i).subscribe(e);return s.add(n.subscribe(i)),s}}function Fo(){return new Vt}function qi(){return t=>ii()(function Et(t,e){return function(r){let i;if(i="function"==typeof t?t:function(){return t},"function"==typeof e)return r.lift(new gt(i,e));const s=Object.create(r,fr);return s.source=r,s.subjectFactory=i,s}}(Fo)(t))}function ft(t,e){return"function"==typeof e?n=>n.pipe(ft((r,i)=>ct(t(r,i)).pipe(Ie((s,o)=>e(r,s,i,o))))):n=>n.lift(new si(t))}class si{constructor(e){this.project=e}call(e,n){return n.subscribe(new Ba(e,this.project))}}class Ba extends zs{constructor(e,n){super(e),this.project=n,this.index=0}_next(e){let n;const r=this.index++;try{n=this.project(e,r)}catch(i){return void this.destination.error(i)}this._innerSub(n)}_innerSub(e){const n=this.innerSubscription;n&&n.unsubscribe();const r=new ko(this),i=this.destination;i.add(r),this.innerSubscription=St(e,r),this.innerSubscription!==r&&i.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;(!e||e.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}function Zs(t,e){return n=>n.lift(new hc(t,e))}class hc{constructor(e,n){this.compare=e,this.keySelector=n}call(e,n){return n.subscribe(new A(e,this.compare,this.keySelector))}}class A extends Ee{constructor(e,n,r){super(e),this.keySelector=r,this.hasKey=!1,"function"==typeof n&&(this.compare=n)}compare(e,n){return e===n}_next(e){let n;try{const{keySelector:i}=this;n=i?i(e):e}catch(i){return this.destination.error(i)}let r=!1;if(this.hasKey)try{const{compare:i}=this;r=i(this.key,n)}catch(i){return this.destination.error(i)}else this.hasKey=!0;r||(this.key=n,this.destination.next(e))}}function T(t){for(let e in t)if(t[e]===T)return e;throw Error("Could not find renamed property on target object.")}function P(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function U(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(U).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function x(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const ge=T({__forward_ref__:T});function ce(t){return t.__forward_ref__=ce,t.toString=function(){return U(this())},t}function ae(t){return Sn(t)?t():t}function Sn(t){return"function"==typeof t&&t.hasOwnProperty(ge)&&t.__forward_ref__===ce}function Rn(t){return t&&!!t.\u0275providers}const it="https://g.co/ng/security#xss";class q extends Error{constructor(e,n){super(function Ai(t,e){return`NG0${Math.abs(t)}${e?": "+e:""}`}(e,n)),this.code=e}}function we(t){return"string"==typeof t?t:null==t?"":String(t)}function le(t,e){throw new q(-201,!1)}function oi(t,e){null==t&&function Ce(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}(e,t,null,"!=")}function de(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Vn(t){return{providers:t.providers||[],imports:t.imports||[]}}function Jn(t){return Vo(t,pc)||Vo(t,Zl)}function Vo(t,e){return t.hasOwnProperty(e)?t[e]:null}function _s(t){return t&&(t.hasOwnProperty(Kl)||t.hasOwnProperty(Z_))?t[Kl]:null}const pc=T({\u0275prov:T}),Kl=T({\u0275inj:T}),Zl=T({ngInjectableDef:T}),Z_=T({ngInjectorDef:T});var He=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(He||{});let Uo;function pr(t){const e=Uo;return Uo=t,e}function Bo(t,e,n){const r=Jn(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&He.Optional?null:void 0!==e?e:void le(U(t))}const Rt=globalThis;class re{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=de({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const $a={},Qf="__NG_DI_FLAG__",Yl="ngTempTokenPath",X_=/\n/gm,Xl="__source";let zi;function Ys(t){const e=zi;return zi=t,e}function Xf(t,e=He.Default){if(void 0===zi)throw new q(-203,!1);return null===zi?Bo(t,void 0,e):zi.get(t,e&He.Optional?null:void 0,e)}function z(t,e=He.Default){return(function Wf(){return Uo}()||Xf)(ae(t),e)}function pe(t,e=He.Default){return z(t,mc(e))}function mc(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Jf(t){const e=[];for(let n=0;n<t.length;n++){const r=ae(t[n]);if(Array.isArray(r)){if(0===r.length)throw new q(900,!1);let i,s=He.Default;for(let o=0;o<r.length;o++){const a=r[o],u=MT(a);"number"==typeof u?-1===u?i=a.token:s|=u:i=a}e.push(z(i,s))}else e.push(z(r))}return e}function Ha(t,e){return t[Qf]=e,t.prototype[Qf]=e,t}function MT(t){return t[Qf]}function Si(t){return{toString:t}.toString()}var Jl=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Jl||{}),$r=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}($r||{});const Wi={},st=[],ed=T({\u0275cmp:T}),_c=T({\u0275dir:T}),ep=T({\u0275pipe:T}),td=T({\u0275mod:T}),ai=T({\u0275fac:T}),jo=T({__NG_ELEMENT_ID__:T}),ny=T({__NG_ENV_ID__:T});function nd(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function tp(t,e,n){let r=0;for(;r<n.length;){const i=n[r];if("number"==typeof i){if(0!==i)break;r++;const s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{const s=i,o=n[++r];ry(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function rd(t){return 3===t||4===t||6===t}function ry(t){return 64===t.charCodeAt(0)}function $o(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||iy(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function iy(t,e,n,r,i){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const a=t[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<t.length;){const a=t[s];if("number"==typeof a)break;if(a===n){if(null===r)return void(null!==i&&(t[s+1]=i));if(r===t[s+1])return void(t[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==r&&t.splice(s++,0,r),null!==i&&t.splice(s++,0,i)}const id="ng-template";function kT(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if("string"==typeof s&&i){const o=t[r++];if(n&&"class"===s&&-1!==nd(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;r<t.length&&"string"==typeof(s=t[r++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(i=!1)}}return!1}function sd(t){return 4===t.type&&t.value!==id}function OT(t,e,n){return e===(4!==t.type||n?t.value:id)}function np(t,e,n){let r=4;const i=t.attrs||[],s=function Ki(t){for(let e=0;e<t.length;e++)if(rd(t[e]))return e;return t.length}(i);let o=!1;for(let a=0;a<e.length;a++){const u=e[a];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!OT(t,u,n)||""===u&&1===e.length){if(gr(r))return!1;o=!0}}else{const d=8&r?u:e[++a];if(8&r&&null!==t.attrs){if(!kT(t.attrs,d,n)){if(gr(r))return!1;o=!0}continue}const g=ys(8&r?"class":u,i,sd(t),n);if(-1===g){if(gr(r))return!1;o=!0;continue}if(""!==d){let m;m=g>s?"":i[g+1].toLowerCase();const y=8&r?m:null;if(y&&-1!==nd(y,d,0)||2&r&&d!==m){if(gr(r))return!1;o=!0}}}}else{if(!o&&!gr(r)&&!gr(u))return!1;if(o&&gr(u))continue;o=!1,r=u|1&r}}return gr(r)||o}function gr(t){return 0==(1&t)}function ys(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){const o=e[i];if(o===t)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function VT(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function od(t,e,n=!1){for(let r=0;r<e.length;r++)if(np(t,e[r],n))return!0;return!1}function sy(t,e){return t?":not("+e.trim()+")":e}function ip(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&r){const a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!gr(o)&&(e+=sy(s,i),i=""),r=o,s=s||!gr(r);n++}return""!==i&&(e+=sy(s,i)),e}function ad(t){return Si(()=>{const e=ap(t),n={...e,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Jl.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||$r.Emulated,styles:t.styles||st,_:null,schemas:t.schemas||null,tView:null,id:""};oy(n);const r=t.dependencies;return n.directiveDefs=vs(r,!1),n.pipeDefs=vs(r,!0),n.id=function ud(t){let e=0;const n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(n),n})}function op(t){return ke(t)||rn(t)}function Ho(t){return null!==t}function er(t){return Si(()=>({type:t.type,bootstrap:t.bootstrap||st,declarations:t.declarations||st,imports:t.imports||st,exports:t.exports||st,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function qa(t,e){if(null==t)return Wi;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),n[i]=r,e&&(e[i]=s)}return n}function Re(t){return Si(()=>{const e=ap(t);return oy(e),e})}function tr(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function ke(t){return t[ed]||null}function rn(t){return t[_c]||null}function vn(t){return t[ep]||null}function Rr(t,e){const n=t[td]||null;if(!n&&!0===e)throw new Error(`Type ${U(t)} does not have '\u0275mod' property.`);return n}function ap(t){const e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Wi,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||st,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:qa(t.inputs,e),outputs:qa(t.outputs)}}function oy(t){t.features?.forEach(e=>e(t))}function vs(t,e){if(!t)return null;const n=e?vn:op;return()=>("function"==typeof t?t():t).map(r=>n(r)).filter(Ho)}const Kt=0,oe=1,Pe=2,Je=3,ui=4,yc=5,Ln=6,Es=7,sn=8,Is=9,za=10,Ae=11,qo=12,cd=13,ws=14,Zt=15,Wa=16,Xs=17,Ri=18,zo=19,vc=20,Zi=21,Qi=22,Wo=23,Ka=24,$e=25,Ec=1,ay=2,ci=7,eo=9,En=11;function nr(t){return Array.isArray(t)&&"object"==typeof t[Ec]}function mr(t){return Array.isArray(t)&&!0===t[Ec]}function Ic(t){return 0!=(4&t.flags)}function Zo(t){return t.componentOffset>-1}function Za(t){return 1==(1&t.flags)}function Pi(t){return!!t.template}function wc(t){return 0!=(512&t[Pe])}function Qo(t,e){return t.hasOwnProperty(ai)?t[ai]:null}let Un=null,Qa=!1;function li(t){const e=Un;return Un=t,e}const Yo={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function yy(t){if(!Tc(t)||t.dirty){if(!t.producerMustRecompute(t)&&!HT(t))return void(t.dirty=!1);t.producerRecomputeValue(t),t.dirty=!1}}function Ey(t){t.dirty=!0,function vy(t){if(void 0===t.liveConsumerNode)return;const e=Qa;Qa=!0;try{for(const n of t.liveConsumerNode)n.dirty||Ey(n)}finally{Qa=e}}(t),t.consumerMarkedDirty?.(t)}function hp(t){return t&&(t.nextProducerIndex=0),li(t)}function Iy(t,e){if(li(e),t&&void 0!==t.producerNode&&void 0!==t.producerIndexOfThis&&void 0!==t.producerLastReadVersion){if(Tc(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)hd(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function HT(t){Cc(t);for(let e=0;e<t.producerNode.length;e++){const n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(yy(n),r!==n.version))return!0}return!1}function GT(t){if(Cc(t),Tc(t))for(let e=0;e<t.producerNode.length;e++)hd(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function hd(t,e){if(function qT(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}(t),Cc(t),1===t.liveConsumerNode.length)for(let r=0;r<t.producerNode.length;r++)hd(t.producerNode[r],t.producerIndexOfThis[r]);const n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){const r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];Cc(i),i.producerIndexOfThis[r]=e}}function Tc(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Cc(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}let fd=null;const Cy=()=>{},_x=(()=>({...Yo,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:t=>{t.schedule(t.ref)},hasRun:!1,cleanupFn:Cy}))();class yx{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function In(){return by}function by(t){return t.type.prototype.ngOnChanges&&(t.setInput=bc),QT}function QT(){const t=hn(this),e=t?.current;if(e){const n=t.previous;if(n===Wi)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function bc(t,e,n,r){const i=this.declaredInputs[n],s=hn(t)||function YT(t,e){return t[Dy]=e}(t,{previous:Wi,current:null}),o=s.current||(s.current={}),a=s.previous,u=a[i];o[i]=new yx(u&&u.currentValue,e,a===Wi),t[r]=e}In.ngInherit=!0;const Dy="__ngSimpleChanges__";function hn(t){return t[Dy]||null}const di=function(t,e,n){};function Tt(t){for(;Array.isArray(t);)t=t[Kt];return t}function Xo(t,e){return Tt(e[t])}function _r(t,e){return Tt(e[t.index])}function Sc(t,e){return t.data[e]}function yr(t,e){const n=e[t];return nr(n)?n:n[Kt]}function Xi(t,e){return null==e?null:t[e]}function vp(t){t[Xs]=0}function eC(t){1024&t[Pe]||(t[Pe]|=1024,tC(t,1))}function Py(t){1024&t[Pe]&&(t[Pe]&=-1025,tC(t,-1))}function tC(t,e){let n=t[Je];if(null===n)return;n[yc]+=e;let r=n;for(n=n[Je];null!==n&&(1===e&&1===r[yc]||-1===e&&0===r[yc]);)n[yc]+=e,r=n,n=n[Je]}const be={lFrame:Id(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function xy(){return be.bindingsEnabled}function W(){return be.lFrame.lView}function et(){return be.lFrame.tView}function hi(t){return be.lFrame.contextLView=t,t[sn]}function fi(t){return be.lFrame.contextLView=null,t}function qn(){let t=yd();for(;null!==t&&64===t.type;)t=t.parent;return t}function yd(){return be.lFrame.currentTNode}function pi(t,e){const n=be.lFrame;n.currentTNode=t,n.isParent=e}function Ip(){return be.lFrame.isParent}function Pc(){be.lFrame.isParent=!1}function zn(){const t=be.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function Ji(){return be.lFrame.bindingIndex++}function lC(t,e){const n=be.lFrame;n.bindingIndex=n.bindingRootIndex=t,xc(e)}function xc(t){be.lFrame.currentDirectiveIndex=t}function Oy(){return be.lFrame.currentQueryIndex}function Tp(t){be.lFrame.currentQueryIndex=t}function Cp(t){const e=t[oe];return 2===e.type?e.declTNode:1===e.type?t[Ln]:null}function Fy(t,e,n){if(n&He.SkipSelf){let i=e,s=t;for(;!(i=i.parent,null!==i||n&He.Host||(i=Cp(s),null===i||(s=s[ws],10&i.type))););if(null===i)return!1;e=i,t=s}const r=be.lFrame=Vy();return r.currentTNode=e,r.lView=t,!0}function Mc(t){const e=Vy(),n=t[oe];be.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function Vy(){const t=be.lFrame,e=null===t?null:t.child;return null===e?Id(t):e}function Id(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function wd(){const t=be.lFrame;return be.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Ly=wd;function ea(){const t=wd();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Wn(){return be.lFrame.selectedIndex}function Cs(t){be.lFrame.selectedIndex=t}let $y=!0;function eu(){return $y}function to(t){$y=t}function tu(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:d,ngOnDestroy:f}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),d&&((t.viewHooks??=[]).push(n,d),(t.viewCheckHooks??=[]).push(n,d)),null!=f&&(t.destroyHooks??=[]).push(n,f)}}function Td(t,e,n){Hy(t,e,3,n)}function Cd(t,e,n,r){(3&t[Pe])===n&&Hy(t,e,n,r)}function kc(t,e){let n=t[Pe];(3&n)===e&&(n&=8191,n+=1,t[Pe]=n)}function Hy(t,e,n,r){const s=r??-1,o=e.length-1;let a=0;for(let u=void 0!==r?65535&t[Xs]:0;u<o;u++)if("number"==typeof e[u+1]){if(a=e[u],null!=r&&a>=r)break}else e[u]<0&&(t[Xs]+=65536),(a<s||-1==s)&&(Dd(t,n,e,u),t[Xs]=(4294901760&t[Xs])+u+2),u++}function bd(t,e){di(4,t,e);const n=li(null);try{e.call(t)}finally{li(n),di(5,t,e)}}function Dd(t,e,n,r){const i=n[r]<0,s=n[r+1],a=t[i?-n[r]:n[r]];i?t[Pe]>>13<t[Xs]>>16&&(3&t[Pe])===e&&(t[Pe]+=8192,bd(a,s)):bd(a,s)}const no=-1;class nu{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function Ap(t){return t!==no}function Oc(t){return 32767&t}function ta(t,e){let n=function vC(t){return t>>16}(t),r=e;for(;n>0;)r=r[ws],n--;return r}let Sp=!0;function Sd(t){const e=Sp;return Sp=t,e}const zy=255,Fc=5;let IC=0;const es={};function Rd(t,e){const n=Wy(t,e);if(-1!==n)return n;const r=e[oe];r.firstCreatePass&&(t.injectorIndex=e.length,Rp(r.data,t),Rp(e,null),Rp(r.blueprint,null));const i=Pd(t,e),s=t.injectorIndex;if(Ap(i)){const o=Oc(i),a=ta(i,e),u=a[oe].data;for(let d=0;d<8;d++)e[s+d]=a[o+d]|u[o+d]}return e[s+8]=i,s}function Rp(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Wy(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function Pd(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){if(r=tv(i),null===r)return no;if(n++,i=i[ws],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return no}function Pp(t,e,n){!function wC(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(jo)&&(r=n[jo]),null==r&&(r=n[jo]=IC++);const i=r&zy;e.data[t+(i>>Fc)]|=1<<i}(t,e,n)}function Ky(t,e,n){if(n&He.Optional||void 0!==t)return t;le()}function Zy(t,e,n,r){if(n&He.Optional&&void 0===r&&(r=null),!(n&(He.Self|He.Host))){const i=t[Is],s=pr(void 0);try{return i?i.get(e,r,n&He.Optional):Bo(e,r,n&He.Optional)}finally{pr(s)}}return Ky(r,0,n)}function Qy(t,e,n,r=He.Default,i){if(null!==t){if(2048&e[Pe]&&!(r&He.Self)){const o=function ev(t,e,n,r,i){let s=t,o=e;for(;null!==s&&null!==o&&2048&o[Pe]&&!(512&o[Pe]);){const a=Yy(s,o,n,r|He.Self,es);if(a!==es)return a;let u=s.parent;if(!u){const d=o[vc];if(d){const f=d.get(n,es,r);if(f!==es)return f}u=tv(o),o=o[ws]}s=u}return i}(t,e,n,r,es);if(o!==es)return o}const s=Yy(t,e,n,r,es);if(s!==es)return s}return Zy(e,n,r,i)}function Yy(t,e,n,r,i){const s=function CC(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(jo)?t[jo]:void 0;return"number"==typeof e?e>=0?e&zy:bC:e}(n);if("function"==typeof s){if(!Fy(e,t,r))return r&He.Host?Ky(i,0,r):Zy(e,n,r,i);try{let o;if(o=s(r),null!=o||r&He.Optional)return o;le()}finally{Ly()}}else if("number"==typeof s){let o=null,a=Wy(t,e),u=no,d=r&He.Host?e[Zt][Ln]:null;for((-1===a||r&He.SkipSelf)&&(u=-1===a?Pd(t,e):e[a+8],u!==no&&Jy(r,!1)?(o=e[oe],a=Oc(u),e=ta(u,e)):a=-1);-1!==a;){const f=e[oe];if(Xy(s,a,f.data)){const g=TC(a,e,n,o,r,d);if(g!==es)return g}u=e[a+8],u!==no&&Jy(r,e[oe].data[a+8]===d)&&Xy(s,a,e)?(o=f,a=Oc(u),e=ta(u,e)):a=-1}}return i}function TC(t,e,n,r,i,s){const o=e[oe],a=o.data[t+8],f=Vc(a,o,n,null==r?Zo(a)&&Sp:r!=o&&0!=(3&a.type),i&He.Host&&s===a);return null!==f?na(e,o,f,a):es}function Vc(t,e,n,r,i){const s=t.providerIndexes,o=e.data,a=1048575&s,u=t.directiveStart,f=s>>20,m=i?a+f:t.directiveEnd;for(let y=r?a:a+f;y<m;y++){const E=o[y];if(y<u&&n===E||y>=u&&E.type===n)return y}if(i){const y=o[u];if(y&&Pi(y)&&y.type===n)return u}return null}function na(t,e,n,r){let i=t[n];const s=e.data;if(function Dp(t){return t instanceof nu}(i)){const o=i;o.resolving&&function j(t,e){const n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new q(-200,`Circular dependency in DI detected for ${t}${n}`)}(function Ze(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():we(t)}(s[n]));const a=Sd(o.canSeeViewProviders);o.resolving=!0;const d=o.injectImpl?pr(o.injectImpl):null;Fy(t,r,He.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&function gC(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const o=by(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}(n,s[n],e)}finally{null!==d&&pr(d),Sd(a),o.resolving=!1,Ly()}}return i}function Xy(t,e,n){return!!(n[e+(t>>Fc)]&1<<t)}function Jy(t,e){return!(t&He.Self||t&He.Host&&e)}class Kn{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return Qy(this._tNode,this._lView,e,mc(r),n)}}function bC(){return new Kn(qn(),W())}function Pn(t){return Si(()=>{const e=t.prototype.constructor,n=e[ai]||Mp(e),r=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){const s=i[ai]||Mp(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Mp(t){return Sn(t)?()=>{const e=Mp(ae(t));return e&&e()}:Qo(t)}function tv(t){const e=t[oe],n=e.type;return 2===n?e.declTNode:1===n?t[Ln]:null}const Uc="__parameters__";function ra(t,e,n){return Si(()=>{const r=function su(t){return function(...n){if(t){const r=t(...n);for(const i in r)this[i]=r[i]}}}(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(u,d,f){const g=u.hasOwnProperty(Uc)?u[Uc]:Object.defineProperty(u,Uc,{value:[]})[Uc];for(;g.length<=f;)g.push(null);return(g[f]=g[f]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}function ou(t,e){t.forEach(n=>Array.isArray(n)?ou(n,e):e(n))}function Nd(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function xd(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function Hr(t,e,n){let r=sa(t,e);return r>=0?t[1|r]=n:(r=~r,function PC(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(1===i)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;)t[i]=t[i-2],i--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function Lp(t,e){const n=sa(t,e);if(n>=0)return t[1|n]}function sa(t,e){return function rv(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){const s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}(t,e,1)}const au=Ha(ra("Optional"),8),Od=Ha(ra("SkipSelf"),4);function jd(t){return 128==(128&t.flags)}var c=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(c||{});const l=/^>|^->|<!--|-->|--!>|<!-$/g,p=/(<|>)/g,_="\u200b$1\u200b";const w=new Map;let S=0;const zr="__ngContext__";function Qt(t,e){nr(e)?(t[zr]=e[zo],function H(t){w.set(t[zo],t)}(e)):t[zr]=e}let GC;function qC(t,e){return GC(t,e)}function Zp(t){const e=t[Je];return mr(e)?e[Je]:e}function xx(t){return kx(t[qo])}function Mx(t){return kx(t[ui])}function kx(t){for(;null!==t&&!mr(t);)t=t[ui];return t}function Gd(t,e,n,r,i){if(null!=r){let s,o=!1;mr(r)?s=r:nr(r)&&(o=!0,r=r[Kt]);const a=Tt(r);0===t&&null!==n?null==i?Lx(e,n,a):qc(e,n,a,i||null,!0):1===t&&null!==n?qc(e,n,a,i||null,!0):2===t?function Cv(t,e,n){const r=wv(t,e);r&&function Cz(t,e,n,r){t.removeChild(e,n,r)}(t,r,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function Az(t,e,n,r,i){const s=n[ci];s!==Tt(n)&&Gd(e,t,r,s,i);for(let a=En;a<n.length;a++){const u=n[a];Yp(u[oe],u,t,e,r,s)}}(e,t,s,n,i)}}function zC(t,e){return t.createComment(function v(t){return t.replace(l,e=>e.replace(p,_))}(e))}function Ev(t,e,n){return t.createElement(e,n)}function Fx(t,e){const n=t[eo],r=n.indexOf(e);Py(e),n.splice(r,1)}function Iv(t,e){if(t.length<=En)return;const n=En+e,r=t[n];if(r){const i=r[Wa];null!==i&&i!==t&&Fx(i,r),e>0&&(t[n-1][ui]=r[ui]);const s=xd(t,En+e);!function mz(t,e){Yp(t,e,e[Ae],2,null,null),e[Kt]=null,e[Ln]=null}(r[oe],r);const o=s[Ri];null!==o&&o.detachView(s[oe]),r[Je]=null,r[ui]=null,r[Pe]&=-129}return r}function WC(t,e){if(!(256&e[Pe])){const n=e[Ae];e[Wo]&&GT(e[Wo]),e[Ka]&&GT(e[Ka]),n.destroyNode&&Yp(t,e,n,3,null,null),function vz(t){let e=t[qo];if(!e)return KC(t[oe],t);for(;e;){let n=null;if(nr(e))n=e[qo];else{const r=e[En];r&&(n=r)}if(!n){for(;e&&!e[ui]&&e!==t;)nr(e)&&KC(e[oe],e),e=e[Je];null===e&&(e=t),nr(e)&&KC(e[oe],e),n=e&&e[ui]}e=n}}(e)}}function KC(t,e){if(!(256&e[Pe])){e[Pe]&=-129,e[Pe]|=256,function Tz(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const i=e[n[r]];if(!(i instanceof nu)){const s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],u=s[o+1];di(4,a,u);try{u.call(a)}finally{di(5,a,u)}}else{di(4,i,s);try{s.call(i)}finally{di(5,i,s)}}}}}(t,e),function wz(t,e){const n=t.cleanup,r=e[Es];if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else n[s].call(r[n[s+1]]);null!==r&&(e[Es]=null);const i=e[Zi];if(null!==i){e[Zi]=null;for(let s=0;s<i.length;s++)(0,i[s])()}}(t,e),1===e[oe].type&&e[Ae].destroy();const n=e[Wa];if(null!==n&&mr(e[Je])){n!==e[Je]&&Fx(n,e);const r=e[Ri];null!==r&&r.detachView(t)}!function te(t){w.delete(t[zo])}(e)}}function ZC(t,e,n){return function Vx(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[Kt];{const{componentOffset:i}=r;if(i>-1){const{encapsulation:s}=t.data[r.directiveStart+i];if(s===$r.None||s===$r.Emulated)return null}return _r(r,n)}}(t,e.parent,n)}function qc(t,e,n,r,i){t.insertBefore(e,n,r,i)}function Lx(t,e,n){t.appendChild(e,n)}function Ux(t,e,n,r,i){null!==r?qc(t,e,n,r,i):Lx(t,e,n)}function wv(t,e){return t.parentNode(e)}let QC,bv,eb,Dv,$x=function jx(t,e,n){return 40&t.type?_r(t,n):null};function Tv(t,e,n,r){const i=ZC(t,r,e),s=e[Ae],a=function Bx(t,e,n){return $x(t,e,n)}(r.parent||e[Ln],r,e);if(null!=i)if(Array.isArray(n))for(let u=0;u<n.length;u++)Ux(s,i,n[u],a,!1);else Ux(s,i,n,a,!1);void 0!==QC&&QC(s,r,e,n,i)}function Qp(t,e){if(null!==e){const n=e.type;if(3&n)return _r(e,t);if(4&n)return YC(-1,t[e.index]);if(8&n){const r=e.child;if(null!==r)return Qp(t,r);{const i=t[e.index];return mr(i)?YC(-1,i):Tt(i)}}if(32&n)return qC(e,t)()||Tt(t[e.index]);{const r=Gx(t,e);return null!==r?Array.isArray(r)?r[0]:Qp(Zp(t[Zt]),r):Qp(t,e.next)}}return null}function Gx(t,e){return null!==e?t[Zt][Ln].projection[e.projection]:null}function YC(t,e){const n=En+t+1;if(n<e.length){const r=e[n],i=r[oe].firstChild;if(null!==i)return Qp(r,i)}return e[ci]}function XC(t,e,n,r,i,s,o){for(;null!=n;){const a=r[n.index],u=n.type;if(o&&0===e&&(a&&Qt(Tt(a),r),n.flags|=2),32!=(32&n.flags))if(8&u)XC(t,e,n.child,r,i,s,!1),Gd(e,t,i,a,s);else if(32&u){const d=qC(n,r);let f;for(;f=d();)Gd(e,t,i,f,s);Gd(e,t,i,a,s)}else 16&u?zx(t,e,r,n,i,s):Gd(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Yp(t,e,n,r,i,s){XC(n,r,t.firstChild,e,i,s,!1)}function zx(t,e,n,r,i,s){const o=n[Zt],u=o[Ln].projection[r.projection];if(Array.isArray(u))for(let d=0;d<u.length;d++)Gd(e,t,i,u[d],s);else{let d=u;const f=o[Je];jd(r)&&(d.flags|=128),XC(t,e,d,f,i,s,!0)}}function Wx(t,e,n){""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function Kx(t,e,n){const{mergedAttrs:r,classes:i,styles:s}=n;null!==r&&tp(t,e,r),null!==i&&Wx(t,e,i),null!==s&&function Rz(t,e,n){t.setAttribute(e,"style",n)}(t,e,s)}function qd(t){return function JC(){if(void 0===bv&&(bv=null,Rt.trustedTypes))try{bv=Rt.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return bv}()?.createHTML(t)||t}function zd(){if(void 0!==eb)return eb;if(typeof document<"u")return document;throw new q(210,!1)}function Zx(t){return function tb(){if(void 0===Dv&&(Dv=null,Rt.trustedTypes))try{Dv=Rt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Dv}()?.createHTML(t)||t}class Xx{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${it})`}}function du(t){return t instanceof Xx?t.changingThisBreaksApplicationSecurity:t}class Bz{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const n=(new window.DOMParser).parseFromString(qd(e),"text/html").body;return null===n?this.inertDocumentHelper.getInertBodyElement(e):(n.removeChild(n.firstChild),n)}catch{return null}}}class jz{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const n=this.inertDocument.createElement("template");return n.innerHTML=qd(e),n}}const Hz=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function nb(t){return(t=String(t)).match(Hz)?t:"unsafe:"+t}function aa(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function Jp(...t){const e={};for(const n of t)for(const r in n)n.hasOwnProperty(r)&&(e[r]=!0);return e}const eM=aa("area,br,col,hr,img,wbr"),tM=aa("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),nM=aa("rp,rt"),rb=Jp(eM,Jp(tM,aa("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Jp(nM,aa("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Jp(nM,tM)),ib=aa("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),rM=Jp(ib,aa("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),aa("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Gz=aa("script,style,template");class qz{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let n=e.firstChild,r=!0;for(;n;)if(n.nodeType===Node.ELEMENT_NODE?r=this.startElement(n):n.nodeType===Node.TEXT_NODE?this.chars(n.nodeValue):this.sanitizedSomething=!0,r&&n.firstChild)n=n.firstChild;else for(;n;){n.nodeType===Node.ELEMENT_NODE&&this.endElement(n);let i=this.checkClobberedElement(n,n.nextSibling);if(i){n=i;break}n=this.checkClobberedElement(n,n.parentNode)}return this.buf.join("")}startElement(e){const n=e.nodeName.toLowerCase();if(!rb.hasOwnProperty(n))return this.sanitizedSomething=!0,!Gz.hasOwnProperty(n);this.buf.push("<"),this.buf.push(n);const r=e.attributes;for(let i=0;i<r.length;i++){const s=r.item(i),o=s.name,a=o.toLowerCase();if(!rM.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let u=s.value;ib[a]&&(u=nb(u)),this.buf.push(" ",o,'="',iM(u),'"')}return this.buf.push(">"),!0}endElement(e){const n=e.nodeName.toLowerCase();rb.hasOwnProperty(n)&&!eM.hasOwnProperty(n)&&(this.buf.push("</"),this.buf.push(n),this.buf.push(">"))}chars(e){this.buf.push(iM(e))}checkClobberedElement(e,n){if(n&&(e.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return n}}const zz=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Wz=/([^\#-~ |!])/g;function iM(t){return t.replace(/&/g,"&amp;").replace(zz,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(Wz,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Av;function sb(t){return"content"in t&&function Zz(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var Wd=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Wd||{});function sM(t){const e=function eg(){const t=W();return t&&t[za].sanitizer}();return e?Zx(e.sanitize(Wd.HTML,t)||""):function Xp(t,e){const n=function Uz(t){return t instanceof Xx&&t.getTypeName()||null}(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${it})`)}return n===e}(t,"HTML")?Zx(du(t)):function Kz(t,e){let n=null;try{Av=Av||function Jx(t){const e=new jz(t);return function $z(){try{return!!(new window.DOMParser).parseFromString(qd(""),"text/html")}catch{return!1}}()?new Bz(e):e}(t);let r=e?String(e):"";n=Av.getInertBodyElement(r);let i=5,s=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=s,s=n.innerHTML,n=Av.getInertBodyElement(r)}while(r!==s);return qd((new qz).sanitizeChildren(sb(n)||n))}finally{if(n){const r=sb(n)||n;for(;r.firstChild;)r.removeChild(r.firstChild)}}}(zd(),we(t))}const tg=new re("ENVIRONMENT_INITIALIZER"),cM=new re("INJECTOR",-1),lM=new re("INJECTOR_DEF_TYPES");class ob{get(e,n=$a){if(n===$a){const r=new Error(`NullInjectorError: No provider for ${U(e)}!`);throw r.name="NullInjectorError",r}return n}}function tW(...t){return{\u0275providers:hM(0,t),\u0275fromNgModule:!0}}function hM(t,...e){const n=[],r=new Set;let i;const s=o=>{n.push(o)};return ou(e,o=>{const a=o;Sv(a,s,[],r)&&(i||=[],i.push(a))}),void 0!==i&&fM(i,s),n}function fM(t,e){for(let n=0;n<t.length;n++){const{ngModule:r,providers:i}=t[n];ab(i,s=>{e(s,r)})}}function Sv(t,e,n,r){if(!(t=ae(t)))return!1;let i=null,s=_s(t);const o=!s&&ke(t);if(s||o){if(o&&!o.standalone)return!1;i=t}else{const u=t.ngModule;if(s=_s(u),!s)return!1;i=u}const a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const d of u)Sv(d,e,n,r)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let d;r.add(i);try{ou(s.imports,f=>{Sv(f,e,n,r)&&(d||=[],d.push(f))})}finally{}void 0!==d&&fM(d,e)}if(!a){const d=Qo(i)||(()=>new i);e({provide:i,useFactory:d,deps:st},i),e({provide:lM,useValue:i,multi:!0},i),e({provide:tg,useValue:()=>z(i),multi:!0},i)}const u=s.providers;if(null!=u&&!a){const d=t;ab(u,f=>{e(f,d)})}}}return i!==t&&void 0!==t.providers}function ab(t,e){for(let n of t)Rn(n)&&(n=n.\u0275providers),Array.isArray(n)?ab(n,e):e(n)}const nW=T({provide:String,useValue:T});function ub(t){return null!==t&&"object"==typeof t&&nW in t}function zc(t){return"function"==typeof t}const cb=new re("Set Injector scope."),Rv={},iW={};let lb;function Pv(){return void 0===lb&&(lb=new ob),lb}class ts{}class Kd extends ts{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,hb(e,o=>this.processProvider(o)),this.records.set(cM,Zd(void 0,this)),i.has("environment")&&this.records.set(ts,Zd(void 0,this));const s=this.records.get(cb);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(lM.multi,st,He.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const n=Ys(this),r=pr(void 0);try{return e()}finally{Ys(n),pr(r)}}get(e,n=$a,r=He.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(ny))return e[ny](this);r=mc(r);const s=Ys(this),o=pr(void 0);try{if(!(r&He.SkipSelf)){let u=this.records.get(e);if(void 0===u){const d=function cW(t){return"function"==typeof t||"object"==typeof t&&t instanceof re}(e)&&Jn(e);u=d&&this.injectableDefInScope(d)?Zd(db(e),Rv):null,this.records.set(e,u)}if(null!=u)return this.hydrate(e,u)}return(r&He.Self?Pv():this.parent).get(e,n=r&He.Optional&&n===$a?null:n)}catch(a){if("NullInjectorError"===a.name){if((a[Yl]=a[Yl]||[]).unshift(U(e)),s)throw a;return function Ga(t,e,n,r){const i=t[Yl];throw e[Xl]&&i.unshift(e[Xl]),t.message=function ty(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let i=U(e);if(Array.isArray(e))i=e.map(U).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):U(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(X_,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t[Yl]=null,t}(a,e,"R3InjectorError",this.source)}throw a}finally{pr(o),Ys(s)}}resolveInjectorInitializers(){const e=Ys(this),n=pr(void 0);try{const i=this.get(tg.multi,st,He.Self);for(const s of i)s()}finally{Ys(e),pr(n)}}toString(){const e=[],n=this.records;for(const r of n.keys())e.push(U(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new q(205,!1)}processProvider(e){let n=zc(e=ae(e))?e:ae(e&&e.provide);const r=function oW(t){return ub(t)?Zd(void 0,t.useValue):Zd(mM(t),Rv)}(e);if(zc(e)||!0!==e.multi)this.records.get(n);else{let i=this.records.get(n);i||(i=Zd(void 0,Rv,!0),i.factory=()=>Jf(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===Rv&&(n.value=iW,n.value=n.factory()),"object"==typeof n.value&&n.value&&function uW(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=ae(e.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){const n=this._onDestroyHooks.indexOf(e);-1!==n&&this._onDestroyHooks.splice(n,1)}}function db(t){const e=Jn(t),n=null!==e?e.factory:Qo(t);if(null!==n)return n;if(t instanceof re)throw new q(204,!1);if(t instanceof Function)return function sW(t){const e=t.length;if(e>0)throw function $c(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}(e,"?"),new q(204,!1);const n=function Lo(t){return t&&(t[pc]||t[Zl])||null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new q(204,!1)}function mM(t,e,n){let r;if(zc(t)){const i=ae(t);return Qo(i)||db(i)}if(ub(t))r=()=>ae(t.useValue);else if(function gM(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...Jf(t.deps||[]));else if(function pM(t){return!(!t||!t.useExisting)}(t))r=()=>z(ae(t.useExisting));else{const i=ae(t&&(t.useClass||t.provide));if(!function aW(t){return!!t.deps}(t))return Qo(i)||db(i);r=()=>new i(...Jf(t.deps))}return r}function Zd(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function hb(t,e){for(const n of t)Array.isArray(n)?hb(n,e):n&&Rn(n)?hb(n.\u0275providers,e):e(n)}const Nv=new re("AppId",{providedIn:"root",factory:()=>lW}),lW="ng",_M=new re("Platform Initializer"),Ds=new re("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),yM=new re("CSP nonce",{providedIn:"root",factory:()=>zd().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let vM=(t,e,n)=>null;function Eb(t,e,n=!1){return vM(t,e,n)}class EW{}class wM{}class wW{resolveComponentFactory(e){throw function IW(t){const e=Error(`No component factory found for ${U(t)}.`);return e.ngComponent=t,e}(e)}}let Vv=(()=>{class t{static#e=this.NULL=new wW}return t})();function TW(){return Xd(qn(),W())}function Xd(t,e){return new Ni(_r(t,e))}let Ni=(()=>{class t{constructor(n){this.nativeElement=n}static#e=this.__NG_ELEMENT_ID__=TW}return t})();function CW(t){return t instanceof Ni?t.nativeElement:t}class CM{}let ua=(()=>{class t{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function bW(){const t=W(),n=yr(qn().index,t);return(nr(n)?n:t)[Ae]}()}return t})(),DW=(()=>{class t{static#e=this.\u0275prov=de({token:t,providedIn:"root",factory:()=>null})}return t})();class Jd{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const bM=new Jd("16.2.12"),Tb={};function RM(t,e=null,n=null,r){const i=PM(t,e,n,r);return i.resolveInjectorInitializers(),i}function PM(t,e=null,n=null,r,i=new Set){const s=[n||st,tW(t)];return r=r||("object"==typeof t?void 0:U(t)),new Kd(s,e||Pv(),r||null,i)}let xi=(()=>{class t{static#e=this.THROW_IF_NOT_FOUND=$a;static#t=this.NULL=new ob;static create(n,r){if(Array.isArray(n))return RM({name:""},r,n,"");{const i=n.name??"";return RM({name:i},n.parent,n.providers,i)}}static#n=this.\u0275prov=de({token:t,providedIn:"any",factory:()=>z(cM)});static#r=this.__NG_ELEMENT_ID__=-1}return t})();function bb(t){return t.ngOriginalError}class ca{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&bb(e);for(;n&&bb(n);)n=bb(n);return n||null}}function Ab(t){return e=>{setTimeout(t,void 0,e)}}const fn=class MW extends Vt{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&"object"==typeof e){const u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=Ab(s),i&&(i=Ab(i)),o&&(o=Ab(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof L&&e.add(a),a}};function xM(...t){}class lt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new fn(!1),this.onMicrotaskEmpty=new fn(!1),this.onStable=new fn(!1),this.onError=new fn(!1),typeof Zone>"u")throw new q(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function kW(){const t="function"==typeof Rt.requestAnimationFrame;let e=Rt[t?"requestAnimationFrame":"setTimeout"],n=Rt[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function VW(t){const e=()=>{!function FW(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Rt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Rb(t),t.isCheckStableRunning=!0,Sb(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Rb(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(function UW(t){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0].data?.__ignore_ng_zone__}(a))return n.invokeTask(i,s,o,a);try{return MM(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),kM(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return MM(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),kM(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,Rb(t),Sb(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!lt.isInAngularZone())throw new q(909,!1)}static assertNotInAngularZone(){if(lt.isInAngularZone())throw new q(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,OW,xM,xM);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const OW={};function Sb(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Rb(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function MM(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function kM(t){t._nesting--,Sb(t)}class LW{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new fn,this.onMicrotaskEmpty=new fn,this.onStable=new fn,this.onError=new fn}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}}const OM=new re("",{providedIn:"root",factory:FM});function FM(){const t=pe(lt);let e=!0;return An(new Ge(i=>{e=t.isStable&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks,t.runOutsideAngular(()=>{i.next(e),i.complete()})}),new Ge(i=>{let s;t.runOutsideAngular(()=>{s=t.onStable.subscribe(()=>{lt.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});const o=t.onUnstable.subscribe(()=>{lt.assertInAngularZone(),e&&(e=!1,t.runOutsideAngular(()=>{i.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(qi()))}function la(t){return t instanceof Function?t():t}let Pb=(()=>{class t{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=de({token:t,providedIn:"root",factory:()=>new t})}return t})();function ig(t){for(;t;){t[Pe]|=64;const e=Zp(t);if(wc(t)&&!e)return t;t=e}return null}const jM=new re("",{providedIn:"root",factory:()=>!1});let Uv=null;function qM(t,e){return t[e]??KM()}function zM(t,e){const n=KM();n.producerNode?.length&&(t[e]=Uv,n.lView=t,Uv=WM())}const ZW={...Yo,consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{ig(t.lView)},lView:null};function WM(){return Object.create(ZW)}function KM(){return Uv??=WM(),Uv}const Oe={};function Pt(t){ZM(et(),W(),Wn()+t,!1)}function ZM(t,e,n,r){if(!r)if(3==(3&e[Pe])){const s=t.preOrderCheckHooks;null!==s&&Td(e,s,n)}else{const s=t.preOrderHooks;null!==s&&Cd(e,s,0,n)}Cs(n)}function X(t,e=He.Default){const n=W();return null===n?z(t,e):Qy(qn(),n,ae(t),e)}function Bv(t,e,n,r,i,s,o,a,u,d,f){const g=e.blueprint.slice();return g[Kt]=i,g[Pe]=140|r,(null!==d||t&&2048&t[Pe])&&(g[Pe]|=2048),vp(g),g[Je]=g[ws]=t,g[sn]=n,g[za]=o||t&&t[za],g[Ae]=a||t&&t[Ae],g[Is]=u||t&&t[Is]||null,g[Ln]=s,g[zo]=function B(){return S++}(),g[Qi]=f,g[vc]=d,g[Zt]=2==e.type?t[Zt]:g,g}function nh(t,e,n,r,i){let s=t.data[e];if(null===s)s=function Nb(t,e,n,r,i){const s=yd(),o=Ip(),u=t.data[e]=function r9(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return function Ja(){return null!==be.skipHydrationRootTNode}()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=u),null!==s&&(o?null==s.child&&null!==u.parent&&(s.child=u):null===s.next&&(s.next=u,u.prev=s)),u}(t,e,n,r,i),function wp(){return be.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=n,s.value=r,s.attrs=i;const o=function Rc(){const t=be.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return pi(s,!0),s}function sg(t,e,n,r){if(0===n)return-1;const i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function YM(t,e,n,r,i){const s=qM(e,Wo),o=Wn(),a=2&r;try{Cs(-1),a&&e.length>$e&&ZM(t,e,$e,!1),di(a?2:0,i);const d=a?s:null,f=hp(d);try{null!==d&&(d.dirty=!1),n(r,i)}finally{Iy(d,f)}}finally{a&&null===e[Wo]&&zM(e,Wo),Cs(o),di(a?3:1,i)}}function xb(t,e,n){if(Ic(e)){const r=li(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{li(r)}}}function Mb(t,e,n){xy()&&(function l9(t,e,n,r){const i=n.directiveStart,s=n.directiveEnd;Zo(n)&&function _9(t,e,n){const r=_r(e,t),i=XM(n);let o=16;n.signals?o=4096:n.onPush&&(o=64);const a=jv(t,Bv(t,i,null,o,r,e,null,t[za].rendererFactory.createRenderer(r,n),null,null,null));t[e.index]=a}(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||Rd(n,e),Qt(r,e);const o=n.initialInputs;for(let a=i;a<s;a++){const u=t.data[a],d=na(e,t,a,n);Qt(d,e),null!==o&&y9(0,a-i,d,u,0,o),Pi(u)&&(yr(n.index,e)[sn]=na(e,t,a,n))}}(t,e,n,_r(n,e)),64==(64&n.flags)&&rk(t,e,n))}function kb(t,e,n=_r){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?n(e,t):t[o];t[i++]=a}}}function XM(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Ob(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function Ob(t,e,n,r,i,s,o,a,u,d,f){const g=$e+r,m=g+i,y=function YW(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:Oe);return n}(g,m),E="function"==typeof d?d():d;return y[oe]={type:t,blueprint:y,template:n,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,g),bindingStartIndex:g,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:E,incompleteFirstPass:!1,ssrId:f}}let JM=t=>null;function ek(t,e,n,r){for(let i in t)if(t.hasOwnProperty(i)){n=null===n?{}:n;const s=t[i];null===r?tk(n,e,i,s):r.hasOwnProperty(i)&&tk(n,e,r[i],s)}return n}function tk(t,e,n,r){t.hasOwnProperty(n)?t[n].push(e,r):t[n]=[e,r]}function Fb(t,e,n,r){if(xy()){const i=null===r?null:{"":-1},s=function h9(t,e){const n=t.directiveRegistry;let r=null,i=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];if(od(e,o.selectors,!1))if(r||(r=[]),Pi(o))if(null!==o.findHostDirectiveDefs){const a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o),Vb(t,e,a.length)}else r.unshift(o),Vb(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return null===r?null:[r,i]}(t,n);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&nk(t,e,n,o,i,a),i&&function f9(t,e,n){if(e){const r=t.localNames=[];for(let i=0;i<e.length;i+=2){const s=n[e[i+1]];if(null==s)throw new q(-301,!1);r.push(e[i],s)}}}(n,r,i)}n.mergedAttrs=$o(n.mergedAttrs,n.attrs)}function nk(t,e,n,r,i,s){for(let d=0;d<r.length;d++)Pp(Rd(n,e),t,r[d].type);!function g9(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}(n,t.data.length,r.length);for(let d=0;d<r.length;d++){const f=r[d];f.providersResolver&&f.providersResolver(f)}let o=!1,a=!1,u=sg(t,e,r.length,null);for(let d=0;d<r.length;d++){const f=r[d];n.mergedAttrs=$o(n.mergedAttrs,f.hostAttrs),m9(t,n,e,u,f),p9(u,f,i),null!==f.contentQueries&&(n.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(n.flags|=64);const g=f.type.prototype;!o&&(g.ngOnChanges||g.ngOnInit||g.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(g.ngOnChanges||g.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}!function i9(t,e,n){const i=e.directiveEnd,s=t.data,o=e.attrs,a=[];let u=null,d=null;for(let f=e.directiveStart;f<i;f++){const g=s[f],m=n?n.get(g):null,E=m?m.outputs:null;u=ek(g.inputs,f,u,m?m.inputs:null),d=ek(g.outputs,f,d,E);const C=null===u||null===o||sd(e)?null:v9(u,f,o);a.push(C)}null!==u&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=d}(t,n,s)}function rk(t,e,n){const r=n.directiveStart,i=n.directiveEnd,s=n.index,o=function dC(){return be.lFrame.currentDirectiveIndex}();try{Cs(s);for(let a=r;a<i;a++){const u=t.data[a],d=e[a];xc(a),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&d9(u,d)}}finally{Cs(-1),xc(o)}}function d9(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function Vb(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function p9(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Pi(e)&&(n[""]=t)}}function m9(t,e,n,r,i){t.data[r]=i;const s=i.factory||(i.factory=Qo(i.type)),o=new nu(s,Pi(i),X);t.blueprint[r]=o,n[r]=o,function u9(t,e,n,r,i){const s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;null===o&&(o=t.hostBindingOpCodes=[]);const a=~e.index;(function c9(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(o)!=a&&o.push(a),o.push(n,r,s)}}(t,e,r,sg(t,n,i.hostVars,Oe),i)}function y9(t,e,n,r,i,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)ik(r,n,o[a++],o[a++],o[a++])}function ik(t,e,n,r,i){const s=li(null);try{const o=t.inputTransforms;null!==o&&o.hasOwnProperty(r)&&(i=o[r].call(e,i)),null!==t.setInput?t.setInput(e,i,n,r):e[r]=i}finally{li(s)}}function v9(t,e,n){let r=null,i=0;for(;i<n.length;){const s=n[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(t.hasOwnProperty(s)){null===r&&(r=[]);const o=t[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){r.push(s,o[a+1],n[i+1]);break}}i+=2}else i+=2;else i+=4}return r}function sk(t,e,n,r){return[t,!0,!1,e,null,0,r,n,null,null,null]}function ok(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const s=n[r+1];if(-1!==s){const o=t.data[s];Tp(n[r]),o.contentQueries(2,e[s],s)}}}function jv(t,e){return t[qo]?t[cd][ui]=e:t[qo]=e,t[cd]=e,e}function Ub(t,e,n){Tp(0);const r=li(null);try{e(t,n)}finally{li(r)}}function ak(t){return t[Es]||(t[Es]=[])}function uk(t){return t.cleanup||(t.cleanup=[])}function lk(t,e){const n=t[Is],r=n?n.get(ca,null):null;r&&r.handleError(e)}function Bb(t,e,n,r,i){for(let s=0;s<n.length;){const o=n[s++],a=n[s++];ik(t.data[o],e[o],r,a,i)}}function E9(t,e){const n=yr(e,t),r=n[oe];!function I9(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n);const i=n[Kt];null!==i&&null===n[Qi]&&(n[Qi]=Eb(i,n[Is])),jb(r,n,n[sn])}function jb(t,e,n){Mc(e);try{const r=t.viewQuery;null!==r&&Ub(1,r,n);const i=t.template;null!==i&&YM(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&ok(t,e),t.staticViewQueries&&Ub(2,t.viewQuery,n);const s=t.components;null!==s&&function w9(t,e){for(let n=0;n<e.length;n++)E9(t,e[n])}(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[Pe]&=-5,ea()}}let dk=(()=>{class t{constructor(){this.all=new Set,this.queue=new Map}create(n,r,i){const s=typeof Zone>"u"?null:Zone.current,o=function ZT(t,e,n){const r=Object.create(_x);n&&(r.consumerAllowSignalWrites=!0),r.fn=t,r.schedule=e;const i=o=>{r.cleanupFn=o};return r.ref={notify:()=>Ey(r),run:()=>{if(r.dirty=!1,r.hasRun&&!HT(r))return;r.hasRun=!0;const o=hp(r);try{r.cleanupFn(),r.cleanupFn=Cy,r.fn(i)}finally{Iy(r,o)}},cleanup:()=>r.cleanupFn()},r.ref}(n,d=>{this.all.has(d)&&this.queue.set(d,s)},i);let a;this.all.add(o),o.notify();const u=()=>{o.cleanup(),a?.(),this.all.delete(o),this.queue.delete(o)};return a=r?.onDestroy(u),{destroy:u}}flush(){if(0!==this.queue.size)for(const[n,r]of this.queue)this.queue.delete(n),r?r.run(()=>n.run()):n.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=de({token:t,providedIn:"root",factory:()=>new t})}return t})();function $v(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=x(i,a):2==s&&(r=x(r,a+": "+e[++o]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}function og(t,e,n,r,i=!1){for(;null!==n;){const s=e[n.index];null!==s&&r.push(Tt(s)),mr(s)&&hk(s,r);const o=n.type;if(8&o)og(t,e,n.child,r);else if(32&o){const a=qC(n,e);let u;for(;u=a();)r.push(u)}else if(16&o){const a=Gx(e,n);if(Array.isArray(a))r.push(...a);else{const u=Zp(e[Zt]);og(u[oe],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function hk(t,e){for(let n=En;n<t.length;n++){const r=t[n],i=r[oe].firstChild;null!==i&&og(r[oe],r,i,e)}t[ci]!==t[Kt]&&e.push(t[ci])}function Hv(t,e,n,r=!0){const i=e[za],s=i.rendererFactory,o=i.afterRenderEventManager;s.begin?.(),o?.begin();try{fk(t,e,t.template,n)}catch(u){throw r&&lk(e,u),u}finally{s.end?.(),i.effectManager?.flush(),o?.end()}}function fk(t,e,n,r){const i=e[Pe];if(256!=(256&i)){e[za].effectManager?.flush(),Mc(e);try{vp(e),function vd(t){return be.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&YM(t,e,n,2,r);const o=3==(3&i);if(o){const d=t.preOrderCheckHooks;null!==d&&Td(e,d,null)}else{const d=t.preOrderHooks;null!==d&&Cd(e,d,0,null),kc(e,0)}if(function b9(t){for(let e=xx(t);null!==e;e=Mx(e)){if(!e[ay])continue;const n=e[eo];for(let r=0;r<n.length;r++){eC(n[r])}}}(e),pk(e,2),null!==t.contentQueries&&ok(t,e),o){const d=t.contentCheckHooks;null!==d&&Td(e,d)}else{const d=t.contentHooks;null!==d&&Cd(e,d,1),kc(e,1)}!function QW(t,e){const n=t.hostBindingOpCodes;if(null===n)return;const r=qM(e,Ka);try{for(let i=0;i<n.length;i++){const s=n[i];if(s<0)Cs(~s);else{const o=s,a=n[++i],u=n[++i];lC(a,o),r.dirty=!1;const d=hp(r);try{u(2,e[o])}finally{Iy(r,d)}}}}finally{null===e[Ka]&&zM(e,Ka),Cs(-1)}}(t,e);const a=t.components;null!==a&&mk(e,a,0);const u=t.viewQuery;if(null!==u&&Ub(2,u,r),o){const d=t.viewCheckHooks;null!==d&&Td(e,d)}else{const d=t.viewHooks;null!==d&&Cd(e,d,2),kc(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),e[Pe]&=-73,Py(e)}finally{ea()}}}function pk(t,e){for(let n=xx(t);null!==n;n=Mx(n))for(let r=En;r<n.length;r++)gk(n[r],e)}function D9(t,e,n){gk(yr(e,t),n)}function gk(t,e){if(!function yp(t){return 128==(128&t[Pe])}(t))return;const n=t[oe],r=t[Pe];if(80&r&&0===e||1024&r||2===e)fk(n,t,n.template,t[sn]);else if(t[yc]>0){pk(t,1);const i=n.components;null!==i&&mk(t,i,1)}}function mk(t,e,n){for(let r=0;r<e.length;r++)D9(t,e[r],n)}class ag{get rootNodes(){const e=this._lView,n=e[oe];return og(n,e,n.firstChild,[])}constructor(e,n){this._lView=e,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[sn]}set context(e){this._lView[sn]=e}get destroyed(){return 256==(256&this._lView[Pe])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Je];if(mr(e)){const n=e[8],r=n?n.indexOf(this):-1;r>-1&&(Iv(e,r),xd(n,r))}this._attachedToViewContainer=!1}WC(this._lView[oe],this._lView)}onDestroy(e){!function Jo(t,e){if(256==(256&t[Pe]))throw new q(911,!1);null===t[Zi]&&(t[Zi]=[]),t[Zi].push(e)}(this._lView,e)}markForCheck(){ig(this._cdRefInjectingView||this._lView)}detach(){this._lView[Pe]&=-129}reattach(){this._lView[Pe]|=128}detectChanges(){Hv(this._lView[oe],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new q(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function yz(t,e){Yp(t,e,e[Ae],2,null,null)}(this._lView[oe],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new q(902,!1);this._appRef=e}}class A9 extends ag{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Hv(e[oe],e,e[sn],!1)}checkNoChanges(){}get context(){return null}}class _k extends Vv{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=ke(e);return new ug(n,this.ngModule)}}function yk(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}class R9{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=mc(r);const i=this.injector.get(e,Tb,r);return i!==Tb||n===Tb?i:this.parentInjector.get(e,n,r)}}class ug extends wM{get inputs(){const e=this.componentDef,n=e.inputTransforms,r=yk(e.inputs);if(null!==n)for(const i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return yk(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function LT(t){return t.map(ip).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=(i=i||this.ngModule)instanceof ts?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new R9(e,s):e,a=o.get(CM,null);if(null===a)throw new q(407,!1);const g={rendererFactory:a,sanitizer:o.get(DW,null),effectManager:o.get(dk,null),afterRenderEventManager:o.get(Pb,null)},m=a.createRenderer(null,this.componentDef),y=this.componentDef.selectors[0][0]||"div",E=r?function XW(t,e,n,r){const s=r.get(jM,!1)||n===$r.ShadowDom,o=t.selectRootElement(e,s);return function JW(t){JM(t)}(o),o}(m,r,this.componentDef.encapsulation,o):Ev(m,y,function S9(t){const e=t.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(y)),O=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let R=null;null!==E&&(R=Eb(E,o,!0));const k=Ob(0,null,null,1,0,null,null,null,null,null,null),G=Bv(null,k,null,O,null,null,g,m,o,null,R);let ne,Te;Mc(G);try{const at=this.componentDef;let nn,xa=null;at.findHostDirectiveDefs?(nn=[],xa=new Map,at.findHostDirectiveDefs(at,nn,xa),nn.push(at)):nn=[at];const DT=function N9(t,e){const n=t[oe],r=$e;return t[r]=e,nh(n,r,2,"#host",null)}(G,E),Whe=function x9(t,e,n,r,i,s,o){const a=i[oe];!function M9(t,e,n,r){for(const i of t)e.mergedAttrs=$o(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&($v(e,e.mergedAttrs,!0),null!==n&&Kx(r,n,e))}(r,t,e,o);let u=null;null!==e&&(u=Eb(e,i[Is]));const d=s.rendererFactory.createRenderer(e,n);let f=16;n.signals?f=4096:n.onPush&&(f=64);const g=Bv(i,XM(n),null,f,i[t.index],t,s,d,null,null,u);return a.firstCreatePass&&Vb(a,t,r.length-1),jv(i,g),i[t.index]=g}(DT,E,at,nn,G,g,m);Te=Sc(k,$e),E&&function O9(t,e,n,r){if(r)tp(t,n,["ng-version",bM.full]);else{const{attrs:i,classes:s}=function sp(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let s=t[r];if("string"==typeof s)2===i?""!==s&&e.push(s,t[++r]):8===i&&n.push(s);else{if(!gr(i))break;i=s}r++}return{attrs:e,classes:n}}(e.selectors[0]);i&&tp(t,n,i),s&&s.length>0&&Wx(t,n,s.join(" "))}}(m,at,E,r),void 0!==n&&function F9(t,e,n){const r=t.projection=[];for(let i=0;i<e.length;i++){const s=n[i];r.push(null!=s?Array.from(s):null)}}(Te,this.ngContentSelectors,n),ne=function k9(t,e,n,r,i,s){const o=qn(),a=i[oe],u=_r(o,i);nk(a,i,o,n,null,r);for(let f=0;f<n.length;f++)Qt(na(i,a,o.directiveStart+f,o),i);rk(a,i,o),u&&Qt(u,i);const d=na(i,a,o.directiveStart+o.componentOffset,o);if(t[sn]=i[sn]=d,null!==s)for(const f of s)f(d,e);return xb(a,o,t),d}(Whe,at,nn,xa,G,[V9]),jb(k,G,null)}finally{ea()}return new P9(this.componentType,ne,Xd(Te,G),G,Te)}}class P9 extends EW{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new A9(i),this.componentType=e}setInput(e,n){const r=this._tNode.inputs;let i;if(null!==r&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;const s=this._rootLView;Bb(s[oe],s,i,e,n),this.previousInputValues.set(e,n),ig(yr(this._tNode.index,s))}}get injector(){return new Kn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function V9(){const t=qn();tu(W()[oe],t)}function Ct(t){let e=function vk(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),n=!0;const r=[t];for(;e;){let i;if(Pi(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new q(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);const o=t;o.inputs=Gv(t.inputs),o.inputTransforms=Gv(t.inputTransforms),o.declaredInputs=Gv(t.declaredInputs),o.outputs=Gv(t.outputs);const a=i.hostBindings;a&&j9(t,a);const u=i.viewQuery,d=i.contentQueries;if(u&&U9(t,u),d&&B9(t,d),P(t.inputs,i.inputs),P(t.declaredInputs,i.declaredInputs),P(t.outputs,i.outputs),null!==i.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),P(o.inputTransforms,i.inputTransforms)),Pi(i)&&i.data.animation){const f=t.data;f.animation=(f.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(t),a===Ct&&(n=!1)}}e=Object.getPrototypeOf(e)}!function L9(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){const i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=$o(i.hostAttrs,n=$o(n,i.hostAttrs))}}(r)}function Gv(t){return t===Wi?{}:t===st?[]:t}function U9(t,e){const n=t.viewQuery;t.viewQuery=n?(r,i)=>{e(r,i),n(r,i)}:e}function B9(t,e){const n=t.contentQueries;t.contentQueries=n?(r,i,s)=>{e(r,i,s),n(r,i,s)}:e}function j9(t,e){const n=t.hostBindings;t.hostBindings=n?(r,i)=>{e(r,i),n(r,i)}:e}function Pr(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function ki(t,e,n,r,i,s,o,a){const u=W(),d=et(),f=t+$e,g=d.firstCreatePass?function h3(t,e,n,r,i,s,o,a,u){const d=e.consts,f=nh(e,t,4,o||null,Xi(d,a));Fb(e,n,f,Xi(d,u)),tu(e,f);const g=f.tView=Ob(2,f,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,d,null);return null!==e.queries&&(e.queries.template(e,f),g.queries=e.queries.embeddedTView(f)),f}(f,d,u,e,n,r,i,s,o):d.data[f];pi(g,!1);const m=Fk(d,u,g,t);eu()&&Tv(d,u,m,g),Qt(m,u),jv(u,u[f]=sk(m,u,m,g)),Za(g)&&Mb(d,u,g),null!=o&&kb(u,g,a)}let Fk=function Vk(t,e,n,r){return to(!0),e[Ae].createComment("")};function Ut(t,e,n){const r=W();return Pr(r,Ji(),e)&&function Mi(t,e,n,r,i,s,o,a){const u=_r(e,n);let f,d=e.inputs;!a&&null!=d&&(f=d[r])?(Bb(t,n,f,r,i),Zo(e)&&function o9(t,e){const n=yr(e,t);16&n[Pe]||(n[Pe]|=64)}(n,e.index)):3&e.type&&(r=function s9(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),i=null!=o?o(i,e.value||"",r):i,s.setProperty(u,r,i))}(et(),function kt(){const t=be.lFrame;return Sc(t.tView,t.selectedIndex)}(),r,t,e,r[Ae],n,!1),Ut}function Kb(t,e,n,r,i){const o=i?"class":"style";Bb(t,n,e.inputs[o],o,r)}function mt(t,e,n,r){const i=W(),s=et(),o=$e+t,a=i[Ae],u=s.firstCreatePass?function _3(t,e,n,r,i,s){const o=e.consts,u=nh(e,t,2,r,Xi(o,i));return Fb(e,n,u,Xi(o,s)),null!==u.attrs&&$v(u,u.attrs,!1),null!==u.mergedAttrs&&$v(u,u.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,u),u}(o,s,i,e,n,r):s.data[o],d=Lk(s,i,u,a,e,t);i[o]=d;const f=Za(u);return pi(u,!0),Kx(a,d,u),32!=(32&u.flags)&&eu()&&Tv(s,i,d,u),0===function rC(){return be.lFrame.elementDepthCount}()&&Qt(d,i),function _d(){be.lFrame.elementDepthCount++}(),f&&(Mb(s,i,u),xb(s,u,i)),null!==r&&kb(i,u),mt}function _t(){let t=qn();Ip()?Pc():(t=t.parent,pi(t,!1));const e=t;(function Ep(t){return be.skipHydrationRootTNode===t})(e)&&function uC(){be.skipHydrationRootTNode=null}(),function iC(){be.lFrame.elementDepthCount--}();const n=et();return n.firstCreatePass&&(tu(n,t),Ic(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function Gy(t){return 0!=(8&t.flags)}(e)&&Kb(n,e,W(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function _C(t){return 0!=(16&t.flags)}(e)&&Kb(n,e,W(),e.stylesWithoutHost,!1),_t}function fg(t,e,n,r){return mt(t,e,n,r),_t(),fg}let Lk=(t,e,n,r,i,s)=>(to(!0),Ev(r,i,function jy(){return be.lFrame.currentNamespace}()));function Qv(t,e,n){const r=W(),i=et(),s=t+$e,o=i.firstCreatePass?function E3(t,e,n,r,i){const s=e.consts,o=Xi(s,r),a=nh(e,t,8,"ng-container",o);return null!==o&&$v(a,o,!0),Fb(e,n,a,Xi(s,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,i,r,e,n):i.data[s];pi(o,!0);const a=Uk(i,r,o,t);return r[s]=a,eu()&&Tv(i,r,a,o),Qt(a,r),Za(o)&&(Mb(i,r,o),xb(i,o,r)),null!=n&&kb(r,o),Qv}function Yv(){let t=qn();const e=et();return Ip()?Pc():(t=t.parent,pi(t,!1)),e.firstCreatePass&&(tu(e,t),Ic(t)&&e.queries.elementEnd(t)),Yv}function Zb(t,e,n){return Qv(t,e,n),Yv(),Zb}let Uk=(t,e,n,r)=>(to(!0),zC(e[Ae],""));function hu(){return W()}function pg(t){return!!t&&"function"==typeof t.then}function Bk(t){return!!t&&"function"==typeof t.subscribe}function Bt(t,e,n,r){const i=W(),s=et(),o=qn();return function $k(t,e,n,r,i,s,o){const a=Za(r),d=t.firstCreatePass&&uk(t),f=e[sn],g=ak(e);let m=!0;if(3&r.type||o){const C=_r(r,e),D=o?o(C):C,O=g.length,R=o?G=>o(Tt(G[r.index])):r.index;let k=null;if(!o&&a&&(k=function T3(t,e,n,r){const i=t.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===n&&i[s+1]===r){const a=e[Es],u=i[s+2];return a.length>u?a[u]:null}"string"==typeof o&&(s+=2)}return null}(t,e,i,r.index)),null!==k)(k.__ngLastListenerFn__||k).__ngNextListenerFn__=s,k.__ngLastListenerFn__=s,m=!1;else{s=Gk(r,e,f,s,!1);const G=n.listen(D,i,s);g.push(s,G),d&&d.push(i,R,O,O+1)}}else s=Gk(r,e,f,s,!1);const y=r.outputs;let E;if(m&&null!==y&&(E=y[i])){const C=E.length;if(C)for(let D=0;D<C;D+=2){const ne=e[E[D]][E[D+1]].subscribe(s),Te=g.length;g.push(s,ne),d&&d.push(i,r.index,Te,-(Te+1))}}}(s,i,i[Ae],o,t,e,r),Bt}function Hk(t,e,n,r){try{return di(6,e,n),!1!==n(r)}catch(i){return lk(t,i),!1}finally{di(7,e,n)}}function Gk(t,e,n,r,i){return function s(o){if(o===Function)return r;ig(t.componentOffset>-1?yr(t.index,e):e);let u=Hk(e,n,r,o),d=s.__ngNextListenerFn__;for(;d;)u=Hk(e,n,d,o)&&u,d=d.__ngNextListenerFn__;return i&&!1===u&&o.preventDefault(),u}}function Zn(t=1){return function hC(t){return(be.lFrame.contextLView=function fC(t,e){for(;t>0;)e=e[ws],t--;return e}(t,be.lFrame.contextLView))[sn]}(t)}function Xv(t,e){return t<<17|e<<2}function fu(t){return t>>17&32767}function Yb(t){return 2|t}function Kc(t){return(131068&t)>>2}function Xb(t,e){return-131069&t|e<<2}function Jb(t){return 1|t}function eO(t,e,n,r,i){const s=t[n+1],o=null===e;let a=r?fu(s):Kc(s),u=!1;for(;0!==a&&(!1===u||o);){const f=t[a+1];x3(t[a],e)&&(u=!0,t[a+1]=r?Jb(f):Yb(f)),a=r?fu(f):Kc(f)}u&&(t[n+1]=r?Yb(s):Jb(s))}function x3(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&sa(t,e)>=0}function gg(t,e){return function As(t,e,n,r){const i=W(),s=et(),o=function vr(t){const e=be.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}(2);s.firstUpdatePass&&function cO(t,e,n,r){const i=t.data;if(null===i[n+1]){const s=i[Wn()],o=function uO(t,e){return e>=t.expandoStartIndex}(t,n);(function fO(t,e){return 0!=(t.flags&(e?8:16))})(s,r)&&null===e&&!o&&(e=!1),e=function j3(t,e,n,r){const i=function Ed(t){const e=be.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let s=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(n=mg(n=eD(null,t,e,n,r),e.attrs,r),s=null);else{const o=e.directiveStylingLast;if(-1===o||t[o]!==i)if(n=eD(i,t,e,n,r),null===s){let u=function $3(t,e,n){const r=n?e.classBindings:e.styleBindings;if(0!==Kc(r))return t[fu(r)]}(t,e,r);void 0!==u&&Array.isArray(u)&&(u=eD(null,t,e,u[1],r),u=mg(u,e.attrs,r),function H3(t,e,n,r){t[fu(n?e.classBindings:e.styleBindings)]=r}(t,e,r,u))}else s=function G3(t,e,n){let r;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)r=mg(r,t[s].hostAttrs,n);return mg(r,e.attrs,n)}(t,e,r)}return void 0!==s&&(r?e.residualClasses=s:e.residualStyles=s),n}(i,s,e,r),function P3(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=fu(o),u=Kc(o);t[r]=n;let f,d=!1;if(Array.isArray(n)?(f=n[1],(null===f||sa(n,f)>0)&&(d=!0)):f=n,i)if(0!==u){const m=fu(t[a+1]);t[r+1]=Xv(m,a),0!==m&&(t[m+1]=Xb(t[m+1],r)),t[a+1]=function S3(t,e){return 131071&t|e<<17}(t[a+1],r)}else t[r+1]=Xv(a,0),0!==a&&(t[a+1]=Xb(t[a+1],r)),a=r;else t[r+1]=Xv(u,0),0===a?a=r:t[u+1]=Xb(t[u+1],r),u=r;d&&(t[r+1]=Yb(t[r+1])),eO(t,f,r,!0),eO(t,f,r,!1),function N3(t,e,n,r,i){const s=i?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof e&&sa(s,e)>=0&&(n[r+1]=Jb(n[r+1]))}(e,f,t,r,s),o=Xv(a,u),s?e.classBindings=o:e.styleBindings=o}(i,s,e,n,o,r)}}(s,t,o,r),e!==Oe&&Pr(i,o,e)&&function dO(t,e,n,r,i,s,o,a){if(!(3&e.type))return;const u=t.data,d=u[a+1],f=function R3(t){return 1==(1&t)}(d)?hO(u,e,n,i,Kc(d),o):void 0;Jv(f)||(Jv(s)||function A3(t){return 2==(2&t)}(d)&&(s=hO(u,null,n,i,a,o)),function Sz(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=-1===r.indexOf("-")?void 0:c.DashCase;null==i?t.removeStyle(n,r,s):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=c.Important),t.setStyle(n,r,i,s))}}(r,o,Xo(Wn(),n),i,s))}(s,s.data[Wn()],i,i[Ae],t,i[o+1]=function K3(t,e){return null==t||""===t||("string"==typeof e?t+=e:"object"==typeof t&&(t=U(du(t)))),t}(e,n),r,o)}(t,e,null,!0),gg}function eD(t,e,n,r,i){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=e[a],r=mg(r,s.hostAttrs,i),s!==t);)a++;return null!==t&&(n.directiveStylingLast=a),r}function mg(t,e,n){const r=n?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Hr(t,o,!!n||e[++s]))}return void 0===t?null:t}function hO(t,e,n,r,i,s){const o=null===e;let a;for(;i>0;){const u=t[i],d=Array.isArray(u),f=d?u[1]:u,g=null===f;let m=n[i+1];m===Oe&&(m=g?st:void 0);let y=g?Lp(m,r):f===r?m:void 0;if(d&&!Jv(y)&&(y=Lp(u,r)),Jv(y)&&(a=y,o))return a;const E=t[i+1];i=o?fu(E):Kc(E)}if(null!==e){let u=s?e.residualClasses:e.residualStyles;null!=u&&(a=Lp(u,r))}return a}function Jv(t){return void 0!==t}function Bn(t,e=""){const n=W(),r=et(),i=t+$e,s=r.firstCreatePass?nh(r,i,1,e,null):r.data[i],o=pO(r,n,s,e,t);n[i]=o,eu()&&Tv(r,n,o,s),pi(s,!1)}let pO=(t,e,n,r,i)=>(to(!0),function vv(t,e){return t.createText(e)}(e[Ae],r));function eE(t){return _g("",t,""),eE}function _g(t,e,n){const r=W(),i=function ih(t,e,n,r){return Pr(t,Ji(),n)?e+we(n)+r:Oe}(r,t,e,n);return i!==Oe&&function da(t,e,n){const r=Xo(e,t);!function Ox(t,e,n){t.setValue(e,n)}(t[Ae],r,n)}(r,Wn(),i),_g}const Zc=void 0;var m6=["en",[["a","p"],["AM","PM"],Zc],[["AM","PM"],Zc,Zc],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Zc,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Zc,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Zc,"{1} 'at' {0}",Zc],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function g6(t){const n=Math.floor(Math.abs(t)),r=t.toString().replace(/^[^.]*\.?/,"").length;return 1===n&&0===r?1:5}];let fh={};function Wr(t){const e=function _6(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=OO(e);if(n)return n;const r=e.split("-")[0];if(n=OO(r),n)return n;if("en"===r)return m6;throw new q(701,!1)}function OO(t){return t in fh||(fh[t]=Rt.ng&&Rt.ng.common&&Rt.ng.common.locales&&Rt.ng.common.locales[t]),fh[t]}var jt=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(jt||{});const ph="en-US";let FO=ph;function rD(t,e,n,r,i){if(t=ae(t),Array.isArray(t))for(let s=0;s<t.length;s++)rD(t[s],e,n,r,i);else{const s=et(),o=W(),a=qn();let u=zc(t)?t:ae(t.provide);const d=mM(t),f=1048575&a.providerIndexes,g=a.directiveStart,m=a.providerIndexes>>20;if(zc(t)||!t.multi){const y=new nu(d,i,X),E=sD(u,e,i?f:f+m,g);-1===E?(Pp(Rd(a,o),s,u),iD(s,t,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(y),o.push(y)):(n[E]=y,o[E]=y)}else{const y=sD(u,e,f+m,g),E=sD(u,e,f,f+m),D=E>=0&&n[E];if(i&&!D||!i&&!(y>=0&&n[y])){Pp(Rd(a,o),s,u);const O=function g5(t,e,n,r,i){const s=new nu(t,n,X);return s.multi=[],s.index=e,s.componentProviders=0,a1(s,i,r&&!n),s}(i?p5:f5,n.length,i,r,d);!i&&D&&(n[E].providerFactory=O),iD(s,t,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(O),o.push(O)}else iD(s,t,y>-1?y:E,a1(n[i?E:y],d,!i&&r));!i&&r&&D&&n[E].componentProviders++}}}function iD(t,e,n,r){const i=zc(e),s=function rW(t){return!!t.useClass}(e);if(i||s){const u=(s?ae(e.useClass):e).prototype.ngOnDestroy;if(u){const d=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){const f=d.indexOf(n);-1===f?d.push(n,[r,u]):d[f+1].push(r,u)}else d.push(n,u)}}}function a1(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function sD(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function f5(t,e,n,r){return oD(this.multi,[])}function p5(t,e,n,r){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=na(n,n[oe],this.providerFactory.index,r);s=a.slice(0,o),oD(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],oD(i,s);return s}function oD(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function Yt(t,e=[]){return n=>{n.providersResolver=(r,i)=>function h5(t,e,n){const r=et();if(r.firstCreatePass){const i=Pi(t);rD(n,r.data,r.blueprint,i,!0),rD(e,r.data,r.blueprint,i,!1)}}(r,i?i(t):t,e)}}class Qc{}class u1{}class aD extends Qc{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new _k(this);const i=Rr(e);this._bootstrapComponents=la(i.bootstrap),this._r3Injector=PM(e,n,[{provide:Qc,useValue:this},{provide:Vv,useValue:this.componentFactoryResolver},...r],U(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class uD extends u1{constructor(e){super(),this.moduleType=e}create(e){return new aD(this.moduleType,e,[])}}class c1 extends Qc{constructor(e){super(),this.componentFactoryResolver=new _k(this),this.instance=null;const n=new Kd([...e.providers,{provide:Qc,useValue:this},{provide:Vv,useValue:this.componentFactoryResolver}],e.parent||Pv(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function cD(t,e,n=null){return new c1({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}let y5=(()=>{class t{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const r=hM(0,n.type),i=r.length>0?cD([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,i)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=de({token:t,providedIn:"environment",factory:()=>new t(z(ts))})}return t})();function lD(t){t.getStandaloneInjector=e=>e.get(y5).getOrCreateStandaloneInjector(t)}function _1(t,e,n,r,i,s){const o=e+n;return Pr(t,o,i)?function uo(t,e,n){return t[e]=n}(t,o+1,s?r.call(s,i):r(i)):function Tg(t,e){const n=t[e];return n===Oe?void 0:n}(t,o+1)}function hD(t,e){const n=et();let r;const i=t+$e;n.firstCreatePass?(r=function F5(t,e){if(e)for(let n=e.length-1;n>=0;n--){const r=e[n];if(t===r.name)return r}}(e,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks??=[]).push(i,r.onDestroy)):r=n.data[i];const s=r.factory||(r.factory=Qo(r.type)),a=pr(X);try{const u=Sd(!1),d=s();return Sd(u),function g3(t,e,n,r){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=r}(n,W(),i,d),d}finally{pr(a)}}function fD(t,e,n){const r=t+$e,i=W(),s=function Xa(t,e){return t[e]}(i,r);return function Cg(t,e){return t[oe].data[e].pure}(i,r)?_1(i,zn(),e,s.transform,n,s):s.transform(n)}function j5(){return this._results[Symbol.iterator]()}class pD{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new fn)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=pD.prototype;n[Symbol.iterator]||(n[Symbol.iterator]=j5)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,n){return this._results.reduce(e,n)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,n){const r=this;r.dirty=!1;const i=function gi(t){return t.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function Fp(t,e,n){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++){let i=t[r],s=e[r];if(n&&(i=n(i),s=n(s)),s!==i)return!1}return!0}(r._results,i,n))&&(r._results=i,r.length=i.length,r.last=i[this.length-1],r.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function H5(t,e,n,r=!0){const i=e[oe];if(function Ez(t,e,n,r){const i=En+r,s=n.length;r>0&&(n[i-1][ui]=e),r<s-En?(e[ui]=n[i],Nd(n,En+r,e)):(n.push(e),e[ui]=null),e[Je]=n;const o=e[Wa];null!==o&&n!==o&&function Iz(t,e){const n=t[eo];e[Zt]!==e[Je][Je][Zt]&&(t[ay]=!0),null===n?t[eo]=[e]:n.push(e)}(o,e);const a=e[Ri];null!==a&&a.insertView(t),e[Pe]|=128}(i,e,t,n),r){const s=YC(n,t),o=e[Ae],a=wv(o,t[ci]);null!==a&&function _z(t,e,n,r,i,s){r[Kt]=i,r[Ln]=e,Yp(t,r,n,1,i,s)}(i,t[Ln],o,e,a,s)}}let ha=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=z5}return t})();const G5=ha,q5=class extends G5{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){const i=function $5(t,e,n,r){const i=e.tView,a=Bv(t,i,n,4096&t[Pe]?4096:16,null,e,null,null,null,r?.injector??null,r?.hydrationInfo??null);a[Wa]=t[e.index];const d=t[Ri];return null!==d&&(a[Ri]=d.createEmbeddedView(i)),jb(i,a,n),a}(this._declarationLView,this._declarationTContainer,e,{injector:n,hydrationInfo:r});return new ag(i)}};function z5(){return sE(qn(),W())}function sE(t,e){return 4&t.type?new q5(e,t,Xd(t,e)):null}let Rs=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=X5}return t})();function X5(){return S1(qn(),W())}const J5=Rs,D1=class extends J5{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Xd(this._hostTNode,this._hostLView)}get injector(){return new Kn(this._hostTNode,this._hostLView)}get parentInjector(){const e=Pd(this._hostTNode,this._hostLView);if(Ap(e)){const n=ta(e,this._hostLView),r=Oc(e);return new Kn(n[oe].data[r+8],n)}return new Kn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=A1(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-En}createEmbeddedView(e,n,r){let i,s;"number"==typeof r?i=r:null!=r&&(i=r.index,s=r.injector);const a=e.createEmbeddedViewImpl(n||{},s,null);return this.insertImpl(a,i,false),a}createComponent(e,n,r,i,s){const o=e&&!function jc(t){return"function"==typeof t}(e);let a;if(o)a=n;else{const C=n||{};a=C.index,r=C.injector,i=C.projectableNodes,s=C.environmentInjector||C.ngModuleRef}const u=o?e:new ug(ke(e)),d=r||this.parentInjector;if(!s&&null==u.ngModule){const D=(o?d:this.parentInjector).get(ts,null);D&&(s=D)}ke(u.componentType??{});const y=u.create(d,i,null,s);return this.insertImpl(y.hostView,a,false),y}insert(e,n){return this.insertImpl(e,n,!1)}insertImpl(e,n,r){const i=e._lView;if(function JT(t){return mr(t[Je])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const d=i[Je],f=new D1(d,d[Ln],d[Je]);f.detach(f.indexOf(e))}}const o=this._adjustIndex(n),a=this._lContainer;return H5(a,i,o,!r),e.attachToViewContainerRef(),Nd(gD(a),o,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=A1(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),r=Iv(this._lContainer,n);r&&(xd(gD(this._lContainer),n),WC(r[oe],r))}detach(e){const n=this._adjustIndex(e,-1),r=Iv(this._lContainer,n);return r&&null!=xd(gD(this._lContainer),n)?new ag(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function A1(t){return t[8]}function gD(t){return t[8]||(t[8]=[])}function S1(t,e){let n;const r=e[t.index];return mr(r)?n=r:(n=sk(r,e,null,t),e[t.index]=n,jv(e,n)),R1(n,e,t,r),new D1(n,t,e)}let R1=function P1(t,e,n,r){if(t[ci])return;let i;i=8&n.type?Tt(r):function e8(t,e){const n=t[Ae],r=n.createComment(""),i=_r(e,t);return qc(n,wv(n,i),r,function bz(t,e){return t.nextSibling(e)}(n,i),!1),r}(e,n),t[ci]=i};class mD{constructor(e){this.queryList=e,this.matches=null}clone(){return new mD(this.queryList)}setDirty(){this.queryList.setDirty()}}class _D{constructor(e=[]){this.queries=e}createEmbeddedView(e){const n=e.queries;if(null!==n){const r=null!==e.contentQueries?e.contentQueries[0]:n.length,i=[];for(let s=0;s<r;s++){const o=n.getByIndex(s);i.push(this.queries[o.indexInDeclarationView].clone())}return new _D(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let n=0;n<this.queries.length;n++)null!==V1(e,n).matches&&this.queries[n].setDirty()}}class N1{constructor(e,n,r=null){this.predicate=e,this.flags=n,this.read=r}}class yD{constructor(e=[]){this.queries=e}elementStart(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,n)}elementEnd(e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(e)}embeddedTView(e){let n=null;for(let r=0;r<this.length;r++){const i=null!==n?n.length:0,s=this.getByIndex(r).embeddedTView(e,i);s&&(s.indexInDeclarationView=r,null!==n?n.push(s):n=[s])}return null!==n?new yD(n):null}template(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,n)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class vD{constructor(e,n=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(e,n){this.isApplyingToNode(n)&&this.matchTNode(e,n)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,n){this.elementStart(e,n)}embeddedTView(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new vD(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let r=e.parent;for(;null!==r&&8&r.type&&r.index!==n;)r=r.parent;return n===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(e,n){const r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){const s=r[i];this.matchTNodeWithReadOption(e,n,r8(n,s)),this.matchTNodeWithReadOption(e,n,Vc(n,e,s,!1,!1))}else r===ha?4&n.type&&this.matchTNodeWithReadOption(e,n,-1):this.matchTNodeWithReadOption(e,n,Vc(n,e,r,!1,!1))}matchTNodeWithReadOption(e,n,r){if(null!==r){const i=this.metadata.read;if(null!==i)if(i===Ni||i===Rs||i===ha&&4&n.type)this.addMatch(n.index,-2);else{const s=Vc(n,e,i,!1,!1);null!==s&&this.addMatch(n.index,s)}else this.addMatch(n.index,r)}}addMatch(e,n){null===this.matches?this.matches=[e,n]:this.matches.push(e,n)}}function r8(t,e){const n=t.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1];return null}function s8(t,e,n,r){return-1===n?function i8(t,e){return 11&t.type?Xd(t,e):4&t.type?sE(t,e):null}(e,t):-2===n?function o8(t,e,n){return n===Ni?Xd(e,t):n===ha?sE(e,t):n===Rs?S1(e,t):void 0}(t,e,r):na(t,t[oe],n,e)}function x1(t,e,n,r){const i=e[Ri].queries[r];if(null===i.matches){const s=t.data,o=n.matches,a=[];for(let u=0;u<o.length;u+=2){const d=o[u];a.push(d<0?null:s8(e,s[d],o[u+1],n.metadata.read))}i.matches=a}return i.matches}function ED(t,e,n,r){const i=t.queries.getByIndex(n),s=i.matches;if(null!==s){const o=x1(t,e,i,n);for(let a=0;a<s.length;a+=2){const u=s[a];if(u>0)r.push(o[a/2]);else{const d=s[a+1],f=e[-u];for(let g=En;g<f.length;g++){const m=f[g];m[Wa]===m[Je]&&ED(m[oe],m,d,r)}if(null!==f[eo]){const g=f[eo];for(let m=0;m<g.length;m++){const y=g[m];ED(y[oe],y,d,r)}}}}}return r}function ID(t){const e=W(),n=et(),r=Oy();Tp(r+1);const i=V1(n,r);if(t.dirty&&function Ry(t){return 4==(4&t[Pe])}(e)===(2==(2&i.metadata.flags))){if(null===i.matches)t.reset([]);else{const s=i.crossesNgTemplate?ED(n,e,r,[]):x1(n,e,i,r);t.reset(s,CW),t.notifyOnChanges()}return!0}return!1}function M1(t,e,n){const r=et();r.firstCreatePass&&(function F1(t,e,n){null===t.queries&&(t.queries=new yD),t.queries.track(new vD(e,n))}(r,new N1(t,e,n),-1),2==(2&e)&&(r.staticViewQueries=!0)),function O1(t,e,n){const r=new pD(4==(4&n));(function n9(t,e,n,r){const i=ak(e);i.push(n),t.firstCreatePass&&uk(t).push(r,i.length-1)})(t,e,r,r.destroy),null===e[Ri]&&(e[Ri]=new _D),e[Ri].queries.push(new mD(r))}(r,W(),e)}function V1(t,e){return t.queries.getByIndex(e)}const SD=new re("Application Initializer");let RD=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r}),this.appInits=pe(SD,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const i of this.appInits){const s=i();if(pg(s))n.push(s);else if(Bk(s)){const o=new Promise((a,u)=>{s.subscribe({complete:a,error:u})});n.push(o)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),0===n.length&&r(),this.initialized=!0}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),eF=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();const Ps=new re("LocaleId",{providedIn:"root",factory:()=>pe(Ps,He.Optional|He.SkipSelf)||function P8(){return typeof $localize<"u"&&$localize.locale||ph}()});let tF=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Wt(!1)}add(){this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class M8{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}}let nF=(()=>{class t{compileModuleSync(n){return new uD(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const r=this.compileModuleSync(n),s=la(Rr(n).declarations).reduce((o,a)=>{const u=ke(a);return u&&o.push(new ug(u)),o},[]);return new M8(r,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const oF=new re(""),cE=new re("");let kD,xD=(()=>{class t{constructor(n,r,i){this._ngZone=n,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,kD||(function tK(t){kD=t}(i),i.addToWindow(r)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{lt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:i})}whenStable(n,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,r,i){return[]}static#e=this.\u0275fac=function(r){return new(r||t)(z(lt),z(MD),z(cE))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac})}return t})(),MD=(()=>{class t{constructor(){this._applications=new Map}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return kD?.findTestabilityInTree(this,n,r)??null}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})(),pu=null;const aF=new re("AllowMultipleToken"),OD=new re("PlatformDestroyListeners"),FD=new re("appBootstrapListener");class cF{constructor(e,n){this.name=e,this.token=n}}function dF(t,e,n=[]){const r=`Platform: ${e}`,i=new re(r);return(s=[])=>{let o=VD();if(!o||o.injector.get(aF,!1)){const a=[...n,...s,{provide:i,useValue:!0}];t?t(a):function iK(t){if(pu&&!pu.get(aF,!1))throw new q(400,!1);(function uF(){!function zT(t){fd=t}(()=>{throw new q(600,!1)})})(),pu=t;const e=t.get(fF);(function lF(t){t.get(_M,null)?.forEach(n=>n())})(t)}(function hF(t=[],e){return xi.create({name:e,providers:[{provide:cb,useValue:"platform"},{provide:OD,useValue:new Set([()=>pu=null])},...t]})}(a,r))}return function oK(t){const e=VD();if(!e)throw new q(401,!1);return e}()}}function VD(){return pu?.get(fF)??null}let fF=(()=>{class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const i=function aK(t="zone.js",e){return"noop"===t?new LW:"zone.js"===t?new lt(e):t}(r?.ngZone,function pF(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return i.run(()=>{const s=function _5(t,e,n){return new aD(t,e,n)}(n.moduleType,this.injector,function vF(t){return[{provide:lt,useFactory:t},{provide:tg,multi:!0,useFactory:()=>{const e=pe(cK,{optional:!0});return()=>e.initialize()}},{provide:yF,useFactory:uK},{provide:OM,useFactory:FM}]}(()=>i)),o=s.injector.get(ca,null);return i.runOutsideAngular(()=>{const a=i.onError.subscribe({next:u=>{o.handleError(u)}});s.onDestroy(()=>{lE(this._modules,s),a.unsubscribe()})}),function gF(t,e,n){try{const r=n();return pg(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(o,i,()=>{const a=s.injector.get(RD);return a.runInitializers(),a.donePromise.then(()=>(function VO(t){oi(t,"Expected localeId to be defined"),"string"==typeof t&&(FO=t.toLowerCase().replace(/_/g,"-"))}(s.injector.get(Ps,ph)||ph),this._moduleDoBootstrap(s),s))})})}bootstrapModule(n,r=[]){const i=mF({},r);return function nK(t,e,n){const r=new uD(n);return Promise.resolve(r)}(0,0,n).then(s=>this.bootstrapModuleFactory(s,i))}_moduleDoBootstrap(n){const r=n.injector.get(_h);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new q(-403,!1);n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new q(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const n=this._injector.get(OD,null);n&&(n.forEach(r=>r()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(r){return new(r||t)(z(xi))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();function mF(t,e){return Array.isArray(e)?e.reduce(mF,t):{...t,...e}}let _h=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=pe(yF),this.zoneIsStable=pe(OM),this.componentTypes=[],this.components=[],this.isStable=pe(tF).hasPendingTasks.pipe(ft(n=>n?fe(!1):this.zoneIsStable),Zs(),qi()),this._injector=pe(ts)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,r){const i=n instanceof wM;if(!this._injector.get(RD).done)throw!i&&function Go(t){const e=ke(t)||rn(t)||vn(t);return null!==e&&e.standalone}(n),new q(405,!1);let o;o=i?n:this._injector.get(Vv).resolveComponentFactory(n),this.componentTypes.push(o.componentType);const a=function rK(t){return t.isBoundToModule}(o)?void 0:this._injector.get(Qc),d=o.create(xi.NULL,[],r||o.selector,a),f=d.location.nativeElement,g=d.injector.get(oF,null);return g?.registerApplication(f),d.onDestroy(()=>{this.detachView(d.hostView),lE(this.components,d),g?.unregisterApplication(f)}),this._loadComponent(d),d}tick(){if(this._runningTick)throw new q(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;lE(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const r=this._injector.get(FD,[]);r.push(...this._bootstrapListeners),r.forEach(i=>i(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>lE(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new q(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function lE(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const yF=new re("",{providedIn:"root",factory:()=>pe(ca).handleError.bind(void 0)});function uK(){const t=pe(lt),e=pe(ca);return n=>t.runOutsideAngular(()=>e.handleError(n))}let cK=(()=>{class t{constructor(){this.zone=pe(lt),this.applicationRef=pe(_h)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();let Ag=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=dK}return t})();function dK(t){return function hK(t,e,n){if(Zo(t)&&!n){const r=yr(t.index,e);return new ag(r,r)}return 47&t.type?new ag(e[Zt],e):null}(qn(),W(),16==(16&t))}const bK=dF(null,"core",[]);let DK=(()=>{class t{constructor(n){}static#e=this.\u0275fac=function(r){return new(r||t)(z(_h))};static#t=this.\u0275mod=er({type:t});static#n=this.\u0275inj=Vn({})}return t})();let HD=null;function gu(){return HD}class BK{}const rs=new re("DocumentToken");let GD=(()=>{class t{historyGo(n){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:function(){return pe($K)},providedIn:"platform"})}return t})();const jK=new re("Location Initialized");let $K=(()=>{class t extends GD{constructor(){super(),this._doc=pe(rs),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return gu().getBaseHref(this._doc)}onPopState(n){const r=gu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=gu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,i){this._history.pushState(n,r,i)}replaceState(n,r,i){this._history.replaceState(n,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:function(){return new t},providedIn:"platform"})}return t})();function qD(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function LF(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function fa(t){return t&&"?"!==t[0]?"?"+t:t}let Xc=(()=>{class t{historyGo(n){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:function(){return pe(BF)},providedIn:"root"})}return t})();const UF=new re("appBaseHref");let BF=(()=>{class t extends Xc{constructor(n,r){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??pe(rs).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return qD(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+fa(this._platformLocation.search),i=this._platformLocation.hash;return i&&n?`${r}${i}`:r}pushState(n,r,i,s){const o=this.prepareExternalUrl(i+fa(s));this._platformLocation.pushState(n,r,o)}replaceState(n,r,i,s){const o=this.prepareExternalUrl(i+fa(s));this._platformLocation.replaceState(n,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(r){return new(r||t)(z(GD),z(UF,8))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),HK=(()=>{class t extends Xc{constructor(n,r){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(n){const r=qD(this._baseHref,n);return r.length>0?"#"+r:r}pushState(n,r,i,s){let o=this.prepareExternalUrl(i+fa(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(n,r,o)}replaceState(n,r,i,s){let o=this.prepareExternalUrl(i+fa(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(n,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(r){return new(r||t)(z(GD),z(UF,8))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac})}return t})(),zD=(()=>{class t{constructor(n){this._subject=new fn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const r=this._locationStrategy.getBaseHref();this._basePath=function zK(t){if(new RegExp("^(https?:)?//").test(t)){const[,n]=t.split(/\/\/[^\/]+/);return n}return t}(LF(jF(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+fa(r))}normalize(n){return t.stripTrailingSlash(function qK(t,e){if(!t||!e.startsWith(t))return e;const n=e.substring(t.length);return""===n||["/",";","?","#"].includes(n[0])?n:e}(this._basePath,jF(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",i=null){this._locationStrategy.pushState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+fa(r)),i)}replaceState(n,r="",i=null){this._locationStrategy.replaceState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+fa(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(i=>i(n,r))}subscribe(n,r,i){return this._subject.subscribe({next:n,error:r,complete:i})}static#e=this.normalizeQueryParams=fa;static#t=this.joinWithSlash=qD;static#n=this.stripTrailingSlash=LF;static#r=this.\u0275fac=function(r){return new(r||t)(z(Xc))};static#i=this.\u0275prov=de({token:t,factory:function(){return function GK(){return new zD(z(Xc))}()},providedIn:"root"})}return t})();function jF(t){return t.replace(/\/index.html$/,"")}var Zr=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}(Zr||{}),Ot=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}(Ot||{}),Oi=function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t}(Oi||{}),xn=function(t){return t[t.Decimal=0]="Decimal",t[t.Group=1]="Group",t[t.List=2]="List",t[t.PercentSign=3]="PercentSign",t[t.PlusSign=4]="PlusSign",t[t.MinusSign=5]="MinusSign",t[t.Exponential=6]="Exponential",t[t.SuperscriptingExponent=7]="SuperscriptingExponent",t[t.PerMille=8]="PerMille",t[t.Infinity=9]="Infinity",t[t.NaN=10]="NaN",t[t.TimeSeparator=11]="TimeSeparator",t[t.CurrencyDecimal=12]="CurrencyDecimal",t[t.CurrencyGroup=13]="CurrencyGroup",t}(xn||{});function mE(t,e){return ss(Wr(t)[jt.DateFormat],e)}function _E(t,e){return ss(Wr(t)[jt.TimeFormat],e)}function yE(t,e){return ss(Wr(t)[jt.DateTimeFormat],e)}function is(t,e){const n=Wr(t),r=n[jt.NumberSymbols][e];if(typeof r>"u"){if(e===xn.CurrencyDecimal)return n[jt.NumberSymbols][xn.Decimal];if(e===xn.CurrencyGroup)return n[jt.NumberSymbols][xn.Group]}return r}function HF(t){if(!t[jt.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[jt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function ss(t,e){for(let n=e;n>-1;n--)if(typeof t[n]<"u")return t[n];throw new Error("Locale data API: locale data undefined")}function KD(t){const[e,n]=t.split(":");return{hours:+e,minutes:+n}}const o7=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Rg={},a7=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var pa=function(t){return t[t.Short=0]="Short",t[t.ShortGMT=1]="ShortGMT",t[t.Long=2]="Long",t[t.Extended=3]="Extended",t}(pa||{}),yt=function(t){return t[t.FullYear=0]="FullYear",t[t.Month=1]="Month",t[t.Date=2]="Date",t[t.Hours=3]="Hours",t[t.Minutes=4]="Minutes",t[t.Seconds=5]="Seconds",t[t.FractionalSeconds=6]="FractionalSeconds",t[t.Day=7]="Day",t}(yt||{}),vt=function(t){return t[t.DayPeriods=0]="DayPeriods",t[t.Days=1]="Days",t[t.Months=2]="Months",t[t.Eras=3]="Eras",t}(vt||{});function GF(t,e,n,r){let i=function m7(t){if(WF(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[i,s=1,o=1]=t.split("-").map(a=>+a);return vE(i,s-1,o)}const n=parseFloat(t);if(!isNaN(t-n))return new Date(n);let r;if(r=t.match(o7))return function _7(t){const e=new Date(0);let n=0,r=0;const i=t[8]?e.setUTCFullYear:e.setFullYear,s=t[8]?e.setUTCHours:e.setHours;t[9]&&(n=Number(t[9]+t[10]),r=Number(t[9]+t[11])),i.call(e,Number(t[1]),Number(t[2])-1,Number(t[3]));const o=Number(t[4]||0)-n,a=Number(t[5]||0)-r,u=Number(t[6]||0),d=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return s.call(e,o,a,u,d),e}(r)}const e=new Date(t);if(!WF(e))throw new Error(`Unable to convert "${t}" into a date`);return e}(t);e=ga(n,e)||e;let a,o=[];for(;e;){if(a=a7.exec(e),!a){o.push(e);break}{o=o.concat(a.slice(1));const f=o.pop();if(!f)break;e=f}}let u=i.getTimezoneOffset();r&&(u=zF(r,u),i=function g7(t,e,n){const r=n?-1:1,i=t.getTimezoneOffset();return function p7(t,e){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+e),t}(t,r*(zF(e,i)-i))}(i,r,!0));let d="";return o.forEach(f=>{const g=function f7(t){if(QD[t])return QD[t];let e;switch(t){case"G":case"GG":case"GGG":e=$t(vt.Eras,Ot.Abbreviated);break;case"GGGG":e=$t(vt.Eras,Ot.Wide);break;case"GGGGG":e=$t(vt.Eras,Ot.Narrow);break;case"y":e=jn(yt.FullYear,1,0,!1,!0);break;case"yy":e=jn(yt.FullYear,2,0,!0,!0);break;case"yyy":e=jn(yt.FullYear,3,0,!1,!0);break;case"yyyy":e=jn(yt.FullYear,4,0,!1,!0);break;case"Y":e=TE(1);break;case"YY":e=TE(2,!0);break;case"YYY":e=TE(3);break;case"YYYY":e=TE(4);break;case"M":case"L":e=jn(yt.Month,1,1);break;case"MM":case"LL":e=jn(yt.Month,2,1);break;case"MMM":e=$t(vt.Months,Ot.Abbreviated);break;case"MMMM":e=$t(vt.Months,Ot.Wide);break;case"MMMMM":e=$t(vt.Months,Ot.Narrow);break;case"LLL":e=$t(vt.Months,Ot.Abbreviated,Zr.Standalone);break;case"LLLL":e=$t(vt.Months,Ot.Wide,Zr.Standalone);break;case"LLLLL":e=$t(vt.Months,Ot.Narrow,Zr.Standalone);break;case"w":e=ZD(1);break;case"ww":e=ZD(2);break;case"W":e=ZD(1,!0);break;case"d":e=jn(yt.Date,1);break;case"dd":e=jn(yt.Date,2);break;case"c":case"cc":e=jn(yt.Day,1);break;case"ccc":e=$t(vt.Days,Ot.Abbreviated,Zr.Standalone);break;case"cccc":e=$t(vt.Days,Ot.Wide,Zr.Standalone);break;case"ccccc":e=$t(vt.Days,Ot.Narrow,Zr.Standalone);break;case"cccccc":e=$t(vt.Days,Ot.Short,Zr.Standalone);break;case"E":case"EE":case"EEE":e=$t(vt.Days,Ot.Abbreviated);break;case"EEEE":e=$t(vt.Days,Ot.Wide);break;case"EEEEE":e=$t(vt.Days,Ot.Narrow);break;case"EEEEEE":e=$t(vt.Days,Ot.Short);break;case"a":case"aa":case"aaa":e=$t(vt.DayPeriods,Ot.Abbreviated);break;case"aaaa":e=$t(vt.DayPeriods,Ot.Wide);break;case"aaaaa":e=$t(vt.DayPeriods,Ot.Narrow);break;case"b":case"bb":case"bbb":e=$t(vt.DayPeriods,Ot.Abbreviated,Zr.Standalone,!0);break;case"bbbb":e=$t(vt.DayPeriods,Ot.Wide,Zr.Standalone,!0);break;case"bbbbb":e=$t(vt.DayPeriods,Ot.Narrow,Zr.Standalone,!0);break;case"B":case"BB":case"BBB":e=$t(vt.DayPeriods,Ot.Abbreviated,Zr.Format,!0);break;case"BBBB":e=$t(vt.DayPeriods,Ot.Wide,Zr.Format,!0);break;case"BBBBB":e=$t(vt.DayPeriods,Ot.Narrow,Zr.Format,!0);break;case"h":e=jn(yt.Hours,1,-12);break;case"hh":e=jn(yt.Hours,2,-12);break;case"H":e=jn(yt.Hours,1);break;case"HH":e=jn(yt.Hours,2);break;case"m":e=jn(yt.Minutes,1);break;case"mm":e=jn(yt.Minutes,2);break;case"s":e=jn(yt.Seconds,1);break;case"ss":e=jn(yt.Seconds,2);break;case"S":e=jn(yt.FractionalSeconds,1);break;case"SS":e=jn(yt.FractionalSeconds,2);break;case"SSS":e=jn(yt.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=IE(pa.Short);break;case"ZZZZZ":e=IE(pa.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=IE(pa.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=IE(pa.Long);break;default:return null}return QD[t]=e,e}(f);d+=g?g(i,n,u):"''"===f?"'":f.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),d}function vE(t,e,n){const r=new Date(0);return r.setFullYear(t,e,n),r.setHours(0,0,0),r}function ga(t,e){const n=function KK(t){return Wr(t)[jt.LocaleId]}(t);if(Rg[n]=Rg[n]||{},Rg[n][e])return Rg[n][e];let r="";switch(e){case"shortDate":r=mE(t,Oi.Short);break;case"mediumDate":r=mE(t,Oi.Medium);break;case"longDate":r=mE(t,Oi.Long);break;case"fullDate":r=mE(t,Oi.Full);break;case"shortTime":r=_E(t,Oi.Short);break;case"mediumTime":r=_E(t,Oi.Medium);break;case"longTime":r=_E(t,Oi.Long);break;case"fullTime":r=_E(t,Oi.Full);break;case"short":const i=ga(t,"shortTime"),s=ga(t,"shortDate");r=EE(yE(t,Oi.Short),[i,s]);break;case"medium":const o=ga(t,"mediumTime"),a=ga(t,"mediumDate");r=EE(yE(t,Oi.Medium),[o,a]);break;case"long":const u=ga(t,"longTime"),d=ga(t,"longDate");r=EE(yE(t,Oi.Long),[u,d]);break;case"full":const f=ga(t,"fullTime"),g=ga(t,"fullDate");r=EE(yE(t,Oi.Full),[f,g])}return r&&(Rg[n][e]=r),r}function EE(t,e){return e&&(t=t.replace(/\{([^}]+)}/g,function(n,r){return null!=e&&r in e?e[r]:n})),t}function Ns(t,e,n="-",r,i){let s="";(t<0||i&&t<=0)&&(i?t=1-t:(t=-t,s=n));let o=String(t);for(;o.length<e;)o="0"+o;return r&&(o=o.slice(o.length-e)),s+o}function jn(t,e,n=0,r=!1,i=!1){return function(s,o){let a=function c7(t,e){switch(t){case yt.FullYear:return e.getFullYear();case yt.Month:return e.getMonth();case yt.Date:return e.getDate();case yt.Hours:return e.getHours();case yt.Minutes:return e.getMinutes();case yt.Seconds:return e.getSeconds();case yt.FractionalSeconds:return e.getMilliseconds();case yt.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,s);if((n>0||a>-n)&&(a+=n),t===yt.Hours)0===a&&-12===n&&(a=12);else if(t===yt.FractionalSeconds)return function u7(t,e){return Ns(t,3).substring(0,e)}(a,e);const u=is(o,xn.MinusSign);return Ns(a,e,u,r,i)}}function $t(t,e,n=Zr.Format,r=!1){return function(i,s){return function l7(t,e,n,r,i,s){switch(n){case vt.Months:return function YK(t,e,n){const r=Wr(t),s=ss([r[jt.MonthsFormat],r[jt.MonthsStandalone]],e);return ss(s,n)}(e,i,r)[t.getMonth()];case vt.Days:return function QK(t,e,n){const r=Wr(t),s=ss([r[jt.DaysFormat],r[jt.DaysStandalone]],e);return ss(s,n)}(e,i,r)[t.getDay()];case vt.DayPeriods:const o=t.getHours(),a=t.getMinutes();if(s){const d=function t7(t){const e=Wr(t);return HF(e),(e[jt.ExtraData][2]||[]).map(r=>"string"==typeof r?KD(r):[KD(r[0]),KD(r[1])])}(e),f=function n7(t,e,n){const r=Wr(t);HF(r);const s=ss([r[jt.ExtraData][0],r[jt.ExtraData][1]],e)||[];return ss(s,n)||[]}(e,i,r),g=d.findIndex(m=>{if(Array.isArray(m)){const[y,E]=m,C=o>=y.hours&&a>=y.minutes,D=o<E.hours||o===E.hours&&a<E.minutes;if(y.hours<E.hours){if(C&&D)return!0}else if(C||D)return!0}else if(m.hours===o&&m.minutes===a)return!0;return!1});if(-1!==g)return f[g]}return function ZK(t,e,n){const r=Wr(t),s=ss([r[jt.DayPeriodsFormat],r[jt.DayPeriodsStandalone]],e);return ss(s,n)}(e,i,r)[o<12?0:1];case vt.Eras:return function XK(t,e){return ss(Wr(t)[jt.Eras],e)}(e,r)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${n}`)}}(i,s,t,e,n,r)}}function IE(t){return function(e,n,r){const i=-1*r,s=is(n,xn.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(t){case pa.Short:return(i>=0?"+":"")+Ns(o,2,s)+Ns(Math.abs(i%60),2,s);case pa.ShortGMT:return"GMT"+(i>=0?"+":"")+Ns(o,1,s);case pa.Long:return"GMT"+(i>=0?"+":"")+Ns(o,2,s)+":"+Ns(Math.abs(i%60),2,s);case pa.Extended:return 0===r?"Z":(i>=0?"+":"")+Ns(o,2,s)+":"+Ns(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${t}"`)}}}const d7=0,wE=4;function qF(t){return vE(t.getFullYear(),t.getMonth(),t.getDate()+(wE-t.getDay()))}function ZD(t,e=!1){return function(n,r){let i;if(e){const s=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,o=n.getDate();i=1+Math.floor((o+s)/7)}else{const s=qF(n),o=function h7(t){const e=vE(t,d7,1).getDay();return vE(t,0,1+(e<=wE?wE:wE+7)-e)}(s.getFullYear()),a=s.getTime()-o.getTime();i=1+Math.round(a/6048e5)}return Ns(i,t,is(r,xn.MinusSign))}}function TE(t,e=!1){return function(n,r){return Ns(qF(n).getFullYear(),t,is(r,xn.MinusSign),e)}}const QD={};function zF(t,e){t=t.replace(/:/g,"");const n=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(n)?e:n}function WF(t){return t instanceof Date&&!isNaN(t.valueOf())}let r0=(()=>{class t{constructor(n,r){this._viewContainer=n,this._context=new k7,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){eV("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){eV("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,r){return!0}static#e=this.\u0275fac=function(r){return new(r||t)(X(Rs),X(ha))};static#t=this.\u0275dir=Re({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return t})();class k7{constructor(){this.$implicit=null,this.ngIf=null}}function eV(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${U(e)}'.`)}let nV=(()=>{class t{constructor(n){this._viewContainerRef=n,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(n){if(n.ngTemplateOutlet||n.ngTemplateOutletInjector){const r=this._viewContainerRef;if(this._viewRef&&r.remove(r.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:i,ngTemplateOutletContext:s,ngTemplateOutletInjector:o}=this;this._viewRef=r.createEmbeddedView(i,s,o?{injector:o}:void 0)}else this._viewRef=null}else this._viewRef&&n.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}static#e=this.\u0275fac=function(r){return new(r||t)(X(Rs))};static#t=this.\u0275dir=Re({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[In]})}return t})(),rV=(()=>{class t{transform(n){return JSON.stringify(n,null,2)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275pipe=tr({name:"json",type:t,pure:!1,standalone:!0})}return t})(),sV=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=er({type:t});static#n=this.\u0275inj=Vn({})}return t})();function bE(t){return"server"===t}let cZ=(()=>{class t{static#e=this.\u0275prov=de({token:t,providedIn:"root",factory:()=>new lZ(z(rs),window)})}return t})();class lZ{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const n=function dZ(t,e){const n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if("function"==typeof t.createTreeWalker&&t.body&&"function"==typeof t.body.attachShadow){const r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class OZ extends BK{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class d0 extends OZ{static makeCurrent(){!function UK(t){HD||(HD=t)}(new d0)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=function FZ(){return xg=xg||document.querySelector("base"),xg?xg.getAttribute("href"):null}();return null==n?null:function VZ(t){SE=SE||document.createElement("a"),SE.setAttribute("href",t);const e=SE.pathname;return"/"===e.charAt(0)?e:`/${e}`}(n)}resetBaseElement(){xg=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function R7(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[i,s]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let SE,xg=null,UZ=(()=>{class t{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac})}return t})();const h0=new re("EventManagerPlugins");let dV=(()=>{class t{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(i=>{i.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,i){return this._findPluginFor(r).addEventListener(n,r,i)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(s=>s.supports(n)),!r)throw new q(5101,!1);return this._eventNameToPlugin.set(n,r),r}static#e=this.\u0275fac=function(r){return new(r||t)(z(h0),z(lt))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac})}return t})();class hV{constructor(e){this._doc=e}}const f0="ng-app-id";let fV=(()=>{class t{constructor(n,r,i,s={}){this.doc=n,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=bE(s),this.resetHostNodes()}addStyles(n){for(const r of n)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(n){for(const r of n)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(r=>r.remove()),n.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const r of this.getAllStyles())this.addStyleToHost(n,r)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const r of this.hostNodes)this.addStyleToHost(r,n)}onStyleRemoved(n){const r=this.styleRef;r.get(n)?.elements?.forEach(i=>i.remove()),r.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${f0}="${this.appId}"]`);if(n?.length){const r=new Map;return n.forEach(i=>{null!=i.textContent&&r.set(i.textContent,i)}),r}return null}changeUsageCount(n,r){const i=this.styleRef;if(i.has(n)){const s=i.get(n);return s.usage+=r,s.usage}return i.set(n,{usage:r,elements:[]}),r}getStyleElement(n,r){const i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===n)return i.delete(r),s.removeAttribute(f0),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(f0,this.appId),o}}addStyleToHost(n,r){const i=this.getStyleElement(n,r);n.appendChild(i);const s=this.styleRef,o=s.get(r)?.elements;o?o.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}static#e=this.\u0275fac=function(r){return new(r||t)(z(rs),z(Nv),z(yM,8),z(Ds))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac})}return t})();const p0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},g0=/%COMP%/g,HZ=new re("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function gV(t,e){return e.map(n=>n.replace(g0,t))}let mV=(()=>{class t{constructor(n,r,i,s,o,a,u,d=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=u,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=bE(a),this.defaultRenderer=new m0(n,o,u,this.platformIsServer)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===$r.ShadowDom&&(r={...r,encapsulation:$r.Emulated});const i=this.getOrCreateRenderer(n,r);return i instanceof yV?i.applyToHost(n):i instanceof _0&&i.applyStyles(),i}getOrCreateRenderer(n,r){const i=this.rendererByCompId;let s=i.get(r.id);if(!s){const o=this.doc,a=this.ngZone,u=this.eventManager,d=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,g=this.platformIsServer;switch(r.encapsulation){case $r.Emulated:s=new yV(u,d,r,this.appId,f,o,a,g);break;case $r.ShadowDom:return new WZ(u,d,n,r,o,a,this.nonce,g);default:s=new _0(u,d,r,f,o,a,g)}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(r){return new(r||t)(z(dV),z(fV),z(Nv),z(HZ),z(rs),z(Ds),z(lt),z(yM))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac})}return t})();class m0{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(p0[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(_V(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(_V(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r="string"==typeof e?this.doc.querySelector(e):e;if(!r)throw new q(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;const s=p0[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const i=p0[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(c.DashCase|c.Important)?e.style.setProperty(n,r,i&c.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&c.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e[n]=r}setValue(e,n){e.nodeValue=n}listen(e,n,r){if("string"==typeof e&&!(e=gu().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if("__ngUnwrap__"===n)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))&&n.preventDefault()}}}function _V(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class WZ extends m0{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const d=gV(i.id,i.styles);for(const f of d){const g=document.createElement("style");a&&g.setAttribute("nonce",a),g.textContent=f,this.shadowRoot.appendChild(g)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class _0 extends m0{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?gV(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class yV extends _0{constructor(e,n,r,i,s,o,a,u){const d=i+"-"+r.id;super(e,n,r,s,o,a,u,d),this.contentAttr=function GZ(t){return"_ngcontent-%COMP%".replace(g0,t)}(d),this.hostAttr=function qZ(t){return"_nghost-%COMP%".replace(g0,t)}(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}let KZ=(()=>{class t extends hV{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i){return n.addEventListener(r,i,!1),()=>this.removeEventListener(n,r,i)}removeEventListener(n,r,i){return n.removeEventListener(r,i)}static#e=this.\u0275fac=function(r){return new(r||t)(z(rs))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac})}return t})();const vV=["alt","control","meta","shift"],ZZ={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},QZ={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let YZ=(()=>{class t extends hV{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,r,i){const s=t.parseEventName(r),o=t.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>gu().onAndCancel(n,s.domEventName,o))}static parseEventName(n){const r=n.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=t._normalizeKey(r.pop());let o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),vV.forEach(d=>{const f=r.indexOf(d);f>-1&&(r.splice(f,1),o+=d+".")}),o+=s,0!=r.length||0===s.length)return null;const u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(n,r){let i=ZZ[n.key]||n.key,s="";return r.indexOf("code.")>-1&&(i=n.code,s="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),vV.forEach(o=>{o!==i&&(0,QZ[o])(n)&&(s+=o+".")}),s+=i,s===r)}static eventCallback(n,r,i){return s=>{t.matchEventFullKeyCode(s,n)&&i.runGuarded(()=>r(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}static#e=this.\u0275fac=function(r){return new(r||t)(z(rs))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac})}return t})();const IV=[{provide:Ds,useValue:"browser"},{provide:_M,useValue:function XZ(){d0.makeCurrent()},multi:!0},{provide:rs,useFactory:function eQ(){return function Mz(t){eb=t}(document),document},deps:[]}],tQ=dF(bK,"browser",IV),nQ=new re(""),wV=[{provide:cE,useClass:class LZ{addToWindow(e){Rt.getAngularTestability=(r,i=!0)=>{const s=e.findTestabilityInTree(r,i);if(null==s)throw new q(5103,!1);return s},Rt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Rt.getAllAngularRootElements=()=>e.getAllRootElements(),Rt.frameworkStabilizers||(Rt.frameworkStabilizers=[]),Rt.frameworkStabilizers.push(r=>{const i=Rt.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(u){o=o||u,s--,0==s&&r(o)};i.forEach(u=>{u.whenStable(a)})})}findTestabilityInTree(e,n,r){return null==n?null:e.getTestability(n)??(r?gu().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},deps:[]},{provide:oF,useClass:xD,deps:[lt,MD,cE]},{provide:xD,useClass:xD,deps:[lt,MD,cE]}],TV=[{provide:cb,useValue:"root"},{provide:ca,useFactory:function JZ(){return new ca},deps:[]},{provide:h0,useClass:KZ,multi:!0,deps:[rs,lt,Ds]},{provide:h0,useClass:YZ,multi:!0,deps:[rs]},mV,fV,dV,{provide:CM,useExisting:mV},{provide:class hZ{},useClass:UZ,deps:[]},[]];let rQ=(()=>{class t{constructor(n){}static withServerTransition(n){return{ngModule:t,providers:[{provide:Nv,useValue:n.appId}]}}static#e=this.\u0275fac=function(r){return new(r||t)(z(nQ,12))};static#t=this.\u0275mod=er({type:t});static#n=this.\u0275inj=Vn({providers:[...TV,...wV],imports:[sV,DK]})}return t})(),CV=(()=>{class t{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static#e=this.\u0275fac=function(r){return new(r||t)(z(rs))};static#t=this.\u0275prov=de({token:t,factory:function(r){let i=null;return i=r?new r:function sQ(){return new CV(z(rs))}(),i},providedIn:"root"})}return t})();typeof window<"u"&&window;class SV extends Ee{notifyNext(e,n,r,i,s){this.destination.next(n)}notifyError(e,n){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class dQ extends Ee{constructor(e,n,r){super(),this.parent=e,this.outerValue=n,this.outerIndex=r,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function RV(t,e,n,r,i=new dQ(t,n,r)){if(!i.closed)return e instanceof Ge?e.subscribe(i):Di(e)(i)}const PV={};function v0(...t){let e,n;return gs(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&xt(t[0])&&(t=t[0]),_n(t,n).lift(new hQ(e))}class hQ{constructor(e){this.resultSelector=e}call(e,n){return n.subscribe(new fQ(e,this.resultSelector))}}class fQ extends SV{constructor(e,n){super(e),this.resultSelector=n,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(PV),this.observables.push(e)}_complete(){const e=this.observables,n=e.length;if(0===n)this.destination.complete();else{this.active=n,this.toRespond=n;for(let r=0;r<n;r++)this.add(RV(this,e[r],void 0,r))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,n,r){const i=this.values,o=this.toRespond?i[r]===PV?--this.toRespond:this.toRespond:0;i[r]=n,0===o&&(this.resultSelector?this._tryResultSelector(i):this.destination.next(i.slice()))}_tryResultSelector(e){let n;try{n=this.resultSelector.apply(this,e)}catch(r){return void this.destination.error(r)}this.destination.next(n)}}const RE=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})();function E0(...t){return function pQ(){return K(1)}()(fe(...t))}const Jc=new Ge(t=>t.complete());function PE(t){return t?function gQ(t){return new Ge(e=>t.schedule(()=>e.complete()))}(t):Jc}function NV(t){return new Ge(e=>{let n;try{n=t()}catch(i){return void e.error(i)}return(n?ct(n):PE()).subscribe(e)})}function Eh(t,e){return new Ge(e?n=>e.schedule(mQ,0,{error:t,subscriber:n}):n=>n.error(t))}function mQ({error:t,subscriber:e}){e.error(t)}const xV=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function el(t){return e=>0===t?PE():e.lift(new _Q(t))}class _Q{constructor(e){if(this.total=e,this.total<0)throw new xV}call(e,n){return n.subscribe(new yQ(e,this.total))}}class yQ extends Ee{constructor(e,n){super(e),this.total=n,this.count=0}_next(e){const n=this.total,r=++this.count;r<=n&&(this.destination.next(e),r===n&&(this.destination.complete(),this.unsubscribe()))}}function NE(...t){const e=t[t.length-1];return gs(e)?(t.pop(),n=>E0(t,n,e)):n=>E0(t,n)}function Ms(t,e){return function(r){return r.lift(new vQ(t,e))}}class vQ{constructor(e,n){this.predicate=e,this.thisArg=n}call(e,n){return n.subscribe(new EQ(e,this.predicate,this.thisArg))}}class EQ extends Ee{constructor(e,n,r){super(e),this.predicate=n,this.thisArg=r,this.count=0}_next(e){let n;try{n=this.predicate.call(this.thisArg,e,this.count++)}catch(r){return void this.destination.error(r)}n&&this.destination.next(e)}}function xE(t=null){return e=>e.lift(new IQ(t))}class IQ{constructor(e){this.defaultValue=e}call(e,n){return n.subscribe(new wQ(e,this.defaultValue))}}class wQ extends Ee{constructor(e,n){super(e),this.defaultValue=n,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function MV(t=bQ){return e=>e.lift(new TQ(t))}class TQ{constructor(e){this.errorFactory=e}call(e,n){return n.subscribe(new CQ(e,this.errorFactory))}}class CQ extends Ee{constructor(e,n){super(e),this.errorFactory=n,this.hasValue=!1}_next(e){this.hasValue=!0,this.destination.next(e)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(n){e=n}this.destination.error(e)}}}function bQ(){return new RE}function _u(t,e){const n=arguments.length>=2;return r=>r.pipe(t?Ms((i,s)=>t(i,s,r)):Hn,el(1),n?xE(e):MV(()=>new RE))}function Mg(t,e){return Ye(t,e,1)}function yu(){}function Ir(t,e,n){return function(i){return i.lift(new DQ(t,e,n))}}class DQ{constructor(e,n,r){this.nextOrObserver=e,this.error=n,this.complete=r}call(e,n){return n.subscribe(new AQ(e,this.nextOrObserver,this.error,this.complete))}}class AQ extends Ee{constructor(e,n,r,i){super(e),this._tapNext=yu,this._tapError=yu,this._tapComplete=yu,this._tapError=r||yu,this._tapComplete=i||yu,b(n)?(this._context=this,this._tapNext=n):n&&(this._context=n,this._tapNext=n.next||yu,this._tapError=n.error||yu,this._tapComplete=n.complete||yu)}_next(e){try{this._tapNext.call(this._context,e)}catch(n){return void this.destination.error(n)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(n){return void this.destination.error(n)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}function Ih(t){return function(n){const r=new SQ(t),i=n.lift(r);return r.caught=i}}class SQ{constructor(e){this.selector=e}call(e,n){return n.subscribe(new RQ(e,this.selector,this.caught))}}class RQ extends zs{constructor(e,n,r){super(e),this.selector=n,this.caught=r}error(e){if(!this.isStopped){let n;try{n=this.selector(e,this.caught)}catch(s){return void super.error(s)}this._unsubscribeAndRecycle();const r=new ko(this);this.add(r);const i=St(n,r);i!==r&&this.add(i)}}}function wh(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(i){return i.lift(new PQ(t,e,n))}}class PQ{constructor(e,n,r=!1){this.accumulator=e,this.seed=n,this.hasSeed=r}call(e,n){return n.subscribe(new NQ(e,this.accumulator,this.seed,this.hasSeed))}}class NQ extends Ee{constructor(e,n,r,i){super(e),this.accumulator=n,this._seed=r,this.hasSeed=i,this.index=0}get seed(){return this._seed}set seed(e){this.hasSeed=!0,this._seed=e}_next(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}_tryNext(e){const n=this.index++;let r;try{r=this.accumulator(this.seed,e,n)}catch(i){this.destination.error(i)}this.seed=r,this.destination.next(r)}}function I0(t){return function(n){return 0===t?PE():n.lift(new xQ(t))}}class xQ{constructor(e){if(this.total=e,this.total<0)throw new xV}call(e,n){return n.subscribe(new MQ(e,this.total))}}class MQ extends Ee{constructor(e,n){super(e),this.total=n,this.ring=new Array,this.count=0}_next(e){const n=this.ring,r=this.total,i=this.count++;n.length<r?n.push(e):n[i%r]=e}_complete(){const e=this.destination;let n=this.count;if(n>0){const r=this.count>=this.total?this.total:this.count,i=this.ring;for(let s=0;s<r;s++){const o=n++%r;e.next(i[o])}}e.complete()}}class FQ{constructor(e){this.value=e}call(e,n){return n.subscribe(new VQ(e,this.value))}}class VQ extends Ee{constructor(e,n){super(e),this.value=n}_next(e){this.destination.next(this.value)}}function w0(t){return e=>e.lift(new LQ(t))}class LQ{constructor(e){this.callback=e}call(e,n){return n.subscribe(new UQ(e,this.callback))}}class UQ extends Ee{constructor(e,n){super(e),this.add(new L(n))}}class jQ{constructor(e){this.notifier=e}call(e,n){const r=new $Q(e),i=St(this.notifier,new ko(r));return i&&!r.seenValue?(r.add(i),n.subscribe(r)):r}}class $Q extends zs{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}const Ue="primary",kg=Symbol("RouteTitle");class HQ{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function Th(t){return new HQ(t)}function GQ(t,e,n){const r=n.path.split("/");if(r.length>t.length||"full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let s=0;s<r.length;s++){const o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function fo(t,e){const n=t?Object.keys(t):void 0,r=e?Object.keys(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!kV(t[i],e[i]))return!1;return!0}function kV(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}return t===e}function OV(t){return t.length>0?t[t.length-1]:null}function vu(t){return function lQ(t){return!!t&&(t instanceof Ge||"function"==typeof t.lift&&"function"==typeof t.subscribe)}(t)?t:pg(t)?ct(Promise.resolve(t)):fe(t)}const zQ={exact:function LV(t,e,n){if(!tl(t.segments,e.segments)||!ME(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!t.children[r]||!LV(t.children[r],e.children[r],n))return!1;return!0},subset:UV},FV={exact:function WQ(t,e){return fo(t,e)},subset:function KQ(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>kV(t[n],e[n]))},ignored:()=>!0};function VV(t,e,n){return zQ[n.paths](t.root,e.root,n.matrixParams)&&FV[n.queryParams](t.queryParams,e.queryParams)&&!("exact"===n.fragment&&t.fragment!==e.fragment)}function UV(t,e,n){return BV(t,e,e.segments,n)}function BV(t,e,n,r){if(t.segments.length>n.length){const i=t.segments.slice(0,n.length);return!(!tl(i,n)||e.hasChildren()||!ME(i,n,r))}if(t.segments.length===n.length){if(!tl(t.segments,n)||!ME(t.segments,n,r))return!1;for(const i in e.children)if(!t.children[i]||!UV(t.children[i],e.children[i],r))return!1;return!0}{const i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!!(tl(t.segments,i)&&ME(t.segments,i,r)&&t.children[Ue])&&BV(t.children[Ue],e,s,r)}}function ME(t,e,n){return e.every((r,i)=>FV[n](t[i].parameters,r.parameters))}class Ch{constructor(e=new bt([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Th(this.queryParams)),this._queryParamMap}toString(){return YQ.serialize(this)}}class bt{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return kE(this)}}class Og{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=Th(this.parameters)),this._parameterMap}toString(){return HV(this)}}function tl(t,e){return t.length===e.length&&t.every((n,r)=>n.path===e[r].path)}let Fg=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:function(){return new T0},providedIn:"root"})}return t})();class T0{parse(e){const n=new uY(e);return new Ch(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){const n=`/${Vg(e.root,!0)}`,r=function eY(t){const e=Object.keys(t).map(n=>{const r=t[n];return Array.isArray(r)?r.map(i=>`${OE(n)}=${OE(i)}`).join("&"):`${OE(n)}=${OE(r)}`}).filter(n=>!!n);return e.length?`?${e.join("&")}`:""}(e.queryParams),i="string"==typeof e.fragment?`#${function XQ(t){return encodeURI(t)}(e.fragment)}`:"";return`${n}${r}${i}`}}const YQ=new T0;function kE(t){return t.segments.map(e=>HV(e)).join("/")}function Vg(t,e){if(!t.hasChildren())return kE(t);if(e){const n=t.children[Ue]?Vg(t.children[Ue],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==Ue&&r.push(`${i}:${Vg(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=function QQ(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===Ue&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==Ue&&(n=n.concat(e(i,r)))}),n}(t,(r,i)=>i===Ue?[Vg(t.children[Ue],!1)]:[`${i}:${Vg(r,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[Ue]?`${kE(t)}/${n[0]}`:`${kE(t)}/(${n.join("//")})`}}function jV(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function OE(t){return jV(t).replace(/%3B/gi,";")}function C0(t){return jV(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function FE(t){return decodeURIComponent(t)}function $V(t){return FE(t.replace(/\+/g,"%20"))}function HV(t){return`${C0(t.path)}${function JQ(t){return Object.keys(t).map(e=>`;${C0(e)}=${C0(t[e])}`).join("")}(t.parameters)}`}const tY=/^[^\/()?;#]+/;function b0(t){const e=t.match(tY);return e?e[0]:""}const nY=/^[^\/()?;=#]+/,iY=/^[^=?&#]+/,oY=/^[^&#]+/;class uY{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new bt([],{}):new bt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[Ue]=new bt(e,n)),r}parseSegment(){const e=b0(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new q(4009,!1);return this.capture(e),new Og(FE(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const n=function rY(t){const e=t.match(nY);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const i=b0(this.remaining);i&&(r=i,this.capture(r))}e[FE(n)]=FE(r)}parseQueryParam(e){const n=function sY(t){const e=t.match(iY);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const o=function aY(t){const e=t.match(oY);return e?e[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const i=$V(n),s=$V(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=b0(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new q(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Ue);const o=this.parseChildren();n[s]=1===Object.keys(o).length?o[Ue]:new bt([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new q(4011,!1)}}function GV(t){return t.segments.length>0?new bt([],{[Ue]:t}):t}function qV(t){const e={};for(const r of Object.keys(t.children)){const s=qV(t.children[r]);if(r===Ue&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}return function cY(t){if(1===t.numberOfChildren&&t.children[Ue]){const e=t.children[Ue];return new bt(t.segments.concat(e.segments),e.children)}return t}(new bt(t.segments,e))}function nl(t){return t instanceof Ch}function zV(t){let e;const i=GV(function n(s){const o={};for(const u of s.children){const d=n(u);o[u.outlet]=d}const a=new bt(s.url,o);return s===t&&(e=a),a}(t.root));return e??i}function WV(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(0===e.length)return D0(i,i,i,n,r);const s=function dY(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new ZV(!0,0,t);let e=0,n=!1;const r=t.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([u,d])=>{a[u]="string"==typeof d?d.split("/"):d}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((a,u)=>{0==u&&"."===a||(0==u&&""===a?n=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,s]},[]);return new ZV(n,e,r)}(e);if(s.toRoot())return D0(i,i,new bt([],{}),n,r);const o=function hY(t,e,n){if(t.isAbsolute)return new LE(e,!0,0);if(!n)return new LE(e,!1,NaN);if(null===n.parent)return new LE(n,!0,0);const r=VE(t.commands[0])?0:1;return function fY(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new q(4005,!1);i=r.segments.length}return new LE(r,!1,i-s)}(n,n.segments.length-1+r,t.numberOfDoubleDots)}(s,i,t),a=o.processChildren?Ug(o.segmentGroup,o.index,s.commands):QV(o.segmentGroup,o.index,s.commands);return D0(i,o.segmentGroup,a,n,r)}function VE(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function Lg(t){return"object"==typeof t&&null!=t&&t.outlets}function D0(t,e,n,r,i){let o,s={};r&&Object.entries(r).forEach(([u,d])=>{s[u]=Array.isArray(d)?d.map(f=>`${f}`):`${d}`}),o=t===e?n:KV(t,e,n);const a=GV(qV(o));return new Ch(a,s,i)}function KV(t,e,n){const r={};return Object.entries(t.children).forEach(([i,s])=>{r[i]=s===e?n:KV(s,e,n)}),new bt(t.segments,r)}class ZV{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&VE(r[0]))throw new q(4003,!1);const i=r.find(Lg);if(i&&i!==OV(r))throw new q(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class LE{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}}function QV(t,e,n){if(t||(t=new bt([],{})),0===t.segments.length&&t.hasChildren())return Ug(t,e,n);const r=function gY(t,e,n){let r=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;const o=t.segments[i],a=n[r];if(Lg(a))break;const u=`${a}`,d=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&d&&"object"==typeof d&&void 0===d.outlets){if(!XV(u,d,o))return s;r+=2}else{if(!XV(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const s=new bt(t.segments.slice(0,r.pathIndex),{});return s.children[Ue]=new bt(t.segments.slice(r.pathIndex),t.children),Ug(s,0,i)}return r.match&&0===i.length?new bt(t.segments,{}):r.match&&!t.hasChildren()?A0(t,e,n):r.match?Ug(t,0,i):A0(t,e,n)}function Ug(t,e,n){if(0===n.length)return new bt(t.segments,{});{const r=function pY(t){return Lg(t[0])?t[0].outlets:{[Ue]:t}}(n),i={};if(Object.keys(r).some(s=>s!==Ue)&&t.children[Ue]&&1===t.numberOfChildren&&0===t.children[Ue].segments.length){const s=Ug(t.children[Ue],e,n);return new bt(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(i[s]=QV(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{void 0===r[s]&&(i[s]=o)}),new bt(t.segments,i)}}function A0(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){const s=n[i];if(Lg(s)){const u=mY(s.outlets);return new bt(r,u)}if(0===i&&VE(n[0])){r.push(new Og(t.segments[e].path,YV(n[0]))),i++;continue}const o=Lg(s)?s.outlets[Ue]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&VE(a)?(r.push(new Og(o,YV(a))),i+=2):(r.push(new Og(o,{})),i++)}return new bt(r,{})}function mY(t){const e={};return Object.entries(t).forEach(([n,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(e[n]=A0(new bt([],{}),0,r))}),e}function YV(t){const e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function XV(t,e,n){return t==n.path&&fo(e,n.parameters)}const Bg="imperative";class po{constructor(e,n){this.id=e,this.url=n}}class UE extends po{constructor(e,n,r="imperative",i=null){super(e,n),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Eu extends po{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class jg extends po{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class bh extends po{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=16}}class BE extends po{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class JV extends po{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class _Y extends po{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class yY extends po{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class vY extends po{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class EY extends po{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class IY{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class wY{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class TY{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class CY{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class bY{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class DY{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class eL{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class S0{}class R0{constructor(e){this.url=e}}class AY{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new $g,this.attachRef=null}}let $g=(()=>{class t{constructor(){this.contexts=new Map}onChildOutletCreated(n,r){const i=this.getOrCreateContext(n);i.outlet=r,this.contexts.set(n,i)}onChildOutletDestroyed(n){const r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new AY,this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class tL{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){const n=P0(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){const n=P0(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){const n=N0(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return N0(e,this._root).map(n=>n.value)}}function P0(t,e){if(t===e.value)return e;for(const n of e.children){const r=P0(t,n);if(r)return r}return null}function N0(t,e){if(t===e.value)return[e];for(const n of e.children){const r=N0(t,n);if(r.length)return r.unshift(e),r}return[]}class ma{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}}function Dh(t){const e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}class nL extends tL{constructor(e,n){super(e),this.snapshot=n,x0(this,e)}toString(){return this.snapshot.toString()}}function rL(t,e){const n=function SY(t,e){const o=new jE([],{},{},"",{},Ue,e,null,{});return new sL("",new ma(o,[]))}(0,e),r=new Wt([new Og("",{})]),i=new Wt({}),s=new Wt({}),o=new Wt({}),a=new Wt(""),u=new Ah(r,i,o,a,s,Ue,e,n.root);return u.snapshot=n.root,new nL(new ma(u,[]),n)}class Ah{constructor(e,n,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(Ie(d=>d[kg]))??fe(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Ie(e=>Th(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Ie(e=>Th(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function iL(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const i=n[r],s=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(s.component)break;r--}}return function RY(t){return t.reduce((e,n)=>({params:{...e.params,...n.params},data:{...e.data,...n.data},resolve:{...n.data,...e.resolve,...n.routeConfig?.data,...n._resolvedData}}),{params:{},data:{},resolve:{}})}(n.slice(r))}class jE{get title(){return this.data?.[kg]}constructor(e,n,r,i,s,o,a,u,d){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Th(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Th(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class sL extends tL{constructor(e,n){super(n),this.url=e,x0(this,n)}toString(){return oL(this._root)}}function x0(t,e){e.value._routerState=t,e.children.forEach(n=>x0(t,n))}function oL(t){const e=t.children.length>0?` { ${t.children.map(oL).join(", ")} } `:"";return`${t.value}${e}`}function M0(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,fo(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),fo(e.params,n.params)||t.paramsSubject.next(n.params),function qQ(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!fo(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.urlSubject.next(n.url),fo(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function k0(t,e){const n=fo(t.params,e.params)&&function ZQ(t,e){return tl(t,e)&&t.every((n,r)=>fo(n.parameters,e[r].parameters))}(t.url,e.url);return n&&!(!t.parent!=!e.parent)&&(!t.parent||k0(t.parent,e.parent))}let aL=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ue,this.activateEvents=new fn,this.deactivateEvents=new fn,this.attachEvents=new fn,this.detachEvents=new fn,this.parentContexts=pe($g),this.location=pe(Rs),this.changeDetector=pe(Ag),this.environmentInjector=pe(ts),this.inputBinder=pe($E,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:r,previousValue:i}=n.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new q(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new q(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new q(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new q(4013,!1);this._activatedRoute=n;const i=this.location,o=n.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,u=new PY(n,a,i.injector);this.activated=i.createComponent(o,{index:i.length,injector:u,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275dir=Re({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[In]})}return t})();class PY{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Ah?this.route:e===$g?this.childContexts:this.parent.get(e,n)}}const $E=new re("");let uL=(()=>{class t{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:r}=n,i=v0([r.queryParams,r.params,r.data]).pipe(ft(([s,o,a],u)=>(a={...s,...o,...a},0===u?fe(a):Promise.resolve(a)))).subscribe(s=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(n);const o=function LK(t){const e=ke(t);if(!e)return null;const n=new ug(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(r.component);if(o)for(const{templateName:a}of o.inputs)n.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,i)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac})}return t})();function Hg(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=e.value;const i=function xY(t,e,n){return e.children.map(r=>{for(const i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Hg(t,r,i);return Hg(t,r)})}(t,e,n);return new ma(r,i)}{if(t.shouldAttach(e.value)){const s=t.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Hg(t,a)),o}}const r=function MY(t){return new Ah(new Wt(t.url),new Wt(t.params),new Wt(t.queryParams),new Wt(t.fragment),new Wt(t.data),t.outlet,t.component,t)}(e.value),i=e.children.map(s=>Hg(t,s));return new ma(r,i)}}const O0="ngNavigationCancelingError";function cL(t,e){const{redirectTo:n,navigationBehaviorOptions:r}=nl(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=lL(!1,0,e);return i.url=n,i.navigationBehaviorOptions=r,i}function lL(t,e,n){const r=new Error("NavigationCancelingError: "+(t||""));return r[O0]=!0,r.cancellationCode=e,n&&(r.url=n),r}function dL(t){return t&&t[O0]}let hL=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=ad({type:t,selectors:[["ng-component"]],standalone:!0,features:[lD],decls:1,vars:0,template:function(r,i){1&r&&fg(0,"router-outlet")},dependencies:[aL],encapsulation:2})}return t})();function F0(t){const e=t.children&&t.children.map(F0),n=e?{...t,children:e}:{...t};return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==Ue&&(n.component=hL),n}function ks(t){return t.outlet||Ue}function Gg(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}class jY{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){const n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),M0(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){const i=Dh(n);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){const i=e.value,s=n?n.value:null;if(i===s)if(i.component){const o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){const r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Dh(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(r&&r.outlet){const o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){const r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Dh(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){const i=Dh(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new DY(s.value.snapshot))}),e.children.length&&this.forwardEvent(new CY(e.value.snapshot))}activateRoutes(e,n,r){const i=e.value,s=n?n.value:null;if(M0(i),i===s)if(i.component){const o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){const o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),M0(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=Gg(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}}class fL{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class HE{constructor(e,n){this.component=e,this.route=n}}function $Y(t,e,n){const r=t._root;return qg(r,e?e._root:null,n,[r.value])}function Sh(t,e){const n=Symbol(),r=e.get(t,n);return r===n?"function"!=typeof t||function XN(t){return null!==Jn(t)}(t)?e.get(t):t:r}function qg(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=Dh(e);return t.children.forEach(o=>{(function GY(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const u=function qY(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!tl(t.url,e.url);case"pathParamsOrQueryParamsChange":return!tl(t.url,e.url)||!fo(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!k0(t,e)||!fo(t.queryParams,e.queryParams);default:return!k0(t,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new fL(r)):(s.data=o.data,s._resolvedData=o._resolvedData),qg(t,e,s.component?a?a.children:null:n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new HE(a.outlet.component,o))}else o&&zg(e,a,i),i.canActivateChecks.push(new fL(r)),qg(t,null,s.component?a?a.children:null:n,r,i)})(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>zg(a,n.getContext(o),i)),i}function zg(t,e,n){const r=Dh(t),i=t.value;Object.entries(r).forEach(([s,o])=>{zg(o,i.component?e?e.children.getContext(s):null:e,n)}),n.canDeactivateChecks.push(new HE(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function Wg(t){return"function"==typeof t}function pL(t){return t instanceof RE||"EmptyError"===t?.name}const GE=Symbol("INITIAL_VALUE");function Rh(){return ft(t=>v0(t.map(e=>e.pipe(el(1),NE(GE)))).pipe(Ie(e=>{for(const n of e)if(!0!==n){if(n===GE)return GE;if(!1===n||n instanceof Ch)return n}return!0}),Ms(e=>e!==GE),el(1)))}function gL(t){return function Br(...t){return Gn(t)}(Ir(e=>{if(nl(e))throw cL(0,e)}),Ie(e=>!0===e))}class qE{constructor(e){this.segmentGroup=e||null}}class mL{constructor(e){this.urlTree=e}}function Ph(t){return Eh(new qE(t))}function _L(t){return Eh(new mL(t))}class dX{constructor(e,n){this.urlSerializer=e,this.urlTree=n}noMatchError(e){return new q(4002,!1)}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return fe(r);if(i.numberOfChildren>1||!i.children[Ue])return Eh(new q(4e3,!1));i=i.children[Ue]}}applyRedirectCommands(e,n,r){return this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r)}applyRedirectCreateUrlTree(e,n,r,i){const s=this.createSegmentGroup(e,n.root,r,i);return new Ch(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){const r={};return Object.entries(e).forEach(([i,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){const s=this.createSegments(e,n.segments,r,i);let o={};return Object.entries(n.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new bt(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){const i=r[n.path.substring(1)];if(!i)throw new q(4001,!1);return i}findOrReturn(e,n){let r=0;for(const i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}}const V0={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function hX(t,e,n,r,i){const s=L0(t,e,n);return s.matched?(r=function OY(t,e){return t.providers&&!t._injector&&(t._injector=cD(t.providers,e,`Route: ${t.path}`)),t._injector??e}(e,r),function uX(t,e,n,r){const i=e.canMatch;return i&&0!==i.length?fe(i.map(o=>{const a=Sh(o,t);return vu(function YY(t){return t&&Wg(t.canMatch)}(a)?a.canMatch(e,n):t.runInContext(()=>a(e,n)))})).pipe(Rh(),gL()):fe(!0)}(r,e,n).pipe(Ie(o=>!0===o?s:{...V0}))):fe(s)}function L0(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{...V0}:{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const i=(e.matcher||GQ)(n,t,e);if(!i)return{...V0};const s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});const o=i.consumed.length>0?{...s,...i.consumed[i.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function yL(t,e,n,r){return n.length>0&&function gX(t,e,n){return n.some(r=>zE(t,e,r)&&ks(r)!==Ue)}(t,n,r)?{segmentGroup:new bt(e,pX(r,new bt(n,t.children))),slicedSegments:[]}:0===n.length&&function mX(t,e,n){return n.some(r=>zE(t,e,r))}(t,n,r)?{segmentGroup:new bt(t.segments,fX(t,0,n,r,t.children)),slicedSegments:n}:{segmentGroup:new bt(t.segments,t.children),slicedSegments:n}}function fX(t,e,n,r,i){const s={};for(const o of r)if(zE(t,n,o)&&!i[ks(o)]){const a=new bt([],{});s[ks(o)]=a}return{...i,...s}}function pX(t,e){const n={};n[Ue]=e;for(const r of t)if(""===r.path&&ks(r)!==Ue){const i=new bt([],{});n[ks(r)]=i}return n}function zE(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}class EX{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new dX(this.urlSerializer,this.urlTree)}noMatchError(e){return new q(4002,!1)}recognize(){const e=yL(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Ue).pipe(Ih(n=>{if(n instanceof mL)return this.allowRedirects=!1,this.urlTree=n.urlTree,this.match(n.urlTree);throw n instanceof qE?this.noMatchError(n):n}),Ie(n=>{const r=new jE([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Ue,this.rootComponentType,null,{}),i=new ma(r,n),s=new sL("",i),o=function lY(t,e,n=null,r=null){return WV(zV(t),e,n,r)}(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,Ue).pipe(Ih(r=>{throw r instanceof qE?this.noMatchError(r):r}))}inheritParamsAndData(e){const n=e.value,r=iL(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,n,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0)}processChildren(e,n,r){const i=[];for(const s of Object.keys(r.children))"primary"===s?i.unshift(s):i.push(s);return ct(i).pipe(Mg(s=>{const o=r.children[s],a=function UY(t,e){const n=t.filter(r=>ks(r)===e);return n.push(...t.filter(r=>ks(r)!==e)),n}(n,s);return this.processSegmentGroup(e,a,o,s)}),wh((s,o)=>(s.push(...o),s)),xE(null),function kQ(t,e){const n=arguments.length>=2;return r=>r.pipe(t?Ms((i,s)=>t(i,s,r)):Hn,I0(1),n?xE(e):MV(()=>new RE))}(),Ye(s=>{if(null===s)return Ph(r);const o=vL(s);return function IX(t){t.sort((e,n)=>e.value.outlet===Ue?-1:n.value.outlet===Ue?1:e.value.outlet.localeCompare(n.value.outlet))}(o),fe(o)}))}processSegment(e,n,r,i,s,o){return ct(n).pipe(Mg(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(Ih(u=>{if(u instanceof qE)return fe(null);throw u}))),_u(a=>!!a),Ih(a=>{if(pL(a))return function yX(t,e,n){return 0===e.length&&!t.children[n]}(r,i,s)?fe([]):Ph(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return function _X(t,e,n,r){return!!(ks(t)===r||r!==Ue&&zE(e,n,t))&&("**"===t.path||L0(e,t,n).matched)}(r,i,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,i,r,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):Ph(i):Ph(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,i){const s=this.applyRedirects.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?_L(s):this.applyRedirects.lineralizeSegments(r,s).pipe(Ye(o=>{const a=new bt(o,{});return this.processSegment(e,n,a,o,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){const{matched:a,consumedSegments:u,remainingSegments:d,positionalParamSegments:f}=L0(n,i,s);if(!a)return Ph(n);const g=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,f);return i.redirectTo.startsWith("/")?_L(g):this.applyRedirects.lineralizeSegments(i,g).pipe(Ye(m=>this.processSegment(e,r,n,m.concat(d),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s,o){let a;if("**"===r.path){const u=i.length>0?OV(i).parameters:{};a=fe({snapshot:new jE(i,u,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,EL(r),ks(r),r.component??r._loadedComponent??null,r,IL(r)),consumedSegments:[],remainingSegments:[]}),n.children={}}else a=hX(n,r,i,e).pipe(Ie(({matched:u,consumedSegments:d,remainingSegments:f,parameters:g})=>u?{snapshot:new jE(d,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,EL(r),ks(r),r.component??r._loadedComponent??null,r,IL(r)),consumedSegments:d,remainingSegments:f}:null));return a.pipe(ft(u=>null===u?Ph(n):this.getChildConfig(e=r._injector??e,r,i).pipe(ft(({routes:d})=>{const f=r._loadedInjector??e,{snapshot:g,consumedSegments:m,remainingSegments:y}=u,{segmentGroup:E,slicedSegments:C}=yL(n,m,y,d);if(0===C.length&&E.hasChildren())return this.processChildren(f,d,E).pipe(Ie(O=>null===O?null:[new ma(g,O)]));if(0===d.length&&0===C.length)return fe([new ma(g,[])]);const D=ks(r)===s;return this.processSegment(f,d,E,C,D?Ue:s,!0).pipe(Ie(O=>[new ma(g,O)]))}))))}getChildConfig(e,n,r){return n.children?fe({routes:n.children,injector:e}):n.loadChildren?void 0!==n._loadedRoutes?fe({routes:n._loadedRoutes,injector:n._loadedInjector}):function aX(t,e,n,r){const i=e.canLoad;return void 0===i||0===i.length?fe(!0):fe(i.map(o=>{const a=Sh(o,t);return vu(function WY(t){return t&&Wg(t.canLoad)}(a)?a.canLoad(e,n):t.runInContext(()=>a(e,n)))})).pipe(Rh(),gL())}(e,n,r).pipe(Ye(i=>i?this.configLoader.loadChildren(e,n).pipe(Ir(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):function lX(t){return Eh(lL(!1,3))}())):fe({routes:[],injector:e})}}function wX(t){const e=t.value.routeConfig;return e&&""===e.path}function vL(t){const e=[],n=new Set;for(const r of t){if(!wX(r)){e.push(r);continue}const i=e.find(s=>r.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...r.children),n.add(i)):e.push(r)}for(const r of n){const i=vL(r.children);e.push(new ma(r.value,i))}return e.filter(r=>!n.has(r))}function EL(t){return t.data||{}}function IL(t){return t.resolve||{}}function wL(t){return"string"==typeof t.title||null===t.title}function U0(t){return ft(e=>{const n=t(e);return n?ct(n).pipe(Ie(()=>e)):fe(e)})}const Nh=new re("ROUTES");let B0=(()=>{class t{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=pe(nF)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return fe(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const r=vu(n.loadComponent()).pipe(Ie(TL),Ir(s=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=s}),w0(()=>{this.componentLoaders.delete(n)})),i=new Gi(r,()=>new Vt).pipe(ii());return this.componentLoaders.set(n,i),i}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return fe({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const s=function RX(t,e,n,r){return vu(t.loadChildren()).pipe(Ie(TL),Ye(i=>i instanceof u1||Array.isArray(i)?fe(i):ct(e.compileModuleAsync(i))),Ie(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,!0):(s=i.create(n).injector,o=s.get(Nh,[],{optional:!0,self:!0}).flat()),{routes:o.map(F0),injector:s}}))}(r,this.compiler,n,this.onLoadEndListener).pipe(w0(()=>{this.childrenLoaders.delete(r)})),o=new Gi(s,()=>new Vt).pipe(ii());return this.childrenLoaders.set(r,o),o}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function TL(t){return function PX(t){return t&&"object"==typeof t&&"default"in t}(t)?t.default:t}let WE=(()=>{class t{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Vt,this.transitionAbortSubject=new Vt,this.configLoader=pe(B0),this.environmentInjector=pe(ts),this.urlSerializer=pe(Fg),this.rootContexts=pe($g),this.inputBindingEnabled=null!==pe($E,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>fe(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=i=>this.events.next(new wY(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new IY(i))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:r})}setupNavigations(n,r,i){return this.transitions=new Wt({id:0,currentUrlTree:r,currentRawUrl:r,currentBrowserUrl:r,extractedUrl:n.urlHandlingStrategy.extract(r),urlAfterRedirects:n.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Bg,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ms(s=>0!==s.id),Ie(s=>({...s,extractedUrl:n.urlHandlingStrategy.extract(s.rawUrl)})),ft(s=>{this.currentTransition=s;let o=!1,a=!1;return fe(s).pipe(Ir(u=>{this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),ft(u=>{const d=u.currentBrowserUrl.toString(),f=!n.navigated||u.extractedUrl.toString()!==d||d!==u.currentUrlTree.toString();if(!f&&"reload"!==(u.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const m="";return this.events.next(new bh(u.id,this.urlSerializer.serialize(u.rawUrl),m,0)),u.resolve(null),Jc}if(n.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return fe(u).pipe(ft(m=>{const y=this.transitions?.getValue();return this.events.next(new UE(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),y!==this.transitions?.getValue()?Jc:Promise.resolve(m)}),function TX(t,e,n,r,i,s){return Ye(o=>function vX(t,e,n,r,i,s,o="emptyOnly"){return new EX(t,e,n,r,i,o,s).recognize()}(t,e,n,r,o.extractedUrl,i,s).pipe(Ie(({state:a,tree:u})=>({...o,targetSnapshot:a,urlAfterRedirects:u}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,n.paramsInheritanceStrategy),Ir(m=>{s.targetSnapshot=m.targetSnapshot,s.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects};const y=new JV(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(y)}));if(f&&n.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){const{id:m,extractedUrl:y,source:E,restoredState:C,extras:D}=u,O=new UE(m,this.urlSerializer.serialize(y),E,C);this.events.next(O);const R=rL(0,this.rootComponentType).snapshot;return this.currentTransition=s={...u,targetSnapshot:R,urlAfterRedirects:y,extras:{...D,skipLocationChange:!1,replaceUrl:!1}},fe(s)}{const m="";return this.events.next(new bh(u.id,this.urlSerializer.serialize(u.extractedUrl),m,1)),u.resolve(null),Jc}}),Ir(u=>{const d=new _Y(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),Ie(u=>(this.currentTransition=s={...u,guards:$Y(u.targetSnapshot,u.currentSnapshot,this.rootContexts)},s)),function JY(t,e){return Ye(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?fe({...n,guardsResult:!0}):function eX(t,e,n,r){return ct(t).pipe(Ye(i=>function oX(t,e,n,r,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?fe(s.map(a=>{const u=Gg(e)??i,d=Sh(a,u);return vu(function QY(t){return t&&Wg(t.canDeactivate)}(d)?d.canDeactivate(t,e,n,r):u.runInContext(()=>d(t,e,n,r))).pipe(_u())})).pipe(Rh()):fe(!0)}(i.component,i.route,n,e,r)),_u(i=>!0!==i,!0))}(o,r,i,t).pipe(Ye(a=>a&&function zY(t){return"boolean"==typeof t}(a)?function tX(t,e,n,r){return ct(e).pipe(Mg(i=>E0(function rX(t,e){return null!==t&&e&&e(new TY(t)),fe(!0)}(i.route.parent,r),function nX(t,e){return null!==t&&e&&e(new bY(t)),fe(!0)}(i.route,r),function sX(t,e,n){const r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function HY(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(o)).filter(o=>null!==o).map(o=>NV(()=>fe(o.guards.map(u=>{const d=Gg(o.node)??n,f=Sh(u,d);return vu(function ZY(t){return t&&Wg(t.canActivateChild)}(f)?f.canActivateChild(r,t):d.runInContext(()=>f(r,t))).pipe(_u())})).pipe(Rh())));return fe(s).pipe(Rh())}(t,i.path,n),function iX(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return fe(!0);const i=r.map(s=>NV(()=>{const o=Gg(e)??n,a=Sh(s,o);return vu(function KY(t){return t&&Wg(t.canActivate)}(a)?a.canActivate(e,t):o.runInContext(()=>a(e,t))).pipe(_u())}));return fe(i).pipe(Rh())}(t,i.route,n))),_u(i=>!0!==i,!0))}(r,s,t,e):fe(a)),Ie(a=>({...n,guardsResult:a})))})}(this.environmentInjector,u=>this.events.next(u)),Ir(u=>{if(s.guardsResult=u.guardsResult,nl(u.guardsResult))throw cL(0,u.guardsResult);const d=new yY(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(d)}),Ms(u=>!!u.guardsResult||(this.cancelNavigationTransition(u,"",3),!1)),U0(u=>{if(u.guards.canActivateChecks.length)return fe(u).pipe(Ir(d=>{const f=new vY(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(f)}),ft(d=>{let f=!1;return fe(d).pipe(function CX(t,e){return Ye(n=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return fe(n);let s=0;return ct(i).pipe(Mg(o=>function bX(t,e,n,r){const i=t.routeConfig,s=t._resolve;return void 0!==i?.title&&!wL(i)&&(s[kg]=i.title),function DX(t,e,n,r){const i=function AX(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}(t);if(0===i.length)return fe({});const s={};return ct(i).pipe(Ye(o=>function SX(t,e,n,r){const i=Gg(e)??r,s=Sh(t,i);return vu(s.resolve?s.resolve(e,n):i.runInContext(()=>s(e,n)))}(t[o],e,n,r).pipe(_u(),Ir(a=>{s[o]=a}))),I0(1),function OQ(t){return e=>e.lift(new FQ(t))}(s),Ih(o=>pL(o)?Jc:Eh(o)))}(s,t,e,r).pipe(Ie(o=>(t._resolvedData=o,t.data=iL(t,n).resolve,i&&wL(i)&&(t.data[kg]=i.title),null)))}(o.route,r,t,e)),Ir(()=>s++),I0(1),Ye(o=>s===i.length?fe(n):Jc))})}(n.paramsInheritanceStrategy,this.environmentInjector),Ir({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(d,"",2)}}))}),Ir(d=>{const f=new EY(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(f)}))}),U0(u=>{const d=f=>{const g=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(f.routeConfig).pipe(Ir(m=>{f.component=m}),Ie(()=>{})));for(const m of f.children)g.push(...d(m));return g};return v0(d(u.targetSnapshot.root)).pipe(xE(),el(1))}),U0(()=>this.afterPreactivation()),Ie(u=>{const d=function NY(t,e,n){const r=Hg(t,e._root,n?n._root:void 0);return new nL(r,e)}(n.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=s={...u,targetRouterState:d},s}),Ir(()=>{this.events.next(new S0)}),((t,e,n,r)=>Ie(i=>(new jY(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)))(this.rootContexts,n.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),el(1),Ir({next:u=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Eu(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),n.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{o=!0}}),function BQ(t){return e=>e.lift(new jQ(t))}(this.transitionAbortSubject.pipe(Ir(u=>{throw u}))),w0(()=>{o||a||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),Ih(u=>{if(a=!0,dL(u))this.events.next(new jg(s.id,this.urlSerializer.serialize(s.extractedUrl),u.message,u.cancellationCode)),function kY(t){return dL(t)&&nl(t.url)}(u)?this.events.next(new R0(u.url)):s.resolve(!1);else{this.events.next(new BE(s.id,this.urlSerializer.serialize(s.extractedUrl),u,s.targetSnapshot??void 0));try{s.resolve(n.errorHandler(u))}catch(d){s.reject(d)}}return Jc}))}))}cancelNavigationTransition(n,r,i){const s=new jg(n.id,this.urlSerializer.serialize(n.extractedUrl),r,i);this.events.next(s),n.resolve(!1)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function CL(t){return t!==Bg}let bL=(()=>{class t{buildTitle(n){let r,i=n.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===Ue);return r}getResolvedTitleForRoute(n){return n.data[kg]}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:function(){return pe(NX)},providedIn:"root"})}return t})(),NX=(()=>{class t extends bL{constructor(n){super(),this.title=n}updateTitle(n){const r=this.buildTitle(n);void 0!==r&&this.title.setTitle(r)}static#e=this.\u0275fac=function(r){return new(r||t)(z(CV))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),xX=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:function(){return pe(kX)},providedIn:"root"})}return t})();class MX{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}}let kX=(()=>{class t extends MX{static#e=this.\u0275fac=function(){let n;return function(i){return(n||(n=Pn(t)))(i||t)}}();static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const KE=new re("",{providedIn:"root",factory:()=>({})});let OX=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:function(){return pe(FX)},providedIn:"root"})}return t})(),FX=(()=>{class t{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Kg=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(Kg||{});function DL(t,e){t.events.pipe(Ms(n=>n instanceof Eu||n instanceof jg||n instanceof BE||n instanceof bh),Ie(n=>n instanceof Eu||n instanceof bh?Kg.COMPLETE:n instanceof jg&&(0===n.code||1===n.code)?Kg.REDIRECTING:Kg.FAILED),Ms(n=>n!==Kg.REDIRECTING),el(1)).subscribe(()=>{e()})}function VX(t){throw t}function LX(t,e,n){return e.parse("/")}const UX={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},BX={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let os=(()=>{class t{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=pe(eF),this.isNgZoneEnabled=!1,this._events=new Vt,this.options=pe(KE,{optional:!0})||{},this.pendingTasks=pe(tF),this.errorHandler=this.options.errorHandler||VX,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||LX,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=pe(OX),this.routeReuseStrategy=pe(xX),this.titleStrategy=pe(bL),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=pe(Nh,{optional:!0})?.flat()??[],this.navigationTransitions=pe(WE),this.urlSerializer=pe(Fg),this.location=pe(zD),this.componentInputBindingEnabled=!!pe($E,{optional:!0}),this.eventsSubscription=new L,this.isNgZoneEnabled=pe(lt)instanceof lt&&lt.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Ch,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=rL(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(n=>{this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const n=this.navigationTransitions.events.subscribe(r=>{try{const{currentTransition:i}=this.navigationTransitions;if(null===i)return void(AL(r)&&this._events.next(r));if(r instanceof UE)CL(i.source)&&(this.browserUrlTree=i.extractedUrl);else if(r instanceof bh)this.rawUrlTree=i.rawUrl;else if(r instanceof JV){if("eager"===this.urlUpdateStrategy){if(!i.extras.skipLocationChange){const s=this.urlHandlingStrategy.merge(i.urlAfterRedirects,i.rawUrl);this.setBrowserUrl(s,i)}this.browserUrlTree=i.urlAfterRedirects}}else if(r instanceof S0)this.currentUrlTree=i.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(i.urlAfterRedirects,i.rawUrl),this.routerState=i.targetRouterState,"deferred"===this.urlUpdateStrategy&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i),this.browserUrlTree=i.urlAfterRedirects);else if(r instanceof jg)0!==r.code&&1!==r.code&&(this.navigated=!0),(3===r.code||2===r.code)&&this.restoreHistory(i);else if(r instanceof R0){const s=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),o={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||CL(i.source)};this.scheduleNavigation(s,Bg,null,o,{resolve:i.resolve,reject:i.reject,promise:i.promise})}r instanceof BE&&this.restoreHistory(i,!0),r instanceof Eu&&(this.navigated=!0),AL(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const n=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Bg,n)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const r="popstate"===n.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{this.navigateToSyncWithBrowser(n.url,r,n.state)},0)}))}navigateToSyncWithBrowser(n,r,i){const s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){const u={...i};delete u.navigationId,delete u.\u0275routerPageId,0!==Object.keys(u).length&&(s.state=u)}const a=this.parseUrl(n);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(F0),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){const{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:u}=r,d=u?this.currentUrlTree.fragment:o;let g,f=null;switch(a){case"merge":f={...this.currentUrlTree.queryParams,...s};break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=s||null}null!==f&&(f=this.removeEmptyProps(f));try{g=zV(i?i.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),g=this.currentUrlTree.root}return WV(g,n,f,d??null)}navigateByUrl(n,r={skipLocationChange:!1}){const i=nl(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Bg,null,r)}navigate(n,r={skipLocationChange:!1}){return function jX(t){for(let e=0;e<t.length;e++)if(null==t[e])throw new q(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let r;try{r=this.urlSerializer.parse(n)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,n)}return r}isActive(n,r){let i;if(i=!0===r?{...UX}:!1===r?{...BX}:r,nl(n))return VV(this.currentUrlTree,n,i);const s=this.parseUrl(n);return VV(this.currentUrlTree,s,i)}removeEmptyProps(n){return Object.keys(n).reduce((r,i)=>{const s=n[i];return null!=s&&(r[i]=s),r},{})}scheduleNavigation(n,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,u,d;o?(a=o.resolve,u=o.reject,d=o.promise):d=new Promise((g,m)=>{a=g,u=m});const f=this.pendingTasks.add();return DL(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:n,extras:s,resolve:a,reject:u,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(g=>Promise.reject(g))}setBrowserUrl(n,r){const i=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){const o={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(i,"",o)}else{const s={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId+1)};this.location.go(i,"",s)}}restoreHistory(n,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function AL(t){return!(t instanceof S0||t instanceof R0)}class SL{}let GX=(()=>{class t{constructor(n,r,i,s,o){this.router=n,this.injector=i,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Ms(n=>n instanceof Eu),Mg(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,r){const i=[];for(const s of r){s.providers&&!s._injector&&(s._injector=cD(s.providers,n,`Route: ${s.path}`));const o=s._injector??n,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(a,s.children??s._loadedRoutes))}return ct(i).pipe(K())}preloadConfig(n,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(n,r):fe(null);const s=i.pipe(Ye(o=>null===o?fe(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??n,o.routes))));return r.loadComponent&&!r._loadedComponent?ct([s,this.loader.loadComponent(r)]).pipe(K()):s})}static#e=this.\u0275fac=function(r){return new(r||t)(z(os),z(nF),z(ts),z(SL),z(B0))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const $0=new re("");let RL=(()=>{class t{constructor(n,r,i,s,o={}){this.urlSerializer=n,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof UE?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Eu?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof bh&&0===n.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof eL&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new eL(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){!function QM(){throw new Error("invalid")}()};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac})}return t})();function _a(t,e){return{\u0275kind:t,\u0275providers:e}}function NL(){const t=pe(xi);return e=>{const n=t.get(_h);if(e!==n.components[0])return;const r=t.get(os),i=t.get(xL);1===t.get(H0)&&r.initialNavigation(),t.get(ML,null,He.Optional)?.setUpPreloading(),t.get($0,null,He.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const xL=new re("",{factory:()=>new Vt}),H0=new re("",{providedIn:"root",factory:()=>1}),ML=new re("");function KX(t){return _a(0,[{provide:ML,useExisting:GX},{provide:SL,useExisting:t}])}const kL=new re("ROUTER_FORROOT_GUARD"),QX=[zD,{provide:Fg,useClass:T0},os,$g,{provide:Ah,useFactory:function PL(t){return t.routerState.root},deps:[os]},B0,[]];function YX(){return new cF("Router",os)}let OL=(()=>{class t{constructor(n){}static forRoot(n,r){return{ngModule:t,providers:[QX,[],{provide:Nh,multi:!0,useValue:n},{provide:kL,useFactory:tJ,deps:[[os,new au,new Od]]},{provide:KE,useValue:r||{}},r?.useHash?{provide:Xc,useClass:HK}:{provide:Xc,useClass:BF},{provide:$0,useFactory:()=>{const t=pe(cZ),e=pe(lt),n=pe(KE),r=pe(WE),i=pe(Fg);return n.scrollOffset&&t.setOffset(n.scrollOffset),new RL(i,r,t,e,n)}},r?.preloadingStrategy?KX(r.preloadingStrategy).\u0275providers:[],{provide:cF,multi:!0,useFactory:YX},r?.initialNavigation?nJ(r):[],r?.bindToComponentInputs?_a(8,[uL,{provide:$E,useExisting:uL}]).\u0275providers:[],[{provide:FL,useFactory:NL},{provide:FD,multi:!0,useExisting:FL}]]}}static forChild(n){return{ngModule:t,providers:[{provide:Nh,multi:!0,useValue:n}]}}static#e=this.\u0275fac=function(r){return new(r||t)(z(kL,8))};static#t=this.\u0275mod=er({type:t});static#n=this.\u0275inj=Vn({})}return t})();function tJ(t){return"guarded"}function nJ(t){return["disabled"===t.initialNavigation?_a(3,[{provide:SD,multi:!0,useFactory:()=>{const e=pe(os);return()=>{e.setUpLocationChangeListener()}}},{provide:H0,useValue:2}]).\u0275providers:[],"enabledBlocking"===t.initialNavigation?_a(2,[{provide:H0,useValue:0},{provide:SD,multi:!0,deps:[xi],useFactory:e=>{const n=e.get(jK,Promise.resolve());return()=>n.then(()=>new Promise(r=>{const i=e.get(os),s=e.get(xL);DL(i,()=>{r(!0)}),e.get(WE).afterPreactivation=()=>(r(!0),s.closed?fe(void 0):s),i.initialNavigation()}))}}]).\u0275providers:[]]}const FL=new re(""),iJ=[];let sJ=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=er({type:t});static#n=this.\u0275inj=Vn({imports:[OL.forRoot(iJ),OL]})}return t})();class VL{constructor(e){this.key="",this.players=[],this.secondsPerTurn=60,this.minutesForGame=60,this.startTime=null,this.endTime=null,this.inProgress=!1,e?(this.key=e.key,this.code=e.code,this.secondsPerTurn=e.secondsPerTurn,this.minutesForGame=e.minutesForGame,this.inProgress=e.inProgress,this.startTime=e.startTime??null,this.endTime=e.endTime??null,this.players=e.players):this.code=Math.floor(100*Math.random()+1).toString()}addPlayer(){const e=new oJ(this.getNextPlayerNumber());return this.players.push(e),e}findPlayer(e){return this.players.find(n=>n.number===e)}getNextPlayerNumber(){return(Math.max(0,...this.players.map(e=>+e.number))+1).toString()}}class oJ{constructor(e){this.number="",this.name="",this.color="",this.myTurn=!1,this.number=e}}var vi=je(534);(0,vi.registerVersion)("firebase","10.7.1","app");class cJ extends L{constructor(e,n){super()}schedule(e,n=0){return this}}class G0 extends cJ{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){if(this.closed)return this;this.state=e;const r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,n)),this.pending=!0,this.delay=n,this.id=this.id||this.requestAsyncId(i,this.id,n),this}requestAsyncId(e,n,r=0){return setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(null!==r&&this.delay===r&&!1===this.pending)return n;clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,n);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let i,r=!1;try{this.work(e)}catch(s){r=!0,i=!!s&&s||new Error(s)}if(r)return this.unsubscribe(),i}_unsubscribe(){const e=this.id,n=this.scheduler,r=n.actions,i=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&r.splice(i,1),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null}}let LL=(()=>{class t{constructor(n,r=t.now){this.SchedulerAction=n,this.now=r}schedule(n,r=0,i){return new this.SchedulerAction(this,n).schedule(i,r)}}return t.now=()=>Date.now(),t})();class go extends LL{constructor(e,n=LL.now){super(e,()=>go.delegate&&go.delegate!==this?go.delegate.now():n()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,n=0,r){return go.delegate&&go.delegate!==this?go.delegate.schedule(e,n,r):super.schedule(e,n,r)}flush(e){const{actions:n}=this;if(this.active)return void n.push(e);let r;this.active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=n.shift());if(this.active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}}const UL=new class dJ extends go{}(class lJ extends G0{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return null!==r&&r>0||null===r&&this.delay>0?super.requestAsyncId(e,n,r):e.flush(this)}}),hJ=UL,ZE=new go(G0),fJ=ZE;class as{constructor(e,n,r){this.kind=e,this.value=n,this.error=r,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,n,r){switch(this.kind){case"N":return e&&e(this.value);case"E":return n&&n(this.error);case"C":return r&&r()}}accept(e,n,r){return e&&"function"==typeof e.next?this.observe(e):this.do(e,n,r)}toObservable(){switch(this.kind){case"N":return fe(this.value);case"E":return Eh(this.error);case"C":return PE()}throw new Error("unexpected notification kind value")}static createNext(e){return typeof e<"u"?new as("N",e):as.undefinedValueNotification}static createError(e){return new as("E",void 0,e)}static createComplete(){return as.completeNotification}}function xh(t,e=0){return function(r){return r.lift(new gJ(t,e))}}as.completeNotification=new as("C"),as.undefinedValueNotification=new as("N",void 0);class gJ{constructor(e,n=0){this.scheduler=e,this.delay=n}call(e,n){return n.subscribe(new QE(e,this.scheduler,this.delay))}}class QE extends Ee{constructor(e,n,r=0){super(e),this.scheduler=n,this.delay=r}static dispatch(e){const{notification:n,destination:r}=e;n.observe(r),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(QE.dispatch,this.delay,new mJ(e,this.destination)))}_next(e){this.scheduleMessage(as.createNext(e))}_error(e){this.scheduleMessage(as.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(as.createComplete()),this.unsubscribe()}}class mJ{constructor(e,n){this.notification=e,this.destination=n}}let _J=1;const yJ=Promise.resolve(),YE={};function BL(t){return t in YE&&(delete YE[t],!0)}const jL={setImmediate(t){const e=_J++;return YE[e]=!0,yJ.then(()=>BL(e)&&t()),e},clearImmediate(t){BL(t)}},q0=new class EJ extends go{flush(e){this.active=!0,this.scheduled=void 0;const{actions:n}=this;let r,i=-1,s=n.length;e=e||n.shift();do{if(r=e.execute(e.state,e.delay))break}while(++i<s&&(e=n.shift()));if(this.active=!1,r){for(;++i<s&&(e=n.shift());)e.unsubscribe();throw r}}}(class vJ extends G0{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}requestAsyncId(e,n,r=0){return null!==r&&r>0?super.requestAsyncId(e,n,r):(e.actions.push(this),e.scheduled||(e.scheduled=jL.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,n,r=0){if(null!==r&&r>0||null===r&&this.delay>0)return super.recycleAsyncId(e,n,r);0===e.actions.length&&(jL.clearImmediate(n),e.scheduled=void 0)}});class XE extends Ge{constructor(e,n=0,r=q0){super(),this.source=e,this.delayTime=n,this.scheduler=r,(!function IJ(t){return!xt(t)&&t-parseFloat(t)+1>=0}(n)||n<0)&&(this.delayTime=0),(!r||"function"!=typeof r.schedule)&&(this.scheduler=q0)}static create(e,n=0,r=q0){return new XE(e,n,r)}static dispatch(e){const{source:n,subscriber:r}=e;return this.add(n.subscribe(r))}_subscribe(e){return this.scheduler.schedule(XE.dispatch,this.delayTime,{source:this.source,subscriber:e})}}function JE(t,e=0){return function(r){return r.lift(new wJ(t,e))}}class wJ{constructor(e,n){this.scheduler=e,this.delay=n}call(e,n){return new XE(n,this.delay,this.scheduler).subscribe(e)}}const Zg=new Jd("ANGULARFIRE2_VERSION");class eI{constructor(){return((t,e)=>{const n=(0,vi.getApps)(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r})(CJ)}}const CJ="app-check";function Mh(){}class $L{zone;delegate;constructor(e,n=UL){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){const i=this.zone;return this.delegate.schedule(function(o){i.runGuarded(()=>{e.apply(this,[o])})},n,r)}}class bJ{zone;task=null;constructor(e){this.zone=e}call(e,n){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Mh,{},Mh,Mh)),n.pipe(Ir({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let tI=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new $L(Zone.current)),this.insideAngular=n.run(()=>new $L(Zone.current,ZE)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(z(lt))};static \u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function kh(){const t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return t}function HL(t){return t.pipe(xh(kh().outsideAngular))}function Mn(t){return function AJ(t){return function(n){return(n=n.lift(new bJ(t.ngZone))).pipe(JE(t.outsideAngular),xh(t.insideAngular))}}(kh())(t)}var us=je(106);us.Z.registerVersion("firebase","10.7.1","app-compat");const NJ=["ngOnDestroy"];class GL{constructor(e){return e}}const Oh=new re("angularfire2.app.options"),Fh=new re("angularfire2.app.name");function Qg(t,e,n){const i="object"==typeof n&&n||{};i.name=i.name||"string"==typeof n&&n||"[DEFAULT]";const o=us.Z.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>us.Z.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){const a=!!module.hot;kJ("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new GL(o)}const kJ=(t,...e)=>{},OJ={provide:GL,useFactory:Qg,deps:[Oh,lt,[new au,Fh]]};let FJ=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:Oh,useValue:n},{provide:Fh,useValue:r}]}}constructor(n){us.Z.registerVersion("angularfire",Zg.full,"core"),us.Z.registerVersion("angularfire",Zg.full,"app-compat"),us.Z.registerVersion("angular",bM.full,n.toString())}static \u0275fac=function(r){return new(r||t)(z(Ds))};static \u0275mod=er({type:t});static \u0275inj=Vn({providers:[OJ]})}return t})();function nI(t,e,n,r,i){const[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return function VJ(t,e){try{return t.toString()===e.toString()}catch{return t===e}}(i,o)||(qL("error",`${e} was already initialized on the ${n} Firebase App with different settings.${LJ?" You may need to reload as Firebase is not HMR aware.":""}`),qL("warn",{is:i,was:o})),s;{const a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}const LJ=typeof module<"u"&&!!module.hot,qL=(t,...e)=>{};globalThis.\u0275AngularfireInstanceCache||=[],je(980);class UJ extends Vt{constructor(e=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,r){super(),this.scheduler=r,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const n=this._events;n.push(e),n.length>this._bufferSize&&n.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new BJ(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,s=r.length;let o;if(this.closed)throw new Ke;if(this.isStopped||this.hasError?o=L.EMPTY:(this.observers.push(e),o=new Dn(this,e)),i&&e.add(e=new QE(e,i)),n)for(let a=0;a<s&&!e.closed;a++)e.next(r[a]);else for(let a=0;a<s&&!e.closed;a++)e.next(r[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}_getNow(){return(this.scheduler||hJ).now()}_trimBufferThenGetEvents(){const e=this._getNow(),n=this._bufferSize,r=this._windowTime,i=this._events,s=i.length;let o=0;for(;o<s&&!(e-i[o].time<r);)o++;return s>n&&(o=Math.max(o,s-n)),o>0&&i.splice(0,o),i}}class BJ{constructor(e,n){this.time=e,this.value=n}}function zL(t,e,n){let r;return r=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:n},i=>i.lift(function jJ({bufferSize:t=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:n,scheduler:r}){let i,o,s=0,a=!1,u=!1;return function(f){let g;s++,!i||a?(a=!1,i=new UJ(t,e,r),g=i.subscribe(this),o=f.subscribe({next(m){i.next(m)},error(m){a=!0,i.error(m)},complete(){u=!0,o=void 0,i.complete()}}),u&&(o=void 0)):g=i.subscribe(this),this.add(()=>{s--,g.unsubscribe(),g=void 0,o&&!u&&n&&0===s&&(o.unsubscribe(),o=void 0,i=void 0)})}}(r))}function WL(t,e){return e?ft(()=>t,e):ft(()=>t)}const z0=new re("angularfire2.auth.use-emulator"),W0=new re("angularfire2.auth.settings"),K0=new re("angularfire2.auth.tenant-id"),Z0=new re("angularfire2.auth.langugage-code"),Q0=new re("angularfire2.auth.use-device-language"),Y0=new re("angularfire.auth.persistence"),X0=(t,e,n,r,i,s,o,a)=>nI(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{const u=e.runOutsideAngular(()=>t.auth());if(n&&u.useEmulator(...n),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(const[d,f]of Object.entries(o))u.settings[d]=f;return a&&u.setPersistence(a),u},[n,r,i,s,o,a]);let J0=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,u,d,f,g,m,y){const E=new Vt,C=fe(void 0).pipe(xh(o.outsideAngular),ft(()=>s.runOutsideAngular(()=>Promise.resolve().then(je.bind(je,980)))),Ie(()=>Qg(n,s,r)),Ie(D=>X0(D,s,a,d,f,g,u,m)),zL({bufferSize:1,refCount:!1}));if(bE(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=fe(null);else{C.pipe(_u()).subscribe();const D=C.pipe(ft(k=>k.getRedirectResult().then(G=>G,()=>null)),Mn,zL({bufferSize:1,refCount:!1})),O=C.pipe(ft(k=>new Ge(G=>({unsubscribe:s.runOutsideAngular(()=>k.onAuthStateChanged(ne=>G.next(ne),ne=>G.error(ne),()=>G.complete()))})))),R=C.pipe(ft(k=>new Ge(G=>({unsubscribe:s.runOutsideAngular(()=>k.onIdTokenChanged(ne=>G.next(ne),ne=>G.error(ne),()=>G.complete()))}))));this.authState=D.pipe(WL(O),JE(o.outsideAngular),xh(o.insideAngular)),this.user=D.pipe(WL(R),JE(o.outsideAngular),xh(o.insideAngular)),this.idToken=this.user.pipe(ft(k=>k?ct(k.getIdToken()):fe(null))),this.idTokenResult=this.user.pipe(ft(k=>k?ct(k.getIdTokenResult()):fe(null))),this.credential=An(D,E,this.authState.pipe(Ms(k=>!k))).pipe(Ie(k=>k?.user?k:null),JE(o.outsideAngular),xh(o.insideAngular))}return((t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(NJ.indexOf(s)>-1)return()=>{};const o=e.toPromise().then(a=>{const u=a?.[s];return"function"==typeof u?u.bind(a):u?.then?u.then(d=>n.run(()=>d)):n.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,d)=>o.then(f=>{const g=f?.(...d);return r?.spy?.apply&&r.spy.apply(s,d,g),g})})})}))(this,C,s,{spy:{apply:(D,O,R)=>{(D.startsWith("signIn")||D.startsWith("createUser"))&&R.then(k=>E.next(k))}}})}static \u0275fac=function(r){return new(r||t)(z(Oh),z(Fh,8),z(Ds),z(lt),z(tI),z(z0,8),z(W0,8),z(K0,8),z(Z0,8),z(Q0,8),z(Y0,8),z(eI,8))};static \u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();class GJ{constructor(e,n){this.observables=e,this.project=n}call(e,n){return n.subscribe(new qJ(e,this.observables,this.project))}}class qJ extends SV{constructor(e,n,r){super(e),this.observables=n,this.project=r,this.toRespond=[];const i=n.length;this.values=new Array(i);for(let s=0;s<i;s++)this.toRespond.push(s);for(let s=0;s<i;s++)this.add(RV(this,n[s],void 0,s))}notifyNext(e,n,r){this.values[r]=n;const i=this.toRespond;if(i.length>0){const s=i.indexOf(r);-1!==s&&i.splice(s,1)}}notifyComplete(){}_next(e){if(0===this.toRespond.length){const n=[e,...this.values];this.project?this._tryProject(n):this.destination.next(n)}}_tryProject(e){let n;try{n=this.project.apply(this,e)}catch(r){return void this.destination.error(r)}this.destination.next(n)}}class WJ{constructor(e){this.predicate=e}call(e,n){return n.subscribe(new KJ(e,this.predicate))}}class KJ extends Ee{constructor(e,n){super(e),this.predicate=n,this.skipping=!0,this.index=0}_next(e){const n=this.destination;this.skipping&&this.tryCallPredicate(e),this.skipping||n.next(e)}tryCallPredicate(e){try{const n=this.predicate(e,this.index++);this.skipping=!!n}catch(n){this.destination.error(n)}}}var Os=je(537),$=je(861),I=je(58),Fi=je(879);const KL="@firebase/database";let eA="";function tA(t){eA=t}class ZJ{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){null==n?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,I.Wl)(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return null==n?null:(0,I.cI)(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class QJ{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){null==n?delete this.cache_[e]:this.cache_[e]=n}get(e){return(0,I.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const QL=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new ZJ(e)}}catch{}return new QJ},il=QL("localStorage"),nA=QL("sessionStorage"),Vh=new Fi.Yd("@firebase/database"),YL=function(){let t=1;return function(){return t++}}(),XL=function(t){const e=(0,I.dS)(t),n=new I.gQ;n.update(e);const r=n.digest();return I.US.encodeByteArray(r)},Yg=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=Yg.apply(null,r):e+="object"==typeof r?(0,I.Wl)(r):r,e+=" "}return e};let sl=null,JL=!0;const e2=function(t,e){(0,I.hu)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(Vh.logLevel=Fi.in.VERBOSE,sl=Vh.log.bind(Vh),e&&nA.set("logging_enabled",!0)):"function"==typeof t?sl=t:(sl=null,nA.remove("logging_enabled"))},rr=function(...t){if(!0===JL&&(JL=!1,null===sl&&!0===nA.get("logging_enabled")&&e2(!0)),sl){const e=Yg.apply(null,t);sl(e)}},Xg=function(t){return function(...e){rr(t,...e)}},rA=function(...t){const e="FIREBASE INTERNAL ERROR: "+Yg(...t);Vh.error(e)},mo=function(...t){const e=`FIREBASE FATAL ERROR: ${Yg(...t)}`;throw Vh.error(e),new Error(e)},Nr=function(...t){const e="FIREBASE WARNING: "+Yg(...t);Vh.warn(e)},rI=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},Iu="[MIN_NAME]",ya="[MAX_NAME]",ol=function(t,e){if(t===e)return 0;if(t===Iu||e===ya)return-1;if(e===Iu||t===ya)return 1;{const n=r2(t),r=r2(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1}},JJ=function(t,e){return t===e?0:t<e?-1:1},Jg=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,I.Wl)(e))},iA=function(t){if("object"!=typeof t||null===t)return(0,I.Wl)(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)0!==r&&(n+=","),n+=(0,I.Wl)(e[r]),n+=":",n+=iA(t[e[r]]);return n+="}",n},t2=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)r.push(t.substring(i,i+e>n?n:i+e));return r};function ir(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const n2=function(t){(0,I.hu)(!rI(t),"Invalid JSON number");const r=1023;let i,s,o,a,u;0===t?(s=0,o=0,i=1/t==-1/0?1:0):(i=t<0,(t=Math.abs(t))>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,52-a)-Math.pow(2,52))):(s=0,o=Math.round(t/Math.pow(2,-1074))));const d=[];for(u=52;u;u-=1)d.push(o%2?1:0),o=Math.floor(o/2);for(u=11;u;u-=1)d.push(s%2?1:0),s=Math.floor(s/2);d.push(i?1:0),d.reverse();const f=d.join("");let g="";for(u=0;u<64;u+=8){let m=parseInt(f.substr(u,8),2).toString(16);1===m.length&&(m="0"+m),g+=m}return g.toLowerCase()},ree=new RegExp("^-?(0*)\\d{1,10}$"),r2=function(t){if(ree.test(t)){const e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},Lh=function(t){try{t()}catch(e){setTimeout(()=>{throw Nr("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},em=function(t,e){const n=setTimeout(t,e);return"number"==typeof n&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class aee{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;null===(n=this.appCheckProvider)||void 0===n||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Nr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class uee{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&"auth/token-not-initialized"===n.code?(rr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Nr(e)}}let tm=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}return t.OWNER="owner",t})();const u2=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,d2="websocket",h2="long_polling";class oA{constructor(e,n,r,i,s=!1,o="",a=!1,u=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=il.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&il.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function f2(t,e,n){let r;if((0,I.hu)("string"==typeof e,"typeof type must == string"),(0,I.hu)("object"==typeof n,"typeof params must == object"),e===d2)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==h2)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function cee(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);const i=[];return ir(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}class lee{constructor(){this.counters_={}}incrementCounter(e,n=1){(0,I.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return(0,I.p$)(this.counters_)}}const aA={},uA={};function cA(t){const e=t.toString();return aA[e]||(aA[e]=new lee),aA[e]}class hee{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Lh(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class wu{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Xg(e),this.stats_=cA(n),this.urlFn=u=>(this.appCheckToken&&(u.ac=this.appCheckToken),f2(n,h2,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new hee(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(t){if((0,I.Yr)()||"complete"===document.readyState)t();else{let e=!1;const n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new lA((...s)=>{const[o,a,u,d,f]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===o)this.id=a,this.password=u;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&u2.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){wu.forceAllow_=!0}static forceDisallow(){wu.forceDisallow_=!0}static isAvailable(){return!((0,I.Yr)()||!wu.forceAllow_&&(wu.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=(0,I.Wl)(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=(0,I.h$)(n),i=t2(r,1840);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if((0,I.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=(0,I.Wl)(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class lA{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,I.Yr)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=YL(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=lA.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){rr("frame writing exception"),a.stack&&rr(a.stack),rr(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||rr("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const o=this.pendingSegs.shift();r=r+"&seg"+i+"="+o.seg+"&ts"+i+"="+o.ts+"&d"+i+"="+o.d,i++}return n+=r,this.addLongPollTag_(n,this.currentSerial),!0}return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,n){(0,I.Yr)()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{rr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let sI=null;typeof MozWebSocket<"u"?sI=MozWebSocket:typeof WebSocket<"u"&&(sI=WebSocket);let Uh=(()=>{class t{constructor(n,r,i,s,o,a,u){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Xg(this.connId),this.stats_=cA(r),this.connURL=t.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){const a={v:"5"};return!(0,I.Yr)()&&typeof location<"u"&&location.hostname&&u2.test(location.hostname)&&(a.r="f"),r&&(a.s=r),i&&(a.ls=i),s&&(a.ac=s),o&&(a.p=o),f2(n,d2,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,il.set("previous_websocket_failure",!0);try{let i;if((0,I.Yr)()){i={headers:{"User-Agent":`Firebase/5/${eA}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const o=process.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new sI(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&null!==sI&&!t.forceDisallow_}static previouslyFailed(){return il.isInMemoryStorage||!0===il.get("previous_websocket_failure")}markConnectionHealthy(){il.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,I.cI)(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if((0,I.hu)(null===this.frames,"We already have a frame buffer"),n.length<=6){const r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(null===this.mySock)return;const r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();const r=(0,I.Wl)(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=t2(r,16384);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t})(),E2=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[wu,Uh]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){const r=Uh&&Uh.isAvailable();let i=r&&!Uh.previouslyFailed();if(n.webSocketOnly&&(r||Nr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Uh];else{const s=this.transports_=[];for(const o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return t.globalTransportInitialized_=!1,t})();class A2{constructor(e,n,r,i,s,o,a,u,d,f){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=d,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Xg("c:"+this.id+":"),this.transportManager_=new E2(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=em(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const n=e.t;"a"===n?this.upgradeIfSecondaryHealthy_():"r"===n?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===n&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Jg("t",e),r=Jg("d",e);if("c"===n)this.onSecondaryControl_(r);else{if("d"!==n)throw new Error("Unknown protocol layer: "+n);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Jg("t",e),r=Jg("d",e);"c"===n?this.onControl_(r):"d"===n&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Jg("t",e);if("d"in e){const r=e.d;if("h"===n){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if("n"===n){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===n?this.onConnectionShutdown_(r):"r"===n?this.onReset_(r):"e"===n?rA("Server Error: "+r):"o"===n?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):rA("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),"5"!==r&&Nr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),em(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):em(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(il.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class S2{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}class R2{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,I.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context))return void i.splice(s,1)}validateEventType_(e){(0,I.hu)(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}class oI extends R2{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,I.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new oI}getInitialEvent(e){return(0,I.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class It{constructor(e,n){if(void 0===n){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)""!==this.pieces_[n]&&(e+="/"+this.pieces_[n]);return e||"/"}}function pt(){return new It("")}function qe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Tu(t){return t.pieces_.length-t.pieceNum_}function Ft(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new It(t.pieces_,e)}function hA(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function nm(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function x2(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new It(e,0)}function on(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof It)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new It(n,0)}function ze(t){return t.pieceNum_>=t.pieces_.length}function Qr(t,e){const n=qe(t),r=qe(e);if(null===n)return e;if(n===r)return Qr(Ft(t),Ft(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function kee(t,e){const n=nm(t,0),r=nm(e,0);for(let i=0;i<n.length&&i<r.length;i++){const s=ol(n[i],r[i]);if(0!==s)return s}return n.length===r.length?0:n.length<r.length?-1:1}function fA(t,e){if(Tu(t)!==Tu(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function cs(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Tu(t)>Tu(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class Oee{constructor(e,n){this.errorPrefix_=n,this.parts_=nm(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,I.ug)(this.parts_[r]);M2(this)}}function M2(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+al(t))}function al(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}class pA extends R2{constructor(){let e,n;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new pA}getInitialEvent(e){return(0,I.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const rm=1e3;let uI,ul=(()=>{class t extends S2{constructor(n,r,i,s,o,a,u,d){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=d,this.id=t.nextPersistentConnectionId_++,this.log_=Xg("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=rm,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,d&&!(0,I.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");pA.getInstance().on("visible",this.onVisible_,this),-1===n.host.indexOf("fblocal")&&oI.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){const s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_((0,I.Wl)(o)),(0,I.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();const r=new I.BH,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{const u=a.d;"ok"===a.s?r.resolve(u):r.reject(u)}};return this.outstandingGets_.push(s),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(n,r,i,s){this.initConnection_();const o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),(0,I.hu)(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,I.hu)(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");const u={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(n){const r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){const r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i};n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest("q",o,u=>{const d=u.d,f=u.s;t.warnOnListenWarnings_(d,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",u),"ok"!==f&&this.removeListen_(i,s),n.onComplete&&n.onComplete(f,d))})}static warnOnListenWarnings_(n,r){if(n&&"object"==typeof n&&(0,I.r3)(n,"w")){const i=(0,I.DV)(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Nr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&40===n.length||(0,I.GJ)(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const n=this.authToken_,r=(0,I.w9)(n)?"auth":"gauth",i={cred:n};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{const o=s.s,a=s.d||"error";this.authToken_===n&&("ok"===o?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{const r=n.s,i=n.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){const i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),(0,I.hu)(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);const o={p:n};s&&(o.q=i,o.t=s),this.sendRequest("n",o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){const o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();const a={p:r,d:i};void 0!==o&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(n){const r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){const r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+(0,I.Wl)(n));const r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),"d"===n?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===n?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===n?this.onListenRevoked_(r.p,r.q):"ac"===n?this.onAuthRevoked_(r.s,r.d):"apc"===n?this.onAppCheckRevoked_(r.s,r.d):"sd"===n?this.onSecurityDebugPacket_(r):rA("Unrecognized action received from server: "+(0,I.Wl)(n)+"\nAre you using the latest client?")}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){(0,I.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=rm,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=rm,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=rm),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const n=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var n=this;return(0,$.Z)(function*(){if(n.shouldReconnect_()){n.log_("Making a connection attempt"),n.lastConnectionAttemptTime_=(new Date).getTime(),n.lastConnectionEstablishedTime_=null;const r=n.onDataMessage_.bind(n),i=n.onReady_.bind(n),s=n.onRealtimeDisconnect_.bind(n),o=n.id+":"+t.nextConnectionId_++,a=n.lastSessionId;let u=!1,d=null;const f=function(){d?d.close():(u=!0,s())};n.realtime_={close:f,sendRequest:function(y){(0,I.hu)(d,"sendRequest call when we're not connected not allowed."),d.sendRequest(y)}};const m=n.forceTokenRefresh_;n.forceTokenRefresh_=!1;try{const[y,E]=yield Promise.all([n.authTokenProvider_.getToken(m),n.appCheckTokenProvider_.getToken(m)]);u?rr("getToken() completed but was canceled"):(rr("getToken() completed. Creating connection."),n.authToken_=y&&y.accessToken,n.appCheckToken_=E&&E.token,d=new A2(o,n.repoInfo_,n.applicationId_,n.appCheckToken_,n.authToken_,r,i,s,C=>{Nr(C+" ("+n.repoInfo_.toString()+")"),n.interrupt("server_kill")},a))}catch(y){n.log_("Failed to get token: "+y),u||(n.repoInfo_.nodeAdmin&&Nr(y),f())}}})()}interrupt(n){rr("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){rr("Resuming connection for reason: "+n),delete this.interruptReasons_[n],(0,I.xb)(this.interruptReasons_)&&(this.reconnectDelay_=rm,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){const r=n-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){const r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;i=r?r.map(o=>iA(o)).join("$"):"default";const s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){const i=new It(n).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(r),o.delete(r),0===o.size&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){rr("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===n||"permission_denied"===n)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){rr("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===n||"permission_denied"===n)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const n of this.listens.values())for(const r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){const n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){const n={};let r="js";(0,I.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),n["sdk."+r+"."+eA.replace(/\./g,"-")]=1,(0,I.uI)()?n["framework.cordova"]=1:(0,I.b$)()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){const n=oI.getInstance().currentlyOnline();return(0,I.xb)(this.interruptReasons_)&&n}}return t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t})();class Qe{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new Qe(e,n)}}class aI{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new Qe(Iu,e),i=new Qe(Iu,n);return 0!==this.compare(r,i)}minPost(){return Qe.MIN}}class F2 extends aI{static get __EMPTY_NODE(){return uI}static set __EMPTY_NODE(e){uI=e}compare(e,n){return ol(e.name,n.name)}isDefinedOn(e){throw(0,I.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return Qe.MIN}maxPost(){return new Qe(ya,uI)}makePost(e,n){return(0,I.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new Qe(e,uI)}toString(){return".key"}}const _o=new F2;class cI{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,i&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let n,e=this.nodeStack_.pop();if(n=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let mA,Fs=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Ei.EMPTY_NODE,this.right=o??Ei.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this;const o=i(n,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(n,r,i),null):0===o?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ei.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(n,i.key)){if(i.right.isEmpty())return Ei.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){const n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){const n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){const n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){const n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})();class Ei{constructor(e,n=Ei.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Ei(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Fs.BLACK,null,null))}remove(e){return new Ei(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Fs.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),0===n)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),0===n){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}n<0?r=r.left:n>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new cI(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new cI(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new cI(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new cI(this.root_,null,this.comparator_,!0,e)}}function Hee(t,e){return ol(t.name,e.name)}function gA(t,e){return ol(t,e)}Ei.EMPTY_NODE=new class $ee{copy(e,n,r,i,s){return this}insert(e,n,r){return new Fs(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const V2=function(t){return"number"==typeof t?"number:"+n2(t):"string:"+t},L2=function(t){if(t.isLeafNode()){const e=t.val();(0,I.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,I.r3)(e,".sv"),"Priority must be a string or number.")}else(0,I.hu)(t===mA||t.isEmpty(),"priority of unexpected type.");(0,I.hu)(t===mA||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let U2,B2,j2,Bh=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,(0,I.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),L2(this.priorityNode_)}static set __childrenNodeConstructor(n){U2=n}static get __childrenNodeConstructor(){return U2}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return".priority"===n?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return ze(n)?this:".priority"===qe(n)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return".priority"===n?this.updatePriority(r):r.isEmpty()&&".priority"!==n?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){const i=qe(n);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,I.hu)(".priority"!==i||1===Tu(n),".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ft(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+V2(this.priorityNode_.val())+":");const r=typeof this.value_;n+=r+":",n+="number"===r?n2(this.value_):this.value_,this.lazyHash_=XL(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:((0,I.hu)(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){const r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return(0,I.hu)(s>=0,"Unknown leaf type: "+r),(0,I.hu)(o>=0,"Unknown leaf type: "+i),s===o?"object"===i?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){return n===this||!!n.isLeafNode()&&(this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_))}}return t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t})();const Ht=new class Wee extends aI{compare(e,n){const r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return 0===s?ol(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return Qe.MIN}maxPost(){return new Qe(ya,new Bh("[PRIORITY-POST]",j2))}makePost(e,n){const r=B2(e);return new Qe(n,new Bh("[PRIORITY-POST]",r))}toString(){return".priority"}},Kee=Math.log(2);class Zee{constructor(e){this.count=parseInt(Math.log(e+1)/Kee,10),this.current_=this.count-1;const i=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const lI=function(t,e,n,r){t.sort(e);const i=function(u,d){const f=d-u;let g,m;if(0===f)return null;if(1===f)return g=t[u],m=n?n(g):g,new Fs(m,g.node,Fs.BLACK,null,null);{const y=parseInt(f/2,10)+u,E=i(u,y),C=i(y+1,d);return g=t[y],m=n?n(g):g,new Fs(m,g.node,Fs.BLACK,E,C)}},a=function(u){let d=null,f=null,g=t.length;const m=function(E,C){const D=g-E,O=g;g-=E;const R=i(D+1,O),k=t[D],G=n?n(k):k;y(new Fs(G,k.node,C,null,R))},y=function(E){d?(d.left=E,d=E):(f=E,d=E)};for(let E=0;E<u.count;++E){const C=u.nextBitIsOne(),D=Math.pow(2,u.count-(E+1));C?m(D,Fs.BLACK):(m(D,Fs.BLACK),m(D,Fs.RED))}return f}(new Zee(t.length));return new Ei(r||e,a)};let _A;const jh={};class va{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return(0,I.hu)(jh&&Ht,"ChildrenNode.ts has not been loaded"),_A=_A||new va({".priority":jh},{".priority":Ht}),_A}get(e){const n=(0,I.DV)(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Ei?n:null}hasIndex(e){return(0,I.r3)(this.indexSet_,e.toString())}addIndex(e,n){(0,I.hu)(e!==_o,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=n.getIterator(Qe.Wrap);let a,o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();a=i?lI(r,e.getCompare()):jh;const u=e.toString(),d=Object.assign({},this.indexSet_);d[u]=e;const f=Object.assign({},this.indexes_);return f[u]=a,new va(f,d)}addToIndexes(e,n){const r=(0,I.UI)(this.indexes_,(i,s)=>{const o=(0,I.DV)(this.indexSet_,s);if((0,I.hu)(o,"Missing index implementation for "+s),i===jh){if(o.isDefinedOn(e.node)){const a=[],u=n.getIterator(Qe.Wrap);let d=u.getNext();for(;d;)d.name!==e.name&&a.push(d),d=u.getNext();return a.push(e),lI(a,o.getCompare())}return jh}{const a=n.get(e.name);let u=i;return a&&(u=u.remove(new Qe(e.name,a))),u.insert(e,e.node)}});return new va(r,this.indexSet_)}removeFromIndexes(e,n){const r=(0,I.UI)(this.indexes_,i=>{if(i===jh)return i;{const s=n.get(e.name);return s?i.remove(new Qe(e.name,s)):i}});return new va(r,this.indexSet_)}}let im,Fe=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&L2(this.priorityNode_),this.children_.isEmpty()&&(0,I.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return im||(im=new t(new Ei(gA),null,va.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||im}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(".priority"===n)return this.getPriority();{const r=this.children_.get(n);return null===r?im:r}}getChild(n){const r=qe(n);return null===r?this:this.getImmediateChild(r).getChild(Ft(n))}hasChild(n){return null!==this.children_.get(n)}updateImmediateChild(n,r){if((0,I.hu)(r,"We should always be passing snapshot nodes"),".priority"===n)return this.updatePriority(r);{const i=new Qe(n,r);let s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));const a=s.isEmpty()?im:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){const i=qe(n);if(null===i)return r;{(0,I.hu)(".priority"!==qe(n)||1===Tu(n),".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(Ft(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;const r={};let i=0,s=0,o=!0;if(this.forEachChild(Ht,(a,u)=>{r[a]=u.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){const a=[];for(const u in r)a[u]=r[u];return a}return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let n="";this.getPriority().isEmpty()||(n+="priority:"+V2(this.getPriority().val())+":"),this.forEachChild(Ht,(r,i)=>{const s=i.hash();""!==s&&(n+=":"+r+":"+s)}),this.lazyHash_=""===n?"":XL(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new Qe(n,r));return o?o.name:null}return this.children_.getPredecessorKey(n)}getFirstChildName(n){const r=this.resolveIndex_(n);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(n){const r=this.getFirstChildName(n);return r?new Qe(r,this.children_.get(r)):null}getLastChildName(n){const r=this.resolveIndex_(n);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(n){const r=this.getLastChildName(n);return r?new Qe(r,this.children_.get(r)):null}forEachChild(n,r){const i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{const s=this.children_.getIteratorFrom(n.name,Qe.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{const s=this.children_.getReverseIteratorFrom(n.name,Qe.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===sm?-1:0}withIndex(n){if(n===_o||this.indexMap_.hasIndex(n))return this;{const r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===_o||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{const r=n;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(Ht),s=r.getIterator(Ht);let o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return null===o&&null===a}return!1}return!1}}resolveIndex_(n){return n===_o?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})();const sm=new class Qee extends Fe{constructor(){super(new Ei(gA),Fe.EMPTY_NODE,va.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Fe.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Qe,{MIN:{value:new Qe(Iu,Fe.EMPTY_NODE)},MAX:{value:new Qe(ya,sm)}}),F2.__EMPTY_NODE=Fe.EMPTY_NODE,Bh.__childrenNodeConstructor=Fe,function Gee(t){mA=t}(sm),function zee(t){j2=t}(sm);const Yee=!0;function pn(t,e=null){if(null===t)return Fe.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),(0,I.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new Bh(t,pn(e));if(t instanceof Array||!Yee){let n=Fe.EMPTY_NODE;return ir(t,(r,i)=>{if((0,I.r3)(t,r)&&"."!==r.substring(0,1)){const s=pn(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(pn(e))}{const n=[];let r=!1;if(ir(t,(o,a)=>{if("."!==o.substring(0,1)){const u=pn(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new Qe(o,u)))}}),0===n.length)return Fe.EMPTY_NODE;const s=lI(n,Hee,o=>o.name,gA);if(r){const o=lI(n,Ht.getCompare());return new Fe(s,pn(e),new va({".priority":o},{".priority":Ht}))}return new Fe(s,pn(e),va.Default)}}!function qee(t){B2=t}(pn);class yA extends aI{constructor(e){super(),this.indexPath_=e,(0,I.hu)(!ze(e)&&".priority"!==qe(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return 0===s?ol(e.name,n.name):s}makePost(e,n){const r=pn(e),i=Fe.EMPTY_NODE.updateChild(this.indexPath_,r);return new Qe(n,i)}maxPost(){const e=Fe.EMPTY_NODE.updateChild(this.indexPath_,sm);return new Qe(ya,e)}toString(){return nm(this.indexPath_,0).join("/")}}const vA=new class Xee extends aI{compare(e,n){const r=e.node.compareTo(n.node);return 0===r?ol(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return Qe.MIN}maxPost(){return Qe.MAX}makePost(e,n){const r=pn(e);return new Qe(n,r)}toString(){return".value"}};function $2(t){return{type:"value",snapshotNode:t}}function $h(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function om(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function am(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}class EA{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){(0,I.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(null!=o&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(om(n,a)):(0,I.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange($h(n,r)):o.trackChildChange(am(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return null!=r&&(e.isLeafNode()||e.forEachChild(Ht,(i,s)=>{n.hasChild(i)||r.trackChildChange(om(i,s))}),n.isLeafNode()||n.forEachChild(Ht,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(am(i,s,o))}else r.trackChildChange($h(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?Fe.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class um{constructor(e){this.indexedFilter_=new EA(e.getIndex()),this.index_=e.getIndex(),this.startPost_=um.getStartPost_(e),this.endPost_=um.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new Qe(n,r))||(r=Fe.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=Fe.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(Fe.EMPTY_NODE);const s=this;return n.forEachChild(Ht,(o,a)=>{s.matches(new Qe(o,a))||(i=i.updateImmediateChild(o,Fe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}return e.getIndex().maxPost()}}class ete{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new um(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new Qe(n,r))||(r=Fe.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=Fe.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<n.numChildren()&&n.isIndexed(this.index_)){let s;i=Fe.EMPTY_NODE.withIndex(this.index_),s=this.reverse_?n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a)){if(!this.withinDirectionalEnd(a))break;i=i.updateImmediateChild(a.name,a.node),o++}}}else{let s;i=n.withIndex(this.index_),i=i.updatePriority(Fe.EMPTY_NODE),s=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,Fe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){const g=this.index_.getCompare();o=(m,y)=>g(y,m)}else o=this.index_.getCompare();const a=e;(0,I.hu)(a.numChildren()===this.limit_,"");const u=new Qe(n,r),d=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),f=this.rangedFilter_.matches(u);if(a.hasChild(n)){const g=a.getImmediateChild(n);let m=i.getChildAfterChild(this.index_,d,this.reverse_);for(;null!=m&&(m.name===n||a.hasChild(m.name));)m=i.getChildAfterChild(this.index_,m,this.reverse_);const y=null==m?1:o(m,u);if(f&&!r.isEmpty()&&y>=0)return s?.trackChildChange(am(n,r,g)),a.updateImmediateChild(n,r);{s?.trackChildChange(om(n,g));const C=a.updateImmediateChild(n,Fe.EMPTY_NODE);return null!=m&&this.rangedFilter_.matches(m)?(s?.trackChildChange($h(m.name,m.node)),C.updateImmediateChild(m.name,m.node)):C}}return r.isEmpty()?e:f&&o(d,u)>=0?(null!=s&&(s.trackChildChange(om(d.name,d.node)),s.trackChildChange($h(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(d.name,Fe.EMPTY_NODE)):e}}class dI{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ht}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,I.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,I.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Iu}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,I.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,I.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ya}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,I.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ht}copy(){const e=new dI;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function IA(t,e,n){const r=t.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function wA(t,e,n){const r=t.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function hI(t,e){const n=t.copy();return n.index_=e,n}function H2(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Ht?n="$priority":t.index_===vA?n="$value":t.index_===_o?n="$key":((0,I.hu)(t.index_ instanceof yA,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=(0,I.Wl)(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=(0,I.Wl)(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+(0,I.Wl)(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=(0,I.Wl)(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+(0,I.Wl)(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function G2(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==Ht&&(e.i=t.index_.toString()),e}class fI extends S2{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Xg("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return void 0!==n?"tag$"+n:((0,I.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=fI.getListenId_(e,r),a={};this.listens_[o]=a;const u=H2(e._queryParams);this.restRequest_(s+".json",u,(d,f)=>{let g=f;if(404===d&&(g=null,d=null),null===d&&this.onDataUpdate_(s,g,!1,r),(0,I.DV)(this.listens_,o)===a){let m;m=d?401===d?"permission_denied":"rest_error:"+d:"ok",i(m,null)}})}unlisten(e,n){const r=fI.getListenId_(e,n);delete this.listens_[r]}get(e){const n=H2(e._queryParams),r=e._path.toString(),i=new I.BH;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;404===s&&(a=null,s=null),null===s?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,I.xO)(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=(0,I.cI)(a.responseText)}catch{Nr("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else 401!==a.status&&404!==a.status&&Nr("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}class ote{constructor(){this.rootNode_=Fe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}function pI(){return{value:null,children:new Map}}function Hh(t,e,n){if(ze(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{const r=qe(e);t.children.has(r)||t.children.set(r,pI()),Hh(t.children.get(r),e=Ft(e),n)}}function TA(t,e){if(ze(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(Ht,(r,i)=>{Hh(t,new It(r),i)}),TA(t,e)}}if(t.children.size>0){const n=qe(e);return e=Ft(e),t.children.has(n)&&TA(t.children.get(n),e)&&t.children.delete(n),0===t.children.size}return!0}function CA(t,e,n){null!==t.value?n(e,t.value):function ate(t,e){t.children.forEach((n,r)=>{e(r,n)})}(t,(r,i)=>{CA(i,new It(e.toString()+"/"+r),n)})}class ute{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&ir(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}}class dte{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new ute(e);const r=1e4+2e4*Math.random();em(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;ir(e,(i,s)=>{s>0&&(0,I.r3)(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),em(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var yo=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(yo||{});function AA(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}class gI{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=yo.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(ze(this.path)){if(null!=this.affectedTree.value)return(0,I.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new It(e));return new gI(pt(),n,this.revert)}}return(0,I.hu)(qe(this.path)===e,"operationForChild called for unrelated child."),new gI(Ft(this.path),this.affectedTree,this.revert)}}class cm{constructor(e,n){this.source=e,this.path=n,this.type=yo.LISTEN_COMPLETE}operationForChild(e){return ze(this.path)?new cm(this.source,pt()):new cm(this.source,Ft(this.path))}}class cl{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=yo.OVERWRITE}operationForChild(e){return ze(this.path)?new cl(this.source,pt(),this.snap.getImmediateChild(e)):new cl(this.source,Ft(this.path),this.snap)}}class Gh{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=yo.MERGE}operationForChild(e){if(ze(this.path)){const n=this.children.subtree(new It(e));return n.isEmpty()?null:n.value?new cl(this.source,pt(),n.value):new Gh(this.source,pt(),n)}return(0,I.hu)(qe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Gh(this.source,Ft(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Cu{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ze(e))return this.isFullyInitialized()&&!this.filtered_;const n=qe(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class hte{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function lm(t,e,n,r,i,s){const o=r.filter(a=>a.type===n);o.sort((a,u)=>function gte(t,e,n){if(null==e.childName||null==n.childName)throw(0,I.g5)("Should only compare child_ events.");const r=new Qe(e.childName,e.snapshotNode),i=new Qe(n.childName,n.snapshotNode);return t.index_.compare(r,i)}(t,a,u)),o.forEach(a=>{const u=function pte(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,a,s);i.forEach(d=>{d.respondsTo(a.type)&&e.push(d.createEvent(u,t.query_))})})}function mI(t,e){return{eventCache:t,serverCache:e}}function dm(t,e,n,r){return mI(new Cu(e,n,r),t.serverCache)}function z2(t,e,n,r){return mI(t.eventCache,new Cu(e,n,r))}function _I(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function ll(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let SA;class Gt{constructor(e,n=(()=>(SA||(SA=new Ei(JJ)),SA))()){this.value=e,this.children=n}static fromObject(e){let n=new Gt(null);return ir(e,(r,i)=>{n=n.set(new It(r),i)}),n}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(null!=this.value&&n(this.value))return{path:pt(),value:this.value};if(ze(e))return null;{const r=qe(e),i=this.children.get(r);if(null!==i){const s=i.findRootMostMatchingPathAndValue(Ft(e),n);return null!=s?{path:on(new It(r),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ze(e))return this;{const n=qe(e),r=this.children.get(n);return null!==r?r.subtree(Ft(e)):new Gt(null)}}set(e,n){if(ze(e))return new Gt(n,this.children);{const r=qe(e),s=(this.children.get(r)||new Gt(null)).set(Ft(e),n),o=this.children.insert(r,s);return new Gt(this.value,o)}}remove(e){if(ze(e))return this.children.isEmpty()?new Gt(null):new Gt(null,this.children);{const n=qe(e),r=this.children.get(n);if(r){const i=r.remove(Ft(e));let s;return s=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&s.isEmpty()?new Gt(null):new Gt(this.value,s)}return this}}get(e){if(ze(e))return this.value;{const n=qe(e),r=this.children.get(n);return r?r.get(Ft(e)):null}}setTree(e,n){if(ze(e))return n;{const r=qe(e),s=(this.children.get(r)||new Gt(null)).setTree(Ft(e),n);let o;return o=s.isEmpty()?this.children.remove(r):this.children.insert(r,s),new Gt(this.value,o)}}fold(e){return this.fold_(pt(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(on(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,pt(),n)}findOnPath_(e,n,r){const i=!!this.value&&r(n,this.value);if(i)return i;if(ze(e))return null;{const s=qe(e),o=this.children.get(s);return o?o.findOnPath_(Ft(e),on(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,pt(),n)}foreachOnPath_(e,n,r){if(ze(e))return this;{this.value&&r(n,this.value);const i=qe(e),s=this.children.get(i);return s?s.foreachOnPath_(Ft(e),on(n,i),r):new Gt(null)}}foreach(e){this.foreach_(pt(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(on(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}class Vs{constructor(e){this.writeTree_=e}static empty(){return new Vs(new Gt(null))}}function hm(t,e,n){if(ze(e))return new Vs(new Gt(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let s=r.value;const o=Qr(i,e);return s=s.updateChild(o,n),new Vs(t.writeTree_.set(i,s))}{const i=new Gt(n),s=t.writeTree_.setTree(e,i);return new Vs(s)}}}function RA(t,e,n){let r=t;return ir(n,(i,s)=>{r=hm(r,on(e,i),s)}),r}function W2(t,e){if(ze(e))return Vs.empty();{const n=t.writeTree_.setTree(e,new Gt(null));return new Vs(n)}}function PA(t,e){return null!=dl(t,e)}function dl(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(Qr(n.path,e)):null}function K2(t){const e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Ht,(r,i)=>{e.push(new Qe(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new Qe(r,i.value))}),e}function bu(t,e){if(ze(e))return t;{const n=dl(t,e);return new Vs(null!=n?new Gt(n):t.writeTree_.subtree(e))}}function NA(t){return t.writeTree_.isEmpty()}function qh(t,e){return Z2(pt(),t.writeTree_,e)}function Z2(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{".priority"===i?((0,I.hu)(null!==s.value,"Priority writes must always be leaf nodes"),r=s.value):n=Z2(on(t,i),s,n)}),!n.getChild(t).isEmpty()&&null!==r&&(n=n.updateChild(on(t,".priority"),r)),n}}function yI(t,e){return eU(e,t)}function Ite(t,e){if(t.snap)return cs(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&cs(on(t.path,n),e))return!0;return!1}function Tte(t){return t.visible}function Q2(t,e,n){let r=Vs.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const o=s.path;let a;if(s.snap)cs(n,o)?(a=Qr(n,o),r=hm(r,a,s.snap)):cs(o,n)&&(a=Qr(o,n),r=hm(r,pt(),s.snap.getChild(a)));else{if(!s.children)throw(0,I.g5)("WriteRecord should have .snap or .children");if(cs(n,o))a=Qr(n,o),r=RA(r,a,s.children);else if(cs(o,n))if(a=Qr(o,n),ze(a))r=RA(r,pt(),s.children);else{const u=(0,I.DV)(s.children,qe(a));if(u){const d=u.getChild(Ft(a));r=hm(r,pt(),d)}}}}}return r}function Y2(t,e,n,r,i){if(r||i){const s=bu(t.visibleWrites,e);return!i&&NA(s)?n:i||null!=n||PA(s,pt())?qh(Q2(t.allWrites,function(d){return(d.visible||i)&&(!r||!~r.indexOf(d.writeId))&&(cs(d.path,e)||cs(e,d.path))},e),n||Fe.EMPTY_NODE):null}{const s=dl(t.visibleWrites,e);if(null!=s)return s;{const o=bu(t.visibleWrites,e);return NA(o)?n:null!=n||PA(o,pt())?qh(o,n||Fe.EMPTY_NODE):null}}}function vI(t,e,n,r){return Y2(t.writeTree,t.treePath,e,n,r)}function xA(t,e){return function Cte(t,e,n){let r=Fe.EMPTY_NODE;const i=dl(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ht,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){const s=bu(t.visibleWrites,e);return n.forEachChild(Ht,(o,a)=>{const u=qh(bu(s,new It(o)),a);r=r.updateImmediateChild(o,u)}),K2(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}return K2(bu(t.visibleWrites,e)).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}(t.writeTree,t.treePath,e)}function X2(t,e,n,r){return function bte(t,e,n,r,i){(0,I.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=on(e,n);if(PA(t.visibleWrites,s))return null;{const o=bu(t.visibleWrites,s);return NA(o)?i.getChild(n):qh(o,i.getChild(n))}}(t.writeTree,t.treePath,e,n,r)}function EI(t,e){return function Ate(t,e){return dl(t.visibleWrites,e)}(t.writeTree,on(t.treePath,e))}function MA(t,e,n){return function Dte(t,e,n,r){const i=on(e,n),s=dl(t.visibleWrites,i);return null!=s?s:r.isCompleteForChild(n)?qh(bu(t.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function J2(t,e){return eU(on(t.treePath,e),t.writeTree)}function eU(t,e){return{treePath:t,writeTree:e}}class Nte{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;(0,I.hu)("child_added"===n||"child_changed"===n||"child_removed"===n,"Only child changes supported for tracking"),(0,I.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if("child_added"===n&&"child_removed"===s)this.changeMap.set(r,am(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===n&&"child_added"===s)this.changeMap.delete(r);else if("child_removed"===n&&"child_changed"===s)this.changeMap.set(r,om(r,i.oldSnap));else if("child_changed"===n&&"child_added"===s)this.changeMap.set(r,$h(r,e.snapshotNode));else{if("child_changed"!==n||"child_changed"!==s)throw(0,I.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,am(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const tU=new class xte{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}};class kA{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new Cu(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return MA(this.writes_,e,r)}}getChildAfterChild(e,n,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:ll(this.viewCache_),s=function Pte(t,e,n,r,i,s){return function Ste(t,e,n,r,i,s,o){let a;const u=bu(t.visibleWrites,e),d=dl(u,pt());if(null!=d)a=d;else{if(null==n)return[];a=qh(u,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const f=[],g=o.getCompare(),m=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let y=m.getNext();for(;y&&f.length<i;)0!==g(y,r)&&f.push(y),y=m.getNext();return f}}(t.writeTree,t.treePath,e,n,r,i,s)}(this.writes_,i,n,1,r,e);return 0===s.length?null:s[0]}}function nU(t,e,n,r,i,s){const o=e.eventCache;if(null!=EI(r,n))return e;{let a,u;if(ze(n))if((0,I.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=ll(e),g=xA(r,d instanceof Fe?d:Fe.EMPTY_NODE);a=t.filter.updateFullNode(e.eventCache.getNode(),g,s)}else{const d=vI(r,ll(e));a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{const d=qe(n);if(".priority"===d){(0,I.hu)(1===Tu(n),"Can't have a priority with additional path components");const f=o.getNode();u=e.serverCache.getNode();const g=X2(r,n,f,u);a=null!=g?t.filter.updatePriority(f,g):o.getNode()}else{const f=Ft(n);let g;if(o.isCompleteForChild(d)){u=e.serverCache.getNode();const m=X2(r,n,o.getNode(),u);g=null!=m?o.getNode().getImmediateChild(d).updateChild(f,m):o.getNode().getImmediateChild(d)}else g=MA(r,d,e.serverCache);a=null!=g?t.filter.updateChild(o.getNode(),d,g,f,i,s):o.getNode()}}return dm(e,a,o.isFullyInitialized()||ze(n),t.filter.filtersNodes())}}function II(t,e,n,r,i,s,o,a){const u=e.serverCache;let d;const f=o?t.filter:t.filter.getIndexedFilter();if(ze(n))d=f.updateFullNode(u.getNode(),r,null);else if(f.filtersNodes()&&!u.isFiltered()){const y=u.getNode().updateChild(n,r);d=f.updateFullNode(u.getNode(),y,null)}else{const y=qe(n);if(!u.isCompleteForPath(n)&&Tu(n)>1)return e;const E=Ft(n),D=u.getNode().getImmediateChild(y).updateChild(E,r);d=".priority"===y?f.updatePriority(u.getNode(),D):f.updateChild(u.getNode(),y,D,E,tU,null)}const g=z2(e,d,u.isFullyInitialized()||ze(n),f.filtersNodes());return nU(t,g,n,i,new kA(i,g,s),a)}function OA(t,e,n,r,i,s,o){const a=e.eventCache;let u,d;const f=new kA(i,e,s);if(ze(n))d=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=dm(e,d,!0,t.filter.filtersNodes());else{const g=qe(n);if(".priority"===g)d=t.filter.updatePriority(e.eventCache.getNode(),r),u=dm(e,d,a.isFullyInitialized(),a.isFiltered());else{const m=Ft(n),y=a.getNode().getImmediateChild(g);let E;if(ze(m))E=r;else{const C=f.getCompleteChild(g);E=null!=C?".priority"===hA(m)&&C.getChild(x2(m)).isEmpty()?C:C.updateChild(m,r):Fe.EMPTY_NODE}u=y.equals(E)?e:dm(e,t.filter.updateChild(a.getNode(),g,E,m,f,o),a.isFullyInitialized(),t.filter.filtersNodes())}}return u}function rU(t,e){return t.eventCache.isCompleteForChild(e)}function iU(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function FA(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let d,u=e;d=ze(n)?r:new Gt(null).setTree(n,r);const f=e.serverCache.getNode();return d.children.inorderTraversal((g,m)=>{if(f.hasChild(g)){const E=iU(0,e.serverCache.getNode().getImmediateChild(g),m);u=II(t,u,new It(g),E,i,s,o,a)}}),d.children.inorderTraversal((g,m)=>{const y=!e.serverCache.isCompleteForChild(g)&&null===m.value;if(!f.hasChild(g)&&!y){const C=iU(0,e.serverCache.getNode().getImmediateChild(g),m);u=II(t,u,new It(g),C,i,s,o,a)}}),u}class jte{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new EA(r.getIndex()),s=function tte(t){return t.loadsAllData()?new EA(t.getIndex()):t.hasLimit()?new ete(t):new um(t)}(r);this.processor_=function Mte(t){return{filter:t}}(s);const o=n.serverCache,a=n.eventCache,u=i.updateFullNode(Fe.EMPTY_NODE,o.getNode(),null),d=s.updateFullNode(Fe.EMPTY_NODE,a.getNode(),null),f=new Cu(u,o.isFullyInitialized(),i.filtersNodes()),g=new Cu(d,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=mI(g,f),this.eventGenerator_=new hte(this.query_)}get query(){return this.query_}}function Gte(t,e){const n=ll(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ze(e)&&!n.getImmediateChild(qe(e)).isEmpty())?n.getChild(e):null}function sU(t){return 0===t.eventRegistrations_.length}function oU(t,e,n){const r=[];if(n){(0,I.hu)(null==e,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){const o=t.eventRegistrations_[s];if(o.matches(e)){if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}else i.push(o)}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function aU(t,e,n,r){e.type===yo.MERGE&&null!==e.source.queryId&&((0,I.hu)(ll(t.viewCache_),"We should always have a full cache before handling merges"),(0,I.hu)(_I(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=function Ote(t,e,n,r,i){const s=new Nte;let o,a;if(n.type===yo.OVERWRITE){const d=n;d.source.fromUser?o=OA(t,e,d.path,d.snap,r,i,s):((0,I.hu)(d.source.fromServer,"Unknown source."),a=d.source.tagged||e.serverCache.isFiltered()&&!ze(d.path),o=II(t,e,d.path,d.snap,r,i,a,s))}else if(n.type===yo.MERGE){const d=n;d.source.fromUser?o=function Vte(t,e,n,r,i,s,o){let a=e;return r.foreach((u,d)=>{const f=on(n,u);rU(e,qe(f))&&(a=OA(t,a,f,d,i,s,o))}),r.foreach((u,d)=>{const f=on(n,u);rU(e,qe(f))||(a=OA(t,a,f,d,i,s,o))}),a}(t,e,d.path,d.children,r,i,s):((0,I.hu)(d.source.fromServer,"Unknown source."),a=d.source.tagged||e.serverCache.isFiltered(),o=FA(t,e,d.path,d.children,r,i,a,s))}else if(n.type===yo.ACK_USER_WRITE){const d=n;o=d.revert?function Bte(t,e,n,r,i,s){let o;if(null!=EI(r,n))return e;{const a=new kA(r,e,i),u=e.eventCache.getNode();let d;if(ze(n)||".priority"===qe(n)){let f;if(e.serverCache.isFullyInitialized())f=vI(r,ll(e));else{const g=e.serverCache.getNode();(0,I.hu)(g instanceof Fe,"serverChildren would be complete if leaf node"),f=xA(r,g)}d=t.filter.updateFullNode(u,f,s)}else{const f=qe(n);let g=MA(r,f,e.serverCache);null==g&&e.serverCache.isCompleteForChild(f)&&(g=u.getImmediateChild(f)),d=null!=g?t.filter.updateChild(u,f,g,Ft(n),a,s):e.eventCache.getNode().hasChild(f)?t.filter.updateChild(u,f,Fe.EMPTY_NODE,Ft(n),a,s):u,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=vI(r,ll(e)),o.isLeafNode()&&(d=t.filter.updateFullNode(d,o,s)))}return o=e.serverCache.isFullyInitialized()||null!=EI(r,pt()),dm(e,d,o,t.filter.filtersNodes())}}(t,e,d.path,r,i,s):function Lte(t,e,n,r,i,s,o){if(null!=EI(i,n))return e;const a=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(ze(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return II(t,e,n,u.getNode().getChild(n),i,s,a,o);if(ze(n)){let d=new Gt(null);return u.getNode().forEachChild(_o,(f,g)=>{d=d.set(new It(f),g)}),FA(t,e,n,d,i,s,a,o)}return e}{let d=new Gt(null);return r.foreach((f,g)=>{const m=on(n,f);u.isCompleteForPath(m)&&(d=d.set(f,u.getNode().getChild(m)))}),FA(t,e,n,d,i,s,a,o)}}(t,e,d.path,d.affectedTree,r,i,s)}else{if(n.type!==yo.LISTEN_COMPLETE)throw(0,I.g5)("Unknown operation type: "+n.type);o=function Ute(t,e,n,r,i){const s=e.serverCache;return nU(t,z2(e,s.getNode(),s.isFullyInitialized()||ze(n),s.isFiltered()),n,r,tU,i)}(t,e,n.path,r,s)}const u=s.getChanges();return function Fte(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=_I(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push($2(_I(e)))}}(e,o,u),{viewCache:o,changes:u}}(t.processor_,i,e,n,r);return function kte(t,e){(0,I.hu)(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),(0,I.hu)(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}(t.processor_,s.viewCache),(0,I.hu)(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,uU(t,s.changes,s.viewCache.eventCache.getNode(),null)}function uU(t,e,n,r){return function fte(t,e,n,r){const i=[],s=[];return e.forEach(o=>{"child_changed"===o.type&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(function Jee(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}(o.childName,o.snapshotNode))}),lm(t,i,"child_removed",e,r,n),lm(t,i,"child_added",e,r,n),lm(t,i,"child_moved",s,r,n),lm(t,i,"child_changed",e,r,n),lm(t,i,"value",e,r,n),i}(t.eventGenerator_,e,n,r?[r]:t.eventRegistrations_)}let wI,CI;class cU{constructor(){this.views=new Map}}function VA(t,e,n,r){const i=e.source.queryId;if(null!==i){const s=t.views.get(i);return(0,I.hu)(null!=s,"SyncTree gave us an op for an invalid query."),aU(s,e,n,r)}{let s=[];for(const o of t.views.values())s=s.concat(aU(o,e,n,r));return s}}function lU(t,e,n,r,i){const o=t.views.get(e._queryIdentifier);if(!o){let a=vI(n,i?r:null),u=!1;a?u=!0:r instanceof Fe?(a=xA(n,r),u=!1):(a=Fe.EMPTY_NODE,u=!1);const d=mI(new Cu(a,u,!1),new Cu(r,i,!1));return new jte(e,d)}return o}function dU(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Du(t,e){let n=null;for(const r of t.views.values())n=n||Gte(r,e);return n}function hU(t,e){return e._queryParams.loadsAllData()?TI(t):t.views.get(e._queryIdentifier)}function fU(t,e){return null!=hU(t,e)}function Au(t){return null!=TI(t)}function TI(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let ene=1;class pU{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Gt(null),this.pendingWriteTree_=function Rte(){return{visibleWrites:Vs.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function LA(t,e,n,r,i){return function _te(t,e,n,r,i){(0,I.hu)(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=hm(t.visibleWrites,e,n)),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r,i),i?zh(t,new cl({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function Su(t,e,n=!1){const r=function vte(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(function Ete(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);(0,I.hu)(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&Ite(a,r.path)?i=!1:cs(r.path,a.path)&&(s=!0)),o--}return!!i&&(s?(function wte(t){t.visibleWrites=Q2(t.allWrites,Tte,pt()),t.lastWriteId=t.allWrites.length>0?t.allWrites[t.allWrites.length-1].writeId:-1}(t),!0):(r.snap?t.visibleWrites=W2(t.visibleWrites,r.path):ir(r.children,u=>{t.visibleWrites=W2(t.visibleWrites,on(r.path,u))}),!0))}(t.pendingWriteTree_,e)){let s=new Gt(null);return null!=r.snap?s=s.set(pt(),!0):ir(r.children,o=>{s=s.set(new It(o),!0)}),zh(t,new gI(r.path,s,n))}return[]}function fm(t,e,n){return zh(t,new cl({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function bI(t,e,n,r,i=!1){const s=e._path,o=t.syncPointTree_.get(s);let a=[];if(o&&("default"===e._queryIdentifier||fU(o,e))){const u=function Yte(t,e,n,r){const i=e._queryIdentifier,s=[];let o=[];const a=Au(t);if("default"===i)for(const[u,d]of t.views.entries())o=o.concat(oU(d,n,r)),sU(d)&&(t.views.delete(u),d.query._queryParams.loadsAllData()||s.push(d.query));else{const u=t.views.get(i);u&&(o=o.concat(oU(u,n,r)),sU(u)&&(t.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!Au(t)&&s.push(new(function Kte(){return(0,I.hu)(wI,"Reference.ts has not been loaded"),wI}())(e._repo,e._path)),{removed:s,events:o}}(o,e,n,r);(function Zte(t){return 0===t.views.size})(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const d=u.removed;if(a=u.events,!i){const f=-1!==d.findIndex(m=>m._queryParams.loadsAllData()),g=t.syncPointTree_.findOnPath(s,(m,y)=>Au(y));if(f&&!g){const m=t.syncPointTree_.subtree(s);if(!m.isEmpty()){const y=function ane(t){return t.fold((e,n,r)=>{if(n&&Au(n))return[TI(n)];{let i=[];return n&&(i=dU(n)),ir(r,(s,o)=>{i=i.concat(o)}),i}})}(m);for(let E=0;E<y.length;++E){const C=y[E],D=C.query,O=yU(t,C);t.listenProvider_.startListening(gm(D),pm(t,D),O.hashFn,O.onComplete)}}}!g&&d.length>0&&!r&&(f?t.listenProvider_.stopListening(gm(e),null):d.forEach(m=>{const y=t.queryToTagMap.get(AI(m));t.listenProvider_.stopListening(gm(m),y)}))}!function une(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const i=AI(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}(t,d)}return a}function gU(t,e,n,r){const i=BA(t,r);if(null!=i){const s=jA(i),o=s.path,a=s.queryId,u=Qr(o,e);return $A(t,o,new cl(AA(a),u,n))}return[]}function UA(t,e,n,r=!1){const i=e._path;let s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(m,y)=>{const E=Qr(m,i);s=s||Du(y,E),o=o||Au(y)});let u,a=t.syncPointTree_.get(i);a?(o=o||Au(a),s=s||Du(a,pt())):(a=new cU,t.syncPointTree_=t.syncPointTree_.set(i,a)),null!=s?u=!0:(u=!1,s=Fe.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((y,E)=>{const C=Du(E,pt());C&&(s=s.updateImmediateChild(y,C))}));const d=fU(a,e);if(!d&&!e._queryParams.loadsAllData()){const m=AI(e);(0,I.hu)(!t.queryToTagMap.has(m),"View does not exist, but we have a tag");const y=function cne(){return ene++}();t.queryToTagMap.set(m,y),t.tagToQueryMap.set(y,m)}let g=function Qte(t,e,n,r,i,s){const o=lU(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),function qte(t,e){t.eventRegistrations_.push(e)}(o,n),function zte(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ht,(s,o)=>{r.push($h(s,o))}),n.isFullyInitialized()&&r.push($2(n.getNode())),uU(t,r,n.getNode(),e)}(o,n)}(a,e,n,yI(t.pendingWriteTree_,i),s,u);if(!d&&!o&&!r){const m=hU(a,e);g=g.concat(function lne(t,e,n){const r=e._path,i=pm(t,e),s=yU(t,n),o=t.listenProvider_.startListening(gm(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)(0,I.hu)(!Au(a.value),"If we're adding a query, it shouldn't be shadowed");else{const u=a.fold((d,f,g)=>{if(!ze(d)&&f&&Au(f))return[TI(f).query];{let m=[];return f&&(m=m.concat(dU(f).map(y=>y.query))),ir(g,(y,E)=>{m=m.concat(E)}),m}});for(let d=0;d<u.length;++d){const f=u[d];t.listenProvider_.stopListening(gm(f),pm(t,f))}}return o}(t,e,m))}return g}function DI(t,e,n){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{const d=Du(a,Qr(o,e));if(d)return d});return Y2(i,e,s,n,!0)}function zh(t,e){return mU(e,t.syncPointTree_,null,yI(t.pendingWriteTree_,pt()))}function mU(t,e,n,r){if(ze(t.path))return _U(t,e,n,r);{const i=e.get(pt());null==n&&null!=i&&(n=Du(i,pt()));let s=[];const o=qe(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){const d=n?n.getImmediateChild(o):null,f=J2(r,o);s=s.concat(mU(a,u,d,f))}return i&&(s=s.concat(VA(i,t,r,n))),s}}function _U(t,e,n,r){const i=e.get(pt());null==n&&null!=i&&(n=Du(i,pt()));let s=[];return e.children.inorderTraversal((o,a)=>{const u=n?n.getImmediateChild(o):null,d=J2(r,o),f=t.operationForChild(o);f&&(s=s.concat(_U(f,a,u,d)))}),i&&(s=s.concat(VA(i,t,r,n))),s}function yU(t,e){const n=e.query,r=pm(t,n);return{hashFn:()=>(function $te(t){return t.viewCache_.serverCache.getNode()}(e)||Fe.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function ine(t,e,n){const r=BA(t,n);if(r){const i=jA(r),s=i.path,o=i.queryId,a=Qr(s,e);return $A(t,s,new cm(AA(o),a))}return[]}(t,n._path,r):function rne(t,e){return zh(t,new cm({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);{const s=function nee(t,e){let n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}(i,n);return bI(t,n,null,s)}}}}function pm(t,e){const n=AI(e);return t.queryToTagMap.get(n)}function AI(t){return t._path.toString()+"$"+t._queryIdentifier}function BA(t,e){return t.tagToQueryMap.get(e)}function jA(t){const e=t.indexOf("$");return(0,I.hu)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new It(t.substr(0,e))}}function $A(t,e,n){const r=t.syncPointTree_.get(e);return(0,I.hu)(r,"Missing sync point for query tag that we're tracking"),VA(r,n,yI(t.pendingWriteTree_,e),null)}function gm(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(function Jte(){return(0,I.hu)(CI,"Reference.ts has not been loaded"),CI}())(t._repo,t._path):t}class HA{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new HA(n)}node(){return this.node_}}class GA{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=on(this.path_,e);return new GA(this.syncTree_,n)}node(){return DI(this.syncTree_,this.path_)}}const dne=function(t){return(t=t||{}).timestamp=t.timestamp||(new Date).getTime(),t},vU=function(t,e,n){return t&&"object"==typeof t?((0,I.hu)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?hne(t[".sv"],e,n):"object"==typeof t[".sv"]?fne(t[".sv"],e):void(0,I.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},hne=function(t,e,n){if("timestamp"===t)return n.timestamp;(0,I.hu)(!1,"Unexpected server value: "+t)},fne=function(t,e,n){t.hasOwnProperty("increment")||(0,I.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;"number"!=typeof r&&(0,I.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,I.hu)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!=typeof o?r:o+r},EU=function(t,e,n,r){return zA(e,new GA(n,t),r)},qA=function(t,e,n){return zA(t,new HA(e),n)};function zA(t,e,n){const r=t.getPriority().val(),i=vU(r,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const o=t,a=vU(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Bh(a,pn(i)):t}{const o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Bh(i))),o.forEachChild(Ht,(a,u)=>{const d=zA(u,e.getImmediateChild(a),n);d!==u&&(s=s.updateImmediateChild(a,d))}),s}}class WA{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function SI(t,e){let n=e instanceof It?e:new It(e),r=t,i=qe(n);for(;null!==i;){const s=(0,I.DV)(r.node.children,i)||{children:{},childCount:0};r=new WA(i,r,s),n=Ft(n),i=qe(n)}return r}function hl(t){return t.node.value}function KA(t,e){t.node.value=e,ZA(t)}function IU(t){return t.node.childCount>0}function RI(t,e){ir(t.node.children,(n,r)=>{e(new WA(n,t,r))})}function wU(t,e,n,r){n&&!r&&e(t),RI(t,i=>{wU(i,e,!0,r)}),n&&r&&e(t)}function mm(t){return new It(null===t.parent?t.name:mm(t.parent)+"/"+t.name)}function ZA(t){null!==t.parent&&function mne(t,e,n){const r=function pne(t){return void 0===hl(t)&&!IU(t)}(n),i=(0,I.r3)(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,ZA(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,ZA(t))}(t.parent,t.name,t)}const _ne=/[\[\].#$\/\u0000-\u001F\u007F]/,yne=/[\[\].#$\u0000-\u001F\u007F]/,QA=10485760,PI=function(t){return"string"==typeof t&&0!==t.length&&!_ne.test(t)},TU=function(t){return"string"==typeof t&&0!==t.length&&!yne.test(t)},_m=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!rI(t)||t&&"object"==typeof t&&(0,I.r3)(t,".sv")},vo=function(t,e,n,r){r&&void 0===e||ym((0,I.gK)(t,"value"),e,n)},ym=function(t,e,n){const r=n instanceof It?new Oee(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+al(r));if("function"==typeof e)throw new Error(t+"contains a function "+al(r)+" with contents = "+e.toString());if(rI(e))throw new Error(t+"contains "+e.toString()+" "+al(r));if("string"==typeof e&&e.length>QA/3&&(0,I.ug)(e)>QA)throw new Error(t+"contains a string greater than "+QA+" utf8 bytes "+al(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,s=!1;if(ir(e,(o,a)=>{if(".value"===o)i=!0;else if(".priority"!==o&&".sv"!==o&&(s=!0,!PI(o)))throw new Error(t+" contains an invalid key ("+o+") "+al(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function Fee(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,I.ug)(e),M2(t)})(r,o),ym(t,a,r),function Vee(t){const e=t.parts_.pop();t.byteLength_-=(0,I.ug)(e),t.parts_.length>0&&(t.byteLength_-=1)}(r)}),i&&s)throw new Error(t+' contains ".value" child '+al(r)+" in addition to actual children.")}},CU=function(t,e,n,r){if(r&&void 0===e)return;const i=(0,I.gK)(t,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];ir(e,(o,a)=>{const u=new It(o);if(ym(i,a,on(n,u)),".priority"===hA(u)&&!_m(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const s=nm(r);for(let o=0;o<s.length;o++)if((".priority"!==s[o]||o!==s.length-1)&&!PI(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(kee);let i=null;for(n=0;n<e.length;n++){if(r=e[n],null!==i&&cs(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},YA=function(t,e,n){if(!n||void 0!==e){if(rI(e))throw new Error((0,I.gK)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!_m(e))throw new Error((0,I.gK)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},vm=function(t,e,n,r){if(!(r&&void 0===n||PI(n)))throw new Error((0,I.gK)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Em=function(t,e,n,r){if(!(r&&void 0===n||TU(n)))throw new Error((0,I.gK)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ine=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Em(t,e,n,r)},ls=function(t,e){if(".info"===qe(e))throw new Error(t+" failed = Can't modify data under /.info/")},bU=function(t,e){const n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!PI(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),TU(t)}(n))throw new Error((0,I.gK)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class wne{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function NI(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();null!==n&&!fA(s,n.path)&&(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function DU(t,e,n){NI(t,n),AU(t,r=>fA(r,e))}function Vi(t,e,n){NI(t,n),AU(t,r=>cs(r,e)||cs(e,r))}function AU(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];i&&(e(i.path)?(Tne(t.eventLists_[r]),t.eventLists_[r]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}function Tne(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(null!==n){t.events[e]=null;const r=n.getEventRunner();sl&&rr("event: "+n.toString()),Lh(r)}}}const SU="repo_interrupt",Cne=25;class bne{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new wne,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=pI(),this.transactionQueueTree_=new WA,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function RU(t){const n=t.infoData_.getNode(new It(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+n}function Im(t){return dne({timestamp:RU(t)})}function PU(t,e,n,r,i){t.dataUpdateCount++;const s=new It(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){const u=(0,I.UI)(n,d=>pn(d));o=function sne(t,e,n,r){const i=BA(t,r);if(i){const s=jA(i),o=s.path,a=s.queryId,u=Qr(o,e),d=Gt.fromObject(n);return $A(t,o,new Gh(AA(a),u,d))}return[]}(t.serverSyncTree_,s,u,i)}else{const u=pn(n);o=gU(t.serverSyncTree_,s,u,i)}else if(r){const u=(0,I.UI)(n,d=>pn(d));o=function nne(t,e,n){const r=Gt.fromObject(n);return zh(t,new Gh({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,s,u)}else{const u=pn(n);o=fm(t.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=Kh(t,s)),Vi(t.eventQueue_,a,o)}function NU(t,e){XA(t,"connected",e),!1===e&&function Pne(t){Wh(t,"onDisconnectEvents");const e=Im(t),n=pI();CA(t.onDisconnect_,pt(),(i,s)=>{const o=EU(i,s,t.serverSyncTree_,e);Hh(n,i,o)});let r=[];CA(n,pt(),(i,s)=>{r=r.concat(fm(t.serverSyncTree_,i,s));const o=nS(t,i);Kh(t,o)}),t.onDisconnect_=pI(),Vi(t.eventQueue_,pt(),r)}(t)}function XA(t,e,n){const r=new It("/.info/"+e),i=pn(n);t.infoData_.updateSnapshot(r,i);const s=fm(t.infoSyncTree_,r,i);Vi(t.eventQueue_,r,s)}function xI(t){return t.nextWriteId_++}function JA(t,e,n,r,i){Wh(t,"set",{path:e.toString(),value:n,priority:r});const s=Im(t),o=pn(n,r),a=DI(t.serverSyncTree_,e),u=qA(o,a,s),d=xI(t),f=LA(t.serverSyncTree_,e,u,d,!0);NI(t.eventQueue_,f),t.server_.put(e.toString(),o.val(!0),(m,y)=>{const E="ok"===m;E||Nr("set at "+e+" failed: "+m);const C=Su(t.serverSyncTree_,d,!E);Vi(t.eventQueue_,e,C),Ru(0,i,m,y)});const g=nS(t,e);Kh(t,g),Vi(t.eventQueue_,g,[])}function Nne(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&TA(t.onDisconnect_,e),Ru(0,n,r,i)})}function xU(t,e,n,r){const i=pn(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{"ok"===s&&Hh(t.onDisconnect_,e,i),Ru(0,r,s,o)})}function eS(t,e,n){let r;r=".info"===qe(e._path)?bI(t.infoSyncTree_,e,n):bI(t.serverSyncTree_,e,n),DU(t.eventQueue_,e._path,r)}function MU(t){t.persistentConnection_&&t.persistentConnection_.interrupt(SU)}function Wh(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),rr(n,...e)}function Ru(t,e,n,r){e&&Lh(()=>{if("ok"===n)e(null);else{const i=(n||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function tS(t,e,n){return DI(t.serverSyncTree_,e,n)||Fe.EMPTY_NODE}function MI(t,e=t.transactionQueueTree_){if(e||kI(t,e),hl(e)){const n=OU(t,e);(0,I.hu)(n.length>0,"Sending zero length transaction queue"),n.every(i=>0===i.status)&&function Vne(t,e,n){const r=n.map(d=>d.currentWriteId),i=tS(t,e,r);let s=i;const o=i.hash();for(let d=0;d<n.length;d++){const f=n[d];(0,I.hu)(0===f.status,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=1,f.retryCount++;const g=Qr(e,f.path);s=s.updateChild(g,f.currentOutputSnapshotRaw)}const a=s.val(!0),u=e;t.server_.put(u.toString(),a,d=>{Wh(t,"transaction put response",{path:u.toString(),status:d});let f=[];if("ok"===d){const g=[];for(let m=0;m<n.length;m++)n[m].status=2,f=f.concat(Su(t.serverSyncTree_,n[m].currentWriteId)),n[m].onComplete&&g.push(()=>n[m].onComplete(null,!0,n[m].currentOutputSnapshotResolved)),n[m].unwatcher();kI(t,SI(t.transactionQueueTree_,e)),MI(t,t.transactionQueueTree_),Vi(t.eventQueue_,e,f);for(let m=0;m<g.length;m++)Lh(g[m])}else{if("datastale"===d)for(let g=0;g<n.length;g++)n[g].status=3===n[g].status?4:0;else{Nr("transaction at "+u.toString()+" failed: "+d);for(let g=0;g<n.length;g++)n[g].status=4,n[g].abortReason=d}Kh(t,e)}},o)}(t,mm(e),n)}else IU(e)&&RI(e,n=>{MI(t,n)})}function Kh(t,e){const n=kU(t,e),r=mm(n);return function Lne(t,e,n){if(0===e.length)return;const r=[];let i=[];const o=e.filter(a=>0===a.status).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const u=e[a],d=Qr(n,u.path);let g,f=!1;if((0,I.hu)(null!==d,"rerunTransactionsUnderNode_: relativePath should not be null."),4===u.status)f=!0,g=u.abortReason,i=i.concat(Su(t.serverSyncTree_,u.currentWriteId,!0));else if(0===u.status)if(u.retryCount>=Cne)f=!0,g="maxretry",i=i.concat(Su(t.serverSyncTree_,u.currentWriteId,!0));else{const m=tS(t,u.path,o);u.currentInputSnapshot=m;const y=e[a].update(m.val());if(void 0!==y){ym("transaction failed: Data returned ",y,u.path);let E=pn(y);"object"==typeof y&&null!=y&&(0,I.r3)(y,".priority")||(E=E.updatePriority(m.getPriority()));const D=u.currentWriteId,O=Im(t),R=qA(E,m,O);u.currentOutputSnapshotRaw=E,u.currentOutputSnapshotResolved=R,u.currentWriteId=xI(t),o.splice(o.indexOf(D),1),i=i.concat(LA(t.serverSyncTree_,u.path,R,u.currentWriteId,u.applyLocally)),i=i.concat(Su(t.serverSyncTree_,D,!0))}else f=!0,g="nodata",i=i.concat(Su(t.serverSyncTree_,u.currentWriteId,!0))}Vi(t.eventQueue_,n,i),i=[],f&&(e[a].status=2,setTimeout(e[a].unwatcher,Math.floor(0)),e[a].onComplete&&r.push("nodata"===g?()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot):()=>e[a].onComplete(new Error(g),!1,null)))}kI(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Lh(r[a]);MI(t,t.transactionQueueTree_)}(t,OU(t,n),r),r}function kU(t,e){let n,r=t.transactionQueueTree_;for(n=qe(e);null!==n&&void 0===hl(r);)r=SI(r,n),n=qe(e=Ft(e));return r}function OU(t,e){const n=[];return FU(t,e,n),n.sort((r,i)=>r.order-i.order),n}function FU(t,e,n){const r=hl(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);RI(e,i=>{FU(t,i,n)})}function kI(t,e){const n=hl(e);if(n){let r=0;for(let i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,KA(e,n.length>0?n:void 0)}RI(e,r=>{kI(t,r)})}function nS(t,e){const n=mm(kU(t,e)),r=SI(t.transactionQueueTree_,e);return function gne(t,e,n){let r=n?t:t.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{rS(t,i)}),rS(t,r),wU(r,i=>{rS(t,i)}),n}function rS(t,e){const n=hl(e);if(n){const r=[];let i=[],s=-1;for(let o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?((0,I.hu)(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):((0,I.hu)(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Su(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===s?KA(e,void 0):n.length=s+1,Vi(t.eventQueue_,mm(e),i);for(let o=0;o<r.length;o++)Lh(r[o])}}const iS=function(t,e){const n=jne(t),r=n.namespace;return"firebase.com"===n.domain&&mo(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==n.domain&&mo("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Nr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new oA(n.host,n.secure,r,"ws"===n.scheme||"wss"===n.scheme,e,"",r!==n.subdomain),path:new It(n.pathString)}},jne=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",u=443;if("string"==typeof t){let d=t.indexOf("//");d>=0&&(a=t.substring(0,d-1),t=t.substring(d+2));let f=t.indexOf("/");-1===f&&(f=t.length);let g=t.indexOf("?");-1===g&&(g=t.length),e=t.substring(0,Math.min(f,g)),f<g&&(i=function Une(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(t.substring(f,g)));const m=function Bne(t){const e={};"?"===t.charAt(0)&&(t=t.substring(1));for(const n of t.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Nr(`Invalid query segment '${n}' in query '${t}'`)}return e}(t.substring(Math.min(t.length,g)));d=e.indexOf(":"),d>=0?(o="https"===a||"wss"===a,u=parseInt(e.substring(d+1),10)):d=e.length;const y=e.slice(0,d);if("localhost"===y.toLowerCase())n="localhost";else if(y.split(".").length<=2)n=y;else{const E=e.indexOf(".");r=e.substring(0,E).toLowerCase(),n=e.substring(E+1),s=r}"ns"in m&&(s=m.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},VU="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",$ne=function(){let t=0;const e=[];return function(n){const r=n===t;let i;t=n;const s=new Array(8);for(i=7;i>=0;i--)s[i]=VU.charAt(n%64),n=Math.floor(n/64);(0,I.hu)(0===n,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)o+=VU.charAt(e[i]);return(0,I.hu)(20===o.length,"nextPushId: Length should be 20."),o}}();class LU{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,I.Wl)(this.snapshot.exportVal())}}class UU{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class sS{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return(0,I.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class BU{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new I.BH;return Nne(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){ls("OnDisconnect.remove",this._path);const e=new I.BH;return xU(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){ls("OnDisconnect.set",this._path),vo("OnDisconnect.set",e,this._path,!1);const n=new I.BH;return xU(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){ls("OnDisconnect.setWithPriority",this._path),vo("OnDisconnect.setWithPriority",e,this._path,!1),YA("OnDisconnect.setWithPriority",n,!1);const r=new I.BH;return function xne(t,e,n,r,i){const s=pn(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{"ok"===o&&Hh(t.onDisconnect_,e,s),Ru(0,i,o,a)})}(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){ls("OnDisconnect.update",this._path),CU("OnDisconnect.update",e,this._path,!1);const n=new I.BH;return function Mne(t,e,n,r){if((0,I.xb)(n))return rr("onDisconnect().update() called with empty data.  Don't do anything."),void Ru(0,r,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{"ok"===i&&ir(n,(o,a)=>{const u=pn(a);Hh(t.onDisconnect_,on(e,o),u)}),Ru(0,r,i,s)})}(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}class Ii{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return ze(this._path)?null:hA(this._path)}get ref(){return new ds(this._repo,this._path)}get _queryIdentifier(){const e=G2(this._queryParams),n=iA(e);return"{}"===n?"default":n}get _queryObject(){return G2(this._queryParams)}isEqual(e){if(!((e=(0,I.m9)(e))instanceof Ii))return!1;const n=this._repo===e._repo,r=fA(this._path,e._path);return n&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function Mee(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)}}function OI(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function Pu(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===_o){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Iu)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==ya)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===Ht){if(null!=e&&!_m(e)||null!=n&&!_m(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,I.hu)(t.getIndex()instanceof yA||t.getIndex()===vA,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function FI(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class ds extends Ii{constructor(e,n){super(e,n,new dI,!1)}get parent(){const e=x2(this._path);return null===e?null:new ds(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class fl{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new It(e),r=pl(this.ref,e);return new fl(this._node.getChild(n),r,Ht)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new fl(i,pl(this.ref,r),Ht)))}hasChild(e){const n=new It(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function jU(t,e){return(t=(0,I.m9)(t))._checkNotDeleted("ref"),void 0!==e?pl(t._root,e):t._root}function $U(t,e){(t=(0,I.m9)(t))._checkNotDeleted("refFromURL");const n=iS(e,t._repo.repoInfo_.nodeAdmin);bU("refFromURL",n);const r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&mo("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),jU(t,n.path.toString())}function pl(t,e){return null===qe((t=(0,I.m9)(t))._path)?Ine("child","path",e,!1):Em("child","path",e,!1),new ds(t._repo,on(t._path,e))}function oS(t,e){t=(0,I.m9)(t),ls("set",t._path),vo("set",e,t._path,!1);const n=new I.BH;return JA(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function Wne(t,e){CU("update",e,t._path,!1);const n=new I.BH;return function Rne(t,e,n,r){Wh(t,"update",{path:e.toString(),value:n});let i=!0;const s=Im(t),o={};if(ir(n,(a,u)=>{i=!1,o[a]=EU(on(e,a),pn(u),t.serverSyncTree_,s)}),i)rr("update() called with empty data.  Don't do anything."),Ru(0,r,"ok",void 0);else{const a=xI(t),u=function tne(t,e,n,r){!function yte(t,e,n,r){(0,I.hu)(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=RA(t.visibleWrites,e,n),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r);const i=Gt.fromObject(n);return zh(t,new Gh({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(t.serverSyncTree_,e,o,a);NI(t.eventQueue_,u),t.server_.merge(e.toString(),n,(d,f)=>{const g="ok"===d;g||Nr("update at "+e+" failed: "+d);const m=Su(t.serverSyncTree_,a,!g),y=m.length>0?Kh(t,e):e;Vi(t.eventQueue_,y,m),Ru(0,r,d,f)}),ir(n,d=>{const f=nS(t,on(e,d));Kh(t,f)}),Vi(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function Kne(t){t=(0,I.m9)(t);const e=new sS(()=>{}),n=new wm(e);return function Sne(t,e,n){const r=function one(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(d,f)=>{const g=Qr(d,n);r=r||Du(f,g)});let i=t.syncPointTree_.get(n);i?r=r||Du(i,pt()):(i=new cU,t.syncPointTree_=t.syncPointTree_.set(n,i));const s=null!=r,o=s?new Cu(r,!0,!1):null;return function Hte(t){return _I(t.viewCache_)}(lU(i,e,yI(t.pendingWriteTree_,e._path),s?o.getNode():Fe.EMPTY_NODE,s))}(t.serverSyncTree_,e);return null!=r?Promise.resolve(r):t.server_.get(e).then(i=>{const s=pn(i).withIndex(e._queryParams.getIndex());let o;if(UA(t.serverSyncTree_,e,n,!0),e._queryParams.loadsAllData())o=fm(t.serverSyncTree_,e._path,s);else{const a=pm(t.serverSyncTree_,e);o=gU(t.serverSyncTree_,e._path,s,a)}return Vi(t.eventQueue_,e._path,o),bI(t.serverSyncTree_,e,n,null,!0),s},i=>(Wh(t,"get for query "+(0,I.Wl)(e)+" failed: "+i),Promise.reject(new Error(i))))}(t._repo,t,n).then(r=>new fl(r,new ds(t._repo,t._path),t._queryParams.getIndex()))}class wm{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,n){const r=n._queryParams.getIndex();return new LU("value",this,new fl(e.snapshotNode,new ds(n._repo,n._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new UU(this,e,n):null}matches(e){return e instanceof wm&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class VI{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n="children_added"===e?"child_added":e;return n="children_removed"===n?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new UU(this,e,n):null}createEvent(e,n){(0,I.hu)(null!=e.childName,"Child events should have a childName.");const r=pl(new ds(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new LU(e.type,this,new fl(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof VI&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function Tm(t,e,n,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const u=n,d=(f,g)=>{eS(t._repo,t,a),u(f,g)};d.userCallback=n.userCallback,d.context=n.context,n=d}const o=new sS(n,s||void 0),a="value"===e?new wm(o):new VI(e,o);return function kne(t,e,n){let r;r=".info"===qe(e._path)?UA(t.infoSyncTree_,e,n):UA(t.serverSyncTree_,e,n),DU(t.eventQueue_,e._path,r)}(t._repo,t,a),()=>eS(t._repo,t,a)}function aS(t,e,n,r){return Tm(t,"value",e,n,r)}function HU(t,e,n,r){return Tm(t,"child_added",e,n,r)}function GU(t,e,n,r){return Tm(t,"child_changed",e,n,r)}function qU(t,e,n,r){return Tm(t,"child_moved",e,n,r)}function zU(t,e,n,r){return Tm(t,"child_removed",e,n,r)}function WU(t,e,n){let r=null;const i=n?new sS(n):null;"value"===e?r=new wm(i):e&&(r=new VI(e,i)),eS(t._repo,t,r)}class Ls{}class KU extends Ls{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){vo("endAt",this._value,e._path,!0);const n=wA(e._queryParams,this._value,this._key);if(FI(n),Pu(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ii(e._repo,e._path,n,e._orderByCalled)}}class Qne extends Ls{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){vo("endBefore",this._value,e._path,!1);const n=function ste(t,e,n){let r;return r=wA(t,e,t.index_===_o||n?n:Iu),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(FI(n),Pu(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ii(e._repo,e._path,n,e._orderByCalled)}}class ZU extends Ls{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){vo("startAt",this._value,e._path,!0);const n=IA(e._queryParams,this._value,this._key);if(FI(n),Pu(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Ii(e._repo,e._path,n,e._orderByCalled)}}class Jne extends Ls{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){vo("startAfter",this._value,e._path,!1);const n=function ite(t,e,n){let r;return r=IA(t,e,t.index_===_o||n?n:ya),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(FI(n),Pu(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Ii(e._repo,e._path,n,e._orderByCalled)}}class tre extends Ls{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ii(e._repo,e._path,function nte(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}class rre extends Ls{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ii(e._repo,e._path,function rte(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}class sre extends Ls{constructor(e){super(),this._path=e}_apply(e){OI(e,"orderByChild");const n=new It(this._path);if(ze(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new yA(n),i=hI(e._queryParams,r);return Pu(i),new Ii(e._repo,e._path,i,!0)}}class are extends Ls{_apply(e){OI(e,"orderByKey");const n=hI(e._queryParams,_o);return Pu(n),new Ii(e._repo,e._path,n,!0)}}class cre extends Ls{_apply(e){OI(e,"orderByPriority");const n=hI(e._queryParams,Ht);return Pu(n),new Ii(e._repo,e._path,n,!0)}}class dre extends Ls{_apply(e){OI(e,"orderByValue");const n=hI(e._queryParams,vA);return Pu(n),new Ii(e._repo,e._path,n,!0)}}class fre extends Ls{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(vo("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new KU(this._value,this._key)._apply(new ZU(this._value,this._key)._apply(e))}}function Us(t,...e){let n=(0,I.m9)(t);for(const r of e)n=r._apply(n);return n}(function Wte(t){(0,I.hu)(!wI,"__referenceConstructor has already been defined"),wI=t})(ds),function Xte(t){(0,I.hu)(!CI,"__referenceConstructor has already been defined"),CI=t}(ds);const uS={};function cS(t,e,n,r,i){let s=r||t.options.databaseURL;void 0===s&&(t.options.projectId||mo("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),rr("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let u,d,o=iS(s,i),a=o.repoInfo;typeof process<"u"&&process.env&&(d=process.env.FIREBASE_DATABASE_EMULATOR_HOST),d?(u=!0,s=`http://${d}?ns=${a.namespace}`,o=iS(s,i),a=o.repoInfo):u=!o.repoInfo.secure;const f=i&&u?new tm(tm.OWNER):new uee(t.name,t.options,e);bU("Invalid Firebase Database URL",o),ze(o.path)||mo("Database URL must point to the root of a Firebase Database (not including a child path).");const g=function yre(t,e,n,r){let i=uS[e.name];i||(i={},uS[e.name]=i);let s=i[t.toURLString()];return s&&mo("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new bne(t,false,n,r),i[t.toURLString()]=s,s}(a,t,f,new aee(t.name,n));return new Ere(g,t)}class Ere{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function Dne(t,e,n){if(t.stats_=cA(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new fI(t.repoInfo_,(r,i,s,o)=>{PU(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>NU(t,!0),0);else{if(typeof n<"u"&&null!==n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,I.Wl)(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new ul(t.repoInfo_,e,(r,i,s,o)=>{PU(t,r,i,s,o)},r=>{NU(t,r)},r=>{!function Ane(t,e){ir(e,(n,r)=>{XA(t,n,r)})}(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=function dee(t,e){const n=t.toString();return uA[n]||(uA[n]=e()),uA[n]}(t.repoInfo_,()=>new dte(t.stats_,t.server_)),t.infoData_=new ote,t.infoSyncTree_=new pU({startListening:(r,i,s,o)=>{let a=[];const u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=fm(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),XA(t,"connected",!1),t.serverSyncTree_=new pU({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,u)=>{const d=o(a,u);Vi(t.eventQueue_,r._path,d)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ds(this._repo,pt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function _re(t,e){const n=uS[e];(!n||n[t.key]!==t)&&mo(`Database ${e}(${t.repoInfo_}) has already been deleted.`),MU(t),delete n[t.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&mo("Cannot call "+e+" on a deleted database.")}}function YU(){E2.IS_TRANSPORT_INITIALIZED&&Nr("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Ire(){YU(),wu.forceDisallow()}function wre(){YU(),Uh.forceDisallow(),wu.forceAllow()}function bre(t,e){e2(t,e)}const Are={".sv":"timestamp"};class Pre{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}ul.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},ul.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)},function Dre(t){tA(vi.SDK_VERSION),(0,vi._registerComponent)(new Os.wA("database",(e,{instanceIdentifier:n})=>cS(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n),"PUBLIC").setMultipleInstances(!0)),(0,vi.registerVersion)(KL,"1.0.2",t),(0,vi.registerVersion)(KL,"1.0.2","esm2017")}();const kre=new Fi.Yd("@firebase/database-compat"),JU=function(t){kre.warn("FIREBASE WARNING: "+t)};class Vre{constructor(e){this._delegate=e}cancel(e){(0,I.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,I.Wj)("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){(0,I.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,I.Wj)("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){(0,I.Dv)("OnDisconnect.set",1,2,arguments.length),(0,I.Wj)("OnDisconnect.set","onComplete",n,!0);const r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){(0,I.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,I.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if((0,I.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,JU("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,I.Wj)("OnDisconnect.update","onComplete",n,!0);const r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}}class Lre{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return(0,I.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class Nu{constructor(e,n){this._database=e,this._delegate=n}val(){return(0,I.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,I.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,I.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,I.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,I.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),Em("DataSnapshot.child","path",e,!1),new Nu(this._database,this._delegate.child(e))}hasChild(e){return(0,I.Dv)("DataSnapshot.hasChild",1,1,arguments.length),Em("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,I.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,I.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,I.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new Nu(this._database,n)))}hasChildren(){return(0,I.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,I.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,I.Dv)("DataSnapshot.ref",0,0,arguments.length),new Li(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class wr{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;(0,I.Dv)("Query.on",2,4,arguments.length),(0,I.Wj)("Query.on","callback",n,!1);const o=wr.getCancelAndContextArgs_("Query.on",r,i),a=(d,f)=>{n.call(o.context,new Nu(this.database,d),f)};a.userCallback=n,a.context=o.context;const u=null===(s=o.cancel)||void 0===s?void 0:s.bind(o.context);switch(e){case"value":return aS(this._delegate,a,u),n;case"child_added":return HU(this._delegate,a,u),n;case"child_removed":return zU(this._delegate,a,u),n;case"child_changed":return GU(this._delegate,a,u),n;case"child_moved":return qU(this._delegate,a,u),n;default:throw new Error((0,I.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if((0,I.Dv)("Query.off",0,3,arguments.length),function(t,e,n){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,I.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,I.Wj)("Query.off","callback",n,!0),(0,I.lb)("Query.off","context",r,!0),n){const i=()=>{};i.userCallback=n,i.context=r,WU(this._delegate,e,i)}else WU(this._delegate,e)}get(){return Kne(this._delegate).then(e=>new Nu(this.database,e))}once(e,n,r,i){(0,I.Dv)("Query.once",1,4,arguments.length),(0,I.Wj)("Query.once","callback",n,!0);const s=wr.getCancelAndContextArgs_("Query.once",r,i),o=new I.BH,a=(d,f)=>{const g=new Nu(this.database,d);n&&n.call(s.context,g,f),o.resolve(g)};a.userCallback=n,a.context=s.context;const u=d=>{s.cancel&&s.cancel.call(s.context,d),o.reject(d)};switch(e){case"value":aS(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":HU(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":zU(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":GU(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":qU(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error((0,I.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return(0,I.Dv)("Query.limitToFirst",1,1,arguments.length),new wr(this.database,Us(this._delegate,function nre(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new tre(t)}(e)))}limitToLast(e){return(0,I.Dv)("Query.limitToLast",1,1,arguments.length),new wr(this.database,Us(this._delegate,function ire(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new rre(t)}(e)))}orderByChild(e){return(0,I.Dv)("Query.orderByChild",1,1,arguments.length),new wr(this.database,Us(this._delegate,function ore(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Em("orderByChild","path",t,!1),new sre(t)}(e)))}orderByKey(){return(0,I.Dv)("Query.orderByKey",0,0,arguments.length),new wr(this.database,Us(this._delegate,function ure(){return new are}()))}orderByPriority(){return(0,I.Dv)("Query.orderByPriority",0,0,arguments.length),new wr(this.database,Us(this._delegate,function lre(){return new cre}()))}orderByValue(){return(0,I.Dv)("Query.orderByValue",0,0,arguments.length),new wr(this.database,Us(this._delegate,function hre(){return new dre}()))}startAt(e=null,n){return(0,I.Dv)("Query.startAt",0,2,arguments.length),new wr(this.database,Us(this._delegate,function Xne(t=null,e){return vm("startAt","key",e,!0),new ZU(t,e)}(e,n)))}startAfter(e=null,n){return(0,I.Dv)("Query.startAfter",0,2,arguments.length),new wr(this.database,Us(this._delegate,function ere(t,e){return vm("startAfter","key",e,!0),new Jne(t,e)}(e,n)))}endAt(e=null,n){return(0,I.Dv)("Query.endAt",0,2,arguments.length),new wr(this.database,Us(this._delegate,function Zne(t,e){return vm("endAt","key",e,!0),new KU(t,e)}(e,n)))}endBefore(e=null,n){return(0,I.Dv)("Query.endBefore",0,2,arguments.length),new wr(this.database,Us(this._delegate,function Yne(t,e){return vm("endBefore","key",e,!0),new Qne(t,e)}(e,n)))}equalTo(e,n){return(0,I.Dv)("Query.equalTo",1,2,arguments.length),new wr(this.database,Us(this._delegate,function pre(t,e){return vm("equalTo","key",e,!0),new fre(t,e)}(e,n)))}toString(){return(0,I.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,I.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,I.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof wr))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){const i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,(0,I.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,I.lb)(e,"context",i.context,!0);else if(n)if("object"==typeof n&&null!==n)i.context=n;else{if("function"!=typeof n)throw new Error((0,I.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=n}return i}get ref(){return new Li(this.database,new ds(this._delegate._repo,this._delegate._path))}}class Li extends wr{constructor(e,n){super(e,new Ii(n._repo,n._path,new dI,!1)),this.database=e,this._delegate=n}getKey(){return(0,I.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,I.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new Li(this.database,pl(this._delegate,e))}getParent(){(0,I.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Li(this.database,e):null}getRoot(){return(0,I.Dv)("Reference.root",0,0,arguments.length),new Li(this.database,this._delegate.root)}set(e,n){(0,I.Dv)("Reference.set",1,2,arguments.length),(0,I.Wj)("Reference.set","onComplete",n,!0);const r=oS(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if((0,I.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,JU("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ls("Reference.update",this._delegate._path),(0,I.Wj)("Reference.update","onComplete",n,!0);const r=Wne(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){(0,I.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,I.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function zne(t,e,n){if(ls("setWithPriority",t._path),vo("setWithPriority",e,t._path,!1),YA("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";const r=new I.BH;return JA(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){(0,I.Dv)("Reference.remove",0,1,arguments.length),(0,I.Wj)("Reference.remove","onComplete",e,!0);const n=function Gne(t){return ls("remove",t._path),oS(t,null)}(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){(0,I.Dv)("Reference.transaction",1,3,arguments.length),(0,I.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,I.Wj)("Reference.transaction","onComplete",n,!0),function(t,e,n,r){if(void 0!==n&&"boolean"!=typeof n)throw new Error((0,I.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function Nre(t,e,n){var r;if(t=(0,I.m9)(t),ls("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";const i=null===(r=n?.applyLocally)||void 0===r||r,s=new I.BH,a=aS(t,()=>{});return function Fne(t,e,n,r,i,s){Wh(t,"transaction on "+e);const o={path:e,update:n,onComplete:r,status:null,order:YL(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=tS(t,e,void 0);o.currentInputSnapshot=a;const u=o.update(a.val());if(void 0===u)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{ym("transaction failed: Data returned ",u,o.path),o.status=0;const d=SI(t.transactionQueueTree_,e),f=hl(d)||[];let g;f.push(o),KA(d,f),"object"==typeof u&&null!==u&&(0,I.r3)(u,".priority")?(g=(0,I.DV)(u,".priority"),(0,I.hu)(_m(g),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):g=(DI(t.serverSyncTree_,e)||Fe.EMPTY_NODE).getPriority().val();const m=Im(t),y=pn(u,g),E=qA(y,a,m);o.currentOutputSnapshotRaw=y,o.currentOutputSnapshotResolved=E,o.currentWriteId=xI(t);const C=LA(t.serverSyncTree_,e,E,o.currentWriteId,o.applyLocally);Vi(t.eventQueue_,e,C),MI(t,t.transactionQueueTree_)}}(t._repo,t._path,e,(u,d,f)=>{let g=null;u?s.reject(u):(g=new fl(f,new ds(t._repo,t._path),Ht),s.resolve(new Pre(d,g)))},a,i),s.promise}(this._delegate,e,{applyLocally:r}).then(s=>new Lre(s.committed,new Nu(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){(0,I.Dv)("Reference.setPriority",1,2,arguments.length),(0,I.Wj)("Reference.setPriority","onComplete",n,!0);const r=function qne(t,e){t=(0,I.m9)(t),ls("setPriority",t._path),YA("setPriority",e,!1);const n=new I.BH;return JA(t._repo,on(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){(0,I.Dv)("Reference.push",0,2,arguments.length),(0,I.Wj)("Reference.push","onComplete",n,!0);const r=function Hne(t,e){t=(0,I.m9)(t),ls("push",t._path),vo("push",e,t._path,!0);const n=RU(t._repo),r=$ne(n),i=pl(t,r),s=pl(t,r);let o;return o=null!=e?oS(s,e).then(()=>s):Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}(this._delegate,e),i=r.then(o=>new Li(this.database,o));n&&i.then(()=>n(null),o=>n(o));const s=new Li(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return ls("Reference.onDisconnect",this._delegate._path),new Vre(new BU(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class Cm{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:Ire,forceLongPolling:wre}}useEmulator(e,n,r={}){!function XU(t,e,n,r={}){(t=(0,I.m9)(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&mo("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&mo('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new tm(tm.OWNER);else if(r.mockUserToken){const o="string"==typeof r.mockUserToken?r.mockUserToken:(0,I.Sg)(r.mockUserToken,t.app.options.projectId);s=new tm(o)}!function mre(t,e,n,r){t.repoInfo_=new oA(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}(i,e,n,s)}(this._delegate,e,n,r)}ref(e){if((0,I.Dv)("database.ref",0,1,arguments.length),e instanceof Li){const n=$U(this._delegate,e.toString());return new Li(this,n)}{const n=jU(this._delegate,e);return new Li(this,n)}}refFromURL(e){(0,I.Dv)("database.refFromURL",1,1,arguments.length);const r=$U(this._delegate,e);return new Li(this,r)}goOffline(){return(0,I.Dv)("database.goOffline",0,0,arguments.length),function Tre(t){(t=(0,I.m9)(t))._checkNotDeleted("goOffline"),MU(t._repo)}(this._delegate)}goOnline(){return(0,I.Dv)("database.goOnline",0,0,arguments.length),function Cre(t){(t=(0,I.m9)(t))._checkNotDeleted("goOnline"),function One(t){t.persistentConnection_&&t.persistentConnection_.resume(SU)}(t._repo)}(this._delegate)}}Cm.ServerValue={TIMESTAMP:function Sre(){return Are}(),increment:t=>function Rre(t){return{".sv":{increment:t}}}(t)};var Bre=Object.freeze({__proto__:null,initStandalone:function Ure({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){tA(n);const a=new Os.H0("database-standalone"),u=new Os.zt("auth-internal",a);let d;return u.setComponent(new Os.wA("auth-internal",()=>r,"PRIVATE")),i&&(d=new Os.zt("app-check-internal",a),d.setComponent(new Os.wA("app-check-internal",()=>i,"PRIVATE"))),{instance:new Cm(cS(t,u,d,e,o),t),namespace:s}}});const jre=Cm.ServerValue;function bm(t,e,n="on",r=ZE){return new Ge(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),"once"===n&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),"on"===n?{unsubscribe(){null!=s&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(Ie(i=>{const{snapshot:s,prevKey:o}=i;let a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),qi())}function eB(t){return null==t}function tB(t){return"function"==typeof t.set}function nB(t,e){return tB(e)?e:t.ref(e)}function rB(t,e){if(function Hre(t){return"string"==typeof t}(t))return e.stringCase();if(tB(t))return e.firebaseCase();if(function Gre(t){return"function"==typeof t.exportVal}(t))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof t)}function iB(t){return(eB(t)||0===t.length)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function sB(t,e,n){return An(...(e=iB(e)).map(i=>bm(t,i,"on",n)))}function oB(t,e){return function(r,i){return rB(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function Kre(t){return function(n){return n?rB(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function aB(t,e){const n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function Yre(t,e){const{payload:n,prevKey:r,key:i}=e,s=aB(t,i),o=function Qre(t,e){if(eB(e))return 0;{const n=aB(t,e);return-1===n?t.length:n+1}}(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{const d={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,t=[...t,d],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(u=>u.payload.key!==n.key)).splice(o,0,e);else{if(null==r)return[e,...t];(t=t.slice()).splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){const a=t.splice(s,1)[0];return(t=t.slice()).splice(o,0,a),t}return t;default:return t}}function uB(t,e,n){return function Zre(t,e,n){return bm(t,"value","once",n).pipe(ft(r=>{const i=[fe(r)];return e.forEach(s=>i.push(bm(t,s,"on",n))),An(...i).pipe(wh(Yre,[]))}),Zs())}(t,e=iB(e),n)}function cB(t,e){return function(){return bm(t,"value","on",e)}}!function $re(t){t.INTERNAL.registerComponent(new Os.wA("database-compat",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Cm(i,r)},"PUBLIC").setServiceProps({Reference:Li,Query:wr,Database:Cm,DataSnapshot:Nu,enableLogging:bre,INTERNAL:Bre,ServerValue:jre}).setMultipleInstances(!0)),t.registerVersion("@firebase/database-compat","1.0.2")}(us.Z);const eie=new re("angularfire2.realtimeDatabaseURL"),tie=new re("angularfire2.database.use-emulator");let lB=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,u,d,f,g,m,y,E,C,D){this.schedulers=a;const O=u,R=Qg(n,o,r);d&&X0(R,o,f,m,y,E,g,C),this.database=nI(`${R.name}.database.${i}`,"AngularFireDatabase",R.name,()=>{const k=o.runOutsideAngular(()=>R.database(i||void 0));return O&&k.useEmulator(...O),k},[O])}list(n,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>nB(this.database,n));let s=i;return r&&(s=r(i)),function Xre(t,e){const n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:oB(r,"update"),set:oB(r,"set"),push:i=>r.push(i),remove:Kre(r),snapshotChanges:i=>uB(t,i,n).pipe(Mn),stateChanges:i=>sB(t,i,n).pipe(Mn),auditTrail:i=>function qre(t,e,n){return function Wre(t,e,n){return function zre(t,e){return bm(t,"value","on",e).pipe(Ie(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}(t,n).pipe(function HJ(...t){return e=>{let n;return"function"==typeof t[t.length-1]&&(n=t.pop()),e.lift(new GJ(t,n))}}(e),Ie(([i,s])=>{const o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),function zJ(t){return e=>e.lift(new WJ(t))}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),Ie(i=>i.actions))}(t,sB(t,e).pipe(wh((i,s)=>[...i,s],[])),n)}(t,i,n).pipe(Mn),valueChanges:(i,s)=>uB(t,i,n).pipe(Ie(a=>a.map(u=>s&&s.idField?{...u.payload.val(),[s.idField]:u.key}:u.payload.val())),Mn)}}(s,this)}object(n){return function Jre(t,e){return{query:t,snapshotChanges:()=>cB(t,e.schedulers.outsideAngular)().pipe(Mn),update:n=>t.ref.update(n),set:n=>t.ref.set(n),remove:()=>t.ref.remove(),valueChanges:()=>cB(t,e.schedulers.outsideAngular)().pipe(Mn,Ie(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>nB(this.database,n)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(z(Oh),z(Fh,8),z(eie,8),z(Ds),z(lt),z(tI),z(tie,8),z(J0,8),z(z0,8),z(W0,8),z(K0,8),z(Z0,8),z(Q0,8),z(Y0,8),z(eI,8))};static \u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),nie=(()=>{class t{constructor(){us.Z.registerVersion("angularfire",Zg.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=er({type:t});static \u0275inj=Vn({providers:[lB]})}return t})(),lS=(()=>{class t{constructor(n){this.db=n,this.games=n.list("games").snapshotChanges().pipe(Ie(r=>r.map(i=>({...i.payload.val(),key:i.payload.key}))))}get games$(){return this.games.pipe(Ie(n=>n.map(r=>new VL(r))))}addGame(n){return this.db.list("games").push(n),n}updateGame(n){this.db.list("games").update(n.key,n)}static#e=this.\u0275fac=function(r){return new(r||t)(z(lB))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),dS=(()=>{class t{constructor(n){this.dbSvc=n,this.gameSubject=new Wt(null),this.gameCodeSubject=new Wt(""),this.dbSvc.games$.subscribe(r=>{this.game=r.find(i=>i.code===this.gameCode)??null})}get game(){return this.gameSubject.value}set game(n){n&&this.dbSvc.updateGame(n),this.gameSubject.next(n)}get gameCode(){return this.gameCodeSubject.value}set gameCode(n){this.gameCodeSubject.next(n),this._setGame(n)}startGame(){const n=this.game;n&&(n.startTime=new Date,n.endTime=new Date(n.startTime.getTime()+6e4*n.minutesForGame),n.players[0].myTurn=!0,n.inProgress=!0,this.game=n)}createGame(){const n=new VL;return n.addPlayer(),this.dbSvc.addGame(n)}_setGame(n){this.dbSvc.games$.pipe(el(1)).subscribe(r=>{this.game=r.find(i=>i.code===n)??null})}static#e=this.\u0275fac=function(r){return new(r||t)(z(lS))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),dB=(()=>{class t{constructor(n,r){this.gameStore=n,this.dbSvc=r,this.playerSubject=new Wt(null),this.playerNumberSubject=new Wt(""),this.dbSvc.games$.subscribe(i=>{const s=i.find(o=>o.code===this.gameStore.gameCode);s&&(this.player=s.findPlayer(this.playerNumber)??null)})}get player(){return this.playerSubject.value}set player(n){if(n){const r=this.gameStore.game;r&&(r.players.forEach(i=>{i.number===n.number&&Object.assign(i,n)}),this.dbSvc.updateGame(r))}this.playerSubject.next(n)}get playerNumber(){return this.playerNumberSubject.value}set playerNumber(n){this.playerNumberSubject.next(n),this._setPlayer(n)}_setPlayer(n){this.player=this.gameStore.game?.players?.find(r=>r.number===n)??null}static#e=this.\u0275fac=function(r){return new(r||t)(z(dS),z(lS))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function LI(t,e){return new Ge(n=>{const r=t.length;if(0===r)return void n.complete();const i=new Array(r);let s=0,o=0;for(let a=0;a<r;a++){const u=ct(t[a]);let d=!1;n.add(u.subscribe({next:f=>{d||(d=!0,o++),i[a]=f},error:f=>n.error(f),complete:()=>{s++,(s===r||!d)&&(o===r&&n.next(e?e.reduce((f,g,m)=>(f[g]=i[m],f),{}):i),n.complete())}}))}})}let hB=(()=>{class t{constructor(n,r){this._renderer=n,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(n,r){this._renderer.setProperty(this._elementRef.nativeElement,n,r)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}static#e=this.\u0275fac=function(r){return new(r||t)(X(ua),X(Ni))};static#t=this.\u0275dir=Re({type:t})}return t})(),gl=(()=>{class t extends hB{static#e=this.\u0275fac=function(){let n;return function(i){return(n||(n=Pn(t)))(i||t)}}();static#t=this.\u0275dir=Re({type:t,features:[Ct]})}return t})();const Eo=new re("NgValueAccessor"),sie={provide:Eo,useExisting:ce(()=>UI),multi:!0},aie=new re("CompositionEventMode");let UI=(()=>{class t extends hB{constructor(n,r,i){super(n,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function oie(){const t=gu()?gu().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}static#e=this.\u0275fac=function(r){return new(r||t)(X(ua),X(Ni),X(aie,8))};static#t=this.\u0275dir=Re({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){1&r&&Bt("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[Yt([sie]),Ct]})}return t})();const xr=new re("NgValidators"),Mu=new re("NgAsyncValidators");function TB(t){return null!=t}function CB(t){return pg(t)?ct(t):t}function bB(t){let e={};return t.forEach(n=>{e=null!=n?{...e,...n}:e}),0===Object.keys(e).length?null:e}function DB(t,e){return e.map(n=>n(t))}function AB(t){return t.map(e=>function cie(t){return!t.validate}(e)?e:n=>e.validate(n))}function hS(t){return null!=t?function SB(t){if(!t)return null;const e=t.filter(TB);return 0==e.length?null:function(n){return bB(DB(n,e))}}(AB(t)):null}function fS(t){return null!=t?function RB(t){if(!t)return null;const e=t.filter(TB);return 0==e.length?null:function(n){return function rie(...t){if(1===t.length){const e=t[0];if(xt(e))return LI(e,null);if(mn(e)&&Object.getPrototypeOf(e)===Object.prototype){const n=Object.keys(e);return LI(n.map(r=>e[r]),n)}}if("function"==typeof t[t.length-1]){const e=t.pop();return LI(t=1===t.length&&xt(t[0])?t[0]:t,null).pipe(Ie(n=>e(...n)))}return LI(t,null)}(DB(n,e).map(CB)).pipe(Ie(bB))}}(AB(t)):null}function PB(t,e){return null===t?[e]:Array.isArray(t)?[...t,e]:[t,e]}function pS(t){return t?Array.isArray(t)?t:[t]:[]}function jI(t,e){return Array.isArray(t)?t.includes(e):t===e}function MB(t,e){const n=pS(e);return pS(t).forEach(i=>{jI(n,i)||n.push(i)}),n}function kB(t,e){return pS(e).filter(n=>!jI(t,n))}class OB{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=hS(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=fS(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return!!this.control&&this.control.hasError(e,n)}getError(e,n){return this.control?this.control.getError(e,n):null}}class Yr extends OB{get formDirective(){return null}get path(){return null}}class ku extends OB{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class FB{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let VB=(()=>{class t extends FB{constructor(n){super(n)}static#e=this.\u0275fac=function(r){return new(r||t)(X(ku,2))};static#t=this.\u0275dir=Re({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){2&r&&gg("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Ct]})}return t})();const Dm="VALID",HI="INVALID",Zh="PENDING",Am="DISABLED";function GI(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class jB{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Dm}get invalid(){return this.status===HI}get pending(){return this.status==Zh}get disabled(){return this.status===Am}get enabled(){return this.status!==Am}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(MB(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(MB(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(kB(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(kB(e,this._rawAsyncValidators))}hasValidator(e){return jI(this._rawValidators,e)}hasAsyncValidator(e){return jI(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Zh,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const n=this._parentMarkedDirty(e.onlySelf);this.status=Am,this.errors=null,this._forEachChild(r=>{r.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:n}),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const n=this._parentMarkedDirty(e.onlySelf);this.status=Dm,this._forEachChild(r=>{r.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:n}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Dm||this.status===Zh)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Am:Dm}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Zh,this._hasOwnPendingAsyncValidator=!0;const n=CB(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(!1!==n.emitEvent)}get(e){let n=e;return null==n||(Array.isArray(n)||(n=n.split(".")),0===n.length)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){const r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new fn,this.statusChanges=new fn}_calculateStatus(){return this._allControlsDisabled()?Am:this.errors?HI:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Zh)?Zh:this._anyControlsHaveStatus(HI)?HI:Dm}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){GI(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function pie(t){return Array.isArray(t)?hS(t):t||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function gie(t){return Array.isArray(t)?fS(t):t||null}(this._rawAsyncValidators)}}const Qh=new re("CallSetDisabledState",{providedIn:"root",factory:()=>qI}),qI="always";function Sm(t,e,n=qI){(function ES(t,e){const n=function NB(t){return t._rawValidators}(t);null!==e.validator?t.setValidators(PB(n,e.validator)):"function"==typeof n&&t.setValidators([n]);const r=function xB(t){return t._rawAsyncValidators}(t);null!==e.asyncValidator?t.setAsyncValidators(PB(r,e.asyncValidator)):"function"==typeof r&&t.setAsyncValidators([r]);const i=()=>t.updateValueAndValidity();KI(e._rawValidators,i),KI(e._rawAsyncValidators,i)})(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||"always"===n)&&e.valueAccessor.setDisabledState?.(t.disabled),function yie(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&$B(t,e)})}(t,e),function Eie(t,e){const n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}(t,e),function vie(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&$B(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),function _ie(t,e){if(e.valueAccessor.setDisabledState){const n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}(t,e)}function KI(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function $B(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function qB(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function zB(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const WB=class extends jB{constructor(e=null,n,r){super(function _S(t){return(GI(t)?t.validators:t)||null}(n),function yS(t,e){return(GI(e)?e.asyncValidators:t)||null}(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),GI(n)&&(n.nonNullable||n.initialValueIsDefault)&&(this.defaultValue=zB(e)?e.value:e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==n.emitViewToModelChange)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){qB(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){qB(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){zB(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},Sie={provide:ku,useExisting:ce(()=>bS)},QB=(()=>Promise.resolve())();let bS=(()=>{class t extends ku{constructor(n,r,i,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new WB,this._registered=!1,this.name="",this.update=new fn,this._parent=n,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=function TS(t,e){if(!e)return null;let n,r,i;return Array.isArray(e),e.forEach(s=>{s.constructor===UI?n=s:function Tie(t){return Object.getPrototypeOf(t.constructor)===gl}(s)?r=s:i=s}),i||r||n||null}(0,s)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const r=n.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),function wS(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Object.is(e,n.currentValue)}(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Sm(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){QB.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){const r=n.isDisabled.currentValue,i=0!==r&&function yh(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}(r);QB.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?function zI(t,e){return[...e.path,t]}(n,this._parent):[n]}static#e=this.\u0275fac=function(r){return new(r||t)(X(Yr,9),X(xr,10),X(Mu,10),X(Eo,10),X(Ag,8),X(Qh,8))};static#t=this.\u0275dir=Re({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Yt([Sie]),Ct,In]})}return t})(),XB=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=er({type:t});static#n=this.\u0275inj=Vn({})}return t})(),Jie=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=er({type:t});static#n=this.\u0275inj=Vn({imports:[XB]})}return t})(),tse=(()=>{class t{static withConfig(n){return{ngModule:t,providers:[{provide:Qh,useValue:n.callSetDisabledState??qI}]}}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=er({type:t});static#n=this.\u0275inj=Vn({imports:[Jie]})}return t})();function nse(t,e){if(1&t&&(Qv(0),fg(1,"span",2),Yv()),2&t){const n=Zn();Pt(1),Ut("innerHTML",n.i.text,sM)}}function rse(t,e){1&t&&Zb(0)}const ise=function(t){return{$implicit:t}};var Mr=function(t){return t[t.ing=0]="ing",t[t.pause=1]="pause",t[t.stop=2]="stop",t[t.done=3]="done",t}(Mr||{});let mj=(()=>{class t{constructor(n){this.ngZone=n,this.fns=[],this.commands=[],this.nextTime=0,this.ing=!1}start(){!0!==this.ing&&(this.ing=!0,this.nextTime=+new Date,this.ngZone.runOutsideAngular(()=>{this.process()}))}process(){for(;this.commands.length;)this.commands.shift()();let n=+new Date-this.nextTime;const r=1+Math.floor(n/100);n=100-n%100,this.nextTime+=100*r;for(let i=0,s=this.fns.length;i<s;i+=2){let o=this.fns[i+1];if(0===o)this.fns[i](r);else{o+=2*r-1;const a=Math.floor(o/20);a>0&&this.fns[i](a),this.fns[i+1]=o%20+1}}this.ing&&setTimeout(()=>this.process(),n)}add(n,r){return this.commands.push(()=>{this.fns.push(n),this.fns.push(1e3===r?1:0),this.ing=!0}),this}remove(n){return this.commands.push(()=>{const r=this.fns.indexOf(n);-1!==r&&this.fns.splice(r,2),this.ing=this.fns.length>0}),this}static#e=this.\u0275fac=function(r){return new(r||t)(z(lt))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac})}return t})(),_j=(()=>{class t{constructor(n){this.locale=n,this.demand=!1,this.leftTime=0,this.format="HH:mm:ss",this.timezone="+0000",this.formatDate=({date:r,formatStr:i,timezone:s})=>GF(new Date(r),i,this.locale,s||this.timezone||"+0000")}static#e=this.\u0275fac=function(r){return new(r||t)(z(Ps))};static#t=this.\u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),yj=(()=>{class t{set config(n){null!=n.notify&&!Array.isArray(n.notify)&&n.notify>0&&(n.notify=[n.notify]),this._config=n}get config(){return this._config}constructor(n,r,i,s,o){this.locale=n,this.timer=r,this.defCog=i,this.cdr=s,this.ngZone=o,this.frequency=1e3,this._notify={},this.status=Mr.ing,this.isDestroy=!1,this.i={},this.left=0,this.event=new fn}begin(){this.status=Mr.ing,this.callEvent("start")}restart(){this.status!==Mr.stop&&this.destroy(),this.init(),this.callEvent("restart")}stop(){this.status!==Mr.stop&&(this.status=Mr.stop,this.destroy(),this.callEvent("stop"))}pause(){this.status===Mr.stop||this.status===Mr.pause||(this.status=Mr.pause,this.callEvent("pause"))}resume(){this.status===Mr.stop||this.status!==Mr.pause||(this.status=Mr.ing,this.callEvent("resume"))}callEvent(n){this.event.emit({action:n,left:this.left,status:this.status,text:this.i.text})}init(){const{locale:n,defCog:r}=this,i=this.config={...new _j(n),...r,...this.config},s=this.frequency=~i.format.indexOf("S")?100:1e3;this.status=i.demand?Mr.pause:Mr.ing,this.getLeft();const o=this.reflow;this.reflow=(a=0,u=!1)=>o.apply(this,[a,u]),Array.isArray(i.notify)&&i.notify.forEach(a=>{if(a<1)throw new Error("The notify config must be a positive integer.");a*=1e3,this._notify[a-=a%s]=!0}),this.timer.add(this.reflow,s).start(),this.reflow(0,!0)}destroy(){return this.timer.remove(this.reflow),this}reflow(n=0,r=!1){if(this.isDestroy)return;const{status:i,config:s,_notify:o}=this;if(!r&&i!==Mr.ing)return;let a=this.left=this.left-this.frequency*n;a<1&&(a=0),this.i={value:a,text:s.formatDate({date:a,formatStr:s.format,timezone:s.timezone})},"function"==typeof s.prettyText&&(this.i.text=s.prettyText(this.i.text)),this.cdr.detectChanges(),(0===s.notify||o[a])&&this.ngZone.run(()=>{this.callEvent("notify")}),0===a&&this.ngZone.run(()=>{this.status=Mr.done,this.destroy(),this.callEvent("done")})}getLeft(){const{config:n,frequency:r}=this;let i=1e3*n.leftTime;const s=n.stopTime;!i&&s&&(i=s-(new Date).getTime()),this.left=i-i%r}ngOnInit(){this.init(),this.config.demand||this.begin()}ngOnDestroy(){this.isDestroy=!0,this.destroy()}ngOnChanges(n){n.config.firstChange||this.restart()}static#e=this.\u0275fac=function(r){return new(r||t)(X(Ps),X(mj),X(_j),X(Ag),X(lt))};static#t=this.\u0275cmp=ad({type:t,selectors:[["countdown"]],hostVars:2,hostBindings:function(r,i){2&r&&gg("count-down",!0)},inputs:{config:"config",render:"render"},outputs:{event:"event"},standalone:!0,features:[Yt([mj]),In,lD],decls:2,vars:5,consts:[[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"innerHTML"]],template:function(r,i){1&r&&(ki(0,nse,2,1,"ng-container",0),ki(1,rse,1,0,"ng-container",1)),2&r&&(Ut("ngIf",!i.render),Pt(1),Ut("ngTemplateOutlet",i.render)("ngTemplateOutletContext",function m1(t,e,n,r){return _1(W(),zn(),t,e,n,r)}(3,ise,i.i)))},dependencies:[sV,r0,nV],encapsulation:2,changeDetection:0})}return t})(),sse=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=er({type:t});static#n=this.\u0275inj=Vn({imports:[yj]})}return t})();const ose=["playerTurnCountdown"];function ase(t,e){if(1&t){const n=hu();mt(0,"button",9),Bt("click",function(){return hi(n),fi(Zn().startNewGame())}),Bn(1,"Start New Game"),_t()}}function use(t,e){if(1&t){const n=hu();mt(0,"button",9),Bt("click",function(){return hi(n),fi(Zn().changeGame())}),Bn(1,"Change Game"),_t()}}function cse(t,e){if(1&t){const n=hu();mt(0,"div",14)(1,"div",1)(2,"span",2),Bn(3,"Total Minutes of Game:"),_t(),mt(4,"input",15),Bt("ngModelChange",function(i){return hi(n),fi(Zn(2).game.minutesForGame=i)}),_t()(),mt(5,"div",16)(6,"span",2),Bn(7,"Seconds Per Turn:"),_t(),mt(8,"input",15),Bt("ngModelChange",function(i){return hi(n),fi(Zn(2).game.secondsPerTurn=i)}),_t()(),mt(9,"div",17)(10,"button",12),Bt("click",function(){return hi(n),fi(Zn(2).gameSetUpComplete())}),Bn(11,"Done"),_t()()()}if(2&t){const n=Zn(2);Pt(4),Ut("ngModel",n.game.minutesForGame),Pt(4),Ut("ngModel",n.game.secondsPerTurn)}}function lse(t,e){if(1&t){const n=hu();mt(0,"button",9),Bt("click",function(){return hi(n),fi(Zn(3).newPlayer())}),Bn(1,"New Player"),_t()}}function dse(t,e){if(1&t){const n=hu();mt(0,"button",9),Bt("click",function(){return hi(n),fi(Zn(3).changePlayer())}),Bn(1,"Change Player"),_t()}}function hse(t,e){if(1&t){const n=hu();mt(0,"div",14)(1,"div",1)(2,"span",2),Bn(3,"Player #:"),_t(),mt(4,"input",3),Bt("ngModelChange",function(i){return hi(n),fi(Zn(2).playerNumber=i)}),_t(),ki(5,lse,2,0,"button",4),ki(6,dse,2,0,"button",4),_t()()}if(2&t){const n=Zn(2);Pt(4),Ut("ngModel",n.playerNumber)("disabled",!!n.player),Pt(1),Ut("ngIf",!n.player),Pt(1),Ut("ngIf",n.player)}}function fse(t,e){if(1&t&&(mt(0,"div"),ki(1,cse,12,2,"div",7),ki(2,hse,7,4,"div",7),_t()),2&t){const n=Zn();Pt(1),Ut("ngIf",n.setUpGame),Pt(1),Ut("ngIf",!n.setUpGame)}}function pse(t,e){if(1&t){const n=hu();mt(0,"div",14)(1,"div",1)(2,"span",2),Bn(3,"Name:"),_t(),mt(4,"input",15),Bt("ngModelChange",function(i){return hi(n),fi(Zn().player.name=i)}),_t()(),mt(5,"div",16)(6,"span",2),Bn(7,"Color:"),_t(),mt(8,"input",15),Bt("ngModelChange",function(i){return hi(n),fi(Zn().player.color=i)}),_t()(),mt(9,"div",17)(10,"button",12),Bt("click",function(){return hi(n),fi(Zn().playerSetUpComplete())}),Bn(11,"Done"),_t()()()}if(2&t){const n=Zn();Pt(4),Ut("ngModel",n.player.name),Pt(4),Ut("ngModel",n.player.color)}}function gse(t,e){if(1&t&&(mt(0,"div",18)(1,"code")(2,"pre"),Bn(3),hD(4,"json"),_t()()()),2&t){const n=Zn();Pt(3),eE(fD(4,1,n.player))}}function mse(t,e){if(1&t&&(mt(0,"div",18)(1,"code")(2,"pre"),Bn(3),hD(4,"json"),_t()()()),2&t){const n=Zn();Pt(3),eE(fD(4,1,n.game))}}let _se=(()=>{class t{constructor(n,r){this.gameStore=n,this.playerStore=r,this.title="please-take-your-turn",this.setUpGame=!1,this.setUpPlayer=!1,this._gameCode="",this._playerNumber="",this.playerTurnCountdownConfig={demand:!0,leftTime:60,format:"mm:ss",notify:5}}get gameCode(){return this._gameCode}set gameCode(n){this._gameCode=n,this.gameStore.gameCode=n}get playerNumber(){return this._playerNumber}set playerNumber(n){this._playerNumber=n,this.playerStore.playerNumber=n}get game(){return this.gameStore.game}get player(){return this.playerStore.player}get myTurn(){return this.player?.myTurn}get whosTurnIsIt(){return this.game?.players?.find(n=>n.myTurn)?.name}startNewGame(){const n=this.gameStore.createGame();this.gameCode=n.code;const r=n.players[0];this.playerNumber=r.number,this.playerStore.playerNumber=r.number,this.playerStore.player=r,this.setUpGame=!0}changeGame(){this.gameCode=""}gameSetUpComplete(){if(this.game){const n=this.game;n.secondsPerTurn=+this.game.secondsPerTurn,n.minutesForGame=+this.game.minutesForGame,this.gameStore.game=n,this.playerTurnCountdownConfig.leftTime=this.game.secondsPerTurn}this.setUpGame=!1,this.setUpPlayer=!0}playerSetUpComplete(){this.playerStore.player=this.player,this.setUpPlayer=!1}startGame(){this.gameStore.startGame(),"1"===this.player?.number&&this.playerTurnCountdown?.begin()}newPlayer(){const n=this.game?.addPlayer();localStorage.setItem("PLAYER_NUM",n?.number??""),this.playerNumber=n?.number??"",this.setUpPlayer=!0}changePlayer(){this.playerNumber=""}startTurn(){this.playerTurnCountdown?.restart()}endTurn(){this.playerTurnCountdown?.stop()}static#e=this.\u0275fac=function(r){return new(r||t)(X(dS),X(dB))};static#t=this.\u0275cmp=ad({type:t,selectors:[["app-root"]],viewQuery:function(r,i){if(1&r&&M1(ose,5),2&r){let s;ID(s=function wD(){return function a8(t,e){return t[Ri].queries[e].queryList}(W(),Oy())}())&&(i.playerTurnCountdown=s.first)}},decls:27,vars:15,consts:[[1,"m-5"],[1,"input-group","input-group-lg"],["id","inputGroup-sizing-lg",1,"input-group-text"],["type","text","aria-label","Sizing example input","aria-describedby","inputGroup-sizing-lg",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","btn btn-primary","type","button",3,"click",4,"ngIf"],[4,"ngIf"],[1,"mt-4",3,"hidden"],["class","mt-4",4,"ngIf"],[3,"hidden"],["type","button",1,"btn","btn-primary",3,"click"],[3,"config"],["playerTurnCountdown",""],["type","button",1,"btn","btn-success",3,"click"],["class","box box-default",4,"ngIf"],[1,"mt-4"],["type","text","aria-label","Sizing example input","aria-describedby","inputGroup-sizing-lg",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group","input-group-lg","mt-2"],[1,"mt-2"],[1,"box","box-default"]],template:function(r,i){if(1&r&&(mt(0,"div",0)(1,"h1"),Bn(2," Welcome, Please take your turn! "),_t(),mt(3,"div",1)(4,"span",2),Bn(5,"Game #:"),_t(),mt(6,"input",3),Bt("ngModelChange",function(o){return i.gameCode=o}),_t(),ki(7,ase,2,0,"button",4),ki(8,use,2,0,"button",4),_t(),ki(9,fse,3,2,"div",5),mt(10,"div",6),ki(11,pse,12,2,"div",7),mt(12,"div",8),Bn(13),mt(14,"button",9),Bt("click",function(){return i.startGame()}),Bn(15,"Start Game"),_t()(),mt(16,"div",8),Bn(17),_t(),mt(18,"div",8)(19,"div"),fg(20,"countdown",10,11),_t(),mt(22,"div")(23,"button",12),Bt("click",function(){return i.endTurn()}),Bn(24,"Done"),_t()()()()(),ki(25,gse,5,3,"div",13),ki(26,mse,5,3,"div",13)),2&r){let s,o;Pt(6),Ut("ngModel",i.gameCode)("disabled",!!i.game),Pt(1),Ut("ngIf",!i.game),Pt(1),Ut("ngIf",i.game),Pt(1),Ut("ngIf",i.game),Pt(1),Ut("hidden",!i.player),Pt(1),Ut("ngIf",i.setUpPlayer&&i.player),Pt(1),Ut("hidden",null!==(s=null==i.game?null:i.game.inProgress)&&void 0!==s&&s||i.setUpPlayer||i.setUpGame||"1"!==i.playerNumber),Pt(1),_g(" ",null!==(o=null==i.player?null:i.player.name)&&void 0!==o?o:"Player 1"," start when you are ready. "),Pt(3),Ut("hidden",i.myTurn||!i.whosTurnIsIt),Pt(1),_g(" ",i.whosTurnIsIt," Turn. "),Pt(1),Ut("hidden",!i.myTurn),Pt(2),Ut("config",i.playerTurnCountdownConfig),Pt(5),Ut("ngIf",i.player),Pt(1),Ut("ngIf",i.game)}},dependencies:[r0,UI,VB,bS,yj,rV]})}return t})();function xS(){return t=>t.lift(new yse)}class yse{call(e,n){return n.subscribe(new vse(e))}}class vse extends Ee{constructor(e){super(e),this.hasPrev=!1}_next(e){let n;this.hasPrev?n=[this.prev,e]:this.hasPrev=!0,this.prev=e,n&&this.destination.next(n)}}var ue,Ese=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Bs={},MS=MS||{},Me=Ese||self;function QI(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Pm(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var kS="closure_uid_"+(1e9*Math.random()>>>0),wse=0;function Tse(t,e,n){return t.call.apply(t.bind,arguments)}function Cse(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function kr(t,e,n){return(kr=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Tse:Cse).apply(null,arguments)}function YI(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function sr(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Ou(){this.s=this.s,this.o=this.o}Ou.prototype.s=!1,Ou.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function Ise(t){Object.prototype.hasOwnProperty.call(t,kS)&&t[kS]||(t[kS]=++wse)}(this)},Ou.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const vj=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function OS(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function Ej(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(QI(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Or(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Or.prototype.h=function(){this.defaultPrevented=!0};var Dse=function(){if(!Me.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const n=()=>{};Me.addEventListener("test",n,e),Me.removeEventListener("test",n,e)}catch{}return t}();function Nm(t){return/^[\s\xa0]*$/.test(t)}function XI(){var t=Me.navigator;return t&&(t=t.userAgent)?t:""}function Io(t){return-1!=XI().indexOf(t)}function FS(t){return FS[" "](t),t}FS[" "]=function(){};var LS,Sse=Io("Opera"),Yh=Io("Trident")||Io("MSIE"),Ij=Io("Edge"),VS=Ij||Yh,wj=Io("Gecko")&&!(-1!=XI().toLowerCase().indexOf("webkit")&&!Io("Edge"))&&!(Io("Trident")||Io("MSIE"))&&!Io("Edge"),Rse=-1!=XI().toLowerCase().indexOf("webkit")&&!Io("Edge");function Tj(){var t=Me.document;return t?t.documentMode:void 0}e:{var US="",BS=function(){var t=XI();return wj?/rv:([^\);]+)(\)|;)/.exec(t):Ij?/Edge\/([\d\.]+)/.exec(t):Yh?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Rse?/WebKit\/(\S+)/.exec(t):Sse?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(BS&&(US=BS?BS[1]:""),Yh){var jS=Tj();if(null!=jS&&jS>parseFloat(US)){LS=String(jS);break e}}LS=US}var Pse=Me.document&&Yh&&(Tj()||parseInt(LS,10))||void 0;function xm(t,e){if(Or.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(wj){e:{try{FS(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nse[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&xm.$.h.call(this)}}sr(xm,Or);var Nse={2:"touch",3:"pen",4:"mouse"};xm.prototype.h=function(){xm.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Mm="closure_listenable_"+(1e6*Math.random()|0),xse=0;function Mse(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++xse,this.fa=this.ia=!1}function JI(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function HS(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function bj(t){const e={};for(const n in t)e[n]=t[n];return e}const Dj="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Aj(t,e){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(let s=0;s<Dj.length;s++)n=Dj[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ew(t){this.src=t,this.g={},this.h=0}function GS(t,e){var n=e.type;if(n in t.g){var s,r=t.g[n],i=vj(r,e);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(JI(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function qS(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}ew.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=qS(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new Mse(e,this.src,s,!!r,i)).ia=n,t.push(e)),e};var zS="closure_lm_"+(1e6*Math.random()|0),WS={};function Sj(t,e,n,r,i){if(r&&r.once)return Pj(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Sj(t,e[s],n,r,i);return null}return n=YS(n),t&&t[Mm]?t.O(e,n,Pm(r)?!!r.capture:!!r,i):Rj(t,e,n,!1,r,i)}function Rj(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Pm(i)?!!i.capture:!!i,a=ZS(t);if(a||(t[zS]=a=new ew(t)),(n=a.add(e,n,r,o,s)).proxy)return n;if(r=function Ose(){const e=Fse;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Dse||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(xj(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pj(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Pj(t,e[s],n,r,i);return null}return n=YS(n),t&&t[Mm]?t.P(e,n,Pm(r)?!!r.capture:!!r,i):Rj(t,e,n,!0,r,i)}function Nj(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)Nj(t,e[s],n,r,i);else r=Pm(r)?!!r.capture:!!r,n=YS(n),t&&t[Mm]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=qS(s=t.g[e],n,r,i))&&(JI(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=ZS(t))&&(e=t.g[e.toString()],t=-1,e&&(t=qS(e,n,r,i)),(n=-1<t?e[t]:null)&&KS(n))}function KS(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[Mm])GS(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(xj(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ZS(e))?(GS(n,t),0==n.h&&(n.src=null,e[zS]=null)):JI(t)}}}function xj(t){return t in WS?WS[t]:WS[t]="on"+t}function Fse(t,e){if(t.fa)t=!0;else{e=new xm(e,this);var n=t.listener,r=t.la||t.src;t.ia&&KS(t),t=n.call(r,e)}return t}function ZS(t){return(t=t[zS])instanceof ew?t:null}var QS="__closure_events_fn_"+(1e9*Math.random()>>>0);function YS(t){return"function"==typeof t?t:(t[QS]||(t[QS]=function(e){return t.handleEvent(e)}),t[QS])}function or(){Ou.call(this),this.i=new ew(this),this.S=this,this.J=null}function Tr(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,"string"==typeof e)e=new Or(e,t);else if(e instanceof Or)e.target=e.target||t;else{var i=e;Aj(e=new Or(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=tw(o,r,!0,e)&&i}if(i=tw(o=e.g=t,r,!0,e)&&i,i=tw(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=tw(o=e.g=n[s],r,!1,e)&&i}function tw(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,u=o.la||o.src;o.ia&&GS(t.i,o),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}sr(or,Ou),or.prototype[Mm]=!0,or.prototype.removeEventListener=function(t,e,n,r){Nj(this,t,e,n,r)},or.prototype.N=function(){if(or.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)JI(n[r]);delete t.g[e],t.h--}}this.J=null},or.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},or.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var XS=Me.JSON.stringify;function Lse(){var t=JS;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Mj=new class Vse{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new Bse,t=>t.reset());class Bse{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function jse(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function $se(t){Me.setTimeout(()=>{throw t},0)}let km,Om=!1,JS=new class Use{constructor(){this.h=this.g=null}add(e,n){const r=Mj.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},kj=()=>{const t=Me.Promise.resolve(void 0);km=()=>{t.then(Hse)}};var Hse=()=>{for(var t;t=Lse();){try{t.h.call(t.g)}catch(n){$se(n)}var e=Mj;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Om=!1};function nw(t,e){or.call(this),this.h=t||1,this.g=e||Me,this.j=kr(this.qb,this),this.l=Date.now()}function eR(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function tR(t,e,n){if("function"==typeof t)n&&(t=kr(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=kr(t.handleEvent,t)}return 2147483647<Number(e)?-1:Me.setTimeout(t,e||0)}function Oj(t){t.g=tR(()=>{t.g=null,t.i&&(t.i=!1,Oj(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}sr(nw,or),(ue=nw.prototype).ga=!1,ue.T=null,ue.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Tr(this,"tick"),this.ga&&(eR(this),this.start()))}},ue.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},ue.N=function(){nw.$.N.call(this),eR(this),delete this.g};class Gse extends Ou{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Oj(this)}N(){super.N(),this.g&&(Me.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Fm(t){Ou.call(this),this.h=t,this.g={}}sr(Fm,Ou);var Fj=[];function Vj(t,e,n,r){Array.isArray(n)||(n&&(Fj[0]=n.toString()),n=Fj);for(var i=0;i<n.length;i++){var s=Sj(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Lj(t){HS(t.g,function(e,n){this.g.hasOwnProperty(n)&&KS(e)},t),t.g={}}function rw(){this.g=!0}function Xh(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Kse(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return XS(n)}catch{return e}}(t,n)+(r?" "+r:"")})}Fm.prototype.N=function(){Fm.$.N.call(this),Lj(this)},Fm.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},rw.prototype.Ea=function(){this.g=!1},rw.prototype.info=function(){};var _l={},Uj=null;function iw(){return Uj=Uj||new or}function Bj(t){Or.call(this,_l.Ta,t)}function Vm(t){const e=iw();Tr(e,new Bj(e))}function jj(t,e){Or.call(this,_l.STAT_EVENT,t),this.stat=e}function Xr(t){const e=iw();Tr(e,new jj(e,t))}function $j(t,e){Or.call(this,_l.Ua,t),this.size=e}function Lm(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Me.setTimeout(function(){t()},e)}_l.Ta="serverreachability",sr(Bj,Or),_l.STAT_EVENT="statevent",sr(jj,Or),_l.Ua="timingevent",sr($j,Or);var sw={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Hj={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function nR(){}function qj(){}nR.prototype.h=null;var sR,Um={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function rR(){Or.call(this,"d")}function iR(){Or.call(this,"c")}function ow(){}function Bm(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Fm(this),this.P=Zse,this.V=new nw(t=VS?125:void 0),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new zj}function zj(){this.i=null,this.g="",this.h=!1}sr(rR,Or),sr(iR,Or),sr(ow,nR),ow.prototype.g=function(){return new XMLHttpRequest},ow.prototype.i=function(){return{}},sR=new ow;var Zse=45e3,Wj={},oR={};function aR(t,e,n){t.L=1,t.A=lw(Ea(e)),t.u=n,t.S=!0,Kj(t,null)}function Kj(t,e){t.G=Date.now(),jm(t),t.B=Ea(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),i$(n.i,"t",r),t.o=0,n=t.l.J,t.h=new zj,t.g=S$(t.l,n?e:null,!t.u),0<t.O&&(t.M=new Gse(kr(t.Pa,t,t.g),t.O)),Vj(t.U,t.g,"readystatechange",t.nb),e=t.I?bj(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Vm(),function qse(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var d=a[u].split("=");if(1<d.length){var f=d[0];d=d[1];var g=f.split("_");o=2<=g.length&&"type"==g[1]?o+(f+"=")+d+"&":o+(f+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o})}(t.j,t.v,t.B,t.m,t.W,t.u)}function Zj(t){return!!t.g&&"GET"==t.v&&2!=t.L&&t.l.Ha}function Qj(t,e,n){let i,r=!0;for(;!t.J&&t.o<n.length;){if(i=Qse(t,n),i==oR){4==e&&(t.s=4,Xr(14),r=!1),Xh(t.j,t.m,null,"[Incomplete Response]");break}if(i==Wj){t.s=4,Xr(15),Xh(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}Xh(t.j,t.m,i,null),uR(t,i)}Zj(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,Xr(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),gR(e),e.M=!0,Xr(11))):(Xh(t.j,t.m,n,"[Invalid Chunked Response]"),yl(t),$m(t))}function Qse(t,e){var n=t.o,r=e.indexOf("\n",n);return-1==r?oR:(n=Number(e.substring(n,r)),isNaN(n)?Wj:(r+=1)+n>e.length?oR:(e=e.slice(r,r+n),t.o=r+n,e))}function jm(t){t.Y=Date.now()+t.P,Yj(t,t.P)}function Yj(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=Lm(kr(t.lb,t),e)}function aw(t){t.C&&(Me.clearTimeout(t.C),t.C=null)}function $m(t){0==t.l.H||t.J||C$(t.l,t)}function yl(t){aw(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,eR(t.V),Lj(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function uR(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||cR(n.i,t)))if(!t.K&&cR(n.i,t)&&3==n.H){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break e;mw(n),pw(n)}pR(n),Xr(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=Lm(kr(n.ib,n),6e3));if(1>=a$(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else El(n,11)}else if((t.K||n.g==t)&&mw(n),!Nm(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let d=i[e];if(n.V=d[0],d=d[1],2==n.H)if("c"==d[0]){n.K=d[1],n.pa=d[2];const f=d[3];null!=f&&(n.ra=f,n.l.info("VER="+n.ra));const g=d[4];null!=g&&(n.Ga=g,n.l.info("SVER="+n.Ga));const m=d[5];null!=m&&"number"==typeof m&&0<m&&(n.L=r=1.5*m,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const y=t.g;if(y){const E=y.g?y.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(E){var s=r.i;s.g||-1==E.indexOf("spdy")&&-1==E.indexOf("quic")&&-1==E.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(lR(s,s.h),s.h=null))}if(r.F){const C=y.g?y.g.getResponseHeader("X-HTTP-Session-Id"):null;C&&(r.Da=C,Xt(r.I,r.F,C))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((r=n).wa=A$(r,r.J?r.pa:null,r.Y),o.K){u$(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.C&&(aw(a),jm(a)),r.g=o}else w$(r);0<n.j.length&&gw(n)}else"stop"!=d[0]&&"close"!=d[0]||El(n,7);else 3==n.H&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?El(n,7):fR(n):"noop"!=d[0]&&n.h&&n.h.Aa(d),n.A=0)}Vm()}catch{}}function Xj(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(QI(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function Xse(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(QI(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function Yse(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(QI(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}(ue=Bm.prototype).setTimeout=function(t){this.P=t},ue.nb=function(t){t=t.target;const e=this.M;e&&3==wo(t)?e.l():this.Pa(t)},ue.Pa=function(t){try{if(t==this.g)e:{const f=wo(this.g);var e=this.g.Ia();if(this.g.da(),!(3>f)&&(3!=f||VS||this.g&&(this.h.h||this.g.ja()||m$(this.g)))){this.J||4!=f||7==e||Vm(),aw(this);var n=this.g.da();this.ca=n;t:if(Zj(this)){var r=m$(this.g);t="";var i=r.length,s=4==wo(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){yl(this),$m(this);var o="";break t}this.h.i=new Me.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function zse(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o})}(this.j,this.v,this.B,this.m,this.W,f,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Nm(a)){var d=a;break t}}d=null}if(!(n=d)){this.i=!1,this.s=3,Xr(12),yl(this),$m(this);break e}Xh(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,uR(this,n)}this.S?(Qj(this,f,o),VS&&this.i&&3==f&&(Vj(this.U,this.V,"tick",this.mb),this.V.start())):(Xh(this.j,this.m,o,null),uR(this,o)),4==f&&yl(this),this.i&&!this.J&&(4==f?C$(this.l,this):(this.i=!1,jm(this)))}else(function moe(t){const e={};t=(t.g&&2<=wo(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<t.length;r++){if(Nm(t[r]))continue;var n=jse(t[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}!function kse(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,function(r){return r.join(", ")})})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Xr(12)):(this.s=0,Xr(13)),yl(this),$m(this)}}}catch{}},ue.mb=function(){if(this.g){var t=wo(this.g),e=this.g.ja();this.o<e.length&&(aw(this),Qj(this,t,e),this.i&&4!=t&&jm(this))}},ue.cancel=function(){this.J=!0,yl(this)},ue.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function Wse(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.j,this.B),2!=this.L&&(Vm(),Xr(17)),yl(this),this.s=2,$m(this)):Yj(this,this.Y-t)};var Jj=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vl(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof vl){this.h=t.h,uw(this,t.j),this.s=t.s,this.g=t.g,cw(this,t.m),this.l=t.l;var e=t.i,n=new qm;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),e$(this,n),this.o=t.o}else t&&(e=String(t).match(Jj))?(this.h=!1,uw(this,e[1]||"",!0),this.s=Hm(e[2]||""),this.g=Hm(e[3]||"",!0),cw(this,e[4]),this.l=Hm(e[5]||"",!0),e$(this,e[6]||"",!0),this.o=Hm(e[7]||"")):(this.h=!1,this.i=new qm(null,this.h))}function Ea(t){return new vl(t)}function uw(t,e,n){t.j=n?Hm(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function cw(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function e$(t,e,n){e instanceof qm?(t.i=e,function soe(t,e){e&&!t.j&&(Fu(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(n$(this,r),i$(this,i,n))},t)),t.j=e}(t.i,t.h)):(n||(e=Gm(e,roe)),t.i=new qm(e,t.h))}function Xt(t,e,n){t.i.set(e,n)}function lw(t){return Xt(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Hm(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Gm(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,eoe),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function eoe(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}vl.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Gm(e,t$,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Gm(e,t$,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(Gm(n,"/"==n.charAt(0)?noe:toe,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Gm(n,ioe)),t.join("")};var t$=/[#\/\?@]/g,toe=/[#\?:]/g,noe=/[#\?]/g,roe=/[#\?@]/g,ioe=/#/g;function qm(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Fu(t){t.g||(t.g=new Map,t.h=0,t.i&&function Jse(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function n$(t,e){Fu(t),e=Jh(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function r$(t,e){return Fu(t),e=Jh(t,e),t.g.has(e)}function i$(t,e,n){n$(t,e),0<n.length&&(t.i=null,t.g.set(Jh(t,e),OS(n)),t.h+=n.length)}function Jh(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function s$(t){this.l=t||aoe,t=Me.PerformanceNavigationTiming?0<(t=Me.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Me.g&&Me.g.Ka&&Me.g.Ka()&&Me.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(ue=qm.prototype).add=function(t,e){Fu(this),this.i=null,t=Jh(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},ue.forEach=function(t,e){Fu(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)},ue.ta=function(){Fu(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n},ue.Z=function(t){Fu(this);let e=[];if("string"==typeof t)r$(this,t)&&(e=e.concat(this.g.get(Jh(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},ue.set=function(t,e){return Fu(this),this.i=null,r$(this,t=Jh(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},ue.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},ue.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};var aoe=10;function o$(t){return!!t.h||!!t.g&&t.g.size>=t.j}function a$(t){return t.h?1:t.g?t.g.size:0}function cR(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function lR(t,e){t.g?t.g.add(e):t.h=e}function u$(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function c$(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return OS(t.i)}s$.prototype.cancel=function(){if(this.i=c$(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var uoe=class{stringify(t){return Me.JSON.stringify(t,void 0)}parse(t){return Me.JSON.parse(t,void 0)}};function coe(){this.g=new uoe}function loe(t,e,n){const r=n||"";try{Xj(t,function(i,s){let o=i;Pm(i)&&(o=XS(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function dw(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function zm(t){this.l=t.ec||null,this.j=t.ob||!1}function hw(t,e){or.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=dR,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}sr(zm,nR),zm.prototype.g=function(){return new hw(this.l,this.j)},zm.prototype.i=function(t){return function(){return t}}({}),sr(hw,or);var dR=0;function l$(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function Wm(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Km(t)}function Km(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(ue=hw.prototype).open=function(t,e){if(this.readyState!=dR)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Km(this)},ue.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Me).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},ue.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Wm(this)),this.readyState=dR},ue.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Km(this)),this.g&&(this.readyState=3,Km(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Me.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;l$(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},ue.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Wm(this):Km(this),3==this.readyState&&l$(this)}},ue.Za=function(t){this.g&&(this.response=this.responseText=t,Wm(this))},ue.Ya=function(t){this.g&&(this.response=t,Wm(this))},ue.ka=function(){this.g&&Wm(this)},ue.setRequestHeader=function(t,e){this.v.append(t,e)},ue.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},ue.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(hw.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var hoe=Me.JSON.parse;function Tn(t){or.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=d$,this.L=this.M=!1}sr(Tn,or);var d$="",foe=/^https?$/i,poe=["POST","PUT"];function h$(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,f$(t),fw(t)}function f$(t){t.F||(t.F=!0,Tr(t,"complete"),Tr(t,"error"))}function p$(t){if(t.h&&typeof MS<"u"&&(!t.C[1]||4!=wo(t)||2!=t.da()))if(t.v&&4==wo(t))tR(t.La,0,t);else if(Tr(t,"readystatechange"),4==wo(t)){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=0===o){var i=String(t.I).match(Jj)[1]||null;!i&&Me.self&&Me.self.location&&(i=Me.self.location.protocol.slice(0,-1)),r=!foe.test(i?i.toLowerCase():"")}n=r}if(n)Tr(t,"complete"),Tr(t,"success");else{t.m=6;try{var s=2<wo(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",f$(t)}}finally{fw(t)}}}function fw(t,e){if(t.g){g$(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Tr(t,"ready");try{n.onreadystatechange=r}catch{}}}function g$(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Me.clearTimeout(t.A),t.A=null)}function wo(t){return t.g?t.g.readyState:0}function m$(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case d$:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function _$(t){let e="";return HS(t,function(n,r){e+=r,e+=":",e+=n,e+="\r\n"}),e}function hR(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=_$(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Xt(t,e,n))}function Zm(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function y$(t){this.Ga=0,this.j=[],this.l=new rw,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Zm("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Zm("baseRetryDelayMs",5e3,t),this.hb=Zm("retryDelaySeedMs",1e4,t),this.eb=Zm("forwardChannelMaxRetries",2,t),this.xa=Zm("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new s$(t&&t.concurrentRequestLimit),this.Ja=new coe,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function fR(t){if(v$(t),3==t.H){var e=t.W++,n=Ea(t.I);if(Xt(n,"SID",t.K),Xt(n,"RID",e),Xt(n,"TYPE","terminate"),Qm(t,n),(e=new Bm(t,t.l,e)).L=2,e.A=lw(Ea(n)),n=!1,Me.navigator&&Me.navigator.sendBeacon)try{n=Me.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Me.Image&&((new Image).src=e.A,n=!0),n||(e.g=S$(e.l,null),e.g.ha(e.A)),e.G=Date.now(),jm(e)}D$(t)}function pw(t){t.g&&(gR(t),t.g.cancel(),t.g=null)}function v$(t){pw(t),t.u&&(Me.clearTimeout(t.u),t.u=null),mw(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Me.clearTimeout(t.m),t.m=null)}function gw(t){if(!o$(t.i)&&!t.m){t.m=!0;var e=t.Na;km||kj(),Om||(km(),Om=!0),JS.add(e,t),t.C=0}}function E$(t,e){var n;n=e?e.m:t.W++;const r=Ea(t.I);Xt(r,"SID",t.K),Xt(r,"RID",n),Xt(r,"AID",t.V),Qm(t,r),t.o&&t.s&&hR(r,t.o,t.s),n=new Bm(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=I$(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),lR(t.i,n),aR(n,r,e)}function Qm(t,e){t.na&&HS(t.na,function(n,r){Xt(e,r,n)}),t.h&&Xj({},function(n,r){Xt(e,r,n)})}function I$(t,e,n){n=Math.min(t.j.length,n);var r=t.h?kr(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){const o=["count="+n];-1==s?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<n;u++){let d=i[u].g;const f=i[u].map;if(d-=s,0>d)s=Math.max(0,i[u].g-100),a=!1;else try{loe(f,o,"req"+d+"_")}catch{r&&r(f)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function w$(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;km||kj(),Om||(km(),Om=!0),JS.add(e,t),t.A=0}}function pR(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=Lm(kr(t.Ma,t),b$(t,t.A)),t.A++,0))}function gR(t){null!=t.B&&(Me.clearTimeout(t.B),t.B=null)}function T$(t){t.g=new Bm(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=Ea(t.wa);Xt(e,"RID","rpc"),Xt(e,"SID",t.K),Xt(e,"AID",t.V),Xt(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Xt(e,"TO",t.qa),Xt(e,"TYPE","xmlhttp"),Qm(t,e),t.o&&t.s&&hR(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=lw(Ea(e)),n.u=null,n.S=!0,Kj(n,t)}function mw(t){null!=t.v&&(Me.clearTimeout(t.v),t.v=null)}function C$(t,e){var n=null;if(t.g==e){mw(t),gR(t),t.g=null;var r=2}else{if(!cR(t.i,e))return;n=e.F,u$(t.i,e),r=1}if(0!=t.H)if(e.i)if(1==r){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;Tr(r=iw(),new $j(r,n)),gw(t)}else w$(t);else if(3==(i=e.s)||0==i&&0<e.ca||!(1==r&&function _oe(t,e){return!(a$(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=Lm(kr(t.Na,t,e),b$(t,t.C)),t.C++,0)))}(t,e)||2==r&&pR(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:El(t,5);break;case 4:El(t,10);break;case 3:El(t,6);break;default:El(t,2)}}function b$(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function El(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var r=kr(t.pb,t);n||(n=new vl("//www.google.com/images/cleardot.gif"),Me.location&&"http"==Me.location.protocol||uw(n,"https"),lw(n)),function doe(t,e){const n=new rw;if(Me.Image){const r=new Image;r.onload=YI(dw,n,r,"TestLoadImage: loaded",!0,e),r.onerror=YI(dw,n,r,"TestLoadImage: error",!1,e),r.onabort=YI(dw,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=YI(dw,n,r,"TestLoadImage: timeout",!1,e),Me.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Xr(2);t.H=0,t.h&&t.h.za(e),D$(t),v$(t)}function D$(t){if(t.H=0,t.ma=[],t.h){const e=c$(t.i);(0!=e.length||0!=t.j.length)&&(Ej(t.ma,e),Ej(t.ma,t.j),t.i.i.length=0,OS(t.j),t.j.length=0),t.h.ya()}}function A$(t,e,n){var r=n instanceof vl?Ea(n):new vl(n);if(""!=r.g)e&&(r.g=e+"."+r.g),cw(r,r.m);else{var i=Me.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new vl(null);r&&uw(s,r),e&&(s.g=e),i&&cw(s,i),n&&(s.l=n),r=s}return e=t.Da,(n=t.F)&&e&&Xt(r,n,e),Xt(r,"VER",t.ra),Qm(t,r),r}function S$(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Tn(t.Ha&&!t.va?new zm({ob:n}):t.va)).Oa(t.J),e}function R$(){}function _w(){if(Yh&&!(10<=Number(Pse)))throw Error("Environmental error: no available transport.")}function Ui(t,e){or.call(this),this.g=new y$(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Nm(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Nm(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new ef(this)}function P$(t){rR.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function N$(){iR.call(this),this.status=1}function ef(t){this.g=t}function js(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function mR(t,e,n){n||(n=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;var s=t.g[3],o=(e=t.g[0])+(s^(n=t.g[1])&((i=t.g[2])^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}function Dt(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=0|t[i];r&&s==e||(n[i]=s,r=!1)}this.g=n}(ue=Tn.prototype).Oa=function(t){this.M=t},ue.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():sR.g(),this.C=function Gj(t){return t.h||(t.h=t.i())}(this.u?this.u:sR),this.g.onreadystatechange=kr(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){return void h$(this,s)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const s of r.keys())n.set(s,r.get(s))}r=Array.from(n.keys()).find(s=>"content-type"==s.toLowerCase()),i=Me.FormData&&t instanceof Me.FormData,!(0<=vj(poe,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{g$(this),0<this.B&&((this.L=function goe(t){return Yh&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=kr(this.ua,this)):this.A=tR(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){h$(this,s)}},ue.ua=function(){typeof MS<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Tr(this,"timeout"),this.abort(8))},ue.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Tr(this,"complete"),Tr(this,"abort"),fw(this))},ue.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),fw(this,!0)),Tn.$.N.call(this)},ue.La=function(){this.s||(this.G||this.v||this.l?p$(this):this.kb())},ue.kb=function(){p$(this)},ue.isActive=function(){return!!this.g},ue.da=function(){try{return 2<wo(this)?this.g.status:-1}catch{return-1}},ue.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},ue.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),hoe(e)}},ue.Ia=function(){return this.m},ue.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(ue=y$.prototype).ra=8,ue.H=1,ue.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new Bm(this,this.l,t);let s=this.s;if(this.U&&(s?(s=bj(s),Aj(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break e}if(4096===e||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=I$(this,i,e),Xt(n=Ea(this.I),"RID",t),Xt(n,"CVER",22),this.F&&Xt(n,"X-HTTP-Session-Id",this.F),Qm(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(_$(s)))+"&"+e:this.o&&hR(n,this.o,s)),lR(this.i,i),this.bb&&Xt(n,"TYPE","init"),this.P?(Xt(n,"$req",e),Xt(n,"SID","null"),i.aa=!0,aR(i,n,null)):aR(i,n,e),this.H=2}}else 3==this.H&&(t?E$(this,t):0==this.j.length||o$(this.i)||E$(this))},ue.Ma=function(){if(this.u=null,T$(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Lm(kr(this.jb,this),t)}},ue.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Xr(10),pw(this),T$(this))},ue.ib=function(){null!=this.v&&(this.v=null,pw(this),pR(this),Xr(19))},ue.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Xr(2)):(this.l.info("Failed to ping google.com"),Xr(1))},ue.isActive=function(){return!!this.h&&this.h.isActive(this)},(ue=R$.prototype).Ba=function(){},ue.Aa=function(){},ue.za=function(){},ue.ya=function(){},ue.isActive=function(){return!0},ue.Va=function(){},_w.prototype.g=function(t,e){return new Ui(t,e)},sr(Ui,or),Ui.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Xr(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=A$(t,null,t.Y),gw(t)},Ui.prototype.close=function(){fR(this.g)},Ui.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=XS(t),t=n);e.j.push(new class{constructor(t,e){this.g=t,this.map=e}}(e.fb++,t)),3==e.H&&gw(e)},Ui.prototype.N=function(){this.g.h=null,delete this.j,fR(this.g),delete this.g,Ui.$.N.call(this)},sr(P$,rR),sr(N$,iR),sr(ef,R$),ef.prototype.Ba=function(){Tr(this.g,"a")},ef.prototype.Aa=function(t){Tr(this.g,new P$(t))},ef.prototype.za=function(t){Tr(this.g,new N$)},ef.prototype.ya=function(){Tr(this.g,"b")},sr(js,function yoe(){this.blockSize=-1}),js.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},js.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=n;)mR(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){mR(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){mR(this,r),i=0;break}}this.h=i,this.i+=e},js.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var voe={};function _R(t){return-128<=t&&128>t?function Ase(t,e){var n=voe;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(e){return new Dt([0|e],0>e?-1:0)}):new Dt([0|t],0>t?-1:0)}function To(t){if(isNaN(t)||!isFinite(t))return tf;if(0>t)return Cr(To(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=yR;return new Dt(e,0)}var yR=4294967296,tf=_R(0),vR=_R(1),M$=_R(16777216);function Ia(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function hs(t){return-1==t.h}function Cr(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Dt(n,~t.h).add(vR)}function yw(t,e){return t.add(Cr(e))}function vw(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Ym(t,e){this.g=t,this.h=e}function Ew(t,e){if(Ia(e))throw Error("division by zero");if(Ia(t))return new Ym(tf,tf);if(hs(t))return e=Ew(Cr(t),e),new Ym(Cr(e.g),Cr(e.h));if(hs(e))return e=Ew(t,Cr(e)),new Ym(Cr(e.g),e.h);if(30<t.g.length){if(hs(t)||hs(e))throw Error("slowDivide_ only works with positive integers.");for(var n=vR,r=e;0>=r.X(t);)n=k$(n),r=k$(r);var i=nf(n,1),s=nf(r,1);for(r=nf(r,2),n=nf(n,2);!Ia(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=nf(r,1),n=nf(n,1)}return e=yw(t,i.R(e)),new Ym(i,e)}for(i=tf;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=To(n)).R(e);hs(o)||0<o.X(t);)o=(s=To(n-=r)).R(e);Ia(s)&&(s=vR),i=i.add(s),t=yw(t,o)}return new Ym(i,t)}function k$(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Dt(n,t.h)}function nf(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Dt(i,t.h)}(ue=Dt.prototype).ea=function(){if(hs(this))return-Cr(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:yR+r)*e,e*=yR}return t},ue.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(Ia(this))return"0";if(hs(this))return"-"+Cr(this).toString(t);for(var e=To(Math.pow(t,6)),n=this,r="";;){var i=Ew(n,e).g,s=((0<(n=yw(n,i.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(Ia(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},ue.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},ue.X=function(t){return hs(t=yw(this,t))?-1:Ia(t)?0:1},ue.abs=function(){return hs(this)?Cr(this):this},ue.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&t.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,n[i]=(o&=65535)<<16|(s&=65535)}return new Dt(n,-2147483648&n[n.length-1]?-1:0)},ue.R=function(t){if(Ia(this)||Ia(t))return tf;if(hs(this))return hs(t)?Cr(this).R(Cr(t)):Cr(Cr(this).R(t));if(hs(t))return Cr(this.R(Cr(t)));if(0>this.X(M$)&&0>t.X(M$))return To(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=t.D(i)>>>16,u=65535&t.D(i);n[2*r+2*i]+=o*u,vw(n,2*r+2*i),n[2*r+2*i+1]+=s*u,vw(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,vw(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,vw(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Dt(n,0)},ue.gb=function(t){return Ew(this,t).h},ue.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Dt(n,this.h&t.h)},ue.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Dt(n,this.h|t.h)},ue.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Dt(n,this.h^t.h)},_w.prototype.createWebChannel=_w.prototype.g,Ui.prototype.send=Ui.prototype.u,Ui.prototype.open=Ui.prototype.m,Ui.prototype.close=Ui.prototype.close,sw.NO_ERROR=0,sw.TIMEOUT=8,sw.HTTP_ERROR=6,Hj.COMPLETE="complete",qj.EventType=Um,Um.OPEN="a",Um.CLOSE="b",Um.ERROR="c",Um.MESSAGE="d",or.prototype.listen=or.prototype.O,Tn.prototype.listenOnce=Tn.prototype.P,Tn.prototype.getLastError=Tn.prototype.Sa,Tn.prototype.getLastErrorCode=Tn.prototype.Ia,Tn.prototype.getStatus=Tn.prototype.da,Tn.prototype.getResponseJson=Tn.prototype.Wa,Tn.prototype.getResponseText=Tn.prototype.ja,Tn.prototype.send=Tn.prototype.ha,Tn.prototype.setWithCredentials=Tn.prototype.Oa,js.prototype.digest=js.prototype.l,js.prototype.reset=js.prototype.reset,js.prototype.update=js.prototype.j,Dt.prototype.add=Dt.prototype.add,Dt.prototype.multiply=Dt.prototype.R,Dt.prototype.modulo=Dt.prototype.gb,Dt.prototype.compare=Dt.prototype.X,Dt.prototype.toNumber=Dt.prototype.ea,Dt.prototype.toString=Dt.prototype.toString,Dt.prototype.getBits=Dt.prototype.D,Dt.fromNumber=To,Dt.fromString=function x$(t,e){if(0==t.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==t.charAt(0))return Cr(x$(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=To(Math.pow(e,8)),r=tf,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=To(Math.pow(e,s)),r=r.R(s).add(To(o))):r=(r=r.R(n)).add(To(o))}return r};var Eoe=Bs.createWebChannelTransport=function(){return new _w},Ioe=Bs.getStatEventTarget=function(){return iw()},ER=Bs.ErrorCode=sw,woe=Bs.EventType=Hj,Toe=Bs.Event=_l,O$=Bs.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Iw=(Bs.FetchXmlHttpFactory=zm,Bs.WebChannel=qj),Coe=Bs.XhrIo=Tn,boe=Bs.Md5=js,rf=Bs.Integer=Dt;const F$="@firebase/firestore";class ar{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ar.UNAUTHENTICATED=new ar(null),ar.GOOGLE_CREDENTIALS=new ar("google-credentials-uid"),ar.FIRST_PARTY=new ar("first-party-uid"),ar.MOCK_USER=new ar("mock-user");let sf="10.7.0";const Vu=new Fi.Yd("@firebase/firestore");function af(){return Vu.logLevel}function Y(t,...e){if(Vu.logLevel<=Fi.in.DEBUG){const n=e.map(IR);Vu.debug(`Firestore (${sf}): ${t}`,...n)}}function kn(t,...e){if(Vu.logLevel<=Fi.in.ERROR){const n=e.map(IR);Vu.error(`Firestore (${sf}): ${t}`,...n)}}function wi(t,...e){if(Vu.logLevel<=Fi.in.WARN){const n=e.map(IR);Vu.warn(`Firestore (${sf}): ${t}`,...n)}}function IR(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch{return t}}function he(t="Unexpected state"){const e=`FIRESTORE (${sf}) INTERNAL ASSERTION FAILED: `+t;throw kn(e),new Error(e)}function me(t,e){t||he()}function ie(t,e){return t}const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Z extends I.ZR{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Yn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}class V${constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Soe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ar.UNAUTHENTICATED))}shutdown(){}}class Roe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Poe{constructor(e){this.t=e,this.currentUser=ar.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){var r=this;let i=this.i;const s=d=>this.i!==i?(i=this.i,n(d)):Promise.resolve();let o=new Yn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Yn,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const d=o;e.enqueueRetryable((0,$.Z)(function*(){yield d.promise,yield s(r.currentUser)}))},u=d=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(d=>u(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?u(d):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Yn)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(me("string"==typeof r.accessToken),new V$(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return me(null===e||"string"==typeof e),new ar(e)}}class Noe{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=ar.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class xoe{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Noe(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(ar.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class L${constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Moe{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=s=>{null!=s.error&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Y("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(me("string"==typeof n.token),this.R=n.token,new L$(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function koe(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class U${static newId(){const n=62*Math.floor(256/62);let r="";for(;r.length<20;){const i=koe(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return r}}function Ne(t,e){return t<e?-1:t>e?1:0}function uf(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function B$(t){return t+"\0"}class an{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Z(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Z(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new Z(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Z(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return an.fromMillis(Date.now())}static fromDate(e){return an.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new an(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ne(this.nanoseconds,e.nanoseconds):Ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class _e{constructor(e){this.timestamp=e}static fromTimestamp(e){return new _e(e)}static min(){return new _e(new an(0,0))}static max(){return new _e(new an(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Xm{constructor(e,n,r){void 0===n?n=0:n>e.length&&he(),void 0===r?r=e.length-n:r>e.length-n&&he(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return 0===Xm.comparator(this,e)}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Xm?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class dt extends Xm{construct(e,n,r){return new dt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Z(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new dt(n)}static emptyPath(){return new dt([])}}const Ooe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Jt extends Xm{construct(e,n,r){return new Jt(e,n,r)}static isValidIdentifier(e){return Ooe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Jt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Jt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(0===r.length)throw new Z(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new Z(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Z(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===a?(o=!o,i++):"."!==a||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new Z(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Jt(n)}static emptyPath(){return new Jt([])}}class se{constructor(e){this.path=e}static fromPath(e){return new se(dt.fromString(e))}static fromName(e){return new se(dt.fromString(e).popFirst(5))}static empty(){return new se(dt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===dt.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,n){return dt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new se(new dt(e.slice()))}}class cf{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function wR(t){return t.fields.find(e=>2===e.kind)}function Il(t){return t.fields.filter(e=>2!==e.kind)}cf.UNKNOWN_ID=-1;class wl{constructor(e,n){this.fieldPath=e,this.kind=n}}class lf{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new lf(0,Bi.min())}}function j$(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=_e.fromTimestamp(1e9===r?new an(n+1,0):new an(n,r));return new Bi(i,se.empty(),e)}function $$(t){return new Bi(t.readTime,t.key,-1)}class Bi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Bi(_e.min(),se.empty(),-1)}static max(){return new Bi(_e.max(),se.empty(),-1)}}function TR(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=se.comparator(t.documentKey,e.documentKey),0!==n?n:Ne(t.largestBatchId,e.largestBatchId))}const H$="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class G${constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Lu(t){return CR.apply(this,arguments)}function CR(){return CR=(0,$.Z)(function*(t){if(t.code!==F.FAILED_PRECONDITION||t.message!==H$)throw t;Y("LocalStore","Unexpectedly lost primary lease")}),CR.apply(this,arguments)}class N{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&he(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new N((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof N?n:N.resolve(n)}catch(n){return N.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):N.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):N.reject(n)}static resolve(e){return new N((n,r)=>{n(e)})}static reject(e){return new N((n,r)=>{r(e)})}static waitFor(e){return new N((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=N.resolve(!1);for(const r of e)n=n.next(i=>i?N.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new N((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const d=u;n(e[d]).next(f=>{o[d]=f,++a,a===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new N((r,i)=>{const s=()=>{!0===e()?n().next(()=>{s()},i):r()};s()})}}class ww{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Yn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Jm(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=bR(r.target.error);this.V.reject(new Jm(e,i))}}static open(e,n,r,i){try{return new ww(n,e.transaction(i,r))}catch(s){throw new Jm(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Y("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const n=this.transaction.objectStore(e);return new Uoe(n)}}class $s{constructor(e,n,r){this.name=e,this.version=n,this.p=r,12.2===$s.S((0,I.z$)())&&kn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Y("SimpleDb","Removing database:",e),Tl(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,I.hl)())return!1;if($s.C())return!0;const e=(0,I.z$)(),n=$s.S(e),r=0<n&&n<10,i=$s.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.F)}static M(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){var n=this;return(0,$.Z)(function*(){return n.db||(Y("SimpleDb","Opening database:",n.name),n.db=yield new Promise((r,i)=>{const s=indexedDB.open(n.name,n.version);s.onsuccess=o=>{r(o.target.result)},s.onblocked=()=>{i(new Jm(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;i("VersionError"===a.name?new Z(F.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new Z(F.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new Jm(e,a))},s.onupgradeneeded=o=>{Y("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',o.oldVersion),n.p.N(o.target.result,s.transaction,o.oldVersion,n.version).next(()=>{Y("SimpleDb","Database upgrade to version "+n.version+" complete")})}})),n.B&&(n.db.onversionchange=r=>n.B(r)),n.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){var s=this;return(0,$.Z)(function*(){const o="readonly"===n;let a=0;for(;;){++a;try{s.db=yield s.O(e);const u=ww.open(s.db,e,o?"readonly":"readwrite",r),d=i(u).next(f=>(u.g(),f)).catch(f=>(u.abort(f),N.reject(f))).toPromise();return d.catch(()=>{}),yield u.m,d}catch(u){const d=u,f="FirebaseError"!==d.name&&a<3;if(Y("SimpleDb","Transaction failed with error:",d.message,"Retrying:",f),s.close(),!f)return Promise.reject(d)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Loe{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Tl(this.k.delete())}}class Jm extends Z{constructor(e,n){super(F.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Uu(t){return"IndexedDbTransactionError"===t.name}class Uoe{constructor(e){this.store=e}put(e,n){let r;return void 0!==n?(Y("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(Y("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Tl(r)}add(e){return Y("SimpleDb","ADD",this.store.name,e,e),Tl(this.store.add(e))}get(e){return Tl(this.store.get(e)).next(n=>(void 0===n&&(n=null),Y("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return Y("SimpleDb","DELETE",this.store.name,e),Tl(this.store.delete(e))}count(){return Y("SimpleDb","COUNT",this.store.name),Tl(this.store.count())}W(e,n){const r=this.options(e,n);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),s=[];return this.G(i,(o,a)=>{s.push(a)}).next(()=>s)}{const i=this.store.getAll(r.range);return new N((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}j(e,n){const r=this.store.getAll(e,null===n?void 0:n);return new N((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){Y("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.J=!1;const i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.G(i,n)}Z(e){const n=this.cursor({});return new N((r,i)=>{n.onerror=s=>{const o=bR(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){const r=[];return new N((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const u=new Loe(a),d=n(a.primaryKey,a.value,u);if(d instanceof N){const f=d.catch(g=>(u.done(),N.reject(g)));r.push(f)}u.isDone?i():null===u.$?a.continue():a.continue(u.$)}}).next(()=>N.waitFor(r))}options(e,n){let r;return void 0!==e&&("string"==typeof e?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Tl(t){return new N((e,n)=>{t.onsuccess=r=>{e(r.target.result)},t.onerror=r=>{const i=bR(r.target.error);n(i)}})}let q$=!1;function bR(t){const e=$s.S((0,I.z$)());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new Z("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return q$||(q$=!0,setTimeout(()=>{throw r},0)),r}}return t}class Boe{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){var n=this;Y("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,$.Z)(function*(){n.task=null;try{Y("IndexBackiller",`Documents written: ${yield n.X.te()}`)}catch(r){Uu(r)?Y("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield Lu(r)}yield n.ee(6e4)}))}}class joe{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){var n=this;return(0,$.Z)(function*(){return n.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>n.ne(r,e))})()}ne(e,n){const r=new Set;let i=n,s=!0;return N.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!r.has(o))return Y("IndexBackiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(Y("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=$$(s);TR(o,r)>0&&(r=o)}),new Bi(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}let ji=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){const n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function e_(t){return null==t}function t_(t){return 0===t&&1/t==-1/0}function z$(t){return"number"==typeof t&&Number.isInteger(t)&&!t_(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Fr(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=W$(e)),e=$oe(t.get(n),e);return W$(e)}function $oe(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=s}}return n}function W$(t){return t+"\x01\x01"}function Co(t){const e=t.length;if(me(e>=2),2===e)return me("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),dt.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("\x01",s);switch((o<0||o>n)&&he(),t.charAt(o+1)){case"\x01":const a=t.substring(s,o);let u;0===i.length?u=a:(i+=a,u=i,i=""),r.push(u);break;case"\x10":i+=t.substring(s,o),i+="\0";break;case"\x11":i+=t.substring(s,o+1);break;default:he()}s=o+2}return new dt(r)}const K$=["userId","batchId"];function Tw(t,e){return[t,Fr(e)]}function Z$(t,e,n){return[t,Fr(e),n]}const Hoe={},Goe=["prefixPath","collectionGroup","readTime","documentId"],qoe=["prefixPath","collectionGroup","documentId"],zoe=["collectionGroup","readTime","prefixPath","documentId"],Woe=["canonicalId","targetId"],Koe=["targetId","path"],Zoe=["path","targetId"],Qoe=["collectionId","parent"],Yoe=["indexId","uid"],Xoe=["uid","sequenceNumber"],Joe=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],eae=["indexId","uid","orderedDocumentKey"],tae=["userId","collectionPath","documentId"],nae=["userId","collectionPath","largestBatchId"],rae=["userId","collectionGroup","largestBatchId"],Q$=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],iae=[...Q$,"documentOverlays"],Y$=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],X$=Y$,sae=[...X$,"indexConfiguration","indexState","indexEntries"];class DR extends G${constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}}function ur(t,e){const n=ie(t);return $s.M(n.ae,e)}function J$(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Bu(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function eH(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class qt{constructor(e,n){this.comparator=e,this.root=n||br.EMPTY}insert(e,n){return new qt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,br.BLACK,null,null))}remove(e){return new qt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,br.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cw(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cw(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cw(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cw(this.root,e,this.comparator,!0)}}class Cw{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class br{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??br.RED,this.left=i??br.EMPTY,this.right=s??br.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new br(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):0===s?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return br.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return br.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,br.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,br.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw he();const e=this.left.check();if(e!==this.right.check())throw he();return e+(this.isRed()?0:1)}}br.EMPTY=null,br.RED=!0,br.BLACK=!1,br.EMPTY=new class{constructor(){this.size=0}get key(){throw he()}get value(){throw he()}get color(){throw he()}get left(){throw he()}get right(){throw he()}copy(e,n,r,i,s){return this}insert(e,n,r){return new br(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Nt{constructor(e){this.comparator=e,this.data=new qt(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=void 0!==n?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new tH(this.data.getIterator())}getIteratorFrom(e){return new tH(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Nt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Nt(this.comparator);return n.data=e,n}}class tH{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function df(t){return t.hasNext()?t.getNext():void 0}class Ti{constructor(e){this.fields=e,e.sort(Jt.comparator)}static empty(){return new Ti([])}unionWith(e){let n=new Nt(Jt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Ti(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return uf(this.fields,e.fields,(n,r)=>n.isEqual(r))}}class nH extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Xn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new nH("Invalid base64 string: "+s):s}}(e);return new Xn(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Xn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xn.EMPTY_BYTE_STRING=new Xn("");const aae=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ju(t){if(me(!!t),"string"==typeof t){let e=0;const n=aae.exec(t);if(me(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Cn(t.seconds),nanos:Cn(t.nanos)}}function Cn(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function wa(t){return"string"==typeof t?Xn.fromBase64String(t):Xn.fromUint8Array(t)}function bw(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=t?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Dw(t){const e=t.mapValue.fields.__previous_value__;return bw(e)?Dw(e):e}function n_(t){const e=ju(t.mapValue.fields.__local_write_time__.timestampValue);return new an(e.seconds,e.nanos)}class uae{constructor(e,n,r,i,s,o,a,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=d}}class $u{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new $u("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof $u&&e.projectId===this.projectId&&e.database===this.database}}const Hu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Aw={nullValue:"NULL_VALUE"};function Gu(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?bw(t)?4:oH(t)?9007199254740991:10:he()}function bo(t,e){if(t===e)return!0;const n=Gu(t);if(n!==Gu(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return n_(t).isEqual(n_(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=ju(i.timestampValue),a=ju(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return s=e,wa(t.bytesValue).isEqual(wa(s.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Cn(i.geoPointValue.latitude)===Cn(s.geoPointValue.latitude)&&Cn(i.geoPointValue.longitude)===Cn(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Cn(i.integerValue)===Cn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Cn(i.doubleValue),a=Cn(s.doubleValue);return o===a?t_(o)===t_(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return uf(t.arrayValue.values||[],e.arrayValue.values||[],bo);case 10:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(J$(o)!==J$(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(void 0===a[u]||!bo(o[u],a[u])))return!1;return!0}(t,e);default:return he()}var s}function r_(t,e){return void 0!==(t.values||[]).find(n=>bo(n,e))}function qu(t,e){if(t===e)return 0;const n=Gu(t),r=Gu(e);if(n!==r)return Ne(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ne(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Cn(s.integerValue||s.doubleValue),u=Cn(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return rH(t.timestampValue,e.timestampValue);case 4:return rH(n_(t),n_(e));case 5:return Ne(t.stringValue,e.stringValue);case 6:return function(s,o){const a=wa(s),u=wa(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),u=o.split("/");for(let d=0;d<a.length&&d<u.length;d++){const f=Ne(a[d],u[d]);if(0!==f)return f}return Ne(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ne(Cn(s.latitude),Cn(o.latitude));return 0!==a?a:Ne(Cn(s.longitude),Cn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],u=o.values||[];for(let d=0;d<a.length&&d<u.length;++d){const f=qu(a[d],u[d]);if(f)return f}return Ne(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Hu.mapValue&&o===Hu.mapValue)return 0;if(s===Hu.mapValue)return 1;if(o===Hu.mapValue)return-1;const a=s.fields||{},u=Object.keys(a),d=o.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let g=0;g<u.length&&g<f.length;++g){const m=Ne(u[g],f[g]);if(0!==m)return m;const y=qu(a[u[g]],d[f[g]]);if(0!==y)return y}return Ne(u.length,f.length)}(t.mapValue,e.mapValue);default:throw he()}}function rH(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ne(t,e);const n=ju(t),r=ju(e),i=Ne(n.seconds,r.seconds);return 0!==i?i:Ne(n.nanos,r.nanos)}function hf(t){return AR(t)}function AR(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ju(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?wa(t.bytesValue).toBase64():"referenceValue"in t?se.fromName(t.referenceValue).toString():"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=AR(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${AR(n.fields[o])}`;return i+"}"}(t.mapValue):he()}function Cl(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function SR(t){return!!t&&"integerValue"in t}function i_(t){return!!t&&"arrayValue"in t}function iH(t){return!!t&&"nullValue"in t}function sH(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Rw(t){return!!t&&"mapValue"in t}function s_(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Bu(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=s_(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=s_(t.arrayValue.values[n]);return e}return Object.assign({},t)}function oH(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}function cae(t){return"nullValue"in t?Aw:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Cl($u.empty(),se.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:he()}function lae(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Cl($u.empty(),se.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Hu:he()}function aH(t,e){const n=qu(t.value,e.value);return 0!==n?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function uH(t,e){const n=qu(t.value,e.value);return 0!==n?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}class Dr{constructor(e){this.value=e}static empty(){return new Dr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Rw(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=s_(n)}setAll(e){let n=Jt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=s_(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Rw(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return bo(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Rw(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Bu(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Dr(s_(this.value))}}function cH(t){const e=[];return Bu(t.fields,(n,r)=>{const i=new Jt([n]);if(Rw(r)){const s=cH(r.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Ti(e)}class en{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new en(e,0,_e.min(),_e.min(),_e.min(),Dr.empty(),0)}static newFoundDocument(e,n,r,i){return new en(e,1,n,_e.min(),r,i,0)}static newNoDocument(e,n){return new en(e,2,n,_e.min(),_e.min(),Dr.empty(),0)}static newUnknownDocument(e,n){return new en(e,3,n,_e.min(),_e.min(),Dr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(_e.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=_e.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof en&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new en(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class zu{constructor(e,n){this.position=e,this.inclusive=n}}function lH(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.isKeyField()?se.comparator(se.fromName(o.referenceValue),n.key):qu(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function dH(t,e){if(null===t)return null===e;if(null===e||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!bo(t.position[n],e.position[n]))return!1;return!0}class o_{constructor(e,n="asc"){this.field=e,this.dir=n}}function dae(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class hH{}class ot extends hH{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?"in"===n||"not-in"===n?this.createKeyFieldInFilter(e,n,r):new hae(e,n,r):"array-contains"===n?new gae(e,r):"in"===n?new yH(e,r):"not-in"===n?new mae(e,r):"array-contains-any"===n?new _ae(e,r):new ot(e,n,r)}static createKeyFieldInFilter(e,n,r){return"in"===n?new fae(e,r):new pae(e,r)}matches(e){const n=e.data.field(this.field);return"!="===this.op?null!==n&&this.matchesComparison(qu(n,this.value)):null!==n&&Gu(this.value)===Gu(n)&&this.matchesComparison(qu(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return he()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class At extends hH{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new At(e,n)}matches(e){return ff(this)?void 0===this.filters.find(n=>!n.matches(e)):void 0!==this.filters.find(n=>n.matches(e))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function ff(t){return"and"===t.op}function RR(t){return"or"===t.op}function PR(t){return fH(t)&&ff(t)}function fH(t){for(const e of t.filters)if(e instanceof At)return!1;return!0}function NR(t){if(t instanceof ot)return t.field.canonicalString()+t.op.toString()+hf(t.value);if(PR(t))return t.filters.map(e=>NR(e)).join(",");{const e=t.filters.map(n=>NR(n)).join(",");return`${t.op}(${e})`}}function pH(t,e){return t instanceof ot?(r=t,(i=e)instanceof ot&&r.op===i.op&&r.field.isEqual(i.field)&&bo(r.value,i.value)):t instanceof At?function(r,i){return i instanceof At&&r.op===i.op&&r.filters.length===i.filters.length&&r.filters.reduce((s,o,a)=>s&&pH(o,i.filters[a]),!0)}(t,e):void he();var r,i}function gH(t,e){const n=t.filters.concat(e);return At.create(n,t.op)}function mH(t){return t instanceof ot?`${(n=t).field.canonicalString()} ${n.op} ${hf(n.value)}`:t instanceof At?function(n){return n.op.toString()+" {"+n.getFilters().map(mH).join(" ,")+"}"}(t):"Filter";var n}class hae extends ot{constructor(e,n,r){super(e,n,r),this.key=se.fromName(r.referenceValue)}matches(e){const n=se.comparator(e.key,this.key);return this.matchesComparison(n)}}class fae extends ot{constructor(e,n){super(e,"in",n),this.keys=_H(0,n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class pae extends ot{constructor(e,n){super(e,"not-in",n),this.keys=_H(0,n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function _H(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(r=>se.fromName(r.referenceValue))}class gae extends ot{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return i_(n)&&r_(n.arrayValue,this.value)}}class yH extends ot{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return null!==n&&r_(this.value.arrayValue,n)}}class mae extends ot{constructor(e,n){super(e,"not-in",n)}matches(e){if(r_(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return null!==n&&!r_(this.value.arrayValue,n)}}class _ae extends ot{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!i_(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>r_(this.value.arrayValue,r))}}class yae{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}}function xR(t,e=null,n=[],r=[],i=null,s=null,o=null){return new yae(t,e,n,r,i,s,o)}function bl(t){const e=ie(t);if(null===e.ce){let n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>NR(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),e_(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>hf(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>hf(r)).join(",")),e.ce=n}return e.ce}function a_(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!dae(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!pH(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!dH(t.startAt,e.startAt)&&dH(t.endAt,e.endAt)}function Pw(t){return se.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Nw(t,e){return t.filters.filter(n=>n instanceof ot&&n.field.isEqual(e))}function vH(t,e,n){let r=Aw,i=!0;for(const s of Nw(t,e)){let o=Aw,a=!0;switch(s.op){case"<":case"<=":o=cae(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Aw}aH({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(null!==n)for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];aH({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}return{value:r,inclusive:i}}function EH(t,e,n){let r=Hu,i=!0;for(const s of Nw(t,e)){let o=Hu,a=!0;switch(s.op){case">=":case">":o=lae(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Hu}uH({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(null!==n)for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];uH({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}return{value:r,inclusive:i}}class Ta{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.le=null,this.he=null,this.Pe=null}}function IH(t,e,n,r,i,s,o,a){return new Ta(t,e,n,r,i,s,o,a)}function pf(t){return new Ta(t)}function wH(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function MR(t){return null!==t.collectionGroup}function gf(t){const e=ie(t);if(null===e.le){e.le=[];const n=new Set;for(const s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Nt(Jt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new o_(s,r))}),n.has(Jt.keyField().canonicalString())||e.le.push(new o_(Jt.keyField(),r))}return e.le}function Jr(t){const e=ie(t);return e.he||(e.he=function TH(t,e){if("F"===t.limitType)return xR(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>new o_(i.field,"desc"===i.dir?"asc":"desc"));const n=t.endAt?new zu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new zu(t.startAt.position,t.startAt.inclusive):null;return xR(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}(e,gf(t))),e.he}function kR(t,e){const n=t.filters.concat([e]);return new Ta(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function xw(t,e,n){return new Ta(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function u_(t,e){return a_(Jr(t),Jr(e))&&t.limitType===e.limitType}function CH(t){return`${bl(Jr(t))}|lt:${t.limitType}`}function mf(t){return`Query(target=${function(n){let r=n.path.canonicalString();return null!==n.collectionGroup&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>mH(i)).join(", ")}]`),e_(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>{return`${(o=i).field.canonicalString()} (${o.dir})`;var o}).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>hf(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>hf(i)).join(",")),`Target(${r})`}(Jr(t))}; limitType=${t.limitType})`}function c_(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return null!==r.collectionGroup?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):se.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of gf(r))if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&(i=e,!((r=t).startAt&&!function(o,a,u){const d=lH(o,a,u);return o.inclusive?d<=0:d<0}(r.startAt,gf(r),i)||r.endAt&&!function(o,a,u){const d=lH(o,a,u);return o.inclusive?d>=0:d>0}(r.endAt,gf(r),i)));var r,i}function bH(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function DH(t){return(e,n)=>{let r=!1;for(const i of gf(t)){const s=vae(i,e,n);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function vae(t,e,n){const r=t.field.isKeyField()?se.comparator(e.key,n.key):function(s,o,a){const u=o.data.field(s),d=a.data.field(s);return null!==u&&null!==d?qu(u,d):he()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return he()}}class Ca{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Bu(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return eH(this.inner)}size(){return this.innerSize}}const Eae=new qt(se.comparator);function Ci(){return Eae}const AH=new qt(se.comparator);function l_(...t){let e=AH;for(const n of t)e=e.insert(n.key,n);return e}function SH(t){let e=AH;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Do(){return d_()}function RH(){return d_()}function d_(){return new Ca(t=>t.toString(),(t,e)=>t.isEqual(e))}const Iae=new qt(se.comparator),wae=new Nt(se.comparator);function Be(...t){let e=wae;for(const n of t)e=e.add(n);return e}const Tae=new Nt(Ne);function OR(){return Tae}function PH(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t_(e)?"-0":e}}function NH(t){return{integerValue:""+t}}function xH(t,e){return z$(e)?NH(e):PH(t,e)}class Mw{constructor(){this._=void 0}}function Cae(t,e,n){return t instanceof _f?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&bw(s)&&(s=Dw(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Dl?kH(t,e):t instanceof Al?OH(t,e):function(i,s){const o=MH(i,s),a=FH(o)+FH(i.Ie);return SR(o)&&SR(i.Ie)?NH(a):PH(i.serializer,a)}(t,e)}function bae(t,e,n){return t instanceof Dl?kH(t,e):t instanceof Al?OH(t,e):n}function MH(t,e){return t instanceof yf?SR(r=e)||(s=r)&&"doubleValue"in s?e:{integerValue:0}:null;var r,s}class _f extends Mw{}class Dl extends Mw{constructor(e){super(),this.elements=e}}function kH(t,e){const n=VH(e);for(const r of t.elements)n.some(i=>bo(i,r))||n.push(r);return{arrayValue:{values:n}}}class Al extends Mw{constructor(e){super(),this.elements=e}}function OH(t,e){let n=VH(e);for(const r of t.elements)n=n.filter(i=>!bo(i,r));return{arrayValue:{values:n}}}class yf extends Mw{constructor(e,n){super(),this.serializer=e,this.Ie=n}}function FH(t){return Cn(t.integerValue||t.doubleValue)}function VH(t){return i_(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class h_{constructor(e,n){this.field=e,this.transform=n}}class Aae{constructor(e,n){this.version=e,this.transformResults=n}}class un{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new un}static exists(e){return new un(void 0,e)}static updateTime(e){return new un(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function kw(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Ow{}function LH(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Ef(t.key,un.none()):new vf(t.key,t.data,un.none());{const n=t.data,r=Dr.empty();let i=new Nt(Jt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);null===o&&s.length>1&&(s=s.popLast(),o=n.field(s)),null===o?r.delete(s):r.set(s,o),i=i.add(s)}return new ba(t.key,r,new Ti(i.toArray()),un.none())}}function Sae(t,e,n){t instanceof vf?function(i,s,o){const a=i.value.clone(),u=jH(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ba?function(i,s,o){if(!kw(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=jH(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(BH(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):e.convertToNoDocument(n.version).setHasCommittedMutations()}function f_(t,e,n,r){return t instanceof vf?function(s,o,a,u){if(!kw(s.precondition,o))return a;const d=s.value.clone(),f=$H(s.fieldTransforms,u,o);return d.setAll(f),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof ba?function(s,o,a,u){if(!kw(s.precondition,o))return a;const d=$H(s.fieldTransforms,u,o),f=o.data;return f.setAll(BH(s)),f.setAll(d),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),null===a?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(t,e,n,r):(a=n,kw(t.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a);var o,a}function Rae(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=MH(r.transform,i||null);null!=s&&(null===n&&(n=Dr.empty()),n.set(r.field,s))}return n||null}function UH(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(r=t.fieldTransforms)&&void 0===i||r&&i&&uf(r,i,(s,o)=>function Dae(t,e){return t.field.isEqual(e.field)&&(i=e.transform,(r=t.transform)instanceof Dl&&i instanceof Dl||r instanceof Al&&i instanceof Al?uf(r.elements,i.elements,bo):r instanceof yf&&i instanceof yf?bo(r.Ie,i.Ie):r instanceof _f&&i instanceof _f);var r,i}(s,o))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var r,i}class vf extends Ow{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ba extends Ow{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function BH(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function jH(t,e,n){const r=new Map;me(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,bae(o,a,n[i]))}return r}function $H(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,Cae(s,o,e))}return r}class Ef extends Ow{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class FR extends Ow{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class VR{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Sae(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=f_(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=f_(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=RH();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const u=LH(o,a);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(_e.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Be())}isEqual(e){return this.batchId===e.batchId&&uf(this.mutations,e.mutations,(n,r)=>UH(n,r))&&uf(this.baseMutations,e.baseMutations,(n,r)=>UH(n,r))}}class LR{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){me(e.mutations.length===r.length);let i=Iae;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new LR(e,n,r,i)}}class UR{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Nae{constructor(e,n){this.count=e,this.unchangedNames=n}}var $n,ht;function HH(t){switch(t){default:return he();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function GH(t){if(void 0===t)return kn("GRPC error has no .code"),F.UNKNOWN;switch(t){case $n.OK:return F.OK;case $n.CANCELLED:return F.CANCELLED;case $n.UNKNOWN:return F.UNKNOWN;case $n.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case $n.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case $n.INTERNAL:return F.INTERNAL;case $n.UNAVAILABLE:return F.UNAVAILABLE;case $n.UNAUTHENTICATED:return F.UNAUTHENTICATED;case $n.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case $n.NOT_FOUND:return F.NOT_FOUND;case $n.ALREADY_EXISTS:return F.ALREADY_EXISTS;case $n.PERMISSION_DENIED:return F.PERMISSION_DENIED;case $n.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case $n.ABORTED:return F.ABORTED;case $n.OUT_OF_RANGE:return F.OUT_OF_RANGE;case $n.UNIMPLEMENTED:return F.UNIMPLEMENTED;case $n.DATA_LOSS:return F.DATA_LOSS;default:return he()}}(ht=$n||($n={}))[ht.OK=0]="OK",ht[ht.CANCELLED=1]="CANCELLED",ht[ht.UNKNOWN=2]="UNKNOWN",ht[ht.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ht[ht.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ht[ht.NOT_FOUND=5]="NOT_FOUND",ht[ht.ALREADY_EXISTS=6]="ALREADY_EXISTS",ht[ht.PERMISSION_DENIED=7]="PERMISSION_DENIED",ht[ht.UNAUTHENTICATED=16]="UNAUTHENTICATED",ht[ht.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ht[ht.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ht[ht.ABORTED=10]="ABORTED",ht[ht.OUT_OF_RANGE=11]="OUT_OF_RANGE",ht[ht.UNIMPLEMENTED=12]="UNIMPLEMENTED",ht[ht.INTERNAL=13]="INTERNAL",ht[ht.UNAVAILABLE=14]="UNAVAILABLE",ht[ht.DATA_LOSS=15]="DATA_LOSS";function qH(){return new TextEncoder}const xae=new rf([4294967295,4294967295],0);function zH(t){const e=qH().encode(t),n=new boe;return n.update(e),new Uint8Array(n.digest())}function WH(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new rf([n,r],0),new rf([i,s],0)]}class BR{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new p_(`Invalid padding: ${n}`);if(r<0)throw new p_(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new p_(`Invalid hash count: ${r}`);if(0===e.length&&0!==n)throw new p_(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=rf.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(rf.fromNumber(r)));return 1===i.compare(xae)&&(i=new rf([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const n=zH(e),[r,i]=WH(n);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new BR(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(0===this.Te)return;const n=zH(e),[r,i]=WH(n);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);this.Re(o)}}Re(e){const n=Math.floor(e/8);this.bitmap[n]|=1<<e%8}}class p_ extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class g_{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,m_.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new g_(_e.min(),i,new qt(Ne),Ci(),Be())}}class m_{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new m_(r,n,Be(),Be(),Be())}}class Vw{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}}class KH{constructor(e,n){this.targetId=e,this.fe=n}}class ZH{constructor(e,n,r=Xn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class QH{constructor(){this.ge=0,this.pe=XH(),this.ye=Xn.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=Be(),n=Be(),r=Be();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:he()}}),new m_(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=XH()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,me(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class Mae{constructor(e){this.Le=e,this.ke=new Map,this.qe=Ci(),this.Qe=YH(),this.Ke=new qt(Ne)}$e(e){for(const n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(const n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:he()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){const n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){const s=i.target;if(Pw(s))if(0===r){const o=new se(s.path);this.We(n,o,en.newNoDocument(o,_e.min()))}else me(1===r);else{const o=this.Ze(n);if(o!==r){const a=this.Xe(e),u=a?this.et(a,e,o):1;0!==u&&(this.He(n),this.Ke=this.Ke.insert(n,2===u?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Xe(e){const n=e.fe.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=wa(r).toUint8Array()}catch(u){if(u instanceof nH)return wi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new BR(o,i,s)}catch(u){return wi(u instanceof p_?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return 0===a.Te?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){const n=new Map;this.ke.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&Pw(a.target)){const u=new se(a.target.path);null!==this.qe.get(u)||this.st(o,u)||this.We(o,u,en.newNoDocument(u,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=Be();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{const d=this.Ye(u);return!d||"TargetPurposeLimboResolution"===d.purpose||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));const i=new g_(e,n,this.Ke,this.qe,r);return this.qe=Ci(),this.Qe=YH(),this.Ke=new qt(Ne),i}Ue(e,n){if(!this.je(e))return;const r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new QH,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Nt(Ne),this.Qe=this.Qe.insert(e,n)),n}je(e){const n=null!==this.Ye(e);return n||Y("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new QH),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function YH(){return new qt(se.comparator)}function XH(){return new qt(se.comparator)}const kae={asc:"ASCENDING",desc:"DESCENDING"},Oae={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Fae={and:"AND",or:"OR"};class Vae{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function jR(t,e){return t.useProto3Json||e_(e)?e:{value:e}}function If(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function JH(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Lae(t,e){return If(t,e.toTimestamp())}function On(t){return me(!!t),_e.fromTimestamp(function(n){const r=ju(n);return new an(r.seconds,r.nanos)}(t))}function $R(t,e){return(r=t,new dt(["projects",r.projectId,"databases",r.database])).child("documents").child(e).canonicalString();var r}function eG(t){const e=dt.fromString(t);return me(cG(e)),e}function __(t,e){return $R(t.databaseId,e.path)}function Ao(t,e){const n=eG(e);if(n.get(1)!==t.databaseId.projectId)throw new Z(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Z(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new se(nG(n))}function HR(t,e){return $R(t.databaseId,e)}function tG(t){const e=eG(t);return 4===e.length?dt.emptyPath():nG(e)}function y_(t){return new dt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function nG(t){return me(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function rG(t,e,n){return{name:__(t,e),fields:n.value.mapValue.fields}}function iG(t,e,n){const r=Ao(t,e.name),i=On(e.updateTime),s=e.createTime?On(e.createTime):_e.min(),o=new Dr({mapValue:{fields:e.fields}}),a=en.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function v_(t,e){let n;if(e instanceof vf)n={update:rG(t,e.key,e.value)};else if(e instanceof Ef)n={delete:__(t,e.key)};else if(e instanceof ba)n={update:rG(t,e.key,e.data),updateMask:zae(e.fieldMask)};else{if(!(e instanceof FR))return he();n={verify:__(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof _f)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Dl)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Al)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof yf)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw he()}(0,r))),e.precondition.isNone||(n.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:Lae(t,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:he()),n;var s}function GR(t,e){const n=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?un.updateTime(On(s.updateTime)):void 0!==s.exists?un.exists(s.exists):un.none():un.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;"setToServerValue"in a?(me("REQUEST_TIME"===a.setToServerValue),u=new _f):"appendMissingElements"in a?u=new Dl(a.appendMissingElements.values||[]):"removeAllFromArray"in a?u=new Al(a.removeAllFromArray.values||[]):"increment"in a?u=new yf(o,a.increment):he();const d=Jt.fromServerFormat(a.fieldPath);return new h_(d,u)}(t,i)):[];var s;if(e.update){const i=Ao(t,e.update.name),s=new Dr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new Ti((e.updateMask.fieldPaths||[]).map(f=>Jt.fromServerFormat(f)));return new ba(i,s,o,n,r)}return new vf(i,s,n,r)}if(e.delete){const i=Ao(t,e.delete);return new Ef(i,n)}if(e.verify){const i=Ao(t,e.verify);return new FR(i,n)}return he()}function sG(t,e){return{documents:[HR(t,e.path)]}}function qR(t,e){const n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=HR(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=HR(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(u){if(0!==u.length)return uG(At.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(u){if(0!==u.length)return u.map(d=>{return{field:Wu((g=d).field),direction:Hae(g.dir)};var g})}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=jR(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(u=e.startAt).inclusive,values:u.position}),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),n;var u}function oG(t){let e=tG(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){me(1===r);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(g){const m=aG(g);return m instanceof At&&PR(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(m=>{return new o_(wf((E=m).field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction));var E}));let a=null;n.limit&&(a=function(g){let m;return m="object"==typeof g?g.value:g,e_(m)?null:m}(n.limit));let u=null;var g;n.startAt&&(u=new zu((g=n.startAt).values||[],!!g.before));let d=null;return n.endAt&&(d=function(g){return new zu(g.values||[],!g.before)}(n.endAt)),IH(e,i,o,s,a,"F",u,d)}function aG(t){return void 0!==t.unaryFilter?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=wf(n.unaryFilter.field);return ot.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=wf(n.unaryFilter.field);return ot.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=wf(n.unaryFilter.field);return ot.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=wf(n.unaryFilter.field);return ot.create(o,"!=",{nullValue:"NULL_VALUE"});default:return he()}}(t):void 0!==t.fieldFilter?ot.create(wf((n=t).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return he()}}(n.fieldFilter.op),n.fieldFilter.value):void 0!==t.compositeFilter?function(n){return At.create(n.compositeFilter.filters.map(r=>aG(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return he()}}(n.compositeFilter.op))}(t):he();var n}function Hae(t){return kae[t]}function Gae(t){return Oae[t]}function qae(t){return Fae[t]}function Wu(t){return{fieldPath:t.canonicalString()}}function wf(t){return Jt.fromServerFormat(t.fieldPath)}function uG(t){return t instanceof ot?function(n){if("=="===n.op){if(sH(n.value))return{unaryFilter:{field:Wu(n.field),op:"IS_NAN"}};if(iH(n.value))return{unaryFilter:{field:Wu(n.field),op:"IS_NULL"}}}else if("!="===n.op){if(sH(n.value))return{unaryFilter:{field:Wu(n.field),op:"IS_NOT_NAN"}};if(iH(n.value))return{unaryFilter:{field:Wu(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wu(n.field),op:Gae(n.op),value:n.value}}}(t):t instanceof At?function(n){const r=n.getFilters().map(i=>uG(i));return 1===r.length?r[0]:{compositeFilter:{op:qae(n.op),filters:r}}}(t):he()}function zae(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function cG(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class Da{constructor(e,n,r,i,s=_e.min(),o=_e.min(),a=Xn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new Da(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Da(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Da(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Da(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class lG{constructor(e){this.ut=e}}function dG(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Lw(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:__(s=t.ut,(o=e).key),fields:o.data.value.mapValue.fields,updateTime:If(s,o.version.toTimestamp()),createTime:If(s,o.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Sl(e.version)};else{if(!e.isUnknownDocument())return he();r.unknownDocument={path:n.path.toArray(),version:Sl(e.version)}}var s,o;return r}function Lw(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Sl(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Rl(t){const e=new an(t.seconds,t.nanoseconds);return _e.fromTimestamp(e)}function Pl(t,e){const n=(e.baseMutations||[]).map(s=>GR(t.ut,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const r=e.mutations.map(s=>GR(t.ut,s)),i=an.fromMillis(e.localWriteTimeMs);return new VR(e.batchId,i,n,r)}function E_(t){const e=Rl(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Rl(t.lastLimboFreeSnapshotVersion):_e.min();let r;return r=void 0!==t.query.documents?(me(1===(s=t.query).documents.length),Jr(pf(tG(s.documents[0])))):function(s){return Jr(oG(s))}(t.query),new Da(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Xn.fromBase64String(t.resumeToken));var s}function hG(t,e){const n=Sl(e.snapshotVersion),r=Sl(e.lastLimboFreeSnapshotVersion);let i;i=Pw(e.target)?sG(t.ut,e.target):qR(t.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:bl(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function zR(t){const e=oG({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?xw(e,e.limit,"L"):e}function WR(t,e){return new UR(e.largestBatchId,GR(t.ut,e.overlayMutation))}function fG(t,e){const n=e.path.lastSegment();return[t,Fr(e.path.popLast()),n]}function pG(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:Sl(r.readTime),documentKey:Fr(r.documentKey.path),largestBatchId:r.largestBatchId}}class Kae{getBundleMetadata(e,n){return gG(e).get(n).next(r=>{if(r)return{id:(s=r).bundleId,createTime:Rl(s.createTime),version:s.version};var s})}saveBundleMetadata(e,n){return gG(e).put({bundleId:(i=n).id,createTime:Sl(On(i.createTime)),version:i.version});var i}getNamedQuery(e,n){return mG(e).get(n).next(r=>{if(r)return{name:(s=r).name,query:zR(s.bundledQuery),readTime:Rl(s.readTime)};var s})}saveNamedQuery(e,n){return mG(e).put({name:(i=n).name,readTime:Sl(On(i.readTime)),bundledQuery:i.bundledQuery});var i}}function gG(t){return ur(t,"bundles")}function mG(t){return ur(t,"namedQueries")}class Uw{constructor(e,n){this.serializer=e,this.userId=n}static ct(e,n){return new Uw(e,n.uid||"")}getOverlay(e,n){return I_(e).get(fG(this.userId,n)).next(r=>r?WR(this.serializer,r):null)}getOverlays(e,n){const r=Do();return N.forEach(n,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new UR(n,o);i.push(this.lt(e,a))}),N.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(Fr(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(I_(e).H("collectionPathOverlayIndex",a))}),N.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Do(),s=Fr(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return I_(e).W("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const d=WR(this.serializer,u);i.set(d.getKey(),d)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Do();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return I_(e).Y({index:"collectionGroupOverlayIndex",range:a},(u,d,f)=>{const g=WR(this.serializer,d);s.size()<i||g.largestBatchId===o?(s.set(g.getKey(),g),o=g.largestBatchId):f.done()}).next(()=>s)}lt(e,n){return I_(e).put(function(i,s,o){const[a,u,d]=fG(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:v_(i.ut,o.mutation)}}(this.serializer,this.userId,n))}}function I_(t){return ur(t,"documentOverlays")}class Nl{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(Cn(e.integerValue));else if("doubleValue"in e){const r=Cn(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),t_(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(n,20),"string"==typeof r?n.dt(r):(n.dt(`${r.seconds||""}`),n.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt(wa(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?oH(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):he()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){const r=e.fields||{};this.Tt(n,55);for(const i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){const r=e.values||[];this.Tt(n,50);for(const i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),se.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}}function Zae(t){if(0===t)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function _G(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=Zae(255&r[s]);if(i+=o,8!==o)break}return i}(t);return Math.ceil(e/8)}Nl.St=new Nl;class Qae{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Dt(r.value),r=n.next();this.Ct()}vt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(n<"\ud800"||"\udbff"<n)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=n.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\ud800"||"\udbff"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const n=this.Bt(e),r=_G(n);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}kt(e){const n=this.Bt(e),r=_G(n);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=0!=(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Dt(e){const n=255&e;0===n?(this.Qt(0),this.Qt(255)):255===n?(this.Qt(255),this.Qt(0)):this.Qt(n)}Ft(e){const n=255&e;0===n?(this.$t(0),this.$t(255)):255===n?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Yae{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class Xae{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class w_{constructor(){this.Wt=new Qae,this.Gt=new Yae(this.Wt),this.zt=new Xae(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return 0===e?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class xl{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,n=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new xl(this.indexId,this.documentKey,this.arrayValue,r)}}function Ku(t,e){let n=t.indexId-e.indexId;return 0!==n?n:(n=yG(t.arrayValue,e.arrayValue),0!==n?n:(n=yG(t.directionalValue,e.directionalValue),0!==n?n:se.comparator(t.documentKey,e.documentKey)))}function yG(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(0!==r)return r}return t.length-e.length}class vG{constructor(e){this.Jt=new Nt((n,r)=>Jt.comparator(n.field,r.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const n of e.filters){const r=n;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(me(e.collectionGroup===this.collectionId),this.Xt)return!1;const n=wR(e);if(void 0!==n&&!this.tn(n))return!1;const r=Il(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const a=this.Jt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const u=r[s];if(!this.nn(a,u)||!this.rn(this.Yt[o++],u))return!1}++s}for(;s<r.length;++s)if(o>=this.Yt.length||!this.rn(this.Yt[o++],r[s]))return!1;return!0}sn(){if(this.Xt)return null;let e=new Nt(Jt.comparator);const n=[];for(const r of this.Zt)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)n.push(new wl(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new wl(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new wl(r.field,"asc"===r.dir?0:1)));return new cf(cf.UNKNOWN_ID,this.collectionId,n,lf.empty())}tn(e){for(const n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){return!(void 0===e||!e.field.isEqual(n.fieldPath))&&2===n.kind==("array-contains"===e.op||"array-contains-any"===e.op)}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(0===n.kind&&"asc"===e.dir||1===n.kind&&"desc"===e.dir)}}function EG(t){var e,n;if(me(t instanceof ot||t instanceof At),t instanceof ot){if(t instanceof yH){const i=(null===(n=null===(e=t.value.arrayValue)||void 0===e?void 0:e.values)||void 0===n?void 0:n.map(s=>ot.create(t.field,"==",s)))||[];return At.create(i,"or")}return t}const r=t.filters.map(i=>EG(i));return At.create(r,t.op)}function Jae(t){if(0===t.getFilters().length)return[];const e=QR(EG(t));return me(IG(e)),KR(e)||ZR(e)?[e]:e.getFilters()}function KR(t){return t instanceof ot}function ZR(t){return t instanceof At&&PR(t)}function IG(t){return KR(t)||ZR(t)||function(n){if(n instanceof At&&RR(n)){for(const r of n.getFilters())if(!KR(r)&&!ZR(r))return!1;return!0}return!1}(t)}function QR(t){if(me(t instanceof ot||t instanceof At),t instanceof ot)return t;if(1===t.filters.length)return QR(t.filters[0]);const e=t.filters.map(r=>QR(r));let n=At.create(e,t.op);return n=Bw(n),IG(n)?n:(me(n instanceof At),me(ff(n)),me(n.filters.length>1),n.filters.reduce((r,i)=>YR(r,i)))}function YR(t,e){let n;return me(t instanceof ot||t instanceof At),me(e instanceof ot||e instanceof At),n=t instanceof ot?e instanceof ot?At.create([t,e],"and"):wG(t,e):e instanceof ot?wG(e,t):function(i,s){if(me(i.filters.length>0&&s.filters.length>0),ff(i)&&ff(s))return gH(i,s.getFilters());const o=RR(i)?i:s,a=RR(i)?s:i,u=o.filters.map(d=>YR(d,a));return At.create(u,"or")}(t,e),Bw(n)}function wG(t,e){if(ff(e))return gH(e,t.getFilters());{const n=e.filters.map(r=>YR(t,r));return At.create(n,"or")}}function Bw(t){if(me(t instanceof ot||t instanceof At),t instanceof ot)return t;const e=t.getFilters();if(1===e.length)return Bw(e[0]);if(fH(t))return t;const n=e.map(i=>Bw(i)),r=[];return n.forEach(i=>{i instanceof ot?r.push(i):i instanceof At&&(i.op===t.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:At.create(r,t.op)}class eue{constructor(){this.on=new XR}addToCollectionParentIndex(e,n){return this.on.add(n),N.resolve()}getCollectionParents(e,n){return N.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return N.resolve()}deleteFieldIndex(e,n){return N.resolve()}deleteAllFieldIndexes(e){return N.resolve()}createTargetIndexes(e,n){return N.resolve()}getDocumentsMatchingTarget(e,n){return N.resolve(null)}getIndexType(e,n){return N.resolve(0)}getFieldIndexes(e,n){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,n){return N.resolve(Bi.min())}getMinOffsetFromCollectionGroup(e,n){return N.resolve(Bi.min())}updateCollectionGroup(e,n,r){return N.resolve()}updateIndexEntries(e,n){return N.resolve()}}class XR{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Nt(dt.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Nt(dt.comparator)).toArray()}}const jw=new Uint8Array(0);class tue{constructor(e,n){this.user=e,this.databaseId=n,this._n=new XR,this.an=new Ca(r=>bl(r),(r,i)=>a_(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this._n.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this._n.add(n)});const s={collectionId:r,parent:Fr(i)};return TG(e).put(s)}return N.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[B$(n),""],!1,!0);return TG(e).W(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Co(o.parent))}return r})}addFieldIndex(e,n){const r=T_(e),i={indexId:(a=n).indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])};var a;delete i.indexId;const s=r.add(i);if(n.indexState){const o=Cf(e);return s.next(a=>{o.put(pG(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=T_(e),i=Cf(e),s=Tf(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=T_(e),r=Tf(e),i=Cf(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return N.forEach(this.un(n),r=>this.getIndexType(e,r).next(i=>{if(0===i||1===i){const s=new vG(r).sn();if(null!=s)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=Tf(e);let i=!0;const s=new Map;return N.forEach(this.un(n),o=>this.cn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Be();const a=[];return N.forEach(s,(u,d)=>{var k;Y("IndexedDbIndexManager",`Using index ${k=u,`id=${k.indexId}|cg=${k.collectionGroup}|f=${k.fields.map(G=>`${G.fieldPath}:${G.kind}`).join(",")}`} to execute ${bl(n)}`);const f=function(k,G){const ne=wR(G);if(void 0===ne)return null;for(const Te of Nw(k,ne.fieldPath))switch(Te.op){case"array-contains-any":return Te.value.arrayValue.values||[];case"array-contains":return[Te.value]}return null}(d,u),g=function(k,G){const ne=new Map;for(const Te of Il(G))for(const at of Nw(k,Te.fieldPath))switch(at.op){case"==":case"in":ne.set(Te.fieldPath.canonicalString(),at.value);break;case"not-in":case"!=":return ne.set(Te.fieldPath.canonicalString(),at.value),Array.from(ne.values())}return null}(d,u),m=function(k,G){const ne=[];let Te=!0;for(const at of Il(G)){const nn=0===at.kind?vH(k,at.fieldPath,k.startAt):EH(k,at.fieldPath,k.startAt);ne.push(nn.value),Te&&(Te=nn.inclusive)}return new zu(ne,Te)}(d,u),y=function(k,G){const ne=[];let Te=!0;for(const at of Il(G)){const nn=0===at.kind?EH(k,at.fieldPath,k.endAt):vH(k,at.fieldPath,k.endAt);ne.push(nn.value),Te&&(Te=nn.inclusive)}return new zu(ne,Te)}(d,u),E=this.ln(u,d,m),C=this.ln(u,d,y),D=this.hn(u,d,g),O=this.Pn(u.indexId,f,E,m.inclusive,C,y.inclusive,D);return N.forEach(O,R=>r.j(R,n.limit).next(k=>{k.forEach(G=>{const ne=se.fromSegments(G.documentKey);o.has(ne)||(o=o.add(ne),a.push(ne))})}))}).next(()=>a)}return N.resolve(null)})}un(e){let n=this.an.get(e);return n||(n=0===e.filters.length?[e]:Jae(At.create(e.filters,"and")).map(r=>xR(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,n),n)}Pn(e,n,r,i,s,o,a){const u=(null!=n?n.length:1)*Math.max(r.length,s.length),d=u/(null!=n?n.length:1),f=[];for(let g=0;g<u;++g){const m=n?this.In(n[g/d]):jw,y=this.Tn(e,m,r[g%d],i),E=this.En(e,m,s[g%d],o),C=a.map(D=>this.Tn(e,m,D,!0));f.push(...this.createRange(y,E,C))}return f}Tn(e,n,r,i){const s=new xl(e,se.empty(),n,r);return i?s:s.Ht()}En(e,n,r,i){const s=new xl(e,se.empty(),n,r);return i?s.Ht():s}cn(e,n){const r=new vG(n),i=null!=n.collectionGroup?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.un(n);return N.forEach(i,s=>this.cn(e,s).next(o=>{o?0!==r&&o.fields.length<function(u){let d=new Nt(Jt.comparator),f=!1;for(const g of u.filters)for(const m of g.getFlattenedFilters())m.field.isKeyField()||("array-contains"===m.op||"array-contains-any"===m.op?f=!0:d=d.add(m.field));for(const g of u.orderBy)g.field.isKeyField()||(d=d.add(g.field));return d.size+(f?1:0)}(s)&&(r=1):r=0})).next(()=>null!==n.limit&&i.length>1&&2===r?1:r)}dn(e,n){const r=new w_;for(const i of Il(e)){const s=n.data.field(i.fieldPath);if(null==s)return null;const o=r.jt(i.kind);Nl.St.ht(s,o)}return r.Ut()}In(e){const n=new w_;return Nl.St.ht(e,n.jt(0)),n.Ut()}An(e,n){const r=new w_;return Nl.St.ht(Cl(this.databaseId,n),r.jt(function(s){const o=Il(s);return 0===o.length?0:o[o.length-1].kind}(e))),r.Ut()}hn(e,n,r){if(null===r)return[];let i=[];i.push(new w_);let s=0;for(const o of Il(e)){const a=r[s++];for(const u of i)if(this.Rn(n,o.fieldPath)&&i_(a))i=this.Vn(i,o,a);else{const d=u.jt(o.kind);Nl.St.ht(a,d)}}return this.mn(i)}ln(e,n,r){return this.hn(e,n,r.position)}mn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ut();return n}Vn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const u=new w_;u.seed(a.Ut()),Nl.St.ht(o,u.jt(n.kind)),s.push(u)}return s}Rn(e,n){return!!e.filters.find(r=>r instanceof ot&&r.field.isEqual(n)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,n){const r=T_(e),i=Cf(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{const o=[];return N.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(f,g){const m=g?new lf(g.sequenceNumber,new Bi(Rl(g.readTime),new se(Co(g.documentKey)),g.largestBatchId)):lf.empty(),y=f.fields.map(([E,C])=>new wl(Jt.fromServerFormat(E),C));return new cf(f.indexId,f.collectionGroup,y,m)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>0===n.length?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:Ne(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=T_(e),s=Cf(e);return this.fn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>N.forEach(a,u=>s.put(pG(u.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return N.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?N.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),N.forEach(a,u=>this.gn(e,i,u).next(d=>{const f=this.pn(s,u);return d.isEqual(f)?N.resolve():this.yn(e,s,u,d,f)}))))})}wn(e,n,r,i){return Tf(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,n.key),documentKey:n.key.path.toArray()})}Sn(e,n,r,i){return Tf(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,n.key),n.key.path.toArray()])}gn(e,n,r){const i=Tf(e);let s=new Nt(Ku);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,n)])},(o,a)=>{s=s.add(new xl(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}pn(e,n){let r=new Nt(Ku);const i=this.dn(n,e);if(null==i)return r;const s=wR(n);if(null!=s){const o=e.data.field(s.fieldPath);if(i_(o))for(const a of o.arrayValue.values||[])r=r.add(new xl(n.indexId,e.key,this.In(a),i))}else r=r.add(new xl(n.indexId,e.key,jw,i));return r}yn(e,n,r,i,s){Y("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(u,d,f,g,m){const y=u.getIterator(),E=d.getIterator();let C=df(y),D=df(E);for(;C||D;){let O=!1,R=!1;if(C&&D){const k=f(C,D);k<0?R=!0:k>0&&(O=!0)}else null!=C?R=!0:O=!0;O?(g(D),D=df(E)):R?(m(C),C=df(y)):(C=df(y),D=df(E))}}(i,s,Ku,a=>{o.push(this.wn(e,n,r,a))},a=>{o.push(this.Sn(e,n,r,a))}),N.waitFor(o)}fn(e){let n=1;return Cf(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Ku(o,a)).filter((o,a,u)=>!a||0!==Ku(o,u[a-1]));const i=[];i.push(e);for(const o of r){const a=Ku(o,e),u=Ku(o,n);if(0===a)i[0]=e.Ht();else if(a>0&&u<0)i.push(o),i.push(o.Ht());else if(u>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];s.push(IDBKeyRange.bound([i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,jw,[]],[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,jw,[]]))}return s}bn(e,n){return Ku(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(CG)}getMinOffset(e,n){return N.mapArray(this.un(n),r=>this.cn(e,r).next(i=>i||he())).next(CG)}}function TG(t){return ur(t,"collectionParents")}function Tf(t){return ur(t,"indexEntries")}function T_(t){return ur(t,"indexConfiguration")}function Cf(t){return ur(t,"indexState")}function CG(t){me(0!==t.length);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;TR(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Bi(e.readTime,e.documentKey,n)}const bG={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Vr{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Vr(e,Vr.DEFAULT_COLLECTION_PERCENTILE,Vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function DG(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const u=r.Y({range:o},(f,g,m)=>(a++,m.delete()));s.push(u.next(()=>{me(1===a)}));const d=[];for(const f of n.mutations){const g=Z$(e,f.key.path,n.batchId);s.push(i.delete(g)),d.push(f.key)}return N.waitFor(s).next(()=>d)}function $w(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw he();e=t.noDocument}return JSON.stringify(e).length}Vr.DEFAULT_COLLECTION_PERCENTILE=10,Vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vr.DEFAULT=new Vr(41943040,Vr.DEFAULT_COLLECTION_PERCENTILE,Vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vr.DISABLED=new Vr(-1,0,0);class Hw{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,n,r,i){me(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new Hw(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Zu(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=bf(e),o=Zu(e);return o.add({}).next(a=>{me("number"==typeof a);const u=new VR(a,n,r,i),d=function(y,E,C){const D=C.baseMutations.map(R=>v_(y.ut,R)),O=C.mutations.map(R=>v_(y.ut,R));return{userId:E,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:D,mutations:O}}(this.serializer,this.userId,u),f=[];let g=new Nt((m,y)=>Ne(m.canonicalString(),y.canonicalString()));for(const m of i){const y=Z$(this.userId,m.key.path,a);g=g.add(m.key.path.popLast()),f.push(o.put(d)),f.push(s.put(y,Hoe))}return g.forEach(m=>{f.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Dn[a]=u.keys()}),N.waitFor(f).next(()=>u)})}lookupMutationBatch(e,n){return Zu(e).get(n).next(r=>r?(me(r.userId===this.userId),Pl(this.serializer,r)):null)}Cn(e,n){return this.Dn[n]?N.resolve(this.Dn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Dn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Zu(e).Y({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(me(a.batchId>=r),s=Pl(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Zu(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Zu(e).W("userMutationsIndex",n).next(r=>r.map(i=>Pl(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Tw(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return bf(e).Y({range:i},(o,a,u)=>{const[d,f,g]=o,m=Co(f);if(d===this.userId&&n.path.isEqual(m))return Zu(e).get(g).next(y=>{if(!y)throw he();me(y.userId===this.userId),s.push(Pl(this.serializer,y))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Nt(Ne);const i=[];return n.forEach(s=>{const o=Tw(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=bf(e).Y({range:a},(d,f,g)=>{const[m,y,E]=d,C=Co(y);m===this.userId&&s.path.isEqual(C)?r=r.add(E):g.done()});i.push(u)}),N.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Tw(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Nt(Ne);return bf(e).Y({range:o},(u,d,f)=>{const[g,m,y]=u,E=Co(m);g===this.userId&&r.isPrefixOf(E)?E.length===i&&(a=a.add(y)):f.done()}).next(()=>this.vn(e,a))}vn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Zu(e).get(s).next(o=>{if(null===o)throw he();me(o.userId===this.userId),r.push(Pl(this.serializer,o))}))}),N.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return DG(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Fn(n.batchId)}),N.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return N.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return bf(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){const u=Co(s[1]);i.push(u)}else a.done()}).next(()=>{me(0===i.length)})})}containsKey(e,n){return AG(e,this.userId,n)}Mn(e){return SG(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function AG(t,e,n){const r=Tw(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return bf(t).Y({range:s,J:!0},(a,u,d)=>{const[f,g,m]=a;f===e&&g===i&&(o=!0),d.done()}).next(()=>o)}function Zu(t){return ur(t,"mutations")}function bf(t){return ur(t,"documentMutations")}function SG(t){return ur(t,"mutationQueues")}class Ml{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Ml(0)}static Nn(){return new Ml(-1)}}class nue{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{const r=new Ml(n.highestTargetId);return n.highestTargetId=r.next(),this.Ln(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>_e.fromTimestamp(new an(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Ln(e,i)))}addTargetData(e,n){return this.kn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(n,r),this.Ln(e,r))))}updateTargetData(e,n){return this.kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Df(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(me(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Df(e).Y((o,a)=>{const u=E_(a);u.sequenceNumber<=n&&null===r.get(u.targetId)&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>N.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Df(e).Y((r,i)=>{const s=E_(i);n(s)})}Bn(e){return RG(e).get("targetGlobalKey").next(n=>(me(null!==n),n))}Ln(e,n){return RG(e).put("targetGlobalKey",n)}kn(e,n){return Df(e).put(hG(this.serializer,n))}qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=bl(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Df(e).Y({range:i,index:"queryTargetsIndex"},(o,a,u)=>{const d=E_(a);a_(n,d.target)&&(s=d,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Qu(e);return n.forEach(o=>{const a=Fr(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),N.waitFor(i)}removeMatchingKeys(e,n,r){const i=Qu(e);return N.forEach(n,s=>{const o=Fr(s.path);return N.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Qu(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Qu(e);let s=Be();return i.Y({range:r,J:!0},(o,a,u)=>{const d=Co(o[1]),f=new se(d);s=s.add(f)}).next(()=>s)}containsKey(e,n){const r=Fr(n.path),i=IDBKeyRange.bound([r],[B$(r)],!1,!0);let s=0;return Qu(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],u,d)=>{0!==o&&(s++,d.done())}).next(()=>s>0)}_t(e,n){return Df(e).get(n).next(r=>r?E_(r):null)}}function Df(t){return ur(t,"targets")}function RG(t){return ur(t,"targetGlobal")}function Qu(t){return ur(t,"targetDocuments")}function PG([t,e],[n,r]){const i=Ne(t,n);return 0===i?Ne(e,r):i}class rue{constructor(e){this.Qn=e,this.buffer=new Nt(PG),this.Kn=0}$n(){return++this.Kn}Un(e){const n=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();PG(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class NG{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Wn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return null!==this.Wn}Gn(e){var n=this;Y("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,$.Z)(function*(){n.Wn=null;try{yield n.localStore.collectGarbage(n.garbageCollector)}catch(r){Uu(r)?Y("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield Lu(r)}yield n.Gn(3e5)}))}}class iue{constructor(e,n){this.zn=e,this.params=n}calculateTargetCount(e,n){return this.zn.jn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(0===n)return N.resolve(ji._e);const r=new rue(n);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.zn.removeOrphanedDocuments(e,n)}collect(e,n){return-1===this.params.cacheSizeCollectionThreshold?(Y("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(bG)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Y("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bG):this.Jn(e,n))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,n){let r,i,s,o,a,u,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(Y("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,o=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(r=g,a=Date.now(),this.removeTargets(e,r,n))).next(g=>(s=g,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(g=>(d=Date.now(),af()<=Fi.in.DEBUG&&Y("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-f}ms\n\tDetermined least recently used ${i} in `+(a-o)+`ms\n\tRemoved ${s} targets in `+(u-a)+`ms\n\tRemoved ${g} documents in `+(d-u)+`ms\nTotal Duration: ${d-f}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:g})))}}class sue{constructor(e,n){this.db=e,this.garbageCollector=function xG(t,e){return new iue(t,e)}(this,n)}jn(e){const n=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Yn(e){let n=0;return this.Hn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Hn(e,n){return this.Zn(e,(r,i)=>n(i))}addReference(e,n,r){return Gw(e,r)}removeReference(e,n,r){return Gw(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Gw(e,n)}Xn(e,n){return function(i,s){let o=!1;return SG(i).Z(a=>AG(i,a,s).next(u=>(u&&(o=!0),N.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(o,a)=>{if(a<=n){const u=this.Xn(e,o).next(d=>{if(!d)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,_e.min()),Qu(e).delete([0,Fr(o.path)])))});i.push(u)}}).next(()=>N.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Gw(e,n)}Zn(e,n){const r=Qu(e);let i,s=ji._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:d})=>{0===o?(s!==ji._e&&n(new se(Co(i)),s),s=d,i=u):s=ji._e}).next(()=>{s!==ji._e&&n(new se(Co(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Gw(t,e){return Qu(t).put((i=t.currentSequenceNumber,{targetId:0,path:Fr(e.path),sequenceNumber:i}));var i}class MG{constructor(){this.changes=new Ca(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,en.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return void 0!==r?N.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class oue{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return kl(e).put(r)}removeEntry(e,n,r){return kl(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Lw(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.er(e,r)))}getEntry(e,n){let r=en.newInvalidDocument(n);return kl(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(C_(n))},(i,s)=>{r=this.tr(n,s)}).next(()=>r)}nr(e,n){let r={size:0,document:en.newInvalidDocument(n)};return kl(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(C_(n))},(i,s)=>{r={document:this.tr(n,s),size:$w(s)}}).next(()=>r)}getEntries(e,n){let r=Ci();return this.rr(e,n,(i,s)=>{const o=this.tr(i,s);r=r.insert(i,o)}).next(()=>r)}ir(e,n){let r=Ci(),i=new qt(se.comparator);return this.rr(e,n,(s,o)=>{const a=this.tr(s,o);r=r.insert(s,a),i=i.insert(s,$w(o))}).next(()=>({documents:r,sr:i}))}rr(e,n,r){if(n.isEmpty())return N.resolve();let i=new Nt(VG);n.forEach(u=>i=i.add(u));const s=IDBKeyRange.bound(C_(i.first()),C_(i.last())),o=i.getIterator();let a=o.getNext();return kl(e).Y({index:"documentKeyIndex",range:s},(u,d,f)=>{const g=se.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&VG(a,g)<0;)r(a,null),a=o.getNext();a&&a.isEqual(g)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?f.U(C_(a)):f.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Lw(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return kl(e).W(IDBKeyRange.bound(a,u,!0)).next(d=>{s?.incrementDocumentReadCount(d.length);let f=Ci();for(const g of d){const m=this.tr(se.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);m.isFoundDocument()&&(c_(n,m)||i.has(m.key))&&(f=f.insert(m.key,m))}return f})}getAllFromCollectionGroup(e,n,r,i){let s=Ci();const o=FG(n,r),a=FG(n,Bi.max());return kl(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,d,f)=>{const g=this.tr(se.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);s=s.insert(g.key,g),s.size===i&&f.done()}).next(()=>s)}newChangeBuffer(e){return new aue(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return OG(e).get("remoteDocumentGlobalKey").next(n=>(me(!!n),n))}er(e,n){return OG(e).put("remoteDocumentGlobalKey",n)}tr(e,n){if(n){const r=function Wae(t,e){let n;if(e.document)n=iG(t.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=se.fromSegments(e.noDocument.path),i=Rl(e.noDocument.readTime);n=en.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return he();{const r=se.fromSegments(e.unknownDocument.path),i=Rl(e.unknownDocument.version);n=en.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new an(i[0],i[1]);return _e.fromTimestamp(s)}(e.readTime)),n}(this.serializer,n);if(!r.isNoDocument()||!r.version.isEqual(_e.min()))return r}return en.newInvalidDocument(e)}}function kG(t){return new oue(t)}class aue extends MG{constructor(e,n){super(),this._r=e,this.trackRemovals=n,this.ar=new Ca(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Nt((s,o)=>Ne(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.ar.get(s);if(n.push(this._r.removeEntry(e,s,a.readTime)),o.isValidDocument()){const u=dG(this._r.serializer,o);i=i.add(s.path.popLast());const d=$w(u);r+=d-a.size,n.push(this._r.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){const u=dG(this._r.serializer,o.convertToNoDocument(_e.min()));n.push(this._r.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),n.push(this._r.updateMetadata(e,r)),N.waitFor(n)}getFromCache(e,n){return this._r.nr(e,n).next(r=>(this.ar.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this._r.ir(e,n).next(({documents:r,sr:i})=>(i.forEach((s,o)=>{this.ar.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function OG(t){return ur(t,"remoteDocumentGlobal")}function kl(t){return ur(t,"remoteDocumentsV14")}function C_(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function FG(t,e){const n=e.documentKey.path.toArray();return[t,Lw(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function VG(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Ne(n[s],r[s]),i)return i;return i=Ne(n.length,r.length),i||(i=Ne(n[n.length-2],r[r.length-2]),i||Ne(n[n.length-1],r[r.length-1]))}class uue{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class LG{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(null!==r&&f_(r.mutation,i,Ti.empty(),an.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Be()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Be()){const i=Do();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=l_();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Do();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Be()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Ci();const o=d_(),a=d_();return n.forEach((u,d)=>{const f=r.get(d.key);i.has(d.key)&&(void 0===f||f.mutation instanceof ba)?s=s.insert(d.key,d):void 0!==f?(o.set(d.key,f.mutation.getFieldMask()),f_(f.mutation,d,f.mutation.getFieldMask(),an.now())):o.set(d.key,Ti.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((d,f)=>o.set(d,f)),n.forEach((d,f)=>{var g;return a.set(d,new uue(f,null!==(g=o.get(d))&&void 0!==g?g:null))}),a))}recalculateAndSaveOverlays(e,n){const r=d_();let i=new qt((o,a)=>o-a),s=Be();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(u=>{const d=n.get(u);if(null===d)return;let f=r.get(u)||Ti.empty();f=a.applyToLocalView(d,f),r.set(u,f);const g=(i.get(a.batchId)||Be()).add(u);i=i.insert(a.batchId,g)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),d=u.key,f=u.value,g=RH();f.forEach(m=>{if(!s.has(m)){const y=LH(n.get(m),r.get(m));null!==y&&g.set(m,y),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,g))}return N.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return se.isDocumentKey((o=n).path)&&null===o.collectionGroup&&0===o.filters.length?this.getDocumentsMatchingDocumentQuery(e,n.path):MR(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i);var o}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):N.resolve(Do());let a=-1,u=s;return o.next(d=>N.forEach(d,(f,g)=>(a<g.largestBatchId&&(a=g.largestBatchId),s.get(f)?N.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{u=u.insert(f,m)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,u,d,Be())).next(f=>({batchId:a,changes:SH(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new se(n)).next(r=>{let i=l_();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=l_();return this.indexManager.getCollectionParents(e,s).next(a=>N.forEach(a,u=>{const d=(g=n,m=u.child(s),new Ta(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt));var g,m;return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(f=>{f.forEach((g,m)=>{o=o.insert(g,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,d)=>{const f=d.getKey();null===o.get(f)&&(o=o.insert(f,en.newInvalidDocument(f)))});let a=l_();return o.forEach((u,d)=>{const f=s.get(u);void 0!==f&&f_(f.mutation,d,Ti.empty(),an.now()),c_(n,d)&&(a=a.insert(u,d))}),a})}}class cue{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return N.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,{id:(i=n).id,version:i.version,createTime:On(i.createTime)}),N.resolve();var i}getNamedQuery(e,n){return N.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,{name:(i=n).name,query:zR(i.bundledQuery),readTime:On(i.readTime)}),N.resolve();var i}}class lue{constructor(){this.overlays=new qt(se.comparator),this.lr=new Map}getOverlay(e,n){return N.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Do();return N.forEach(n,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),N.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.lr.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),N.resolve()}getOverlaysForCollection(e,n,r){const i=Do(),s=n.length+1,o=new se(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return N.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new qt((d,f)=>d-f);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let f=s.get(d.largestBatchId);null===f&&(f=Do(),s=s.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const a=Do(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>a.set(d,f)),!(a.size()>=i)););return N.resolve(a)}lt(e,n,r){const i=this.overlays.get(r.key);if(null!==i){const o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new UR(n,r));let s=this.lr.get(n);void 0===s&&(s=Be(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}}class JR{constructor(){this.hr=new Nt(cr.Pr),this.Ir=new Nt(cr.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){const r=new cr(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new cr(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){const n=new se(new dt([])),r=new cr(n,e),i=new cr(n,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const n=new se(new dt([])),r=new cr(n,e),i=new cr(n,e+1);let s=Be();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new cr(e,0),r=this.hr.firstAfterOrEqual(n);return null!==r&&e.isEqual(r.key)}}class cr{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return se.comparator(e.key,n.key)||Ne(e.gr,n.gr)}static Tr(e,n){return Ne(e.gr,n.gr)||se.comparator(e.key,n.key)}}class due{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new Nt(cr.Pr)}checkEmpty(e){return N.resolve(0===this.mutationQueue.length)}addMutationBatch(e,n,r,i){const s=this.pr;this.pr++;const o=new VR(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.yr=this.yr.add(new cr(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return N.resolve(o)}lookupMutationBatch(e,n){return N.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){const i=this.Sr(n+1),s=i<0?0:i;return N.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new cr(n,0),i=new cr(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{const a=this.wr(o.gr);s.push(a)}),N.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Nt(Ne);return n.forEach(i=>{const s=new cr(i,0),o=new cr(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),N.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;se.isDocumentKey(s)||(s=s.child(""));const o=new cr(new se(s),0);let a=new Nt(Ne);return this.yr.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(a=a.add(u.gr)),!0)},o),N.resolve(this.br(a))}br(e){const n=[];return e.forEach(r=>{const i=this.wr(r);null!==i&&n.push(i)}),n}removeMutationBatch(e,n){me(0===this.Dr(n.batchId,"removed")),this.mutationQueue.shift();let r=this.yr;return N.forEach(n.mutations,i=>{const s=new cr(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){const r=new cr(n,0),i=this.yr.firstAfterOrEqual(r);return N.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return N.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class hue{constructor(e){this.Cr=e,this.docs=new qt(se.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return N.resolve(r?r.document.mutableCopy():en.newInvalidDocument(n))}getEntries(e,n){let r=Ci();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():en.newInvalidDocument(i))}),N.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Ci();const o=n.path,a=new se(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||TR($$(f),r)<=0||(i.has(f.key)||c_(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return N.resolve(s)}getAllFromCollectionGroup(e,n,r,i){he()}vr(e,n){return N.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new fue(this)}getSize(e){return N.resolve(this.size)}}class fue extends MG{constructor(e){super(),this._r=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),N.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}}class pue{constructor(e){this.persistence=e,this.Fr=new Ca(n=>bl(n),a_),this.lastRemoteSnapshotVersion=_e.min(),this.highestTargetId=0,this.Mr=0,this.Or=new JR,this.targetCount=0,this.Nr=Ml.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),N.resolve()}kn(e){this.Fr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Nr=new Ml(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,N.resolve()}updateTargetData(e,n){return this.kn(n),N.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&null===r.get(a.targetId)&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),N.waitFor(s).next(()=>i)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,n){const r=this.Fr.get(n)||null;return N.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),N.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),N.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),N.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Or.mr(n);return N.resolve(r)}containsKey(e,n){return N.resolve(this.Or.containsKey(n))}}class eP{constructor(e,n){this.Br={},this.overlays={},this.Lr=new ji(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new pue(this),this.indexManager=new eue,this.remoteDocumentCache=new hue(r=>this.referenceDelegate.Qr(r)),this.serializer=new lG(n),this.Kr=new cue(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new lue,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new due(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){Y("MemoryPersistence","Starting transaction:",e);const i=new gue(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return N.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}}class gue extends G${constructor(e){super(),this.currentSequenceNumber=e}}class qw{constructor(e){this.persistence=e,this.Gr=new JR,this.zr=null}static jr(e){return new qw(e)}get Hr(){if(this.zr)return this.zr;throw he()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),N.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),N.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),N.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.Hr,r=>{const i=se.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,_e.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return N.or([()=>N.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}}class mue{constructor(e){this.serializer=e}N(e,n,r,i){const s=new ww("createOrUpgrade",n);var u;r<1&&i>=1&&(e.createObjectStore("owner"),(u=e).createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",K$,{unique:!0}),u.createObjectStore("documentMutations"),UG(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=N.resolve();return r<3&&i>=3&&(0!==r&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),UG(e)),o=o.next(()=>function(u){const d=u.store("targetGlobal"),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:_e.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",f)}(s))),r<4&&i>=4&&(0!==r&&(o=o.next(()=>function(u,d){return d.store("mutations").W().next(f=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",K$,{unique:!0});const g=d.store("mutations"),m=f.map(y=>g.put(y));return N.waitFor(m)})}(e,s))),o=o.next(()=>{!function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(o=o.next(()=>this.Zr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(o=o.next(()=>this.ei(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(e,s))),r<9&&i>=9&&(o=o.next(()=>{!function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(o=o.next(()=>this.ni(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{!function(u){const d=u.createObjectStore("documentOverlays",{keyPath:tae});d.createIndex("collectionPathOverlayIndex",nae,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",rae,{unique:!1})}(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){const d=u.createObjectStore("remoteDocumentsV14",{keyPath:Goe});d.createIndex("documentKeyIndex",qoe),d.createIndex("collectionGroupIndex",zoe)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ii(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:Yoe}).createIndex("sequenceNumberIndex",Xoe,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:Joe}).createIndex("documentKeyIndex",eae,{unique:!1})}(e))),o}Xr(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=$w(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>N.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>N.forEach(a,u=>{me(u.userId===s.userId);const d=Pl(this.serializer,u);return DG(e,s.userId,d).next(()=>{})}))}))}ei(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((o,a)=>{const u=new dt(o),d=[0,Fr(u)];s.push(n.get(d).next(f=>f?N.resolve():n.put({targetId:0,path:Fr(u),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>N.waitFor(s))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:Qoe});const r=n.store("collectionParents"),i=new XR,s=o=>{if(i.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:Fr(u)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{const u=new dt(o);return s(u.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,u],d)=>{const f=Co(a);return s(f.popLast())}))}ni(e){const n=e.store("targets");return n.Y((r,i)=>{const s=E_(i),o=hG(this.serializer,s);return n.put(o)})}ri(e,n){const r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{const a=n.store("remoteDocumentsV14"),u=(g=o,g.document?new se(dt.fromString(g.document.name).popFirst(5)):g.noDocument?se.fromSegments(g.noDocument.path):g.unknownDocument?se.fromSegments(g.unknownDocument.path):he()).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};var g;i.push(a.put(d))}).next(()=>N.waitFor(i))}ii(e,n){const r=n.store("mutations"),i=kG(this.serializer),s=new eP(qw.jr,this.serializer.ut);return r.W().next(o=>{const a=new Map;return o.forEach(u=>{var d;let f=null!==(d=a.get(u.userId))&&void 0!==d?d:Be();Pl(this.serializer,u).keys().forEach(g=>f=f.add(g)),a.set(u.userId,f)}),N.forEach(a,(u,d)=>{const f=new ar(d),g=Uw.ct(this.serializer,f),m=s.getIndexManager(f),y=Hw.ct(f,this.serializer,m,s.referenceDelegate);return new LG(i,y,g,m).recalculateAndSaveOverlaysForDocumentKeys(new DR(n,ji._e),u).next()})})}}function UG(t){t.createObjectStore("targetDocuments",{keyPath:Koe}).createIndex("documentTargetsIndex",Zoe,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Woe,{unique:!0}),t.createObjectStore("targetGlobal")}const tP="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class nP{constructor(e,n,r,i,s,o,a,u,d,f,g=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.si=s,this.window=o,this.document=a,this.oi=d,this._i=f,this.ai=g,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=m=>Promise.resolve(),!nP.D())throw new Z(F.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new sue(this,i),this.Ii=n+"main",this.serializer=new lG(u),this.Ti=new $s(this.Ii,this.ai,new mue(this.serializer)),this.qr=new nue(this.referenceDelegate,this.serializer),this.remoteDocumentCache=kG(this.serializer),this.Kr=new Kae,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,!1===f&&kn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Z(F.FAILED_PRECONDITION,tP);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new ji(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){var n=this;return this.Pi=function(){var r=(0,$.Z)(function*(i){if(n.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(function(){var n=(0,$.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return n.apply(this,arguments)}}())}setNetworkEnabled(e){var n=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget((0,$.Z)(function*(){n.started&&(yield n.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ww(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(n=>this.isPrimary&&!n?this.pi(e).next(()=>!1):!!n&&this.yi(e).next(()=>!0))).catch(e=>{if(Uu(e))return Y("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Y("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return b_(e).get("owner").next(n=>N.resolve(this.wi(n)))}Si(e){return Ww(e).delete(this.clientId)}bi(){var e=this;return(0,$.Z)(function*(){if(e.isPrimary&&!e.Di(e.hi,18e5)){e.hi=Date.now();const n=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=ur(r,"clientMetadata");return i.W().next(s=>{const o=e.Ci(s,18e5),a=s.filter(u=>-1===o.indexOf(u));return N.forEach(a,u=>i.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(e.Ei)for(const r of n)e.Ei.removeItem(e.vi(r.clientId))}})()}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?N.resolve(!0):b_(e).get("owner").next(n=>{if(null!==n&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)){if(this.wi(n)&&this.networkEnabled)return!0;if(!this.wi(n)){if(!n.allowTabSynchronization)throw new Z(F.FAILED_PRECONDITION,tP);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ww(e).W().next(r=>void 0===this.Ci(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(n=>(this.isPrimary!==n&&Y("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){var e=this;return(0,$.Z)(function*(){e.kr=!1,e.Mi(),e.li&&(e.li.cancel(),e.li=null),e.xi(),e.Oi(),yield e.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],n=>{const r=new DR(n,ji._e);return e.pi(r).next(()=>e.Si(r))}),e.Ti.close(),e.Ni()})()}Ci(e,n){return e.filter(r=>this.Di(r.updateTimeMs,n)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Ww(e).W().next(n=>this.Ci(n,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,n){return Hw.ct(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new tue(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Uw.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,n,r){Y("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===n?"readonly":"readwrite",s=15===(u=this.ai)?sae:14===u?X$:13===u?Y$:12===u?iae:11===u?Q$:void he();var u;let o;return this.Ti.runTransaction(e,i,s,a=>(o=new DR(a,this.Lr?this.Lr.next():ji._e),"readwrite-primary"===n?this.fi(o).next(u=>!!u||this.gi(o)).next(u=>{if(!u)throw kn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new Z(F.FAILED_PRECONDITION,H$);return r(o)}).next(u=>this.yi(o).next(()=>u)):this.Li(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Li(e){return b_(e).get("owner").next(n=>{if(null!==n&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)&&!this.wi(n)&&!(this._i||this.allowTabSynchronization&&n.allowTabSynchronization))throw new Z(F.FAILED_PRECONDITION,tP)})}yi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return b_(e).put("owner",n)}static D(){return $s.D()}pi(e){const n=b_(e);return n.get("owner").next(r=>this.wi(r)?(Y("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):N.resolve())}Di(e,n){const r=Date.now();return!(e<r-n||e>r&&(kn(`Detected an update time that is in the future: ${e} > ${r}`),1))}Ai(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Mi();const n=/(?:Version|Mobile)\/1[456]/;(0,I.G6)()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var n;try{const r=null!==(null===(n=this.Ei)||void 0===n?void 0:n.getItem(this.vi(e)));return Y("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return kn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){kn("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function b_(t){return ur(t,"owner")}function Ww(t){return ur(t,"clientMetadata")}function rP(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}class iP{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=Be(),i=Be();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new iP(e,n.fromCache,r,i)}}class _ue{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class BG{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.zi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new _ue;return this.Hi(e,n,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(af()<=Fi.in.DEBUG&&Y("QueryEngine","SDK will not create cache indexes for query:",mf(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),N.resolve()):(af()<=Fi.in.DEBUG&&Y("QueryEngine","Query:",mf(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(af()<=Fi.in.DEBUG&&Y("QueryEngine","The SDK decides to create cache indexes for query:",mf(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Jr(n))):N.resolve())}zi(e,n){if(wH(n))return N.resolve(null);let r=Jr(n);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==n.limit&&1===i&&(n=xw(n,null,"F"),r=Jr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Be(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.Yi(n,a);return this.Zi(n,d,o,u.readTime)?this.zi(e,xw(n,null,"F")):this.Xi(e,d,n,u)}))})))}ji(e,n,r,i){return wH(n)||i.isEqual(_e.min())?N.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const o=this.Yi(n,s);return this.Zi(n,o,r,i)?N.resolve(null):(af()<=Fi.in.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),mf(n)),this.Xi(e,o,n,j$(i,-1)).next(a=>a))})}Yi(e,n){let r=new Nt(DH(e));return n.forEach((i,s)=>{c_(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(null===e.limit)return!1;if(r.size!==n.size)return!0;const s="F"===e.limitType?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return af()<=Fi.in.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",mf(n)),this.Gi.getDocumentsMatchingQuery(e,n,Bi.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}class yue{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new qt(Ne),this.ns=new Ca(s=>bl(s),a_),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LG(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}}function jG(t,e,n,r){return new yue(t,e,n,r)}function $G(t,e){return sP.apply(this,arguments)}function sP(){return sP=(0,$.Z)(function*(t,e){const n=ie(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let u=Be();for(const d of i){o.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of s){a.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(d=>({_s:d,removedBatchIds:o,addedBatchIds:a}))})})}),sP.apply(this,arguments)}function HG(t){const e=ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function GG(t,e,n){let r=Be(),i=Be();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Ci();return n.forEach((a,u)=>{const d=s.get(a);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(_e.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||0===u.version.compareTo(d.version)&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):Y("LocalStore","Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",u.version)}),{us:o,cs:i}})}function Iue(t,e){const n=ie(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Af(t,e){const n=ie(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,N.resolve(i)):n.qr.allocateTargetId(r).next(o=>(i=new Da(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.ts.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}function Sf(t,e,n){return oP.apply(this,arguments)}function oP(){return oP=(0,$.Z)(function*(t,e,n){const r=ie(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Uu(o))throw o;Y("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}),oP.apply(this,arguments)}function Kw(t,e,n){const r=ie(t);let i=_e.min(),s=Be();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,f){const g=ie(u),m=g.ns.get(f);return void 0!==m?N.resolve(g.ts.get(m)):g.qr.getTargetData(d,f)}(r,o,Jr(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,n?i:_e.min(),n?s:Be())).next(a=>(WG(r,bH(e),a),{documents:a,ls:s})))}function qG(t,e){const n=ie(t),r=ie(n.qr),i=n.ts.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function zG(t,e){const n=ie(t),r=n.rs.get(e)||_e.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.ss.getAllFromCollectionGroup(i,e,j$(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(WG(n,e,i),i))}function WG(t,e,n){let r=t.rs.get(e)||_e.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}function aP(){return aP=(0,$.Z)(function*(t,e,n,r){const i=ie(t);let s=Be(),o=Ci();for(const d of n){const f=e.hs(d.metadata.name);d.document&&(s=s.add(f));const g=e.Ps(d);g.setReadTime(e.Is(d.metadata.readTime)),o=o.insert(f,g)}const a=i.ss.newChangeBuffer({trackRemovals:!0}),u=yield Af(i,(f=r,Jr(pf(dt.fromString(`__bundle__/docs/${f}`)))));var f;return i.persistence.runTransaction("Apply bundle documents","readwrite",d=>GG(d,a,o).next(f=>(a.apply(d),f)).next(f=>i.qr.removeMatchingKeysForTargetId(d,u.targetId).next(()=>i.qr.addMatchingKeys(d,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(d,f.us,f.cs)).next(()=>f.us)))}),aP.apply(this,arguments)}function Tue(t,e){return uP.apply(this,arguments)}function uP(){return uP=(0,$.Z)(function*(t,e,n=Be()){const r=yield Af(t,Jr(zR(e.bundledQuery))),i=ie(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=On(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Kr.saveNamedQuery(s,e);const a=r.withResumeToken(Xn.EMPTY_BYTE_STRING,o);return i.ts=i.ts.insert(a.targetId,a),i.qr.updateTargetData(s,a).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,n,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}),uP.apply(this,arguments)}function KG(t,e){return`firestore_clients_${t}_${e}`}function ZG(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function cP(t,e){return`firestore_targets_${t}_${e}`}class Zw{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ts(e,n,r){const i=JSON.parse(r);let s,o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code,o&&(s=new Z(i.error.code,i.error.message))),o?new Zw(e,n,i.state,s):(kn("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class D_{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ts(e,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new Z(r.error.code,r.error.message))),s?new D_(e,r.state,i):(kn("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Qw{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ts(e,n){const r=JSON.parse(n);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=OR();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=z$(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new Qw(e,s):(kn("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class lP{constructor(e,n){this.clientId=e,this.onlineState=n}static Ts(e){const n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new lP(n.clientId,n.onlineState):(kn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class dP{constructor(){this.activeTargetIds=OR()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class hP{constructor(e,n,r,i,s){this.window=e,this.si=n,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new qt(Ne),this.started=!1,this.ps=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=KG(this.persistenceKey,this.Rs),this.ws=`firestore_sequence_number_${this.persistenceKey}`,this.gs=this.gs.insert(this.Rs,new dP),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=`firestore_online_state_${this.persistenceKey}`,this.vs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,$.Z)(function*(){const n=yield e.syncEngine.Bi();for(const i of n){if(i===e.Rs)continue;const s=e.getItem(KG(e.persistenceKey,i));if(s){const o=Qw.Ts(i,s);o&&(e.gs=e.gs.insert(o.clientId,o))}}e.Fs();const r=e.storage.getItem(e.Cs);if(r){const i=e.Ms(r);i&&e.xs(i)}for(const i of e.ps)e.fs(i);e.ps=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let n=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,n,r){this.Ns(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(cP(this.persistenceKey,e));if(r){const i=D_.Ts(e,r);i&&(n=i.state)}}return this.Ls.ds(e),this.Fs(),n}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(cP(this.persistenceKey,e))}updateQueryState(e,n,r){this.ks(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return Y("SharedClientState","READ",e,n),n}setItem(e,n){Y("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){Y("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){var n=this;const r=e;if(r.storageArea===this.storage){if(Y("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ys)return void kn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable((0,$.Z)(function*(){if(n.started){if(null!==r.key)if(n.Ss.test(r.key)){if(null==r.newValue){const i=n.Ks(r.key);return n.$s(i,null)}{const i=n.Us(r.key,r.newValue);if(i)return n.$s(i.clientId,i)}}else if(n.bs.test(r.key)){if(null!==r.newValue){const i=n.Ws(r.key,r.newValue);if(i)return n.Gs(i)}}else if(n.Ds.test(r.key)){if(null!==r.newValue){const i=n.zs(r.key,r.newValue);if(i)return n.js(i)}}else if(r.key===n.Cs){if(null!==r.newValue){const i=n.Ms(r.newValue);if(i)return n.xs(i)}}else if(r.key===n.ws){const i=function(o){let a=ji._e;if(null!=o)try{const u=JSON.parse(o);me("number"==typeof u),a=u}catch(u){kn("SharedClientState","Failed to read sequence number from WebStorage",u)}return a}(r.newValue);i!==ji._e&&n.sequenceNumberHandler(i)}else if(r.key===n.vs){const i=n.Hs(r.newValue);yield Promise.all(i.map(s=>n.syncEngine.Js(s)))}}else n.ps.push(r)}))}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,n,r){const i=new Zw(this.currentUser,e,n,r),s=ZG(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const n=ZG(this.persistenceKey,this.currentUser,e);this.removeItem(n)}qs(e){this.storage.setItem(this.Cs,JSON.stringify({clientId:this.Rs,onlineState:e}))}ks(e,n,r){const i=cP(this.persistenceKey,e),s=new D_(e,n,r);this.setItem(i,s.Es())}Qs(e){const n=JSON.stringify(Array.from(e));this.setItem(this.vs,n)}Ks(e){const n=this.Ss.exec(e);return n?n[1]:null}Us(e,n){const r=this.Ks(e);return Qw.Ts(r,n)}Ws(e,n){const r=this.bs.exec(e),i=Number(r[1]);return Zw.Ts(new ar(void 0!==r[2]?r[2]:null),i,n)}zs(e,n){const r=this.Ds.exec(e),i=Number(r[1]);return D_.Ts(i,n)}Ms(e){return lP.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){var n=this;return(0,$.Z)(function*(){if(e.user.uid===n.currentUser.uid)return n.syncEngine.Ys(e.batchId,e.state,e.error);Y("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,n){const r=n?this.gs.insert(e,n):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let n=OR();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class QG{constructor(){this.eo=new dP,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new dP,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Cue{ro(e){}shutdown(){}}class YG{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){Y("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){Y("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Yw=null;function fP(){return null===Yw?Yw=268435456+Math.round(2147483648*Math.random()):Yw++,"0x"+Yw.toString(16)}const bue={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Due{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const Lr="WebChannelConnection";class Aue extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+n.host,this.fo=`projects/${i}/databases/${s}`,this.po="(default)"===this.databaseId.database?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(n,r,i,s,o){const a=fP(),u=this.So(n,r);Y("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);const d={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(d,s,o),this.Do(n,u,d,i).then(f=>(Y("RestConnection",`Received RPC '${n}' ${a}: `,f),f),f=>{throw wi("RestConnection",`RPC '${n}' ${a} failed with error: `,f,"url: ",u,"request:",i),f})}Co(n,r,i,s,o,a){return this.wo(n,r,i,s,o)}bo(n,r,i){n["X-Goog-Api-Client"]="gl-js/ fire/"+sf,n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}So(n,r){return`${this.mo}/v1/${r}:${bue[n]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,n,r,i){const s=fP();return new Promise((o,a)=>{const u=new Coe;u.setWithCredentials(!0),u.listenOnce(woe.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case ER.NO_ERROR:const f=u.getResponseJson();Y(Lr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case ER.TIMEOUT:Y(Lr,`RPC '${e}' ${s} timed out`),a(new Z(F.DEADLINE_EXCEEDED,"Request time out"));break;case ER.HTTP_ERROR:const g=u.getStatus();if(Y(Lr,`RPC '${e}' ${s} failed with status:`,g,"response text:",u.getResponseText()),g>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const y=m?.error;if(y&&y.status&&y.message){const E=function(D){const O=D.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(O)>=0?O:F.UNKNOWN}(y.status);a(new Z(E,y.message))}else a(new Z(F.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new Z(F.UNAVAILABLE,"Connection failed."));break;default:he()}}finally{Y(Lr,`RPC '${e}' ${s} completed.`)}});const d=JSON.stringify(i);Y(Lr,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",d,r,15)})}vo(e,n,r){const i=fP(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Eoe(),a=Ioe(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;void 0!==d&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.bo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const f=s.join("");Y(Lr,`Creating RPC '${e}' stream ${i}: ${f}`,u);const g=o.createWebChannel(f,u);let m=!1,y=!1;const E=new Due({co:D=>{y?Y(Lr,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(m||(Y(Lr,`Opening RPC '${e}' stream ${i} transport.`),g.open(),m=!0),Y(Lr,`RPC '${e}' stream ${i} sending:`,D),g.send(D))},lo:()=>g.close()}),C=(D,O,R)=>{D.listen(O,k=>{try{R(k)}catch(G){setTimeout(()=>{throw G},0)}})};return C(g,Iw.EventType.OPEN,()=>{y||Y(Lr,`RPC '${e}' stream ${i} transport opened.`)}),C(g,Iw.EventType.CLOSE,()=>{y||(y=!0,Y(Lr,`RPC '${e}' stream ${i} transport closed`),E.Ro())}),C(g,Iw.EventType.ERROR,D=>{y||(y=!0,wi(Lr,`RPC '${e}' stream ${i} transport errored:`,D),E.Ro(new Z(F.UNAVAILABLE,"The operation could not be completed")))}),C(g,Iw.EventType.MESSAGE,D=>{var O;if(!y){const R=D.data[0];me(!!R);const G=R.error||(null===(O=R[0])||void 0===O?void 0:O.error);if(G){Y(Lr,`RPC '${e}' stream ${i} received error:`,G);const ne=G.status;let Te=function(xa){const DT=$n[xa];if(void 0!==DT)return GH(DT)}(ne),at=G.message;void 0===Te&&(Te=F.INTERNAL,at="Unknown error status: "+ne+" with message "+G.message),y=!0,E.Ro(new Z(Te,at)),g.close()}else Y(Lr,`RPC '${e}' stream ${i} received:`,R),E.Vo(R)}}),C(a,Toe.STAT_EVENT,D=>{D.stat===O$.PROXY?Y(Lr,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===O$.NOPROXY&&Y(Lr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.Ao()},0),E}}function XG(){return typeof window<"u"?window:null}function Xw(){return typeof document<"u"?document:null}function A_(t){return new Vae(t,!0)}class pP{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const n=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&Y("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class JG{constructor(e,n,r,i,s,o,a,u){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new pP(e,n)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}stop(){var e=this;return(0,$.Z)(function*(){e.jo()&&(yield e.close(0))})()}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}Xo(){var e=this;return(0,$.Z)(function*(){if(e.Ho())return e.close(0)})()}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(e,n){var r=this;return(0,$.Z)(function*(){r.t_(),r.n_(),r.zo.cancel(),r.Uo++,4!==e?r.zo.reset():n&&n.code===F.RESOURCE_EXHAUSTED?(kn(n.toString()),kn("Using maximum backoff delay to prevent overloading the backend."),r.zo.Lo()):n&&n.code===F.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.r_(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Io(n)})()}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),n=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===n&&this.s_(r,i)},r=>{e(()=>{const i=new Z(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,n){const r=this.i_(this.Uo);this.stream=this.__(e,n),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){var e=this;this.state=5,this.zo.ko((0,$.Z)(function*(){e.state=0,e.start()}))}o_(e){return Y("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return n=>{this.si.enqueueAndForget(()=>this.Uo===e?n():(Y("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Sue extends JG{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}__(e,n){return this.connection.vo("Listen",e,n)}onMessage(e){this.zo.reset();const n=function Bae(t,e){let n;if("targetChange"in e){const r="NO_CHANGE"===(d=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===d?1:"REMOVE"===d?2:"CURRENT"===d?3:"RESET"===d?4:he(),i=e.targetChange.targetIds||[],s=function(d,f){return d.useProto3Json?(me(void 0===f||"string"==typeof f),Xn.fromBase64String(f||"")):(me(void 0===f||f instanceof Uint8Array),Xn.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const f=void 0===d.code?F.UNKNOWN:GH(d.code);return new Z(f,d.message||"")}(o);n=new ZH(r,i,s,a||null)}else if("documentChange"in e){const r=e.documentChange,i=Ao(t,r.document.name),s=On(r.document.updateTime),o=r.document.createTime?On(r.document.createTime):_e.min(),a=new Dr({mapValue:{fields:r.document.fields}}),u=en.newFoundDocument(i,s,o,a);n=new Vw(r.targetIds||[],r.removedTargetIds||[],u.key,u)}else if("documentDelete"in e){const r=e.documentDelete,i=Ao(t,r.document),s=r.readTime?On(r.readTime):_e.min(),o=en.newNoDocument(i,s);n=new Vw([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const r=e.documentRemove,i=Ao(t,r.document);n=new Vw([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return he();{const r=e.filter,{count:i=0,unchangedNames:s}=r,o=new Nae(i,s);n=new KH(r.targetId,o)}}var d;return n}(this.serializer,e),r=function(s){if(!("targetChange"in s))return _e.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?_e.min():o.readTime?On(o.readTime):_e.min()}(e);return this.listener.a_(n,r)}u_(e){const n={};n.database=y_(this.serializer),n.addTarget=function(s,o){let a;const u=o.target;if(a=Pw(u)?{documents:sG(s,u)}:{query:qR(s,u)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=JH(s,o.resumeToken);const d=jR(s,o.expectedCount);null!==d&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(_e.min())>0){a.readTime=If(s,o.snapshotVersion.toTimestamp());const d=jR(s,o.expectedCount);null!==d&&(a.expectedCount=d)}return a}(this.serializer,e);const r=function $ae(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return he()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);r&&(n.labels=r),this.e_(n)}c_(e){const n={};n.database=y_(this.serializer),n.removeTarget=e,this.e_(n)}}class Rue extends JG{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,n){return this.connection.vo("Write",e,n)}onMessage(e){if(me(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const n=function jae(t,e){return t&&t.length>0?(me(void 0!==e),t.map(n=>function(i,s){let o=On(i.updateTime?i.updateTime:s);return o.isEqual(_e.min())&&(o=On(s)),new Aae(o,i.transformResults||[])}(n,e))):[]}(e.writeResults,e.commitTime),r=On(e.commitTime);return this.listener.I_(r,n)}return me(!e.writeResults||0===e.writeResults.length),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=y_(this.serializer),this.e_(e)}P_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>v_(this.serializer,r))};this.e_(n)}}class Pue extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new Z(F.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,n,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,n,r,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Z(F.UNKNOWN,i.toString())})}Co(e,n,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,n,r,s,o,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Z(F.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class xue{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,"Online"===e&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const n=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(kn(n),this.f_=!1):Y("OnlineStateTracker",n)}S_(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}class Mue{constructor(e,n,r,i,s){var o=this;this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget((0,$.Z)(function*(){var u;Yu(o)&&(Y("RemoteStore","Restarting streams for network reachability change."),yield(u=(0,$.Z)(function*(f){const g=ie(f);g.C_.add(4),yield Rf(g),g.M_.set("Unknown"),g.C_.delete(4),yield S_(g)}),function d(f){return u.apply(this,arguments)})(o))}))}),this.M_=new xue(r,i)}}function S_(t){return mP.apply(this,arguments)}function mP(){return mP=(0,$.Z)(function*(t){if(Yu(t))for(const e of t.v_)yield e(!0)}),mP.apply(this,arguments)}function Rf(t){return _P.apply(this,arguments)}function _P(){return _P=(0,$.Z)(function*(t){for(const e of t.v_)yield e(!1)}),_P.apply(this,arguments)}function Jw(t,e){const n=ie(t);n.D_.has(e.targetId)||(n.D_.set(e.targetId,e),EP(n)?vP(n):Nf(n).Ho()&&yP(n,e))}function R_(t,e){const n=ie(t),r=Nf(n);n.D_.delete(e),r.Ho()&&eq(n,e),0===n.D_.size&&(r.Ho()?r.Zo():Yu(n)&&n.M_.set("Unknown"))}function yP(t,e){if(t.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(_e.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Nf(t).u_(e)}function eq(t,e){t.x_.Oe(e),Nf(t).c_(e)}function vP(t){t.x_=new Mae({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.D_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Nf(t).start(),t.M_.g_()}function EP(t){return Yu(t)&&!Nf(t).jo()&&t.D_.size>0}function Yu(t){return 0===ie(t).C_.size}function tq(t){t.x_=void 0}function kue(t){return IP.apply(this,arguments)}function IP(){return IP=(0,$.Z)(function*(t){t.D_.forEach((e,n)=>{yP(t,e)})}),IP.apply(this,arguments)}function Oue(t,e){return wP.apply(this,arguments)}function wP(){return wP=(0,$.Z)(function*(t,e){tq(t),EP(t)?(t.M_.w_(e),vP(t)):t.M_.set("Unknown")}),wP.apply(this,arguments)}function Fue(t,e,n){return TP.apply(this,arguments)}function TP(){return TP=(0,$.Z)(function*(t,e,n){if(t.M_.set("Online"),e instanceof ZH&&2===e.state&&e.cause)try{yield(r=(0,$.Z)(function*(s,o){const a=o.cause;for(const u of o.targetIds)s.D_.has(u)&&(yield s.remoteSyncer.rejectListen(u,a),s.D_.delete(u),s.x_.removeTarget(u))}),function i(s,o){return r.apply(this,arguments)})(t,e)}catch(r){Y("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield eT(t,r)}else if(e instanceof Vw?t.x_.$e(e):e instanceof KH?t.x_.Je(e):t.x_.Ge(e),!n.isEqual(_e.min()))try{const r=yield HG(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){const a=s.x_.it(o);return a.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=s.D_.get(d);f&&s.D_.set(d,f.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,d)=>{const f=s.D_.get(u);if(!f)return;s.D_.set(u,f.withResumeToken(Xn.EMPTY_BYTE_STRING,f.snapshotVersion)),eq(s,u);const g=new Da(f.target,u,d,f.sequenceNumber);yP(s,g)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){Y("RemoteStore","Failed to raise snapshot:",r),yield eT(t,r)}var r}),TP.apply(this,arguments)}function eT(t,e,n){return CP.apply(this,arguments)}function CP(){return CP=(0,$.Z)(function*(t,e,n){if(!Uu(e))throw e;t.C_.add(1),yield Rf(t),t.M_.set("Offline"),n||(n=()=>HG(t.localStore)),t.asyncQueue.enqueueRetryable((0,$.Z)(function*(){Y("RemoteStore","Retrying IndexedDB access"),yield n(),t.C_.delete(1),yield S_(t)}))}),CP.apply(this,arguments)}function nq(t,e){return e().catch(n=>eT(t,n,e))}function Pf(t){return bP.apply(this,arguments)}function bP(){return bP=(0,$.Z)(function*(t){const e=ie(t),n=Xu(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;Vue(e);)try{const i=yield Iue(e.localStore,r);if(null===i){0===e.b_.length&&n.Zo();break}r=i.batchId,Lue(e,i)}catch(i){yield eT(e,i)}rq(e)&&iq(e)}),bP.apply(this,arguments)}function Vue(t){return Yu(t)&&t.b_.length<10}function Lue(t,e){t.b_.push(e);const n=Xu(t);n.Ho()&&n.h_&&n.P_(e.mutations)}function rq(t){return Yu(t)&&!Xu(t).jo()&&t.b_.length>0}function iq(t){Xu(t).start()}function Uue(t){return DP.apply(this,arguments)}function DP(){return DP=(0,$.Z)(function*(t){Xu(t).E_()}),DP.apply(this,arguments)}function Bue(t){return AP.apply(this,arguments)}function AP(){return AP=(0,$.Z)(function*(t){const e=Xu(t);for(const n of t.b_)e.P_(n.mutations)}),AP.apply(this,arguments)}function jue(t,e,n){return SP.apply(this,arguments)}function SP(){return SP=(0,$.Z)(function*(t,e,n){const r=t.b_.shift(),i=LR.from(r,e,n);yield nq(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Pf(t)}),SP.apply(this,arguments)}function $ue(t,e){return RP.apply(this,arguments)}function RP(){return RP=(0,$.Z)(function*(t,e){var n;e&&Xu(t).h_&&(yield(n=(0,$.Z)(function*(i,s){if(HH(a=s.code)&&a!==F.ABORTED){const o=i.b_.shift();Xu(i).Yo(),yield nq(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield Pf(i)}var a}),function r(i,s){return n.apply(this,arguments)})(t,e)),rq(t)&&iq(t)}),RP.apply(this,arguments)}function sq(t,e){return PP.apply(this,arguments)}function PP(){return PP=(0,$.Z)(function*(t,e){const n=ie(t);n.asyncQueue.verifyOperationInProgress(),Y("RemoteStore","RemoteStore received new credentials");const r=Yu(n);n.C_.add(3),yield Rf(n),r&&n.M_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.C_.delete(3),yield S_(n)}),PP.apply(this,arguments)}function NP(t,e){return xP.apply(this,arguments)}function xP(){return xP=(0,$.Z)(function*(t,e){const n=ie(t);e?(n.C_.delete(2),yield S_(n)):e||(n.C_.add(2),yield Rf(n),n.M_.set("Unknown"))}),xP.apply(this,arguments)}function Nf(t){return t.O_||(t.O_=function(n,r,i){const s=ie(n);return s.A_(),new Sue(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:kue.bind(null,t),Io:Oue.bind(null,t),a_:Fue.bind(null,t)}),t.v_.push(function(){var e=(0,$.Z)(function*(n){n?(t.O_.Yo(),EP(t)?vP(t):t.M_.set("Unknown")):(yield t.O_.stop(),tq(t))});return function(n){return e.apply(this,arguments)}}())),t.O_}function Xu(t){return t.N_||(t.N_=function(n,r,i){const s=ie(n);return s.A_(),new Rue(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:Uue.bind(null,t),Io:$ue.bind(null,t),T_:Bue.bind(null,t),I_:jue.bind(null,t)}),t.v_.push(function(){var e=(0,$.Z)(function*(n){n?(t.N_.Yo(),yield Pf(t)):(yield t.N_.stop(),t.b_.length>0&&(Y("RemoteStore",`Stopping write stream with ${t.b_.length} pending writes`),t.b_=[]))});return function(n){return e.apply(this,arguments)}}())),t.N_}class MP{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Yn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new MP(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Z(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xf(t,e){if(kn("AsyncQueue",`${e}: ${t}`),Uu(t))return new Z(F.UNAVAILABLE,`${e}: ${t}`);throw t}class Mf{constructor(e){this.comparator=e?(n,r)=>e(n,r)||se.comparator(n.key,r.key):(n,r)=>se.comparator(n.key,r.key),this.keyedMap=l_(),this.sortedSet=new qt(this.comparator)}static emptySet(e){return new Mf(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Mf)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,n){const r=new Mf;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class oq{constructor(){this.B_=new qt(se.comparator)}track(e){const n=e.doc.key,r=this.B_.get(n);r?0!==e.type&&3===r.type?this.B_=this.B_.insert(n,e):3===e.type&&1!==r.type?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.B_=this.B_.remove(n):1===e.type&&2===r.type?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):he():this.B_=this.B_.insert(n,e)}L_(){const e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}}class kf{constructor(e,n,r,i,s,o,a,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new kf(e,n,Mf.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&u_(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}class Hue{constructor(){this.k_=void 0,this.listeners=[]}}class Gue{constructor(){this.queries=new Ca(e=>CH(e),u_),this.onlineState="Unknown",this.q_=new Set}}function kP(t,e){return OP.apply(this,arguments)}function OP(){return OP=(0,$.Z)(function*(t,e){const n=ie(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new Hue),i)try{s.k_=yield n.onListen(r)}catch(o){const a=xf(o,`Initialization of query '${mf(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.Q_(n.onlineState),s.k_&&e.K_(s.k_)&&LP(n)}),OP.apply(this,arguments)}function FP(t,e){return VP.apply(this,arguments)}function VP(){return VP=(0,$.Z)(function*(t,e){const n=ie(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}),VP.apply(this,arguments)}function que(t,e){const n=ie(t);let r=!1;for(const i of e){const o=n.queries.get(i.query);if(o){for(const a of o.listeners)a.K_(i)&&(r=!0);o.k_=i}}r&&LP(n)}function zue(t,e,n){const r=ie(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function LP(t){t.q_.forEach(e=>{e.next()})}class UP{constructor(e,n,r){this.query=e,this.U_=n,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new kf(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.W_?this.z_(e)&&(this.U_.next(e),n=!0):this.j_(e,this.onlineState)&&(this.H_(e),n=!0),this.G_=e,n}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let n=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),n=!0),n}j_(e,n){return!e.fromCache||(!this.options.J_||!("Offline"!==n))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===n)}z_(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}H_(e){e=kf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class Wue{constructor(e,n){this.Y_=e,this.byteLength=n}Z_(){return"metadata"in this.Y_}}class aq{constructor(e){this.serializer=e}hs(e){return Ao(this.serializer,e)}Ps(e){return e.metadata.exists?iG(this.serializer,e.document,!1):en.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return On(e)}}class Kue{constructor(e,n,r){this.X_=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=uq(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++n;const r=dt.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ta(e){const n=new Map,r=new aq(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const o of i.metadata.queries){const a=(n.get(o)||Be()).add(s);n.set(o,a)}}return n}complete(){var e=this;return(0,$.Z)(function*(){const n=yield function wue(t,e,n,r){return aP.apply(this,arguments)}(e.localStore,new aq(e.serializer),e.documents,e.X_.id),r=e.ta(e.documents);for(const i of e.queries)yield Tue(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,na:e.collectionGroups,ra:n}})()}}function uq(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}class cq{constructor(e){this.key=e}}class lq{constructor(e){this.key=e}}class dq{constructor(e,n){this.query=e,this.ia=n,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=Be(),this.mutatedKeys=Be(),this._a=DH(e),this.aa=new Mf(this._a)}get ua(){return this.ia}ca(e,n){const r=n?n.la:new oq,i=n?n.aa:this.aa;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,d="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,g)=>{const m=i.get(f),y=c_(this.query,g)?g:null,E=!!m&&this.mutatedKeys.has(m.key),C=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let D=!1;m&&y?m.data.isEqual(y.data)?E!==C&&(r.track({type:3,doc:y}),D=!0):this.ha(m,y)||(r.track({type:2,doc:y}),D=!0,(u&&this._a(y,u)>0||d&&this._a(y,d)<0)&&(a=!0)):!m&&y?(r.track({type:0,doc:y}),D=!0):m&&!y&&(r.track({type:1,doc:m}),D=!0,(u||d)&&(a=!0)),D&&(y?(o=o.add(y),s=C?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const f="F"===this.query.limitType?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{aa:o,la:r,Zi:a,mutatedKeys:s}}ha(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const o=e.la.L_();o.sort((f,g)=>function(y,E){const C=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return he()}};return C(y)-C(E)}(f.type,g.type)||this._a(f.doc,g.doc)),this.Pa(r),i=null!=i&&i;const a=n&&!i?this.Ia():[],u=0===this.oa.size&&this.current&&!i?1:0,d=u!==this.sa;return this.sa=u,0!==o.length||d?{snapshot:new kf(this.query,e.aa,s,o,e.mutatedKeys,0===u,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:a}:{Ta:a}}Q_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({aa:this.aa,la:new oq,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(n=>this.ia=this.ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ia=this.ia.delete(n)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=Be(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const n=[];return e.forEach(r=>{this.oa.has(r)||n.push(new lq(r))}),this.oa.forEach(r=>{e.has(r)||n.push(new cq(r))}),n}da(e){this.ia=e.ls,this.oa=Be();const n=this.ca(e.documents);return this.applyChanges(n,!0)}Aa(){return kf.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}class Zue{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Que{constructor(e){this.key=e,this.Ra=!1}}class Yue{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new Ca(a=>CH(a),u_),this.fa=new Map,this.ga=new Set,this.pa=new qt(se.comparator),this.ya=new Map,this.wa=new JR,this.Sa={},this.ba=new Map,this.Da=Ml.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}function Xue(t,e){return BP.apply(this,arguments)}function BP(){return BP=(0,$.Z)(function*(t,e){const n=cN(t);let r,i;const s=n.ma.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const o=yield Af(n.localStore,Jr(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield jP(n,e,r,"current"===a,o.resumeToken),n.isPrimaryClient&&Jw(n.remoteStore,o)}return i}),BP.apply(this,arguments)}function jP(t,e,n,r,i){return $P.apply(this,arguments)}function $P(){return $P=(0,$.Z)(function*(t,e,n,r,i){t.va=(g,m,y)=>{return(E=(0,$.Z)(function*(D,O,R,k){let G=O.view.ca(R);G.Zi&&(G=yield Kw(D.localStore,O.query,!1).then(({documents:nn})=>O.view.ca(nn,G)));const ne=k&&k.targetChanges.get(O.targetId),Te=k&&null!=k.targetMismatches.get(O.targetId),at=O.view.applyChanges(G,D.isPrimaryClient,ne,Te);return XP(D,O.targetId,at.Ta),at.snapshot}),function C(D,O,R,k){return E.apply(this,arguments)})(t,g,m,y);var E};const s=yield Kw(t.localStore,e,!0),o=new dq(e,s.ls),a=o.ca(s.documents),u=m_.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState,i),d=o.applyChanges(a,t.isPrimaryClient,u);XP(t,n,d.Ta);const f=new Zue(e,n,o);return t.ma.set(e,f),t.fa.has(n)?t.fa.get(n).push(e):t.fa.set(n,[e]),d.snapshot}),$P.apply(this,arguments)}function Jue(t,e){return HP.apply(this,arguments)}function HP(){return HP=(0,$.Z)(function*(t,e){const n=ie(t),r=n.ma.get(e),i=n.fa.get(r.targetId);if(i.length>1)return n.fa.set(r.targetId,i.filter(s=>!u_(s,e))),void n.ma.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Sf(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),R_(n.remoteStore,r.targetId),Of(n,r.targetId)}).catch(Lu))):(Of(n,r.targetId),yield Sf(n.localStore,r.targetId,!0))}),HP.apply(this,arguments)}function GP(){return GP=(0,$.Z)(function*(t,e,n){const r=lN(t);try{const i=yield function(o,a){const u=ie(o),d=an.now(),f=a.reduce((y,E)=>y.add(E.key),Be());let g,m;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let E=Ci(),C=Be();return u.ss.getEntries(y,f).next(D=>{E=D,E.forEach((O,R)=>{R.isValidDocument()||(C=C.add(O))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,E)).next(D=>{g=D;const O=[];for(const R of a){const k=Rae(R,g.get(R.key).overlayedDocument);null!=k&&O.push(new ba(R.key,k,cH(k.value.mapValue),un.exists(!0)))}return u.mutationQueue.addMutationBatch(y,d,O,a)}).next(D=>{m=D;const O=D.applyToLocalDocumentSet(g,C);return u.documentOverlayCache.saveOverlays(y,D.batchId,O)})}).then(()=>({batchId:m.batchId,changes:SH(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let d=o.Sa[o.currentUser.toKey()];d||(d=new qt(Ne)),d=d.insert(a,u),o.Sa[o.currentUser.toKey()]=d}(r,i.batchId,n),yield Aa(r,i.changes),yield Pf(r.remoteStore)}catch(i){const s=xf(i,"Failed to persist write");n.reject(s)}}),GP.apply(this,arguments)}function hq(t,e){return qP.apply(this,arguments)}function qP(){return qP=(0,$.Z)(function*(t,e){const n=ie(t);try{const r=yield function Eue(t,e){const n=ie(t),r=e.snapshotVersion;let i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;const a=[];e.targetChanges.forEach((f,g)=>{const m=i.get(g);if(!m)return;a.push(n.qr.removeMatchingKeys(s,f.removedDocuments,g).next(()=>n.qr.addMatchingKeys(s,f.addedDocuments,g)));let y=m.withSequenceNumber(s.currentSequenceNumber);var C,D,O;null!==e.targetMismatches.get(g)?y=y.withResumeToken(Xn.EMPTY_BYTE_STRING,_e.min()).withLastLimboFreeSnapshotVersion(_e.min()):f.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(f.resumeToken,r)),i=i.insert(g,y),D=y,O=f,(0===(C=m).resumeToken.approximateByteSize()||D.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8||O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0)&&a.push(n.qr.updateTargetData(s,y))});let u=Ci(),d=Be();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(GG(s,o,e.documentUpdates).next(f=>{u=f.us,d=f.cs})),!r.isEqual(_e.min())){const f=n.qr.getLastRemoteSnapshotVersion(s).next(g=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(f)}return N.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,d)).next(()=>u)}).then(s=>(n.ts=i,s))}(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.ya.get(s);o&&(me(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ra=!0:i.modifiedDocuments.size>0?me(o.Ra):i.removedDocuments.size>0&&(me(o.Ra),o.Ra=!1))}),yield Aa(n,r,e)}catch(r){yield Lu(r)}}),qP.apply(this,arguments)}function fq(t,e,n){const r=ie(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const i=[];r.ma.forEach((s,o)=>{const a=o.view.Q_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const u=ie(o);u.onlineState=a;let d=!1;u.queries.forEach((f,g)=>{for(const m of g.listeners)m.Q_(a)&&(d=!0)}),d&&LP(u)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function tce(t,e,n){return zP.apply(this,arguments)}function zP(){return zP=(0,$.Z)(function*(t,e,n){const r=ie(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.ya.get(e),s=i&&i.key;if(s){let o=new qt(se.comparator);o=o.insert(s,en.newNoDocument(s,_e.min()));const a=Be().add(s),u=new g_(_e.min(),new Map,new qt(Ne),o,a);yield hq(r,u),r.pa=r.pa.remove(s),r.ya.delete(e),JP(r)}else yield Sf(r.localStore,e,!1).then(()=>Of(r,e,n)).catch(Lu)}),zP.apply(this,arguments)}function nce(t,e){return WP.apply(this,arguments)}function WP(){return WP=(0,$.Z)(function*(t,e){const n=ie(t),r=e.batch.batchId;try{const i=yield function vue(t,e){const n=ie(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(a,u,d,f){const g=d.batch,m=g.keys();let y=N.resolve();return m.forEach(E=>{y=y.next(()=>f.getEntry(u,E)).next(C=>{const D=d.docVersions.get(E);me(null!==D),C.version.compareTo(D)<0&&(g.applyToRemoteDocument(C,d),C.isValidDocument()&&(C.setReadTime(d.commitVersion),f.addEntry(C)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(u,g))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=Be();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(u=u.add(a.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}(n.localStore,e);YP(n,r,null),QP(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield Aa(n,i)}catch(i){yield Lu(i)}}),WP.apply(this,arguments)}function rce(t,e,n){return KP.apply(this,arguments)}function KP(){return KP=(0,$.Z)(function*(t,e,n){const r=ie(t);try{const i=yield function(o,a){const u=ie(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,a).next(g=>(me(null!==g),f=g.keys(),u.mutationQueue.removeMutationBatch(d,g))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(r.localStore,e);YP(r,e,n),QP(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield Aa(r,i)}catch(i){yield Lu(i)}}),KP.apply(this,arguments)}function ZP(){return ZP=(0,$.Z)(function*(t,e){const n=ie(t);Yu(n.remoteStore)||Y("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(o){const a=ie(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(-1===r)return void e.resolve();const i=n.ba.get(r)||[];i.push(e),n.ba.set(r,i)}catch(r){const i=xf(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),ZP.apply(this,arguments)}function QP(t,e){(t.ba.get(e)||[]).forEach(n=>{n.resolve()}),t.ba.delete(e)}function YP(t,e,n){const r=ie(t);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Of(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.fa.get(e))t.ma.delete(r),n&&t.Va.Fa(r,n);t.fa.delete(e),t.isPrimaryClient&&t.wa.Rr(e).forEach(r=>{t.wa.containsKey(r)||pq(t,r)})}function pq(t,e){t.ga.delete(e.path.canonicalString());const n=t.pa.get(e);null!==n&&(R_(t.remoteStore,n),t.pa=t.pa.remove(e),t.ya.delete(n),JP(t))}function XP(t,e,n){for(const r of n)r instanceof cq?(t.wa.addReference(r.key,e),sce(t,r)):r instanceof lq?(Y("SyncEngine","Document no longer in limbo: "+r.key),t.wa.removeReference(r.key,e),t.wa.containsKey(r.key)||pq(t,r.key)):he()}function sce(t,e){const n=e.key,r=n.path.canonicalString();t.pa.get(n)||t.ga.has(r)||(Y("SyncEngine","New document in limbo: "+n),t.ga.add(r),JP(t))}function JP(t){for(;t.ga.size>0&&t.pa.size<t.maxConcurrentLimboResolutions;){const e=t.ga.values().next().value;t.ga.delete(e);const n=new se(dt.fromString(e)),r=t.Da.next();t.ya.set(r,new Que(n)),t.pa=t.pa.insert(n,r),Jw(t.remoteStore,new Da(Jr(pf(n.path)),r,"TargetPurposeLimboResolution",ji._e))}}function Aa(t,e,n){return eN.apply(this,arguments)}function eN(){return eN=(0,$.Z)(function*(t,e,n){const r=ie(t),i=[],s=[],o=[];var a;r.ma.isEmpty()||(r.ma.forEach((a,u)=>{o.push(r.va(u,e,n).then(d=>{if((d||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,d?.fromCache?"not-current":"current"),d){i.push(d);const f=iP.Qi(u.targetId,d);s.push(f)}}))}),yield Promise.all(o),r.Va.a_(i),yield(a=(0,$.Z)(function*(d,f){const g=ie(d);try{yield g.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>N.forEach(f,y=>N.forEach(y.ki,E=>g.persistence.referenceDelegate.addReference(m,y.targetId,E)).next(()=>N.forEach(y.qi,E=>g.persistence.referenceDelegate.removeReference(m,y.targetId,E)))))}catch(m){if(!Uu(m))throw m;Y("LocalStore","Failed to update sequence numbers: "+m)}for(const m of f){const y=m.targetId;if(!m.fromCache){const E=g.ts.get(y),D=E.withLastLimboFreeSnapshotVersion(E.snapshotVersion);g.ts=g.ts.insert(y,D)}}}),function u(d,f){return a.apply(this,arguments)})(r.localStore,s))}),eN.apply(this,arguments)}function oce(t,e){return tN.apply(this,arguments)}function tN(){return tN=(0,$.Z)(function*(t,e){const n=ie(t);if(!n.currentUser.isEqual(e)){Y("SyncEngine","User change. New user:",e.toKey());const r=yield $G(n.localStore,e);n.currentUser=e,(s=n).ba.forEach(a=>{a.forEach(u=>{u.reject(new Z(F.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.ba.clear(),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Aa(n,r._s)}var s}),tN.apply(this,arguments)}function ace(t,e){const n=ie(t),r=n.ya.get(e);if(r&&r.Ra)return Be().add(r.key);{let i=Be();const s=n.fa.get(e);if(!s)return i;for(const o of s){const a=n.ma.get(o);i=i.unionWith(a.view.ua)}return i}}function uce(t,e){return nN.apply(this,arguments)}function nN(){return nN=(0,$.Z)(function*(t,e){const n=ie(t),r=yield Kw(n.localStore,e.query,!0),i=e.view.da(r);return n.isPrimaryClient&&XP(n,e.targetId,i.Ta),i}),nN.apply(this,arguments)}function cce(t,e){return rN.apply(this,arguments)}function rN(){return rN=(0,$.Z)(function*(t,e){const n=ie(t);return zG(n.localStore,e).then(r=>Aa(n,r))}),rN.apply(this,arguments)}function lce(t,e,n,r){return iN.apply(this,arguments)}function iN(){return iN=(0,$.Z)(function*(t,e,n,r){const i=ie(t),s=yield function(a,u){const d=ie(a),f=ie(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",g=>f.Cn(g,u).next(m=>m?d.localDocuments.getDocuments(g,m):N.resolve(null)))}(i.localStore,e);var u;null!==s?("pending"===n?yield Pf(i.remoteStore):"acknowledged"===n||"rejected"===n?(YP(i,e,r||null),QP(i,e),u=e,ie(ie(i.localStore).mutationQueue).Fn(u)):he(),yield Aa(i,s)):Y("SyncEngine","Cannot apply mutation batch with id: "+e)}),iN.apply(this,arguments)}function sN(){return sN=(0,$.Z)(function*(t,e){const n=ie(t);if(cN(n),lN(n),!0===e&&!0!==n.Ca){const r=n.sharedClientState.getAllActiveQueryTargets(),i=yield gq(n,r.toArray());n.Ca=!0,yield NP(n.remoteStore,!0);for(const s of i)Jw(n.remoteStore,s)}else if(!1===e&&!1!==n.Ca){const r=[];let i=Promise.resolve();n.fa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Of(n,o),Sf(n.localStore,o,!0))),R_(n.remoteStore,o)}),yield i,yield gq(n,r),function(o){const a=ie(o);a.ya.forEach((u,d)=>{R_(a.remoteStore,d)}),a.wa.Vr(),a.ya=new Map,a.pa=new qt(se.comparator)}(n),n.Ca=!1,yield NP(n.remoteStore,!1)}}),sN.apply(this,arguments)}function gq(t,e,n){return oN.apply(this,arguments)}function oN(){return oN=(0,$.Z)(function*(t,e,n){const r=ie(t),i=[],s=[];for(const o of e){let a;const u=r.fa.get(o);if(u&&0!==u.length){a=yield Af(r.localStore,Jr(u[0]));for(const d of u){const f=r.ma.get(d),g=yield uce(r,f);g.snapshot&&s.push(g.snapshot)}}else{const d=yield qG(r.localStore,o);a=yield Af(r.localStore,d),yield jP(r,mq(d),o,!1,a.resumeToken)}i.push(a)}return r.Va.a_(s),i}),oN.apply(this,arguments)}function mq(t){return IH(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function hce(t){return n=ie(t).localStore,ie(ie(n).persistence).Bi();var n}function fce(t,e,n,r){return aN.apply(this,arguments)}function aN(){return aN=(0,$.Z)(function*(t,e,n,r){const i=ie(t);if(i.Ca)return void Y("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=yield zG(i.localStore,bH(s[0])),a=g_.createSynthesizedRemoteEventForCurrentChange(e,"current"===n,Xn.EMPTY_BYTE_STRING);yield Aa(i,o,a);break}case"rejected":yield Sf(i.localStore,e,!0),Of(i,e,r);break;default:he()}}),aN.apply(this,arguments)}function pce(t,e,n){return uN.apply(this,arguments)}function uN(){return uN=(0,$.Z)(function*(t,e,n){const r=cN(t);if(r.Ca){for(const i of e){if(r.fa.has(i)){Y("SyncEngine","Adding an already active target "+i);continue}const s=yield qG(r.localStore,i),o=yield Af(r.localStore,s);yield jP(r,mq(s),o.targetId,!1,o.resumeToken),Jw(r.remoteStore,o)}for(const i of n)r.fa.has(i)&&(yield Sf(r.localStore,i,!1).then(()=>{R_(r.remoteStore,i),Of(r,i)}).catch(Lu))}}),uN.apply(this,arguments)}function cN(t){const e=ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=hq.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ace.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=tce.bind(null,e),e.Va.a_=que.bind(null,e.eventManager),e.Va.Fa=zue.bind(null,e.eventManager),e}function lN(t){const e=ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nce.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rce.bind(null,e),e}class P_{constructor(){this.synchronizeTabs=!1}initialize(e){var n=this;return(0,$.Z)(function*(){n.serializer=A_(e.databaseInfo.databaseId),n.sharedClientState=n.createSharedClientState(e),n.persistence=n.createPersistence(e),yield n.persistence.start(),n.localStore=n.createLocalStore(e),n.gcScheduler=n.createGarbageCollectionScheduler(e,n.localStore),n.indexBackfillerScheduler=n.createIndexBackfillerScheduler(e,n.localStore)})()}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return jG(this.persistence,new BG,e.initialUser,this.serializer)}createPersistence(e){return new eP(qw.jr,this.serializer)}createSharedClientState(e){return new QG}terminate(){var e=this;return(0,$.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class dN extends P_{constructor(e,n,r){super(),this.xa=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var n=()=>super.initialize,r=this;return(0,$.Z)(function*(){yield n().call(r,e),yield r.xa.initialize(r,e),yield lN(r.xa.syncEngine),yield Pf(r.xa.remoteStore),yield r.persistence.mi(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return jG(this.persistence,new BG,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){return new NG(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new joe(n,this.persistence);return new Boe(e.asyncQueue,r)}createPersistence(e){const n=rP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?Vr.withCacheSize(this.cacheSizeBytes):Vr.DEFAULT;return new nP(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,XG(),Xw(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new QG}}class _q extends dN{constructor(e,n){super(e,n,!1),this.xa=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){var n=()=>super.initialize,r=this;return(0,$.Z)(function*(){yield n().call(r,e);const i=r.xa.syncEngine;r.sharedClientState instanceof hP&&(r.sharedClientState.syncEngine={Ys:lce.bind(null,i),Zs:fce.bind(null,i),Xs:pce.bind(null,i),Bi:hce.bind(null,i),Js:cce.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.mi(function(){var s=(0,$.Z)(function*(o){yield function dce(t,e){return sN.apply(this,arguments)}(r.xa.syncEngine,o),r.gcScheduler&&(o&&!r.gcScheduler.started?r.gcScheduler.start():o||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(o&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():o||r.indexBackfillerScheduler.stop())});return function(o){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const n=XG();if(!hP.D(n))throw new Z(F.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=rP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new hP(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Ff{initialize(e,n){var r=this;return(0,$.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(n),r.remoteStore=r.createRemoteStore(n),r.eventManager=r.createEventManager(n),r.syncEngine=r.createSyncEngine(n,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>fq(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=oce.bind(null,r.syncEngine),yield NP(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new Gue}createDatastore(e){const n=A_(e.databaseInfo.databaseId),r=new Aue(e.databaseInfo);return new Pue(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return r=this.localStore,i=this.datastore,s=e.asyncQueue,o=n=>fq(this.syncEngine,n,0),a=YG.D()?new YG:new Cue,new Mue(r,i,s,o,a);var r,i,s,o,a}createSyncEngine(e,n){return function(i,s,o,a,u,d,f){const g=new Yue(i,s,o,a,u,d);return f&&(g.Ca=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return(e=(0,$.Z)(function*(r){const i=ie(r);Y("RemoteStore","RemoteStore shutting down."),i.C_.add(5),yield Rf(i),i.F_.shutdown(),i.M_.set("Unknown")}),function n(r){return e.apply(this,arguments)})(this.remoteStore);var e}}function yq(t,e=10240){let n=0;return{read:()=>(0,$.Z)(function*(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}})(),cancel:()=>(0,$.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class tT{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):kn("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}class _ce{constructor(e,n){this.Ba=e,this.serializer=n,this.metadata=new Yn,this.buffer=new Uint8Array,this.La=new TextDecoder("utf-8"),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}getMetadata(){var e=this;return(0,$.Z)(function*(){return e.metadata.promise})()}Ma(){var e=this;return(0,$.Z)(function*(){return yield e.getMetadata(),e.ka()})()}ka(){var e=this;return(0,$.Z)(function*(){const n=yield e.qa();if(null===n)return null;const r=e.La.decode(n),i=Number(r);isNaN(i)&&e.Qa(`length string (${r}) is not valid number`);const s=yield e.Ka(i);return new Wue(JSON.parse(s),n.length+i)})()}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}qa(){var e=this;return(0,$.Z)(function*(){for(;e.$a()<0&&!(yield e.Ua()););if(0===e.buffer.length)return null;const n=e.$a();n<0&&e.Qa("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,n);return e.buffer=e.buffer.slice(n),r})()}Ka(e){var n=this;return(0,$.Z)(function*(){for(;n.buffer.length<e;)(yield n.Ua())&&n.Qa("Reached the end of bundle when more is expected.");const r=n.La.decode(n.buffer.slice(0,e));return n.buffer=n.buffer.slice(e),r})()}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}Ua(){var e=this;return(0,$.Z)(function*(){const n=yield e.Ba.read();if(!n.done){const r=new Uint8Array(e.buffer.length+n.value.length);r.set(e.buffer),r.set(n.value,e.buffer.length),e.buffer=r}return n.done})()}}class yce{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var n=this;return(0,$.Z)(function*(){if(n.ensureCommitNotCalled(),n.mutations.length>0)throw new Z(F.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,$.Z)(function*(o,a){const u=ie(o),d=y_(u.serializer)+"/documents",f={documents:a.map(E=>__(u.serializer,E))},g=yield u.Co("BatchGetDocuments",d,f,a.length),m=new Map;g.forEach(E=>{const C=function Uae(t,e){return"found"in e?function(r,i){me(!!i.found);const s=Ao(r,i.found.name),o=On(i.found.updateTime),a=i.found.createTime?On(i.found.createTime):_e.min(),u=new Dr({mapValue:{fields:i.found.fields}});return en.newFoundDocument(s,o,a,u)}(t,e):"missing"in e?function(r,i){me(!!i.missing),me(!!i.readTime);const s=Ao(r,i.missing),o=On(i.readTime);return en.newNoDocument(s,o)}(t,e):he()}(u.serializer,E);m.set(C.key.toString(),C)});const y=[];return a.forEach(E=>{const C=m.get(E.toString());me(!!C),y.push(C)}),y}),function s(o,a){return i.apply(this,arguments)})(n.datastore,e);var i;return r.forEach(i=>n.recordVersion(i)),r})()}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ef(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,$.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const n=e.readVersions;var r;e.mutations.forEach(r=>{n.delete(r.key.toString())}),n.forEach((r,i)=>{const s=se.fromPath(i);e.mutations.push(new FR(s,e.precondition(s)))}),yield(r=(0,$.Z)(function*(s,o){const a=ie(s),u=y_(a.serializer)+"/documents",d={writes:o.map(f=>v_(a.serializer,f))};yield a.wo("Commit",u,d)}),function i(s,o){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw he();n=_e.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new Z(F.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(_e.min())?un.exists(!1):un.updateTime(n):un.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(_e.min()))throw new Z(F.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return un.updateTime(n)}return un.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class vce{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new pP(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){var e=this;this.zo.ko((0,$.Z)(function*(){const n=new yce(e.datastore),r=e.za(n);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>n.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.ja(s)}))}).catch(i=>{e.ja(i)})}))}za(e){try{const n=this.updateFunction(e);return!e_(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if("FirebaseError"===e.name){const n=e.code;return"aborted"===n||"failed-precondition"===n||"already-exists"===n||!HH(n)}return!1}}class Ece{constructor(e,n,r,i){var s=this;this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=ar.UNAUTHENTICATED,this.clientId=U$.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=(0,$.Z)(function*(a){Y("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(Y("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return(0,$.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Z(F.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const n=new Yn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,$.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),n.resolve()}catch(r){const i=xf(r,"Failed to shutdown persistence");n.reject(i)}})),n.promise}}function nT(t,e){return hN.apply(this,arguments)}function hN(){return hN=(0,$.Z)(function*(t,e){t.asyncQueue.verifyOperationInProgress(),Y("FirestoreClient","Initializing OfflineComponentProvider");const n=yield t.getConfiguration();yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(function(){var i=(0,$.Z)(function*(s){r.isEqual(s)||(yield $G(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}),hN.apply(this,arguments)}function fN(t,e){return pN.apply(this,arguments)}function pN(){return pN=(0,$.Z)(function*(t,e){t.asyncQueue.verifyOperationInProgress();const n=yield gN(t);Y("FirestoreClient","Initializing OnlineComponentProvider");const r=yield t.getConfiguration();yield e.initialize(n,r),t.setCredentialChangeListener(i=>sq(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>sq(e.remoteStore,s)),t._onlineComponents=e}),pN.apply(this,arguments)}function vq(t){return"FirebaseError"===t.name?t.code===F.FAILED_PRECONDITION||t.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}function gN(t){return mN.apply(this,arguments)}function mN(){return mN=(0,$.Z)(function*(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Y("FirestoreClient","Using user provided OfflineComponentProvider");try{yield nT(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!vq(n))throw n;wi("Error using user provided cache. Falling back to memory cache: "+n),yield nT(t,new P_)}}else Y("FirestoreClient","Using default OfflineComponentProvider"),yield nT(t,new P_);return t._offlineComponents}),mN.apply(this,arguments)}function rT(t){return _N.apply(this,arguments)}function _N(){return _N=(0,$.Z)(function*(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Y("FirestoreClient","Using user provided OnlineComponentProvider"),yield fN(t,t._uninitializedComponentsProvider._online)):(Y("FirestoreClient","Using default OnlineComponentProvider"),yield fN(t,new Ff))),t._onlineComponents}),_N.apply(this,arguments)}function Eq(t){return gN(t).then(e=>e.persistence)}function Vf(t){return gN(t).then(e=>e.localStore)}function Iq(t){return rT(t).then(e=>e.remoteStore)}function yN(t){return rT(t).then(e=>e.syncEngine)}function Lf(t){return vN.apply(this,arguments)}function vN(){return vN=(0,$.Z)(function*(t){const e=yield rT(t),n=e.eventManager;return n.onListen=Xue.bind(null,e.syncEngine),n.onUnlisten=Jue.bind(null,e.syncEngine),n}),vN.apply(this,arguments)}function Tq(t,e,n={}){const r=new Yn;return t.asyncQueue.enqueueAndForget((0,$.Z)(function*(){return function(s,o,a,u,d){const f=new tT({next:m=>{o.enqueueAndForget(()=>FP(s,g));const y=m.docs.has(a);!y&&m.fromCache?d.reject(new Z(F.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&u&&"server"===u.source?d.reject(new Z(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),g=new UP(pf(a.path),f,{includeMetadataChanges:!0,J_:!0});return kP(s,g)}(yield Lf(t),t.asyncQueue,e,n,r)})),r.promise}function Cq(t,e,n={}){const r=new Yn;return t.asyncQueue.enqueueAndForget((0,$.Z)(function*(){return function(s,o,a,u,d){const f=new tT({next:m=>{o.enqueueAndForget(()=>FP(s,g)),m.fromCache&&"server"===u.source?d.reject(new Z(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),g=new UP(a,f,{includeMetadataChanges:!0,J_:!0});return kP(s,g)}(yield Lf(t),t.asyncQueue,e,n,r)})),r.promise}function bq(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const Dq=new Map;function EN(t,e,n){if(!n)throw new Z(F.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Aq(t,e,n,r){if(!0===e&&!0===r)throw new Z(F.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Sq(t){if(!se.isDocumentKey(t))throw new Z(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Rq(t){if(se.isDocumentKey(t))throw new Z(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function iT(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=(r=t).constructor?r.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var r;return"function"==typeof t?"a function":he()}function nt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Z(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=iT(t);throw new Z(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Pq(t,e){if(e<=0)throw new Z(F.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}class Nq{constructor(e){var n,r;if(void 0===e.host){if(void 0!==e.ssl)throw new Z(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(n=e.ssl)||void 0===n||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Z(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Aq("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=bq(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new Z(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Z(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Z(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class N_{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Nq({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Z(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Z(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Nq(e),void 0!==e.credentials&&(this._authCredentials=function(r){if(!r)return new Soe;switch(r.type){case"firstParty":return new xoe(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Z(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Dq.get(n);r&&(Y("ComponentProvider","Removing Datastore"),Dq.delete(n),r.terminate())}(this),Promise.resolve()}}class Ar{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ar(this.firestore,e,this._query)}}class tn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new So(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new tn(this.firestore,e,this._key)}}class So extends Ar{constructor(e,n,r){super(e,n,pf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new tn(this.firestore,null,new se(e))}withConverter(e){return new So(this.firestore,e,this._path)}}function Mq(t,e,...n){if(t=(0,I.m9)(t),EN("collection","path",e),t instanceof N_){const r=dt.fromString(e,...n);return Rq(r),new So(t,null,r)}{if(!(t instanceof tn||t instanceof So))throw new Z(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(dt.fromString(e,...n));return Rq(r),new So(t.firestore,null,r)}}function sT(t,e,...n){if(t=(0,I.m9)(t),1===arguments.length&&(e=U$.newId()),EN("doc","path",e),t instanceof N_){const r=dt.fromString(e,...n);return Sq(r),new tn(t,null,new se(r))}{if(!(t instanceof tn||t instanceof So))throw new Z(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(dt.fromString(e,...n));return Sq(r),new tn(t.firestore,t instanceof So?t.converter:null,new se(r))}}function kq(t,e){return t=(0,I.m9)(t),e=(0,I.m9)(e),(t instanceof tn||t instanceof So)&&(e instanceof tn||e instanceof So)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function IN(t,e){return t=(0,I.m9)(t),e=(0,I.m9)(e),t instanceof Ar&&e instanceof Ar&&t.firestore===e.firestore&&u_(t._query,e._query)&&t.converter===e.converter}class xce{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new pP(this,"async_queue_retry"),this.iu=()=>{const n=Xw();n&&Y("AsyncQueue","Visibility state changed to "+n.visibilityState),this.zo.Qo()};const e=Xw();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const n=Xw();n&&"function"==typeof n.removeEventListener&&n.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const n=new Yn;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}_u(){var e=this;return(0,$.Z)(function*(){if(0!==e.Ya.length){try{yield e.Ya[0](),e.Ya.shift(),e.zo.reset()}catch(n){if(!Uu(n))throw n;Y("AsyncQueue","Operation failed with retryable error: "+n)}e.Ya.length>0&&e.zo.ko(()=>e._u())}})()}ou(e){const n=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{throw this.eu=r,this.tu=!1,kn("INTERNAL UNHANDLED ERROR: ",function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+"\n"+o.stack),a}(r)),r}).then(r=>(this.tu=!1,r))));return this.Ja=n,n}enqueueAfterDelay(e,n,r){this.su(),this.ru.indexOf(e)>-1&&(n=0);const i=MP.createAndSchedule(this,e,n,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&he()}verifyOperationInProgress(){}uu(){var e=this;return(0,$.Z)(function*(){let n;do{n=e.Ja,yield n}while(n!==e.Ja)})()}cu(e){for(const n of this.Xa)if(n.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Xa)if(n.skipDelay(),"all"!==e&&n.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const n=this.Xa.indexOf(e);this.Xa.splice(n,1)}}function wN(t){return function(n,r){if("object"!=typeof n||null===n)return!1;const i=n;for(const s of["next","error","complete"])if(s in i&&"function"==typeof i[s])return!0;return!1}(t)}class Mce{constructor(){this._progressObserver={},this._taskCompletionResolver=new Yn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class zt extends N_{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new xce,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Oq(this),this._firestoreClient.terminate()}}function bn(t){return t._firestoreClient||Oq(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Oq(t){var e,n,r;const i=t._freezeSettings(),s=(u=(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",new uae(t._databaseId,u,t._persistenceKey,(f=i).host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,bq(f.experimentalLongPollingOptions),f.useFetchStreams));var u,f;t._firestoreClient=new Ece(t._authCredentials,t._appCheckCredentials,t._queue,s),null!==(n=i.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function Fq(t,e,n){const r=new Yn;return t.asyncQueue.enqueue((0,$.Z)(function*(){try{yield nT(t,n),yield fN(t,e),r.resolve()}catch(i){const s=i;if(!vq(s))throw s;wi("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function Vq(t){if(t._initialized||t._terminated)throw new Z(F.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Ro{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ro(Xn.fromBase64String(e))}catch(n){throw new Z(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ro(Xn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Sa{constructor(...e){for(let n=0;n<e.length;++n)if(0===e[n].length)throw new Z(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Jt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Ol{constructor(e){this._methodName=e}}class oT{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Z(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Z(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ne(this._lat,e._lat)||Ne(this._long,e._long)}}const Gce=/^__.*__$/;class qce{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return null!==this.fieldMask?new ba(e,this.data,this.fieldMask,n,this.fieldTransforms):new vf(e,this.data,n,this.fieldTransforms)}}class Lq{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ba(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Uq(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw he()}}class aT{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new aT(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var n;const r=null===(n=this.path)||void 0===n?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var n;const r=null===(n=this.path)||void 0===n?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return lT(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return void 0!==this.fieldMask.find(n=>e.isPrefixOf(n))||void 0!==this.fieldTransforms.find(n=>e.isPrefixOf(n.field))}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(0===e.length)throw this.mu("Document fields must not be empty");if(Uq(this.Iu)&&Gce.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class zce{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||A_(e)}pu(e,n,r,i=!1){return new aT({Iu:e,methodName:n,gu:r,path:Jt.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Fl(t){const e=t._freezeSettings(),n=A_(t._databaseId);return new zce(t._databaseId,!!e.ignoreUndefinedProperties,n)}function uT(t,e,n,r,i,s={}){const o=t.pu(s.merge||s.mergeFields?2:0,e,n,i);DN("Data must be an object, but it was:",o,r);const a=$q(r,o);let u,d;if(s.merge)u=new Ti(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const g of s.mergeFields){const m=k_(e,g,n);if(!o.contains(m))throw new Z(F.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Gq(f,m)||f.push(m)}u=new Ti(f),d=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,d=o.fieldTransforms;return new qce(new Dr(a),u,d)}class M_ extends Ol{_toFieldTransform(e){if(2!==e.Iu)throw e.mu(1===e.Iu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof M_}}function Bq(t,e,n){return new aT({Iu:3,gu:e.settings.gu,methodName:t._methodName,du:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class TN extends Ol{_toFieldTransform(e){return new h_(e.path,new _f)}isEqual(e){return e instanceof TN}}class Wce extends Ol{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=Bq(this,e,!0),r=this.yu.map(s=>Vl(s,n)),i=new Dl(r);return new h_(e.path,i)}isEqual(e){return this===e}}class Kce extends Ol{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=Bq(this,e,!0),r=this.yu.map(s=>Vl(s,n)),i=new Al(r);return new h_(e.path,i)}isEqual(e){return this===e}}class Zce extends Ol{constructor(e,n){super(e),this.wu=n}_toFieldTransform(e){const n=new yf(e.serializer,xH(e.serializer,this.wu));return new h_(e.path,n)}isEqual(e){return this===e}}function CN(t,e,n,r){const i=t.pu(1,e,n);DN("Data must be an object, but it was:",i,r);const s=[],o=Dr.empty();Bu(r,(u,d)=>{const f=cT(e,u,n);d=(0,I.m9)(d);const g=i.Ru(f);if(d instanceof M_)s.push(f);else{const m=Vl(d,g);null!=m&&(s.push(f),o.set(f,m))}});const a=new Ti(s);return new Lq(o,a,i.fieldTransforms)}function bN(t,e,n,r,i,s){const o=t.pu(1,e,n),a=[k_(e,r,n)],u=[i];if(s.length%2!=0)throw new Z(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(k_(e,s[m])),u.push(s[m+1]);const d=[],f=Dr.empty();for(let m=a.length-1;m>=0;--m)if(!Gq(d,a[m])){const y=a[m];let E=u[m];E=(0,I.m9)(E);const C=o.Ru(y);if(E instanceof M_)d.push(y);else{const D=Vl(E,C);null!=D&&(d.push(y),f.set(y,D))}}const g=new Ti(d);return new Lq(f,g,o.fieldTransforms)}function jq(t,e,n,r=!1){return Vl(n,t.pu(r?4:3,e))}function Vl(t,e){if(Hq(t=(0,I.m9)(t)))return DN("Unsupported field value:",e,t),$q(t,e);if(t instanceof Ol)return function(r,i){if(!Uq(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.du&&4!==e.Iu)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let u=Vl(a,i.Vu(o));null==u&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if(null===(r=(0,I.m9)(r)))return{nullValue:"NULL_VALUE"};if("number"==typeof r)return xH(i.serializer,r);if("boolean"==typeof r)return{booleanValue:r};if("string"==typeof r)return{stringValue:r};if(r instanceof Date){const s=an.fromDate(r);return{timestampValue:If(i.serializer,s)}}if(r instanceof an){const s=new an(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:If(i.serializer,s)}}if(r instanceof oT)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ro)return{bytesValue:JH(i.serializer,r._byteString)};if(r instanceof tn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:$R(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${iT(r)}`)}(t,e)}function $q(t,e){const n={};return eH(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Bu(t,(r,i)=>{const s=Vl(i,e.Eu(r));null!=s&&(n[r]=s)}),{mapValue:{fields:n}}}function Hq(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof an||t instanceof oT||t instanceof Ro||t instanceof tn||t instanceof Ol)}function DN(t,e,n){if(!Hq(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const r=iT(n);throw e.mu("an object"===r?t+" a custom object":t+" "+r)}var i}function k_(t,e,n){if((e=(0,I.m9)(e))instanceof Sa)return e._internalPath;if("string"==typeof e)return cT(t,e);throw lT("Field path arguments must be of type string or ",t,!1,void 0,n)}const Qce=new RegExp("[~\\*/\\[\\]]");function cT(t,e,n){if(e.search(Qce)>=0)throw lT(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Sa(...e.split("."))._internalPath}catch{throw lT(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function lT(t,e,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new Z(F.INVALID_ARGUMENT,a+t+u)}function Gq(t,e){return t.some(n=>n.isEqual(e))}class O_{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new tn(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Yce(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(dT("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n)}}}class Yce extends O_{data(){return super.data()}}function dT(t,e){return"string"==typeof e?cT(t,e):e instanceof Sa?e._internalPath:e._delegate._internalPath}function qq(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new Z(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AN{}class F_ extends AN{}function Ju(t,e,...n){let r=[];e instanceof AN&&r.push(e),r=r.concat(n),function(s){const o=s.filter(u=>u instanceof Uf).length,a=s.filter(u=>u instanceof V_).length;if(o>1||o>0&&a>0)throw new Z(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class V_ extends F_{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new V_(e,n,r)}_apply(e){const n=this._parse(e);return Zq(e._query,n),new Ar(e.firestore,e.converter,kR(e._query,n))}_parse(e){const n=Fl(e.firestore);return function(s,o,a,u,d,f,g){let m;if(d.isKeyField()){if("array-contains"===f||"array-contains-any"===f)throw new Z(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if("in"===f||"not-in"===f){Kq(g,f);const y=[];for(const E of g)y.push(Wq(u,s,E));m={arrayValue:{values:y}}}else m=Wq(u,s,g)}else"in"!==f&&"not-in"!==f&&"array-contains-any"!==f||Kq(g,f),m=jq(a,"where",g,"in"===f||"not-in"===f);return ot.create(d,f,m)}(e._query,0,n,e.firestore._databaseId,this._field,this._op,this._value)}}class Uf extends AN{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Uf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===n.length?n[0]:At.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return 0===n.getFilters().length?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const u of a)Zq(o,u),o=kR(o,u)}(e._query,n),new Ar(e.firestore,e.converter,kR(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class SN extends F_{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new SN(e,n)}_apply(e){const n=function(i,s,o){if(null!==i.startAt)throw new Z(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new Z(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new o_(s,o)}(e._query,this._field,this._direction);return new Ar(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Ta(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}class hT extends F_{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new hT(e,n,r)}_apply(e){return new Ar(e.firestore,e.converter,xw(e._query,this._limit,this._limitType))}}class fT extends F_{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new fT(e,n,r)}_apply(e){const n=zq(e,this.type,this._docOrFields,this._inclusive);return new Ar(e.firestore,e.converter,(s=n,new Ta((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)));var i,s}}class pT extends F_{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new pT(e,n,r)}_apply(e){const n=zq(e,this.type,this._docOrFields,this._inclusive);return new Ar(e.firestore,e.converter,(s=n,new Ta((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)));var i,s}}function zq(t,e,n,r){if(n[0]=(0,I.m9)(n[0]),n[0]instanceof O_)return function(s,o,a,u,d){if(!u)throw new Z(F.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const f=[];for(const g of gf(s))if(g.field.isKeyField())f.push(Cl(o,u.key));else{const m=u.data.field(g.field);if(bw(m))throw new Z(F.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+g.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===m){const y=g.field.canonicalString();throw new Z(F.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}f.push(m)}return new zu(f,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=Fl(t.firestore);return function(o,a,u,d,f,g){const m=o.explicitOrderBy;if(f.length>m.length)throw new Z(F.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const y=[];for(let E=0;E<f.length;E++){const C=f[E];if(m[E].field.isKeyField()){if("string"!=typeof C)throw new Z(F.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof C}`);if(!MR(o)&&-1!==C.indexOf("/"))throw new Z(F.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${C}' contains a slash.`);const D=o.path.child(dt.fromString(C));if(!se.isDocumentKey(D))throw new Z(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${D}' is not because it contains an odd number of segments.`);const O=new se(D);y.push(Cl(a,O))}else{const D=jq(u,d,C);y.push(D)}}return new zu(y,g)}(t._query,t.firestore._databaseId,i,e,n,r)}}function Wq(t,e,n){if("string"==typeof(n=(0,I.m9)(n))){if(""===n)throw new Z(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!MR(e)&&-1!==n.indexOf("/"))throw new Z(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(dt.fromString(n));if(!se.isDocumentKey(r))throw new Z(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Cl(t,new se(r))}if(n instanceof tn)return Cl(t,n._key);throw new Z(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${iT(n)}.`)}function Kq(t,e){if(!Array.isArray(t)||0===t.length)throw new Z(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Zq(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw new Z(F.INVALID_ARGUMENT,n===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class RN{convertValue(e,n="none"){switch(Gu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Cn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(wa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw he()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Bu(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new oT(Cn(e.latitude),Cn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Dw(e);return null==r?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(n_(e));default:return null}}convertTimestamp(e){const n=ju(e);return new an(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=dt.fromString(e);me(cG(r));const i=new $u(r.get(1),r.get(3)),s=new se(r.popFirst(5));return i.isEqual(n)||kn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}function gT(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class ole extends RN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ro(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new tn(this.firestore,null,n)}}class Ll{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ra extends O_{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new L_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(dT("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class L_ extends Ra{data(e={}){return super.data(e)}}class ec{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Ll(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new L_(this._firestore,this._userDataWriter,r.key,r,new Ll(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Z(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>({type:"added",doc:new L_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ll(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:o++}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||3!==a.type).map(a=>{const u=new L_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ll(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,f=-1;return 0!==a.type&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),1!==a.type&&(o=o.add(a.doc),f=o.indexOf(a.doc.key)),{type:ule(a.type),doc:u,oldIndex:d,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function ule(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return he()}}function Yq(t,e){return t instanceof Ra&&e instanceof Ra?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof ec&&e instanceof ec&&t._firestore===e._firestore&&IN(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}class tc extends RN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ro(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new tn(this.firestore,null,n)}}function Xq(t,e,n){t=nt(t,tn);const r=nt(t.firestore,zt),i=gT(t.converter,e,n);return Bf(r,[uT(Fl(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,un.none())])}function Jq(t,e,n,...r){t=nt(t,tn);const i=nt(t.firestore,zt),s=Fl(i);let o;return o="string"==typeof(e=(0,I.m9)(e))||e instanceof Sa?bN(s,"updateDoc",t._key,e,n,r):CN(s,"updateDoc",t._key,e),Bf(i,[o.toMutation(t._key,un.exists(!0))])}function e4(t,...e){var n,r,i;t=(0,I.m9)(t);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||wN(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(wN(e[o])){const g=e[o];e[o]=null===(n=g.next)||void 0===n?void 0:n.bind(g),e[o+1]=null===(r=g.error)||void 0===r?void 0:r.bind(g),e[o+2]=null===(i=g.complete)||void 0===i?void 0:i.bind(g)}let u,d,f;if(t instanceof tn)d=nt(t.firestore,zt),f=pf(t._key.path),u={next:g=>{e[o]&&e[o](PN(d,t,g))},error:e[o+1],complete:e[o+2]};else{const g=nt(t,Ar);d=nt(g.firestore,zt),f=g._query;const m=new tc(d);u={next:y=>{e[o]&&e[o](new ec(d,m,g,y))},error:e[o+1],complete:e[o+2]},qq(t._query)}return function(m,y,E,C){const D=new tT(C),O=new UP(y,D,E);return m.asyncQueue.enqueueAndForget((0,$.Z)(function*(){return kP(yield Lf(m),O)})),()=>{D.Na(),m.asyncQueue.enqueueAndForget((0,$.Z)(function*(){return FP(yield Lf(m),O)}))}}(bn(d),f,a,u)}function Bf(t,e){return function(r,i){const s=new Yn;return r.asyncQueue.enqueueAndForget((0,$.Z)(function*(){return function ece(t,e,n){return GP.apply(this,arguments)}(yield yN(r),i,s)})),s.promise}(bn(t),e)}function PN(t,e,n){const r=n.docs.get(e._key),i=new tc(t);return new Ra(t,i,e._key,r,new Ll(n.hasPendingWrites,n.fromCache),e.converter)}const Dle={maxAttempts:5};class t4{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Fl(e)}set(e,n,r){this._verifyNotCommitted();const i=nc(e,this._firestore),s=gT(i.converter,n,r),o=uT(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(o.toMutation(i._key,un.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=nc(e,this._firestore);let o;return o="string"==typeof(n=(0,I.m9)(n))||n instanceof Sa?bN(this._dataReader,"WriteBatch.update",s._key,n,r,i):CN(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,un.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=nc(e,this._firestore);return this._mutations=this._mutations.concat(new Ef(n._key,un.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Z(F.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function nc(t,e){if((t=(0,I.m9)(t)).firestore!==e)throw new Z(F.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}class Ale extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=Fl(n)}get(n){const r=nc(n,this._firestore),i=new ole(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||1!==s.length)return he();const o=s[0];if(o.isFoundDocument())return new O_(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new O_(this._firestore,i,r._key,null,r.converter);throw he()})}set(n,r,i){const s=nc(n,this._firestore),o=gT(s.converter,r,i),a=uT(this._dataReader,"Transaction.set",s._key,o,null!==s.converter,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){const o=nc(n,this._firestore);let a;return a="string"==typeof(r=(0,I.m9)(r))||r instanceof Sa?bN(this._dataReader,"Transaction.update",o._key,r,i,s):CN(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){const r=nc(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=nc(e,this._firestore),r=new tc(this._firestore);return super.get(e).then(i=>new Ra(this._firestore,r,n._key,i._document,new Ll(!1,!1),n.converter))}}function xN(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Z("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function s4(){if(typeof Uint8Array>"u")throw new Z("unimplemented","Uint8Arrays are not available in this environment.")}function o4(){if(!function oae(){return typeof atob<"u"}())throw new Z("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(e,n=!0){sf=vi.SDK_VERSION,(0,vi._registerComponent)(new Os.wA("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new zt(new Poe(r.getProvider("auth-internal")),new Moe(r.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Z(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $u(d.options.projectId,f)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),(0,vi.registerVersion)(F$,"4.4.0",e),(0,vi.registerVersion)(F$,"4.4.0","esm2017")}();class U_{constructor(e){this._delegate=e}static fromBase64String(e){return o4(),new U_(Ro.fromBase64String(e))}static fromUint8Array(e){return s4(),new U_(Ro.fromUint8Array(e))}toBase64(){return o4(),this._delegate.toBase64()}toUint8Array(){return s4(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function MN(t){return function Vle(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const r of e)if(r in n&&"function"==typeof n[r])return!0;return!1}(t,["next","error","complete"])}class Lle{enableIndexedDbPersistence(e,n){return function Oce(t,e){Vq(t=nt(t,zt));const n=bn(t);if(n._uninitializedComponentsProvider)throw new Z(F.FAILED_PRECONDITION,"SDK cache is already specified.");wi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),i=new Ff;return Fq(n,i,new dN(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return function Fce(t){Vq(t=nt(t,zt));const e=bn(t);if(e._uninitializedComponentsProvider)throw new Z(F.FAILED_PRECONDITION,"SDK cache is already specified.");wi("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new Ff;return Fq(e,r,new _q(r,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function Vce(t){if(t._initialized&&!t._terminated)throw new Z(F.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Yn;return t._queue.enqueueAndForgetEvenWhileRestricted((0,$.Z)(function*(){try{yield(n=(0,$.Z)(function*(i){if(!$s.D())return Promise.resolve();const s=i+"main";yield $s.delete(s)}),function r(i){return n.apply(this,arguments)})(rP(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}var n})),e.promise}(e._delegate)}}class a4{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof $u||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&wi("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},n),e)).merge,this._delegate._setSettings(e)}useEmulator(e,n,r={}){!function xq(t,e,n,r={}){var i;const s=(t=nt(t,N_))._getSettings(),o=`${e}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&wi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if("string"==typeof r.mockUserToken)a=r.mockUserToken,u=ar.MOCK_USER;else{a=(0,I.Sg)(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new Z(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new ar(d)}t._authCredentials=new Roe(new V$(a,u))}}(this._delegate,e,n,r)}enableNetwork(){return function Uce(t){return function Ice(t){return t.asyncQueue.enqueue((0,$.Z)(function*(){const e=yield Eq(t),n=yield Iq(t);return e.setNetworkEnabled(!0),function(i){const s=ie(i);return s.C_.delete(0),S_(s)}(n)}))}(bn(t=nt(t,zt)))}(this._delegate)}disableNetwork(){return function Bce(t){return function wce(t){return t.asyncQueue.enqueue((0,$.Z)(function*(){const e=yield Eq(t),n=yield Iq(t);return e.setNetworkEnabled(!1),(r=(0,$.Z)(function*(s){const o=ie(s);o.C_.add(0),yield Rf(o),o.M_.set("Offline")}),function i(s){return r.apply(this,arguments)})(n);var r}))}(bn(t=nt(t,zt)))}(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Aq("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function Lce(t){return function(n){const r=new Yn;return n.asyncQueue.enqueueAndForget((0,$.Z)(function*(){return function ice(t,e){return ZP.apply(this,arguments)}(yield yN(n),r)})),r.promise}(bn(t=nt(t,zt)))}(this._delegate)}onSnapshotsInSync(e){return function _le(t,e){return function bce(t,e){const n=new tT(e);return t.asyncQueue.enqueueAndForget((0,$.Z)(function*(){return i=yield Lf(t),s=n,ie(i).q_.add(s),void s.next();var i,s})),()=>{n.Na(),t.asyncQueue.enqueueAndForget((0,$.Z)(function*(){return i=yield Lf(t),s=n,void ie(i).q_.delete(s);var i,s}))}}(bn(t=nt(t,zt)),wN(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Z("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new jf(this,Mq(this._delegate,e))}catch(n){throw ei(n,"collection()","Firestore.collection()")}}doc(e){try{return new fs(this,sT(this._delegate,e))}catch(n){throw ei(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ti(this,function Nce(t,e){if(t=nt(t,N_),EN("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Z(F.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ar(t,null,(r=e,new Ta(dt.emptyPath(),r)));var r}(this._delegate,e))}catch(n){throw ei(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function Sle(t,e,n){t=nt(t,zt);const r=Object.assign(Object.assign({},Dle),n);return function(s){if(s.maxAttempts<1)throw new Z(F.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const u=new Yn;return s.asyncQueue.enqueueAndForget((0,$.Z)(function*(){const d=yield function wq(t){return rT(t).then(e=>e.datastore)}(s);new vce(s.asyncQueue,d,a,o,u).run()})),u.promise}(bn(t),i=>e(new Ale(t,i)),r)}(this._delegate,n=>e(new u4(this,n)))}batch(){return bn(this._delegate),new c4(new t4(this._delegate,e=>Bf(this._delegate,e)))}loadBundle(e){return function jce(t,e){const n=bn(t=nt(t,zt)),r=new Mce;return function Dce(t,e,n,r){const i=function(o,a){let u;return u="string"==typeof o?qH().encode(o):o,f=function(f,g){if(f instanceof Uint8Array)return yq(f,g);if(f instanceof ArrayBuffer)return yq(new Uint8Array(f),g);if(f instanceof ReadableStream)return f.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),new _ce(f,a);var f}(n,A_(e));t.asyncQueue.enqueueAndForget((0,$.Z)(function*(){!function gce(t,e,n){const r=ie(t);var i;(i=(0,$.Z)(function*(o,a,u){try{const d=yield a.getMetadata();if(yield function(E,C){const D=ie(E),O=On(C.createTime);return D.persistence.runTransaction("hasNewerBundle","readonly",R=>D.Kr.getBundleMetadata(R,C.id)).then(R=>!!R&&R.createTime.compareTo(O)>=0)}(o.localStore,d))return yield a.close(),u._completeWith({taskState:"Success",documentsLoaded:(E=d).totalDocuments,bytesLoaded:E.totalBytes,totalDocuments:E.totalDocuments,totalBytes:E.totalBytes}),Promise.resolve(new Set);u._updateProgress(uq(d));const f=new Kue(d,o.localStore,a.serializer);let g=yield a.Ma();for(;g;){const y=yield f.ea(g);y&&u._updateProgress(y),g=yield a.Ma()}const m=yield f.complete();return yield Aa(o,m.ra,void 0),yield function(E,C){const D=ie(E);return D.persistence.runTransaction("Save bundle","readwrite",O=>D.Kr.saveBundleMetadata(O,C))}(o.localStore,d),u._completeWith(m.progress),Promise.resolve(m.na)}catch(d){return wi("SyncEngine",`Loading bundle failed with ${d}`),u._failWith(d),Promise.resolve(new Set)}var E}),function s(o,a,u){return i.apply(this,arguments)})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield yN(t),i,r)}))}(n,t._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function $ce(t,e){return function Ace(t,e){return t.asyncQueue.enqueue((0,$.Z)(function*(){return function(r,i){const s=ie(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Kr.getNamedQuery(o,i))}(yield Vf(t),e)}))}(bn(t=nt(t,zt)),e).then(n=>n?new Ar(t,null,n.query):null)}(this._delegate,e).then(n=>n?new ti(this,n):null)}}class _T extends RN{constructor(e){super(),this.firestore=e}convertBytes(e){return new U_(new Ro(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return fs.forKey(n,this.firestore,null)}}class u4{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new _T(e)}get(e){const n=Bl(e);return this._delegate.get(n).then(r=>new B_(this._firestore,new Ra(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=Bl(e);return r?(xN("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Bl(e);return 2===arguments.length?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Bl(e);return this._delegate.delete(n),this}}class c4{constructor(e){this._delegate=e}set(e,n,r){const i=Bl(e);return r?(xN("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Bl(e);return 2===arguments.length?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Bl(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class Ul{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new L_(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new j_(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=Ul.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new Ul(e,new _T(e),n),i.set(n,s)),s}}Ul.INSTANCES=new WeakMap;class fs{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new _T(e)}static forPath(e,n,r){if(e.length%2!=0)throw new Z("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new fs(n,new tn(n._delegate,r,new se(e)))}static forKey(e,n,r){return new fs(n,new tn(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new jf(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new jf(this.firestore,Mq(this._delegate,e))}catch(n){throw ei(n,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,I.m9)(e))instanceof tn&&kq(this._delegate,e)}set(e,n){n=xN("DocumentReference.set",n);try{return n?Xq(this._delegate,e,n):Xq(this._delegate,e)}catch(r){throw ei(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return 1===arguments.length?Jq(this._delegate,e):Jq(this._delegate,e,n,...r)}catch(i){throw ei(i,"updateDoc()","DocumentReference.update()")}}delete(){return function gle(t){return Bf(nt(t.firestore,zt),[new Ef(t._key,un.none())])}(this._delegate)}onSnapshot(...e){const n=l4(e),r=d4(e,i=>new B_(this.firestore,new Ra(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return e4(this._delegate,n,r)}get(e){let n;return n="cache"===e?.source?function lle(t){t=nt(t,tn);const e=nt(t.firestore,zt),n=bn(e),r=new tc(e);return function Tce(t,e){const n=new Yn;return t.asyncQueue.enqueueAndForget((0,$.Z)(function*(){return(r=(0,$.Z)(function*(s,o,a){try{const u=yield function(f,g){const m=ie(f);return m.persistence.runTransaction("read document","readonly",y=>m.localDocuments.getDocument(y,g))}(s,o);u.isFoundDocument()?a.resolve(u):u.isNoDocument()?a.resolve(null):a.reject(new Z(F.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const d=xf(u,`Failed to get document '${o} from cache`);a.reject(d)}}),function i(s,o,a){return r.apply(this,arguments)})(yield Vf(t),e,n);var r})),n.promise}(n,t._key).then(i=>new Ra(e,r,t._key,i,new Ll(null!==i&&i.hasLocalMutations,!0),t.converter))}(this._delegate):"server"===e?.source?function dle(t){t=nt(t,tn);const e=nt(t.firestore,zt);return Tq(bn(e),t._key,{source:"server"}).then(n=>PN(e,t,n))}(this._delegate):function cle(t){t=nt(t,tn);const e=nt(t.firestore,zt);return Tq(bn(e),t._key).then(n=>PN(e,t,n))}(this._delegate),n.then(r=>new B_(this.firestore,new Ra(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new fs(this.firestore,this._delegate.withConverter(e?Ul.getInstance(this.firestore,e):null))}}function ei(t,e,n){return t.message=t.message.replace(e,n),t}function l4(t){for(const e of t)if("object"==typeof e&&!MN(e))return e;return{}}function d4(t,e){var n,r;let i;return i=MN(t[0])?t[0]:MN(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class B_{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new fs(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Yq(this._delegate,e._delegate)}}class j_ extends B_{data(e){const n=this._delegate.data(e);return this._delegate._converter||function Aoe(t,e){t||he()}(void 0!==n),n}}class ti{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new _T(e)}where(e,n,r){try{return new ti(this.firestore,Ju(this._delegate,function Xce(t,e,n){const r=e,i=dT("where",t);return V_._create(i,r,n)}(e,n,r)))}catch(i){throw ei(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new ti(this.firestore,Ju(this._delegate,function Jce(t,e="asc"){const n=e,r=dT("orderBy",t);return SN._create(r,n)}(e,n)))}catch(r){throw ei(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new ti(this.firestore,Ju(this._delegate,function ele(t){return Pq("limit",t),hT._create("limit",t,"F")}(e)))}catch(n){throw ei(n,"limit()","Query.limit()")}}limitToLast(e){try{return new ti(this.firestore,Ju(this._delegate,function tle(t){return Pq("limitToLast",t),hT._create("limitToLast",t,"L")}(e)))}catch(n){throw ei(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new ti(this.firestore,Ju(this._delegate,function nle(...t){return fT._create("startAt",t,!0)}(...e)))}catch(n){throw ei(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new ti(this.firestore,Ju(this._delegate,function rle(...t){return fT._create("startAfter",t,!1)}(...e)))}catch(n){throw ei(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new ti(this.firestore,Ju(this._delegate,function ile(...t){return pT._create("endBefore",t,!1)}(...e)))}catch(n){throw ei(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new ti(this.firestore,Ju(this._delegate,function sle(...t){return pT._create("endAt",t,!0)}(...e)))}catch(n){throw ei(n,"endAt()","Query.endAt()")}}isEqual(e){return IN(this._delegate,e._delegate)}get(e){let n;return n="cache"===e?.source?function fle(t){t=nt(t,Ar);const e=nt(t.firestore,zt),n=bn(e),r=new tc(e);return function Cce(t,e){const n=new Yn;return t.asyncQueue.enqueueAndForget((0,$.Z)(function*(){return(r=(0,$.Z)(function*(s,o,a){try{const u=yield Kw(s,o,!0),d=new dq(o,u.ls),f=d.ca(u.documents),g=d.applyChanges(f,!1);a.resolve(g.snapshot)}catch(u){const d=xf(u,`Failed to execute query '${o} against cache`);a.reject(d)}}),function i(s,o,a){return r.apply(this,arguments)})(yield Vf(t),e,n);var r})),n.promise}(n,t._query).then(i=>new ec(e,r,t,i))}(this._delegate):"server"===e?.source?function ple(t){t=nt(t,Ar);const e=nt(t.firestore,zt),n=bn(e),r=new tc(e);return Cq(n,t._query,{source:"server"}).then(i=>new ec(e,r,t,i))}(this._delegate):function hle(t){t=nt(t,Ar);const e=nt(t.firestore,zt),n=bn(e),r=new tc(e);return qq(t._query),Cq(n,t._query).then(i=>new ec(e,r,t,i))}(this._delegate),n.then(r=>new kN(this.firestore,new ec(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=l4(e),r=d4(e,i=>new kN(this.firestore,new ec(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return e4(this._delegate,n,r)}withConverter(e){return new ti(this.firestore,this._delegate.withConverter(e?Ul.getInstance(this.firestore,e):null))}}class Ble{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new j_(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class kN{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new ti(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new j_(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new Ble(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new j_(this._firestore,r))})}isEqual(e){return Yq(this._delegate,e._delegate)}}class jf extends ti{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new fs(this.firestore,e):null}doc(e){try{return new fs(this.firestore,void 0===e?sT(this._delegate):sT(this._delegate,e))}catch(n){throw ei(n,"doc()","CollectionReference.doc()")}}add(e){return function mle(t,e){const n=nt(t.firestore,zt),r=sT(t),i=gT(t.converter,e);return Bf(n,[uT(Fl(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,un.exists(!1))]).then(()=>r)}(this._delegate,e).then(n=>new fs(this.firestore,n))}isEqual(e){return kq(this._delegate,e._delegate)}withConverter(e){return new jf(this.firestore,this._delegate.withConverter(e?Ul.getInstance(this.firestore,e):null))}}function Bl(t){return nt(t,tn)}class ON{constructor(...e){this._delegate=new Sa(...e)}static documentId(){return new ON(Jt.keyField().canonicalString())}isEqual(e){return(e=(0,I.m9)(e))instanceof Sa&&this._delegate._internalPath.isEqual(e._internalPath)}}class jl{constructor(e){this._delegate=e}static serverTimestamp(){const e=function Ple(){return new TN("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new jl(e)}static delete(){const e=function Rle(){return new M_("deleteField")}();return e._methodName="FieldValue.delete",new jl(e)}static arrayUnion(...e){const n=function Nle(...t){return new Wce("arrayUnion",t)}(...e);return n._methodName="FieldValue.arrayUnion",new jl(n)}static arrayRemove(...e){const n=function xle(...t){return new Kce("arrayRemove",t)}(...e);return n._methodName="FieldValue.arrayRemove",new jl(n)}static increment(e){const n=function Mle(t){return new Zce("increment",t)}(e);return n._methodName="FieldValue.increment",new jl(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const jle={Firestore:a4,GeoPoint:oT,Timestamp:an,Blob:U_,Transaction:u4,WriteBatch:c4,DocumentReference:fs,DocumentSnapshot:B_,Query:ti,QueryDocumentSnapshot:j_,QuerySnapshot:kN,CollectionReference:jf,FieldPath:ON,FieldValue:jl,setLogLevel:function Ule(t){!function Doe(t){Vu.setLogLevel(t)}(t)},CACHE_SIZE_UNLIMITED:-1};function h4(t,e){return function Gle(t,e=ZE){return new Ge(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}(t,e)}function FN(t,e){return h4(t,e).pipe(Ie(n=>({payload:n,type:"query"})))}!function Hle(t){(function $le(t,e){t.INTERNAL.registerComponent(new Os.wA("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},jle)))})(t,(e,n)=>new a4(e,n,new Lle)),t.registerVersion("@firebase/firestore-compat","0.3.23")}(us.Z);class f4{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){const r=this.ref.collection(e),{ref:i,query:s}=v4(r,n);return new m4(i,s,this.afs)}snapshotChanges(){return function qle(t,e){return h4(t,e).pipe(NE(void 0),xS(),Ie(n=>{const[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Mn)}valueChanges(e={}){return this.snapshotChanges().pipe(Ie(({payload:n})=>e.idField?{...n.data(),[e.idField]:n.id}:n.data()))}get(e){return ct(this.ref.get(e)).pipe(Mn)}}function yT(t,e){return FN(t,e).pipe(NE(void 0),xS(),Ie(n=>{const[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{const d=s.find(g=>g.doc.ref.isEqual(a.ref)),f=r?.payload.docs.find(g=>g.ref.isEqual(a.ref));d&&JSON.stringify(d.doc.metadata)===JSON.stringify(a.metadata)||!d&&f&&JSON.stringify(f.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function p4(t,e,n){return yT(t,n).pipe(wh((r,i)=>function zle(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=function Wle(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return VN(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return VN(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return VN(t,e.oldIndex,1)}return t}(t,r))}),t}(r,i.map(s=>s.payload),e),[]),Zs(),Ie(r=>r.map(i=>({type:i.type,payload:i}))))}function VN(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function g4(t){return(!t||0===t.length)&&(t=["added","removed","modified"]),t}class m4{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=yT(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(Ie(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(NE(void 0),xS(),Ms(([r,i])=>i.length>0||!r),Ie(([,r])=>r),Mn)}auditTrail(e){return this.stateChanges(e).pipe(wh((n,r)=>[...n,...r],[]))}snapshotChanges(e){const n=g4(e);return p4(this.query,n,this.afs.schedulers.outsideAngular).pipe(Mn)}valueChanges(e={}){return FN(this.query,this.afs.schedulers.outsideAngular).pipe(Ie(n=>n.payload.docs.map(r=>e.idField?{...r.data(),[e.idField]:r.id}:r.data())),Mn)}get(e){return ct(this.query.get(e)).pipe(Mn)}add(e){return this.ref.add(e)}doc(e){return new f4(this.ref.doc(e),this.afs)}}class Kle{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return e&&0!==e.length?yT(this.query,this.afs.schedulers.outsideAngular).pipe(Ie(n=>n.filter(r=>e.indexOf(r.type)>-1)),Ms(n=>n.length>0),Mn):yT(this.query,this.afs.schedulers.outsideAngular).pipe(Mn)}auditTrail(e){return this.stateChanges(e).pipe(wh((n,r)=>[...n,...r],[]))}snapshotChanges(e){const n=g4(e);return p4(this.query,n,this.afs.schedulers.outsideAngular).pipe(Mn)}valueChanges(e={}){return FN(this.query,this.afs.schedulers.outsideAngular).pipe(Ie(r=>r.payload.docs.map(i=>e.idField?{[e.idField]:i.id,...i.data()}:i.data())),Mn)}get(e){return ct(this.query.get(e)).pipe(Mn)}}const _4=new re("angularfire2.enableFirestorePersistence"),y4=new re("angularfire2.firestore.persistenceSettings"),Zle=new re("angularfire2.firestore.settings"),Qle=new re("angularfire2.firestore.use-emulator");function v4(t,e=(n=>n)){return{query:e(t),ref:t}}let Yle=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,u,d,f,g,m,y,E,C,D,O,R){this.schedulers=u;const k=Qg(n,a,r),G=f;g&&X0(k,a,m,E,C,D,y,O),[this.firestore,this.persistenceEnabled$]=nI(`${k.name}.firestore`,"AngularFirestore",k.name,()=>{const ne=a.runOutsideAngular(()=>k.firestore());if(s&&ne.settings(s),G&&ne.useEmulator(...G),i&&!bE(o)){const Te=()=>{try{return ct(ne.enablePersistence(d||void 0).then(()=>!0,()=>!1))}catch(at){return typeof console<"u"&&console.warn(at),fe(!1)}};return[ne,a.runOutsideAngular(Te)]}return[ne,fe(!1)]},[s,G,i])}collection(n,r){let i;i="string"==typeof n?this.firestore.collection(n):n;const{ref:s,query:o}=v4(i,r),a=this.schedulers.ngZone.run(()=>s);return new m4(a,o,this)}collectionGroup(n,r){const i=r||(o=>o),s=this.firestore.collectionGroup(n);return new Kle(i(s),this)}doc(n){let r;r="string"==typeof n?this.firestore.doc(n):n;const i=this.schedulers.ngZone.run(()=>r);return new f4(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(z(Oh),z(Fh,8),z(_4,8),z(Zle,8),z(Ds),z(lt),z(tI),z(y4,8),z(Qle,8),z(J0,8),z(z0,8),z(W0,8),z(K0,8),z(Z0,8),z(Q0,8),z(Y0,8),z(eI,8))};static \u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),Xle=(()=>{class t{constructor(){us.Z.registerVersion("angularfire",Zg.full,"fst-compat")}static enablePersistence(n){return{ngModule:t,providers:[{provide:_4,useValue:!0},{provide:y4,useValue:n}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=er({type:t});static \u0275inj=Vn({providers:[Yle]})}return t})();class ede{constructor(e,n){this.dueTime=e,this.scheduler=n}call(e,n){return n.subscribe(new tde(e,this.dueTime,this.scheduler))}}class tde extends Ee{constructor(e,n,r){super(e),this.dueTime=n,this.scheduler=r,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(nde,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:e}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}clearDebounce(){const e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}function nde(t){t.debouncedNext()}const E4="firebasestorage.googleapis.com",I4="storageBucket";class gn extends I.ZR{constructor(e,n,r=0){super(LN(e),`Firebase Storage: ${n} (${LN(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,gn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return LN(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var cn=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(cn||{});function LN(t){return"storage/"+t}function UN(){return new gn(cn.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function w4(){return new gn(cn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function T4(){return new gn(cn.CANCELED,"User canceled the upload/download.")}function C4(){return new gn(cn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function $f(t){return new gn(cn.INVALID_ARGUMENT,t)}function b4(){return new gn(cn.APP_DELETED,"The Firebase app was deleted.")}function D4(t){return new gn(cn.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function $_(t,e){return new gn(cn.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function H_(t){throw new gn(cn.INTERNAL_ERROR,"Internal error: "+t)}class Ur{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Ur.makeFromUrl(e,n)}catch{return new Ur(e,"")}if(""===r.path)return r;throw function hde(t){return new gn(cn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)",a=new RegExp("^gs://"+i+"(/(.*))?$","i");function d(G){G.path_=decodeURIComponent(G.path)}const g=n.replace(/[.]/g,"\\."),k=[{regex:a,indices:{bucket:1,path:3},postModify:function s(G){"/"===G.path.charAt(G.path.length-1)&&(G.path_=G.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${g}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:d},{regex:new RegExp(`^https?://${n===E4?"(?:storage.googleapis.com|storage.cloud.google.com)":n}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:d}];for(let G=0;G<k.length;G++){const ne=k[G],Te=ne.regex.exec(e);if(Te){let nn=Te[ne.indices.path];nn||(nn=""),r=new Ur(Te[ne.indices.bucket],nn),ne.postModify(r);break}}if(null==r)throw function dde(t){return new gn(cn.INVALID_URL,"Invalid URL '"+t+"'.")}(e);return r}}class _de{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function vT(t){return"string"==typeof t||t instanceof String}function A4(t){return BN()&&t instanceof Blob}function BN(){return typeof Blob<"u"}function jN(t,e,n,r){if(r<e)throw $f(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw $f(`Invalid value for '${t}'. Expected ${n} or less.`)}function Pa(t,e,n){let r=e;return null==n&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function S4(t){const e=encodeURIComponent;let n="?";for(const r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n=n.slice(0,-1),n}var Hf=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(Hf||{});function R4(t,e){const n=t>=500&&t<600,i=-1!==[408,429].indexOf(t),s=-1!==e.indexOf(t);return n||i||s}class Tde{constructor(e,n,r,i,s,o,a,u,d,f,g,m=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=d,this.progressCallback_=f,this.connectionFactory_=g,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,E)=>{this.resolve_=y,this.reject_=E,this.start_()})}start_(){const n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const u=this.callback_(a,a.getResponse());!function Ede(t){return void 0!==t}(u)?s():s(u)}catch(u){o(u)}else if(null!==a){const u=UN();u.serverResponse=a.getErrorText(),o(this.errorCallback_?this.errorCallback_(a,u):u)}else o(i.canceled?this.appDelete_?b4():T4():w4())};this.canceled_?n(0,new ET(!1,null,!0)):this.backoffId_=function yde(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function u(){return 2===a}let d=!1;function f(...D){d||(d=!0,e.apply(null,D))}function g(D){i=setTimeout(()=>{i=null,t(y,u())},D)}function m(){s&&clearTimeout(s)}function y(D,...O){if(d)return void m();if(D)return m(),void f.call(null,D,...O);if(u()||o)return m(),void f.call(null,D,...O);let k;r<64&&(r*=2),1===a?(a=2,k=0):k=1e3*(r+Math.random()),g(k)}let E=!1;function C(D){E||(E=!0,m(),!d&&(null!==i?(D||(a=2),clearTimeout(i),g(0)):D||(a=1)))}return g(0),s=setTimeout(()=>{o=!0,C(!0)},n),C}((r,i)=>{if(i)return void r(!1,new ET(!1,null,!0));const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{null!==this.progressCallback_&&this.progressCallback_(a.loaded,a.lengthComputable?a.total:-1)};null!==this.progressCallback_&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Hf.NO_ERROR,u=s.getStatus();if(!a||R4(u,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===Hf.ABORT;return void r(!1,new ET(!1,null,f))}const d=-1!==this.successCodes_.indexOf(u);r(!0,new ET(d,s))})},n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function vde(t){t(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class ET{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function Pde(...t){const e=function Rde(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}if(BN())return new Blob(t);throw new gn(cn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const $i={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class $N{constructor(e,n){this.data=e,this.contentType=n||null}}function HN(t,e){switch(t){case $i.RAW:return new $N(P4(e));case $i.BASE64:case $i.BASE64URL:return new $N(N4(t,e));case $i.DATA_URL:return new $N(function kde(t){const e=new x4(t);return e.base64?N4($i.BASE64,e.rest):function Mde(t){let e;try{e=decodeURIComponent(t)}catch{throw $_($i.DATA_URL,"Malformed data URL.")}return P4(e)}(e.rest)}(e),function Ode(t){return new x4(t).contentType}(e))}throw UN()}function P4(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function N4(t,e){switch(t){case $i.BASE64:{const i=-1!==e.indexOf("-"),s=-1!==e.indexOf("_");if(i||s)throw $_(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case $i.BASE64URL:{const i=-1!==e.indexOf("+"),s=-1!==e.indexOf("/");if(i||s)throw $_(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=function xde(t){if(typeof atob>"u")throw function mde(t){return new gn(cn.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(t)}(e)}catch(i){throw i.message.includes("polyfill")?i:$_(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class x4{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(null===n)throw $_($i.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;null!=r&&(this.base64=function Fde(t,e){return t.length>=e.length&&t.substring(t.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class Po{constructor(e,n){let r=0,i="";A4(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(A4(this.data_)){const i=function Nde(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,e,n);return null===i?null:new Po(i)}{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Po(r,!0)}}static getBlob(...e){if(BN()){const n=e.map(r=>r instanceof Po?r.data_:r);return new Po(Pde.apply(null,n))}{const n=e.map(o=>vT(o)?HN($i.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Po(i,!0)}}uploadData(){return this.data_}}function GN(t){let e;try{e=JSON.parse(t)}catch{return null}return function wde(t){return"object"==typeof t&&!Array.isArray(t)}(e)?e:null}function M4(t){const e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function Ude(t,e){return e}class ni{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||Ude}}let IT=null;function G_(){if(IT)return IT;const t=[];t.push(new ni("bucket")),t.push(new ni("generation")),t.push(new ni("metageneration")),t.push(new ni("name","fullPath",!0));const n=new ni("name");n.xform=function e(s,o){return function Bde(t){return!vT(t)||t.length<2?t:M4(t)}(o)},t.push(n);const i=new ni("size");return i.xform=function r(s,o){return void 0!==o?Number(o):o},t.push(i),t.push(new ni("timeCreated")),t.push(new ni("updated")),t.push(new ni("md5Hash",null,!0)),t.push(new ni("cacheControl",null,!0)),t.push(new ni("contentDisposition",null,!0)),t.push(new ni("contentEncoding",null,!0)),t.push(new ni("contentLanguage",null,!0)),t.push(new ni("contentType",null,!0)),t.push(new ni("metadata","customMetadata",!0)),IT=t,IT}function k4(t,e,n){const r=GN(e);return null===r?null:function $de(t,e,n){const r={type:"file"},i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return function jde(t,e){Object.defineProperty(t,"ref",{get:function n(){const s=new Ur(t.bucket,t.fullPath);return e._makeStorageReference(s)}})}(r,t),r}(t,r,n)}function qN(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}const O4="prefixes",F4="items";class No{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function xo(t){if(!t)throw UN()}function wT(t,e){return function n(r,i){const s=k4(t,i,e);return xo(null!==s),s}}function Gf(t){return function e(n,r){let i;return i=401===n.getStatus()?n.getErrorText().includes("Firebase App Check token is invalid")?function cde(){return new gn(cn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function ude(){return new gn(cn.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===n.getStatus()?function ade(t){return new gn(cn.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(t.bucket):403===n.getStatus()?function lde(t){return new gn(cn.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}(t.path):r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}}function q_(t){const e=Gf(t);return function n(r,i){let s=e(r,i);return 404===r.getStatus()&&(s=function ode(t){return new gn(cn.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}(t.path)),s.serverResponse=i.serverResponse,s}}function V4(t,e,n){const i=Pa(e.fullServerUrl(),t.host,t._protocol),o=t.maxOperationRetryTime,a=new No(i,"GET",wT(t,n),o);return a.errorHandler=q_(e),a}function Kde(t,e,n,r,i){const s={};s.prefix=e.isRoot?"":e.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const a=Pa(e.bucketOnlyServerUrl(),t.host,t._protocol),d=t.maxOperationRetryTime,f=new No(a,"GET",function zde(t,e){return function n(r,i){const s=function qde(t,e,n){const r=GN(n);return null===r?null:function Gde(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[O4])for(const i of n[O4]){const s=i.replace(/\/$/,""),o=t._makeStorageReference(new Ur(e,s));r.prefixes.push(o)}if(n[F4])for(const i of n[F4]){const s=t._makeStorageReference(new Ur(e,i.name));r.items.push(s)}return r}(t,e,r)}(t,e,i);return xo(null!==s),s}}(t,e.bucket),d);return f.urlParams=s,f.errorHandler=Gf(e),f}function U4(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function Xde(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class TT{constructor(e,n,r,i){this.current=e,this.total=n,this.finalized=!!r,this.metadata=i||null}}function zN(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{xo(!1)}return xo(!!n&&-1!==(e||["active"]).indexOf(n)),n}const nhe={STATE_CHANGED:"state_changed"},ri={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function WN(t){switch(t){case"running":case"pausing":case"canceling":return ri.RUNNING;case"paused":return ri.PAUSED;case"success":return ri.SUCCESS;case"canceled":return ri.CANCELED;default:return ri.ERROR}}class rhe{constructor(e,n,r){if(function Ide(t){return"function"==typeof t}(e)||null!=n||null!=r)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}}function qf(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}let $4=null;class ihe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Hf.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Hf.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Hf.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw H_("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),void 0!==i)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw H_("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw H_("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw H_("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw H_("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class she extends ihe{initXhr(){this.xhr_.responseType="text"}}function Hs(){return $4?$4():new she}class H4{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=G_(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(cn.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const s=this.isExponentialBackoffExpired();if(R4(i.status,[])){if(!s)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();i=w4()}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(cn.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,n)=>{const r=function Jde(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o=U4(e,r,i),a={name:o.fullPath},u=Pa(s,t.host,t._protocol),f={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},g=qN(o,n),E=new No(u,"POST",function y(C){let D;zN(C);try{D=C.getResponseHeader("X-Goog-Upload-URL")}catch{xo(!1)}return xo(vT(D)),D},t.maxUploadRetryTime);return E.urlParams=a,E.headers=f,E.body=g,E.errorHandler=Gf(e),E}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Hs,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const i=function ehe(t,e,n,r){const u=new No(n,"POST",function s(d){const f=zN(d,["active","final"]);let g=null;try{g=d.getResponseHeader("X-Goog-Upload-Size-Received")}catch{xo(!1)}g||xo(!1);const m=Number(g);return xo(!isNaN(m)),new TT(m,r.size(),"final"===f)},t.maxUploadRetryTime);return u.headers={"X-Goog-Upload-Command":"query"},u.errorHandler=Gf(e),u}(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Hs,n,r);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,n=new TT(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=function the(t,e,n,r,i,s,o,a){const u=new TT(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw function pde(){return new gn(cn.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const d=u.total-u.current;let f=d;i>0&&(f=Math.min(f,i));const g=u.current;let y="";y=0===f?"finalize":d===f?"upload, finalize":"upload";const E={"X-Goog-Upload-Command":y,"X-Goog-Upload-Offset":`${u.current}`},C=r.slice(g,g+f);if(null===C)throw C4();const k=new No(n,"POST",function D(G,ne){const Te=zN(G,["active","final"]),at=u.current+f,nn=r.size();let xa;return xa="final"===Te?wT(e,s)(G,ne):null,new TT(at,nn,"final"===Te,xa)},e.maxUploadRetryTime);return k.headers=E,k.body=C.uploadData(),k.progressCallback=a||null,k.errorHandler=Gf(t),k}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(u){return this._error=u,void this._transition("error")}const a=this._ref.storage._makeRequest(o,Hs,i,s,!1);this._request=a,a.getPromise().then(u=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(u.current),u.finalized?(this._metadata=u.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=V4(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Hs,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=function B4(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},u=function a(){let k="";for(let G=0;G<2;G++)k+=Math.random().toString().slice(2);return k}();o["Content-Type"]="multipart/related; boundary="+u;const d=U4(e,r,i),f=qN(d,n),y=Po.getBlob("--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+f+"\r\n--"+u+"\r\nContent-Type: "+d.contentType+"\r\n\r\n",r,"\r\n--"+u+"--");if(null===y)throw C4();const E={name:d.fullPath},C=Pa(s,t.host,t._protocol),O=t.maxUploadRetryTime,R=new No(C,"POST",wT(t,n),O);return R.urlParams=E,R.headers=o,R.body=y.uploadData(),R.errorHandler=Gf(e),R}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Hs,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n="paused"===this._state;this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=T4(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=WN(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,i){const s=new rhe(n||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);-1!==n&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(WN(this._state)){case ri.SUCCESS:qf(this._resolve.bind(null,this.snapshot))();break;case ri.CANCELED:case ri.ERROR:qf(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(WN(this._state)){case ri.RUNNING:case ri.PAUSED:e.next&&qf(e.next.bind(e,this.snapshot))();break;case ri.SUCCESS:e.complete&&qf(e.complete.bind(e))();break;default:e.error&&qf(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class $l{constructor(e,n){this._service=e,this._location=n instanceof Ur?n:Ur.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new $l(e,n)}get root(){const e=new Ur(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return M4(this._location.path)}get storage(){return this._service}get parent(){const e=function Vde(t){if(0===t.length)return null;const e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;const n=new Ur(this._location.bucket,e);return new $l(this._service,n)}_throwIfRoot(e){if(""===this._location.path)throw D4(e)}}function q4(t,e,n){return KN.apply(this,arguments)}function KN(){return KN=(0,$.Z)(function*(t,e,n){const i=yield z4(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield q4(t,e,i.nextPageToken))}),KN.apply(this,arguments)}function z4(t,e){null!=e&&"number"==typeof e.maxResults&&jN("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=Kde(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,Hs)}function _he(t){t._throwIfRoot("getDownloadURL");const e=function Zde(t,e,n){const i=Pa(e.fullServerUrl(),t.host,t._protocol),o=t.maxOperationRetryTime,a=new No(i,"GET",function Wde(t,e){return function n(r,i){const s=k4(t,i,e);return xo(null!==s),function Hde(t,e,n,r){const i=GN(e);if(null===i||!vT(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map(d=>{const g=t.fullPath;return Pa("/b/"+o(t.bucket)+"/o/"+o(g),n,r)+S4({alt:"media",token:d})})[0]}(s,i,t.host,t._protocol)}}(t,n),o);return a.errorHandler=q_(e),a}(t.storage,t._location,G_());return t.storage.makeRequestWithTokens(e,Hs).then(n=>{if(null===n)throw function gde(){return new gn(cn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return n})}function W4(t,e){const n=function Lde(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new Ur(t._location.bucket,n);return new $l(t.storage,r)}function K4(t,e){if(t instanceof ZN){const n=t;if(null==n._bucket)throw function fde(){return new gn(cn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+I4+"' property when initializing the app?")}();const r=new $l(n,n._bucket);return null!=e?K4(r,e):r}return void 0!==e?W4(t,e):t}function Ihe(t,e){if(e&&function vhe(t){return/^[A-Za-z]+:\/\//.test(t)}(e)){if(t instanceof ZN)return function Ehe(t,e){return new $l(t,e)}(t,e);throw $f("To use ref(service, url), the first argument must be a Storage instance.")}return K4(t,e)}function Z4(t,e){const n=e?.[I4];return null==n?null:Ur.makeFromBucketSpec(n,t)}class ZN{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=E4,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?Ur.makeFromBucketSpec(i,this._host):Z4(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?Ur.makeFromBucketSpec(this._url,e):Z4(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){jN("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){jN("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,$.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const n=e._authProvider.getImmediate({optional:!0});if(n){const r=yield n.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,$.Z)(function*(){const n=e._appCheckProvider.getImmediate({optional:!0});return n?(yield n.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new $l(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new _de(b4());{const o=function Sde(t,e,n,r,i,s,o=!0){const a=S4(t.urlParams),u=t.url+a,d=Object.assign({},t.headers);return function Dde(t,e){e&&(t["X-Firebase-GMPID"]=e)}(d,e),function Cde(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(d,n),function bde(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(d,s),function Ade(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(d,r),new Tde(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){var r=this;return(0,$.Z)(function*(){const[i,s]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,n,i,s).getPromise()})()}}const Q4="@firebase/storage";function J4(t,e){return Ihe(t=(0,I.m9)(t),e)}function Nhe(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new ZN(n,r,i,e,vi.SDK_VERSION)}!function xhe(){(0,vi._registerComponent)(new Os.wA("storage",Nhe,"PUBLIC").setMultipleInstances(!0)),(0,vi.registerVersion)(Q4,"0.12.0",""),(0,vi.registerVersion)(Q4,"0.12.0","esm2017")}();class CT{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class tz{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new CT(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new CT(r,this,this._ref))},n)}on(e,n,r,i){let s;return n&&(s="function"==typeof n?o=>n(new CT(o,this,this._ref)):{next:n.next?o=>n.next(new CT(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}}class nz{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new Na(e,this._service))}get items(){return this._delegate.items.map(e=>new Na(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class Na{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const n=function Phe(t,e){return W4(t,e)}(this._delegate,e);return new Na(n,this.storage)}get root(){return new Na(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new Na(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new tz(function The(t,e,n){return function hhe(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new H4(t,new Po(e),n)}(t=(0,I.m9)(t),e,n)}(this._delegate,e,n),this)}putString(e,n=$i.RAW,r){this._throwIfRoot("putString");const i=HN(n,e),s=Object.assign({},r);return null==s.contentType&&null!=i.contentType&&(s.contentType=i.contentType),new tz(new H4(this._delegate,new Po(i.data,!0),s),this)}listAll(){return function Ahe(t){return function phe(t){const e={prefixes:[],items:[]};return q4(t,e).then(()=>e)}(t=(0,I.m9)(t))}(this._delegate).then(e=>new nz(e,this.storage))}list(e){return function Dhe(t,e){return z4(t=(0,I.m9)(t),e)}(this._delegate,e||void 0).then(n=>new nz(n,this.storage))}getMetadata(){return function Che(t){return function ghe(t){t._throwIfRoot("getMetadata");const e=V4(t.storage,t._location,G_());return t.storage.makeRequestWithTokens(e,Hs)}(t=(0,I.m9)(t))}(this._delegate)}updateMetadata(e){return function bhe(t,e){return function mhe(t,e){t._throwIfRoot("updateMetadata");const n=function Qde(t,e,n,r){const s=Pa(e.fullServerUrl(),t.host,t._protocol),a=qN(n,r),d=t.maxOperationRetryTime,f=new No(s,"PATCH",wT(t,r),d);return f.headers={"Content-Type":"application/json; charset=utf-8"},f.body=a,f.errorHandler=q_(e),f}(t.storage,t._location,e,G_());return t.storage.makeRequestWithTokens(n,Hs)}(t=(0,I.m9)(t),e)}(this._delegate,e)}getDownloadURL(){return function She(t){return _he(t=(0,I.m9)(t))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function Rhe(t){return function yhe(t){t._throwIfRoot("deleteObject");const e=function Yde(t,e){const r=Pa(e.fullServerUrl(),t.host,t._protocol),a=new No(r,"DELETE",function o(u,d){},t.maxOperationRetryTime);return a.successCodes=[200,204],a.errorHandler=q_(e),a}(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Hs)}(t=(0,I.m9)(t))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw D4(e)}}class rz{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(iz(e))throw $f("ref() expected a child path but got a URL, use refFromURL instead.");return new Na(J4(this._delegate,e),this)}refFromURL(e){if(!iz(e))throw $f("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Ur.makeFromUrl(e,this._delegate.host)}catch{throw $f("refFromUrl() expected a valid full URL but got an invalid one.")}return new Na(J4(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){!function ez(t,e,n,r={}){!function whe(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken="string"==typeof i?i:(0,I.Sg)(i,t.app.options.projectId))}(t,e,n,r)}(this._delegate,e,n,r)}}function iz(t){return/^[A-Za-z]+:\/\//.test(t)}function Fhe(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new rz(n,r)}function sz(t){const e=function Lhe(t){return new Ge(e=>{const n=o=>e.next(o);n(t.snapshot);const s=t.on("state_changed",n);return t.then(o=>{n(o),e.complete()},o=>{n(t.snapshot),(o=>{e.error(o)})(o)}),function(){s()}}).pipe(function Jle(t,e=fJ){return n=>n.lift(new ede(t,e))}(0))}(t);return{task:t,then:t.then.bind(t),catch:t.catch.bind(t),pause:t.pause.bind(t),cancel:t.cancel.bind(t),resume:t.resume.bind(t),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(Ie(n=>n.bytesTransferred/n.totalBytes*100))}}function bT(t){return{getDownloadURL:()=>fe(void 0).pipe(HL,ft(()=>t.getDownloadURL()),Mn),getMetadata:()=>fe(void 0).pipe(HL,ft(()=>t.getMetadata()),Mn),delete:()=>ct(t.delete()),child:e=>bT(t.child(e)),updateMetadata:e=>ct(t.updateMetadata(e)),put:(e,n)=>sz(t.put(e,n)),putString:(e,n,r)=>sz(t.putString(e,n,r)),list:e=>ct(t.list(e)),listAll:()=>ct(t.listAll())}}!function Vhe(t){const e={TaskState:ri,TaskEvent:nhe,StringFormat:$i,Storage:rz,Reference:Na};t.INTERNAL.registerComponent(new Os.wA("storage-compat",Fhe,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage-compat","0.3.3")}(us.Z);const Uhe=new re("angularfire2.storageBucket"),Bhe=new re("angularfire2.storage.maxUploadRetryTime"),jhe=new re("angularfire2.storage.maxOperationRetryTime"),$he=new re("angularfire2.storage.use-emulator");let Hhe=(()=>{class t{storage;constructor(n,r,i,s,o,a,u,d,f,g){const m=Qg(n,o,r);this.storage=nI(`${m.name}.storage.${i}`,"AngularFireStorage",m.name,()=>{const y=o.runOutsideAngular(()=>m.storage(i||void 0)),E=f;return E&&y.useEmulator(...E),u&&y.setMaxUploadRetryTime(u),d&&y.setMaxOperationRetryTime(d),y},[u,d])}ref(n){return bT(this.storage.ref(n))}refFromURL(n){return bT(this.storage.refFromURL(n))}upload(n,r,i){return bT(this.storage.ref(n)).put(r,i)}static \u0275fac=function(r){return new(r||t)(z(Oh),z(Fh,8),z(Uhe,8),z(Ds),z(lt),z(tI),z(Bhe,8),z(jhe,8),z($he,8),z(eI,8))};static \u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),Ghe=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=er({type:t});static \u0275inj=Vn({})}return t})(),qhe=(()=>{class t{constructor(){us.Z.registerVersion("angularfire",Zg.full,"gcs-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=er({type:t});static \u0275inj=Vn({providers:[Hhe],imports:[Ghe]})}return t})();const oz_firebase={apiKey:"AIzaSyAKD3R8dMk-YpNi78GsHXvU_Tkhqp9u3XM",authDomain:"please-take-your-turn.firebaseapp.com",projectId:"please-take-your-turn",storageBucket:"please-take-your-turn.appspot.com",messagingSenderId:"386803685699",appId:"1:386803685699:web:63cff6e4163b36a971f7f6",measurementId:"G-9FT9L70K5D"};let zhe=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=er({type:t,bootstrap:[_se]});static#n=this.\u0275inj=Vn({providers:[lS,dS,dB],imports:[rQ,tse,sse,FJ.initializeApp(oz_firebase),nie,Xle,qhe,sJ]})}return t})();tQ().bootstrapModule(zhe).catch(t=>console.error(t))},106:(Gs,lr,je)=>{je.d(lr,{Z:()=>dr});var b=je(58),De=je(537),V=je(534),Se=je(879);class ln{constructor(We,Ve){this._delegate=We,this.firebase=Ve,(0,V._addComponent)(We,new De.wA("app-compat",()=>this,"PUBLIC")),this.container=We.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(We){this._delegate.automaticDataCollectionEnabled=We}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(We=>{this._delegate.checkDestroyed(),We()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,V.deleteApp)(this._delegate)))}_getService(We,Ve=V._DEFAULT_ENTRY_NAME){var Hn;this._delegate.checkDestroyed();const Br=this._delegate.container.getProvider(We);return!Br.isInitialized()&&"EXPLICIT"===(null===(Hn=Br.getComponent())||void 0===Hn?void 0:Hn.instantiationMode)&&Br.initialize(),Br.getImmediate({identifier:Ve})}_removeServiceInstance(We,Ve=V._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(We).clearInstance(Ve)}_addComponent(We){(0,V._addComponent)(this._delegate,We)}_addOrOverwriteComponent(We){(0,V._addOrOverwriteComponent)(this._delegate,We)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const mn=new b.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),L=function ut(){const Mt=function Fn(Mt){const We={},Ve={__esModule:!0,initializeApp:function Gn(Ke,Dn={}){const dn=V.initializeApp(Ke,Dn);if((0,b.r3)(We,dn.name))return We[dn.name];const Vt=new Mt(dn,Ve);return We[dn.name]=Vt,Vt},app:Br,registerVersion:V.registerVersion,setLogLevel:V.setLogLevel,onLog:V.onLog,apps:null,SDK_VERSION:V.SDK_VERSION,INTERNAL:{registerComponent:function ps(Ke){const Dn=Ke.name,dn=Dn.replace("-compat","");if(V._registerComponent(Ke)&&"PUBLIC"===Ke.type){const Vt=(bi=Br())=>{if("function"!=typeof bi[dn])throw mn.create("invalid-app-argument",{appName:Dn});return bi[dn]()};void 0!==Ke.serviceProps&&(0,b.ZB)(Vt,Ke.serviceProps),Ve[dn]=Vt,Mt.prototype[dn]=function(...bi){return this._getService.bind(this,Dn).apply(this,Ke.multipleInstances?bi:[])}}return"PUBLIC"===Ke.type?Ve[dn]:null},removeApp:function Hn(Ke){delete We[Ke]},useAsService:function rc(Ke,Dn){return"serverAuth"===Dn?null:Dn},modularAPIs:V}};function Br(Ke){if(!(0,b.r3)(We,Ke=Ke||V._DEFAULT_ENTRY_NAME))throw mn.create("no-app",{appName:Ke});return We[Ke]}return Ve.default=Ve,Object.defineProperty(Ve,"apps",{get:function Ge(){return Object.keys(We).map(Ke=>We[Ke])}}),Br.App=Mt,Ve}(ln);return Mt.INTERNAL=Object.assign(Object.assign({},Mt.INTERNAL),{createFirebaseNamespace:ut,extendNamespace:function We(Ve){(0,b.ZB)(Mt,Ve)},createSubscribe:b.ne,ErrorFactory:b.LL,deepExtend:b.ZB}),Mt}(),J=new Se.Yd("@firebase/app-compat");if((0,b.jU)()&&void 0!==self.firebase){J.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Mt=self.firebase.SDK_VERSION;Mt&&Mt.indexOf("LITE")>=0&&J.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const dr=L;!function Ee(Mt){(0,V.registerVersion)("@firebase/app-compat","0.2.25",Mt)}()},534:(Gs,lr,je)=>{je.r(lr),je.d(lr,{FirebaseError:()=>Se.ZR,SDK_VERSION:()=>ql,_DEFAULT_ENTRY_NAME:()=>Sr,_addComponent:()=>An,_addOrOverwriteComponent:()=>Wt,_apps:()=>K,_clearComponents:()=>Ks,_components:()=>_n,_getProvider:()=>ii,_registerComponent:()=>fe,_removeServiceInstance:()=>dc,deleteApp:()=>Fo,getApp:()=>Et,getApps:()=>gt,initializeApp:()=>Ua,onLog:()=>si,registerVersion:()=>ft,setLogLevel:()=>Ba});var b=je(861),De=je(537),V=je(879),Se=je(58);const ln=(j,M)=>M.some(Q=>j instanceof Q);let xt,mn;const L=new WeakMap,J=new WeakMap,ye=new WeakMap,rt=new WeakMap,Ee=new WeakMap;let We={get(j,M,Q){if(j instanceof IDBTransaction){if("done"===M)return J.get(j);if("objectStoreNames"===M)return j.objectStoreNames||ye.get(j);if("store"===M)return Q.objectStoreNames[1]?void 0:Q.objectStore(Q.objectStoreNames[0])}return Gn(j[M])},set:(j,M,Q)=>(j[M]=Q,!0),has:(j,M)=>j instanceof IDBTransaction&&("done"===M||"store"===M)||M in j};function Br(j){return"function"==typeof j?function Hn(j){return j!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ut(){return mn||(mn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(j)?function(...M){return j.apply(Ge(this),M),Gn(L.get(this))}:function(...M){return Gn(j.apply(Ge(this),M))}:function(M,...Q){const le=j.call(Ge(this),M,...Q);return ye.set(le,M.sort?M.sort():[M]),Gn(le)}}(j):(j instanceof IDBTransaction&&function Mt(j){if(J.has(j))return;const M=new Promise((Q,le)=>{const ve=()=>{j.removeEventListener("complete",Xe),j.removeEventListener("error",Le),j.removeEventListener("abort",Le)},Xe=()=>{Q(),ve()},Le=()=>{le(j.error||new DOMException("AbortError","AbortError")),ve()};j.addEventListener("complete",Xe),j.addEventListener("error",Le),j.addEventListener("abort",Le)});J.set(j,M)}(j),ln(j,function Fn(){return xt||(xt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(j,We):j)}function Gn(j){if(j instanceof IDBRequest)return function dr(j){const M=new Promise((Q,le)=>{const ve=()=>{j.removeEventListener("success",Xe),j.removeEventListener("error",Le)},Xe=()=>{Q(Gn(j.result)),ve()},Le=()=>{le(j.error),ve()};j.addEventListener("success",Xe),j.addEventListener("error",Le)});return M.then(Q=>{Q instanceof IDBCursor&&L.set(Q,j)}).catch(()=>{}),Ee.set(M,j),M}(j);if(rt.has(j))return rt.get(j);const M=Br(j);return M!==j&&(rt.set(j,M),Ee.set(M,j)),M}const Ge=j=>Ee.get(j),Ke=["get","getKey","getAll","getAllKeys","count"],Dn=["put","add","delete","clear"],dn=new Map;function Vt(j,M){if(!(j instanceof IDBDatabase)||M in j||"string"!=typeof M)return;if(dn.get(M))return dn.get(M);const Q=M.replace(/FromIndex$/,""),le=M!==Q,ve=Dn.includes(Q);if(!(Q in(le?IDBIndex:IDBObjectStore).prototype)||!ve&&!Ke.includes(Q))return;const Xe=function(){var Le=(0,b.Z)(function*(yn,...wt){const Qs=this.transaction(yn,ve?"readwrite":"readonly");let fc=Qs.store;return le&&(fc=fc.index(wt.shift())),(yield Promise.all([fc[Q](...wt),ve&&Qs.done]))[0]});return function(wt){return Le.apply(this,arguments)}}();return dn.set(M,Xe),Xe}!function Ve(j){We=j(We)}(j=>({...j,get:(M,Q,le)=>Vt(M,Q)||j.get(M,Q,le),has:(M,Q)=>!!Vt(M,Q)||j.has(M,Q)}));class bi{constructor(M){this.container=M}getPlatformInfoString(){return this.container.getProviders().map(Q=>{if(function gs(j){const M=j.getComponent();return"VERSION"===M?.type}(Q)){const le=Q.getImmediate();return`${le.library}/${le.version}`}return null}).filter(Q=>Q).join(" ")}}const Ie="@firebase/app",Hi=new V.Yd("@firebase/app"),Sr="[DEFAULT]",Va={[Ie]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},K=new Map,_n=new Map;function An(j,M){try{j.container.addComponent(M)}catch(Q){Hi.debug(`Component ${M.name} failed to register with FirebaseApp ${j.name}`,Q)}}function Wt(j,M){j.container.addOrOverwriteComponent(M)}function fe(j){const M=j.name;if(_n.has(M))return Hi.debug(`There were multiple attempts to register component ${M}.`),!1;_n.set(M,j);for(const Q of K.values())An(Q,j);return!0}function ii(j,M){const Q=j.container.getProvider("heartbeat").getImmediate({optional:!0});return Q&&Q.triggerHeartbeat(),j.container.getProvider(M)}function dc(j,M,Q=Sr){ii(j,M).clearInstance(Q)}function Ks(){_n.clear()}const fr=new Se.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class La{constructor(M,Q,le){this._isDeleted=!1,this._options=Object.assign({},M),this._config=Object.assign({},Q),this._name=Q.name,this._automaticDataCollectionEnabled=Q.automaticDataCollectionEnabled,this._container=le,this.container.addComponent(new De.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(M){this.checkDestroyed(),this._automaticDataCollectionEnabled=M}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(M){this._isDeleted=M}checkDestroyed(){if(this.isDeleted)throw fr.create("app-deleted",{appName:this._name})}}const ql="10.7.1";function Ua(j,M={}){let Q=j;"object"!=typeof M&&(M={name:M});const le=Object.assign({name:Sr,automaticDataCollectionEnabled:!1},M),ve=le.name;if("string"!=typeof ve||!ve)throw fr.create("bad-app-name",{appName:String(ve)});if(Q||(Q=(0,Se.aH)()),!Q)throw fr.create("no-options");const Xe=K.get(ve);if(Xe){if((0,Se.vZ)(Q,Xe.options)&&(0,Se.vZ)(le,Xe.config))return Xe;throw fr.create("duplicate-app",{appName:ve})}const Le=new De.H0(ve);for(const wt of _n.values())Le.addComponent(wt);const yn=new La(Q,le,Le);return K.set(ve,yn),yn}function Et(j=Sr){const M=K.get(j);if(!M&&j===Sr&&(0,Se.aH)())return Ua();if(!M)throw fr.create("no-app",{appName:j});return M}function gt(){return Array.from(K.values())}function Fo(j){return qi.apply(this,arguments)}function qi(){return(qi=(0,b.Z)(function*(j){const M=j.name;K.has(M)&&(K.delete(M),yield Promise.all(j.container.getProviders().map(Q=>Q.delete())),j.isDeleted=!0)})).apply(this,arguments)}function ft(j,M,Q){var le;let ve=null!==(le=Va[j])&&void 0!==le?le:j;Q&&(ve+=`-${Q}`);const Xe=ve.match(/\s|\//),Le=M.match(/\s|\//);if(Xe||Le){const yn=[`Unable to register library "${ve}" with version "${M}":`];return Xe&&yn.push(`library name "${ve}" contains illegal characters (whitespace or "/")`),Xe&&Le&&yn.push("and"),Le&&yn.push(`version name "${M}" contains illegal characters (whitespace or "/")`),void Hi.warn(yn.join(" "))}fe(new De.wA(`${ve}-version`,()=>({library:ve,version:M}),"VERSION"))}function si(j,M){if(null!==j&&"function"!=typeof j)throw fr.create("invalid-log-argument");(0,V.Am)(j,M)}function Ba(j){(0,V.Ub)(j)}const Zs="firebase-heartbeat-database",hc=1,A="firebase-heartbeat-store";let T=null;function P(){return T||(T=function ps(j,M,{blocked:Q,upgrade:le,blocking:ve,terminated:Xe}={}){const Le=indexedDB.open(j,M),yn=Gn(Le);return le&&Le.addEventListener("upgradeneeded",wt=>{le(Gn(Le.result),wt.oldVersion,wt.newVersion,Gn(Le.transaction),wt)}),Q&&Le.addEventListener("blocked",wt=>Q(wt.oldVersion,wt.newVersion,wt)),yn.then(wt=>{Xe&&wt.addEventListener("close",()=>Xe()),ve&&wt.addEventListener("versionchange",Qs=>ve(Qs.oldVersion,Qs.newVersion,Qs))}).catch(()=>{}),yn}(Zs,hc,{upgrade:(j,M)=>{0===M&&j.createObjectStore(A)}}).catch(j=>{throw fr.create("idb-open",{originalErrorMessage:j.message})})),T}function x(){return(x=(0,b.Z)(function*(j){try{return yield(yield P()).transaction(A).objectStore(A).get(ae(j))}catch(M){if(M instanceof Se.ZR)Hi.warn(M.message);else{const Q=fr.create("idb-get",{originalErrorMessage:M?.message});Hi.warn(Q.message)}}})).apply(this,arguments)}function ge(j,M){return ce.apply(this,arguments)}function ce(){return(ce=(0,b.Z)(function*(j,M){try{const le=(yield P()).transaction(A,"readwrite");yield le.objectStore(A).put(M,ae(j)),yield le.done}catch(Q){if(Q instanceof Se.ZR)Hi.warn(Q.message);else{const le=fr.create("idb-set",{originalErrorMessage:Q?.message});Hi.warn(le.message)}}})).apply(this,arguments)}function ae(j){return`${j.name}!${j.options.appId}`}class jr{constructor(M){this.container=M,this._heartbeatsCache=null;const Q=this.container.getProvider("app").getImmediate();this._storage=new Ai(Q),this._heartbeatsCachePromise=this._storage.read().then(le=>(this._heartbeatsCache=le,le))}triggerHeartbeat(){var M=this;return(0,b.Z)(function*(){var Q,le;const Xe=M.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),Le=it();if((null!=(null===(Q=M._heartbeatsCache)||void 0===Q?void 0:Q.heartbeats)||(M._heartbeatsCache=yield M._heartbeatsCachePromise,null!=(null===(le=M._heartbeatsCache)||void 0===le?void 0:le.heartbeats)))&&M._heartbeatsCache.lastSentHeartbeatDate!==Le&&!M._heartbeatsCache.heartbeats.some(yn=>yn.date===Le))return M._heartbeatsCache.heartbeats.push({date:Le,agent:Xe}),M._heartbeatsCache.heartbeats=M._heartbeatsCache.heartbeats.filter(yn=>{const wt=new Date(yn.date).valueOf();return Date.now()-wt<=2592e6}),M._storage.overwrite(M._heartbeatsCache)})()}getHeartbeatsHeader(){var M=this;return(0,b.Z)(function*(){var Q;if(null===M._heartbeatsCache&&(yield M._heartbeatsCachePromise),null==(null===(Q=M._heartbeatsCache)||void 0===Q?void 0:Q.heartbeats)||0===M._heartbeatsCache.heartbeats.length)return"";const le=it(),{heartbeatsToSend:ve,unsentEntries:Xe}=function q(j,M=1024){const Q=[];let le=j.slice();for(const ve of j){const Xe=Q.find(Le=>Le.agent===ve.agent);if(Xe){if(Xe.dates.push(ve.date),we(Q)>M){Xe.dates.pop();break}}else if(Q.push({agent:ve.agent,dates:[ve.date]}),we(Q)>M){Q.pop();break}le=le.slice(1)}return{heartbeatsToSend:Q,unsentEntries:le}}(M._heartbeatsCache.heartbeats),Le=(0,Se.L)(JSON.stringify({version:2,heartbeats:ve}));return M._heartbeatsCache.lastSentHeartbeatDate=le,Xe.length>0?(M._heartbeatsCache.heartbeats=Xe,yield M._storage.overwrite(M._heartbeatsCache)):(M._heartbeatsCache.heartbeats=[],M._storage.overwrite(M._heartbeatsCache)),Le})()}}function it(){return(new Date).toISOString().substring(0,10)}class Ai{constructor(M){this.app=M,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,b.Z)(function*(){return!!(0,Se.hl)()&&(0,Se.eu)().then(()=>!0).catch(()=>!1)})()}read(){var M=this;return(0,b.Z)(function*(){if(yield M._canUseIndexedDBPromise){const le=yield function U(j){return x.apply(this,arguments)}(M.app);return le?.heartbeats?le:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(M){var Q=this;return(0,b.Z)(function*(){var le;if(yield Q._canUseIndexedDBPromise){const Xe=yield Q.read();return ge(Q.app,{lastSentHeartbeatDate:null!==(le=M.lastSentHeartbeatDate)&&void 0!==le?le:Xe.lastSentHeartbeatDate,heartbeats:M.heartbeats})}})()}add(M){var Q=this;return(0,b.Z)(function*(){var le;if(yield Q._canUseIndexedDBPromise){const Xe=yield Q.read();return ge(Q.app,{lastSentHeartbeatDate:null!==(le=M.lastSentHeartbeatDate)&&void 0!==le?le:Xe.lastSentHeartbeatDate,heartbeats:[...Xe.heartbeats,...M.heartbeats]})}})()}}function we(j){return(0,Se.L)(JSON.stringify({version:2,heartbeats:j})).length}!function Ze(j){fe(new De.wA("platform-logger",M=>new bi(M),"PRIVATE")),fe(new De.wA("heartbeat",M=>new jr(M),"PRIVATE")),ft(Ie,"0.9.25",j),ft(Ie,"0.9.25","esm2017"),ft("fire-js","")}("")},537:(Gs,lr,je)=>{je.d(lr,{H0:()=>Fn,wA:()=>V,zt:()=>ln});var b=je(861),De=je(58);class V{constructor(L,J,ye){this.name=L,this.instanceFactory=J,this.type=ye,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(L){return this.instantiationMode=L,this}setMultipleInstances(L){return this.multipleInstances=L,this}setServiceProps(L){return this.serviceProps=L,this}setInstanceCreatedCallback(L){return this.onInstanceCreated=L,this}}const Se="[DEFAULT]";class ln{constructor(L,J){this.name=L,this.container=J,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(L){const J=this.normalizeInstanceIdentifier(L);if(!this.instancesDeferred.has(J)){const ye=new De.BH;if(this.instancesDeferred.set(J,ye),this.isInitialized(J)||this.shouldAutoInitialize())try{const rt=this.getOrInitializeService({instanceIdentifier:J});rt&&ye.resolve(rt)}catch{}}return this.instancesDeferred.get(J).promise}getImmediate(L){var J;const ye=this.normalizeInstanceIdentifier(L?.identifier),rt=null!==(J=L?.optional)&&void 0!==J&&J;if(!this.isInitialized(ye)&&!this.shouldAutoInitialize()){if(rt)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:ye})}catch(Ee){if(rt)return null;throw Ee}}getComponent(){return this.component}setComponent(L){if(L.name!==this.name)throw Error(`Mismatching Component ${L.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=L,this.shouldAutoInitialize()){if(function mn(ut){return"EAGER"===ut.instantiationMode}(L))try{this.getOrInitializeService({instanceIdentifier:Se})}catch{}for(const[J,ye]of this.instancesDeferred.entries()){const rt=this.normalizeInstanceIdentifier(J);try{const Ee=this.getOrInitializeService({instanceIdentifier:rt});ye.resolve(Ee)}catch{}}}}clearInstance(L=Se){this.instancesDeferred.delete(L),this.instancesOptions.delete(L),this.instances.delete(L)}delete(){var L=this;return(0,b.Z)(function*(){const J=Array.from(L.instances.values());yield Promise.all([...J.filter(ye=>"INTERNAL"in ye).map(ye=>ye.INTERNAL.delete()),...J.filter(ye=>"_delete"in ye).map(ye=>ye._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(L=Se){return this.instances.has(L)}getOptions(L=Se){return this.instancesOptions.get(L)||{}}initialize(L={}){const{options:J={}}=L,ye=this.normalizeInstanceIdentifier(L.instanceIdentifier);if(this.isInitialized(ye))throw Error(`${this.name}(${ye}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const rt=this.getOrInitializeService({instanceIdentifier:ye,options:J});for(const[Ee,dr]of this.instancesDeferred.entries())ye===this.normalizeInstanceIdentifier(Ee)&&dr.resolve(rt);return rt}onInit(L,J){var ye;const rt=this.normalizeInstanceIdentifier(J),Ee=null!==(ye=this.onInitCallbacks.get(rt))&&void 0!==ye?ye:new Set;Ee.add(L),this.onInitCallbacks.set(rt,Ee);const dr=this.instances.get(rt);return dr&&L(dr,rt),()=>{Ee.delete(L)}}invokeOnInitCallbacks(L,J){const ye=this.onInitCallbacks.get(J);if(ye)for(const rt of ye)try{rt(L,J)}catch{}}getOrInitializeService({instanceIdentifier:L,options:J={}}){let ye=this.instances.get(L);if(!ye&&this.component&&(ye=this.component.instanceFactory(this.container,{instanceIdentifier:(ut=L,ut===Se?void 0:ut),options:J}),this.instances.set(L,ye),this.instancesOptions.set(L,J),this.invokeOnInitCallbacks(ye,L),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,L,ye)}catch{}var ut;return ye||null}normalizeInstanceIdentifier(L=Se){return this.component?this.component.multipleInstances?L:Se:L}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Fn{constructor(L){this.name=L,this.providers=new Map}addComponent(L){const J=this.getProvider(L.name);if(J.isComponentSet())throw new Error(`Component ${L.name} has already been registered with ${this.name}`);J.setComponent(L)}addOrOverwriteComponent(L){this.getProvider(L.name).isComponentSet()&&this.providers.delete(L.name),this.addComponent(L)}getProvider(L){if(this.providers.has(L))return this.providers.get(L);const J=new ln(L,this);return this.providers.set(L,J),J}getProviders(){return Array.from(this.providers.values())}}},879:(Gs,lr,je)=>{je.d(lr,{Am:()=>ut,Ub:()=>Fn,Yd:()=>mn,in:()=>De});const b=[];var De=function(L){return L[L.DEBUG=0]="DEBUG",L[L.VERBOSE=1]="VERBOSE",L[L.INFO=2]="INFO",L[L.WARN=3]="WARN",L[L.ERROR=4]="ERROR",L[L.SILENT=5]="SILENT",L}(De||{});const V={debug:De.DEBUG,verbose:De.VERBOSE,info:De.INFO,warn:De.WARN,error:De.ERROR,silent:De.SILENT},Se=De.INFO,ln={[De.DEBUG]:"log",[De.VERBOSE]:"log",[De.INFO]:"info",[De.WARN]:"warn",[De.ERROR]:"error"},xt=(L,J,...ye)=>{if(J<L.logLevel)return;const rt=(new Date).toISOString(),Ee=ln[J];if(!Ee)throw new Error(`Attempted to log a message with an invalid logType (value: ${J})`);console[Ee](`[${rt}]  ${L.name}:`,...ye)};class mn{constructor(J){this.name=J,this._logLevel=Se,this._logHandler=xt,this._userLogHandler=null,b.push(this)}get logLevel(){return this._logLevel}set logLevel(J){if(!(J in De))throw new TypeError(`Invalid value "${J}" assigned to \`logLevel\``);this._logLevel=J}setLogLevel(J){this._logLevel="string"==typeof J?V[J]:J}get logHandler(){return this._logHandler}set logHandler(J){if("function"!=typeof J)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=J}get userLogHandler(){return this._userLogHandler}set userLogHandler(J){this._userLogHandler=J}debug(...J){this._userLogHandler&&this._userLogHandler(this,De.DEBUG,...J),this._logHandler(this,De.DEBUG,...J)}log(...J){this._userLogHandler&&this._userLogHandler(this,De.VERBOSE,...J),this._logHandler(this,De.VERBOSE,...J)}info(...J){this._userLogHandler&&this._userLogHandler(this,De.INFO,...J),this._logHandler(this,De.INFO,...J)}warn(...J){this._userLogHandler&&this._userLogHandler(this,De.WARN,...J),this._logHandler(this,De.WARN,...J)}error(...J){this._userLogHandler&&this._userLogHandler(this,De.ERROR,...J),this._logHandler(this,De.ERROR,...J)}}function Fn(L){b.forEach(J=>{J.setLogLevel(L)})}function ut(L,J){for(const ye of b){let rt=null;J&&J.level&&(rt=V[J.level]),ye.userLogHandler=null===L?null:(Ee,dr,...Mt)=>{const We=Mt.map(Ve=>{if(null==Ve)return null;if("string"==typeof Ve)return Ve;if("number"==typeof Ve||"boolean"==typeof Ve)return Ve.toString();if(Ve instanceof Error)return Ve.message;try{return JSON.stringify(Ve)}catch{return null}}).filter(Ve=>Ve).join(" ");dr>=(rt??Ee.logLevel)&&L({level:De[dr].toLowerCase(),message:We,args:Mt,type:Ee.name})}}}},980:(Gs,lr,je)=>{je.r(lr);var b=je(861),De=je(106),V=je(58),Se=je(534),ln=je(879);function ut(h,c){var l={};for(var p in h)Object.prototype.hasOwnProperty.call(h,p)&&c.indexOf(p)<0&&(l[p]=h[p]);if(null!=h&&"function"==typeof Object.getOwnPropertySymbols){var _=0;for(p=Object.getOwnPropertySymbols(h);_<p.length;_++)c.indexOf(p[_])<0&&Object.prototype.propertyIsEnumerable.call(h,p[_])&&(l[p[_]]=h[p[_]])}return l}"function"==typeof SuppressedError&&SuppressedError;var ms=je(537);const Di={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};const cc=function Gl(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},lc=function uc(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ct=new V.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Oo=new ln.Yd("@firebase/auth");function Ws(h,...c){Oo.logLevel<=ln.in.ERROR&&Oo.error(`Auth (${Se.SDK_VERSION}): ${h}`,...c)}function St(h,...c){throw Va(h,...c)}function Ye(h,...c){return Va(h,...c)}function Fa(h,c,l){const p=Object.assign(Object.assign({},lc()),{[c]:l});return new V.LL("auth","Firebase",p).create(c,{appName:h.name})}function Sr(h,c,l){if(!(c instanceof l))throw l.name!==c.constructor.name&&St(h,"argument-error"),Fa(h,"argument-error",`Type of ${c.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Va(h,...c){if("string"!=typeof h){const l=c[0],p=[...c.slice(1)];return p[0]&&(p[0].appName=h.name),h._errorFactory.create(l,...p)}return ct.create(h,...c)}function K(h,c,...l){if(!h)throw Va(c,...l)}function _n(h){const c="INTERNAL ASSERTION FAILED: "+h;throw Ws(c),new Error(c)}function An(h,c){h||_n(c)}function Wt(){var h;return typeof self<"u"&&(null===(h=self.location)||void 0===h?void 0:h.href)||""}function fe(){return"http:"===ii()||"https:"===ii()}function ii(){var h;return typeof self<"u"&&(null===(h=self.location)||void 0===h?void 0:h.protocol)||null}class Gi{constructor(c,l){this.shortDelay=c,this.longDelay=l,An(l>c,"Short delay should be less than long delay!"),this.isMobile=(0,V.uI)()||(0,V.b$)()}get(){return function dc(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(fe()||(0,V.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function fr(h,c){An(h.emulator,"Emulator should always be set here");const{url:l}=h.emulator;return c?`${l}${c.startsWith("/")?c.slice(1):c}`:l}class La{static initialize(c,l,p){this.fetchImpl=c,l&&(this.headersImpl=l),p&&(this.responseImpl=p)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void _n("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void _n("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void _n("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ql={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Ua=new Gi(3e4,6e4);function Et(h,c){return h.tenantId&&!c.tenantId?Object.assign(Object.assign({},c),{tenantId:h.tenantId}):c}function gt(h,c,l,p){return Fo.apply(this,arguments)}function Fo(){return(Fo=(0,b.Z)(function*(h,c,l,p,_={}){return qi(h,_,(0,b.Z)(function*(){let v={},w={};p&&("GET"===c?w=p:v={body:JSON.stringify(p)});const S=(0,V.xO)(Object.assign({key:h.config.apiKey},w)).slice(1),B=yield h._getAdditionalHeaders();return B["Content-Type"]="application/json",h.languageCode&&(B["X-Firebase-Locale"]=h.languageCode),La.fetch()(Zs(h,h.config.apiHost,l,S),Object.assign({method:c,headers:B,referrerPolicy:"no-referrer"},v))}))})).apply(this,arguments)}function qi(h,c,l){return ft.apply(this,arguments)}function ft(){return(ft=(0,b.Z)(function*(h,c,l){h._canInitEmulator=!1;const p=Object.assign(Object.assign({},ql),c);try{const _=new A(h),v=yield Promise.race([l(),_.promise]);_.clearNetworkTimeout();const w=yield v.json();if("needConfirmation"in w)throw T(h,"account-exists-with-different-credential",w);if(v.ok&&!("errorMessage"in w))return w;{const S=v.ok?w.errorMessage:w.error.message,[B,H]=S.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===B)throw T(h,"credential-already-in-use",w);if("EMAIL_EXISTS"===B)throw T(h,"email-already-in-use",w);if("USER_DISABLED"===B)throw T(h,"user-disabled",w);const ee=p[B]||B.toLowerCase().replace(/[_\s]+/g,"-");if(H)throw Fa(h,ee,H);St(h,ee)}}catch(_){if(_ instanceof V.ZR)throw _;St(h,"network-request-failed",{message:String(_)})}})).apply(this,arguments)}function si(h,c,l,p){return Ba.apply(this,arguments)}function Ba(){return(Ba=(0,b.Z)(function*(h,c,l,p,_={}){const v=yield gt(h,c,l,p,_);return"mfaPendingCredential"in v&&St(h,"multi-factor-auth-required",{_serverResponse:v}),v})).apply(this,arguments)}function Zs(h,c,l,p){const _=`${c}${l}?${p}`;return h.config.emulator?fr(h.config,_):`${h.config.apiScheme}://${_}`}function hc(h){switch(h){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class A{constructor(c){this.auth=c,this.timer=null,this.promise=new Promise((l,p)=>{this.timer=setTimeout(()=>p(Ye(this.auth,"network-request-failed")),Ua.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function T(h,c,l){const p={appName:h.name};l.email&&(p.email=l.email),l.phoneNumber&&(p.phoneNumber=l.phoneNumber);const _=Ye(h,c,p);return _.customData._tokenResponse=l,_}function P(h){return void 0!==h&&void 0!==h.getResponse}function U(h){return void 0!==h&&void 0!==h.enterprise}class x{constructor(c){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===c.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=c.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=c.recaptchaEnforcementState}getProviderEnforcementState(c){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const l of this.recaptchaEnforcementState)if(l.provider&&l.provider===c)return hc(l.enforcementState);return null}isProviderEnabled(c){return"ENFORCE"===this.getProviderEnforcementState(c)||"AUDIT"===this.getProviderEnforcementState(c)}}function ce(){return(ce=(0,b.Z)(function*(h){return(yield gt(h,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function ae(h,c){return Sn.apply(this,arguments)}function Sn(){return(Sn=(0,b.Z)(function*(h,c){return gt(h,"GET","/v2/recaptchaConfig",Et(h,c))})).apply(this,arguments)}function jr(){return(jr=(0,b.Z)(function*(h,c){return gt(h,"POST","/v1/accounts:delete",c)})).apply(this,arguments)}function q(){return(q=(0,b.Z)(function*(h,c){return gt(h,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function we(){return(we=(0,b.Z)(function*(h,c){return gt(h,"POST","/v1/accounts:lookup",c)})).apply(this,arguments)}function Ze(h){if(h)try{const c=new Date(Number(h));if(!isNaN(c.getTime()))return c.toUTCString()}catch{}}function Q(){return(Q=(0,b.Z)(function*(h,c=!1){const l=(0,V.m9)(h),p=yield l.getIdToken(c),_=ve(p);K(_&&_.exp&&_.auth_time&&_.iat,l.auth,"internal-error");const v="object"==typeof _.firebase?_.firebase:void 0,w=v?.sign_in_provider;return{claims:_,token:p,authTime:Ze(le(_.auth_time)),issuedAtTime:Ze(le(_.iat)),expirationTime:Ze(le(_.exp)),signInProvider:w||null,signInSecondFactor:v?.sign_in_second_factor||null}})).apply(this,arguments)}function le(h){return 1e3*Number(h)}function ve(h){const[c,l,p]=h.split(".");if(void 0===c||void 0===l||void 0===p)return Ws("JWT malformed, contained fewer than 3 sections"),null;try{const _=(0,V.tV)(l);return _?JSON.parse(_):(Ws("Failed to decode base64 JWT payload"),null)}catch(_){return Ws("Caught error parsing JWT payload as JSON",_?.toString()),null}}function Le(h,c){return yn.apply(this,arguments)}function yn(){return(yn=(0,b.Z)(function*(h,c,l=!1){if(l)return c;try{return yield c}catch(p){throw p instanceof V.ZR&&function wt({code:h}){return"auth/user-disabled"===h||"auth/user-token-expired"===h}(p)&&h.auth.currentUser===h&&(yield h.auth.signOut()),p}})).apply(this,arguments)}class Qs{constructor(c){this.user=c,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(c){var l;if(c){const p=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),p}{this.errorBackoff=3e4;const _=(null!==(l=this.user.stsTokenManager.expirationTime)&&void 0!==l?l:0)-Date.now()-3e5;return Math.max(0,_)}}schedule(c=!1){var l=this;if(!this.isRunning)return;const p=this.getInterval(c);this.timerId=setTimeout((0,b.Z)(function*(){yield l.iteration()}),p)}iteration(){var c=this;return(0,b.Z)(function*(){try{yield c.user.getIdToken(!0)}catch(l){return void("auth/network-request-failed"===l?.code&&c.schedule(!0))}c.schedule()})()}}class fc{constructor(c,l){this.createdAt=c,this.lastLoginAt=l,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ze(this.lastLoginAt),this.creationTime=Ze(this.createdAt)}_copy(c){this.createdAt=c.createdAt,this.lastLoginAt=c.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function zl(h){return z_.apply(this,arguments)}function z_(){return z_=(0,b.Z)(function*(h){var c;const l=h.auth,p=yield h.getIdToken(),_=yield Le(h,function Ai(h,c){return we.apply(this,arguments)}(l,{idToken:p}));K(_?.users.length,l,"internal-error");const v=_.users[0];h._notifyReloadListener(v);const w=null!==(c=v.providerUserInfo)&&void 0!==c&&c.length?function QN(h){return h.map(c=>{var{providerId:l}=c,p=ut(c,["providerId"]);return{providerId:l,uid:p.rawId||"",displayName:p.displayName||null,email:p.email||null,phoneNumber:p.phoneNumber||null,photoURL:p.photoUrl||null}})}(v.providerUserInfo):[],S=function ST(h,c){return[...h.filter(p=>!c.some(_=>_.providerId===p.providerId)),...c]}(h.providerData,w),ee=!!h.isAnonymous&&!(h.email&&v.passwordHash||S?.length),te={uid:v.localId,displayName:v.displayName||null,photoURL:v.photoUrl||null,email:v.email||null,emailVerified:v.emailVerified||!1,phoneNumber:v.phoneNumber||null,tenantId:v.tenantId||null,providerData:S,metadata:new fc(v.createdAt,v.lastLoginAt),isAnonymous:ee};Object.assign(h,te)}),z_.apply(this,arguments)}function W_(){return(W_=(0,b.Z)(function*(h){const c=(0,V.m9)(h);yield zl(c),yield c.auth._persistUserIfCurrent(c),c.auth._notifyListenersIfCurrent(c)})).apply(this,arguments)}function Ce(){return(Ce=(0,b.Z)(function*(h,c){const l=yield qi(h,{},(0,b.Z)(function*(){const p=(0,V.xO)({grant_type:"refresh_token",refresh_token:c}).slice(1),{tokenApiHost:_,apiKey:v}=h.config,w=Zs(h,_,"/v1/token",`key=${v}`),S=yield h._getAdditionalHeaders();return S["Content-Type"]="application/x-www-form-urlencoded",La.fetch()(w,{method:"POST",headers:S,body:p})}));return{accessToken:l.access_token,expiresIn:l.expires_in,refreshToken:l.refresh_token}})).apply(this,arguments)}function K_(){return(K_=(0,b.Z)(function*(h,c){return gt(h,"POST","/v2/accounts:revokeToken",Et(h,c))})).apply(this,arguments)}class Wl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(c){K(c.idToken,"internal-error"),K(typeof c.idToken<"u","internal-error"),K(typeof c.refreshToken<"u","internal-error");const l="expiresIn"in c&&typeof c.expiresIn<"u"?Number(c.expiresIn):function Xe(h){const c=ve(h);return K(c,"internal-error"),K(typeof c.exp<"u","internal-error"),K(typeof c.iat<"u","internal-error"),Number(c.exp)-Number(c.iat)}(c.idToken);this.updateTokensAndExpiration(c.idToken,c.refreshToken,l)}getToken(c,l=!1){var p=this;return(0,b.Z)(function*(){return K(!p.accessToken||p.refreshToken,c,"user-token-expired"),l||!p.accessToken||p.isExpired?p.refreshToken?(yield p.refresh(c,p.refreshToken),p.accessToken):null:p.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(c,l){var p=this;return(0,b.Z)(function*(){const{accessToken:_,refreshToken:v,expiresIn:w}=yield function oi(h,c){return Ce.apply(this,arguments)}(c,l);p.updateTokensAndExpiration(_,v,Number(w))})()}updateTokensAndExpiration(c,l,p){this.refreshToken=l||null,this.accessToken=c||null,this.expirationTime=Date.now()+1e3*p}static fromJSON(c,l){const{refreshToken:p,accessToken:_,expirationTime:v}=l,w=new Wl;return p&&(K("string"==typeof p,"internal-error",{appName:c}),w.refreshToken=p),_&&(K("string"==typeof _,"internal-error",{appName:c}),w.accessToken=_),v&&(K("number"==typeof v,"internal-error",{appName:c}),w.expirationTime=v),w}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(c){this.accessToken=c.accessToken,this.refreshToken=c.refreshToken,this.expirationTime=c.expirationTime}_clone(){return Object.assign(new Wl,this.toJSON())}_performRefresh(){return _n("not implemented")}}function de(h,c){K("string"==typeof h||typeof h>"u","internal-error",{appName:c})}class ja{constructor(c){var{uid:l,auth:p,stsTokenManager:_}=c,v=ut(c,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Qs(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=l,this.auth=p,this.stsTokenManager=_,this.accessToken=_.accessToken,this.displayName=v.displayName||null,this.email=v.email||null,this.emailVerified=v.emailVerified||!1,this.phoneNumber=v.phoneNumber||null,this.photoURL=v.photoURL||null,this.isAnonymous=v.isAnonymous||!1,this.tenantId=v.tenantId||null,this.providerData=v.providerData?[...v.providerData]:[],this.metadata=new fc(v.createdAt||void 0,v.lastLoginAt||void 0)}getIdToken(c){var l=this;return(0,b.Z)(function*(){const p=yield Le(l,l.stsTokenManager.getToken(l.auth,c));return K(p,l.auth,"internal-error"),l.accessToken!==p&&(l.accessToken=p,yield l.auth._persistUserIfCurrent(l),l.auth._notifyListenersIfCurrent(l)),p})()}getIdTokenResult(c){return function M(h){return Q.apply(this,arguments)}(this,c)}reload(){return function AT(h){return W_.apply(this,arguments)}(this)}_assign(c){this!==c&&(K(this.uid===c.uid,this.auth,"internal-error"),this.displayName=c.displayName,this.photoURL=c.photoURL,this.email=c.email,this.emailVerified=c.emailVerified,this.phoneNumber=c.phoneNumber,this.isAnonymous=c.isAnonymous,this.tenantId=c.tenantId,this.providerData=c.providerData.map(l=>Object.assign({},l)),this.metadata._copy(c.metadata),this.stsTokenManager._assign(c.stsTokenManager))}_clone(c){const l=new ja(Object.assign(Object.assign({},this),{auth:c,stsTokenManager:this.stsTokenManager._clone()}));return l.metadata._copy(this.metadata),l}_onReload(c){K(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=c,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(c){this.reloadListener?this.reloadListener(c):this.reloadUserInfo=c}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(c,l=!1){var p=this;return(0,b.Z)(function*(){let _=!1;c.idToken&&c.idToken!==p.stsTokenManager.accessToken&&(p.stsTokenManager.updateFromServerResponse(c),_=!0),l&&(yield zl(p)),yield p.auth._persistUserIfCurrent(p),_&&p.auth._notifyListenersIfCurrent(p)})()}delete(){var c=this;return(0,b.Z)(function*(){const l=yield c.getIdToken();return yield Le(c,function Rn(h,c){return jr.apply(this,arguments)}(c.auth,{idToken:l})),c.stsTokenManager.clearRefreshToken(),c.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(c=>Object.assign({},c)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(c,l){var p,_,v,w,S,B,H,ee;const te=null!==(p=l.displayName)&&void 0!==p?p:void 0,xe=null!==(_=l.email)&&void 0!==_?_:void 0,tt=null!==(v=l.phoneNumber)&&void 0!==v?v:void 0,Er=null!==(w=l.photoURL)&&void 0!==w?w:void 0,mi=null!==(S=l.tenantId)&&void 0!==S?S:void 0,zr=null!==(B=l._redirectEventId)&&void 0!==B?B:void 0,Qt=null!==(H=l.createdAt)&&void 0!==H?H:void 0,lu=null!==(ee=l.lastLoginAt)&&void 0!==ee?ee:void 0,{uid:$d,emailVerified:Wp,isAnonymous:gv,providerData:Hd,stsTokenManager:mv}=l;K($d&&mv,c,"internal-error");const _v=Wl.fromJSON(this.name,mv);K("string"==typeof $d,c,"internal-error"),de(te,c.name),de(xe,c.name),K("boolean"==typeof Wp,c,"internal-error"),K("boolean"==typeof gv,c,"internal-error"),de(tt,c.name),de(Er,c.name),de(mi,c.name),de(zr,c.name),de(Qt,c.name),de(lu,c.name);const Kp=new ja({uid:$d,auth:c,email:xe,emailVerified:Wp,displayName:te,isAnonymous:gv,photoURL:Er,phoneNumber:tt,tenantId:mi,stsTokenManager:_v,createdAt:Qt,lastLoginAt:lu});return Hd&&Array.isArray(Hd)&&(Kp.providerData=Hd.map(yv=>Object.assign({},yv))),zr&&(Kp._redirectEventId=zr),Kp}static _fromIdTokenResponse(c,l,p=!1){return(0,b.Z)(function*(){const _=new Wl;_.updateFromServerResponse(l);const v=new ja({uid:l.localId,auth:c,stsTokenManager:_,isAnonymous:p});return yield zl(v),v})()}}const Vn=new Map;function Jn(h){An(h instanceof Function,"Expected a class definition");let c=Vn.get(h);return c?(An(c instanceof h,"Instance stored in cache mismatched with class"),c):(c=new h,Vn.set(h,c),c)}const Vo=(()=>{class h{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,b.Z)(function*(){return!0})()}_set(l,p){var _=this;return(0,b.Z)(function*(){_.storage[l]=p})()}_get(l){var p=this;return(0,b.Z)(function*(){const _=p.storage[l];return void 0===_?null:_})()}_remove(l){var p=this;return(0,b.Z)(function*(){delete p.storage[l]})()}_addListener(l,p){}_removeListener(l,p){}}return h.type="NONE",h})();function Lo(h,c,l){return`firebase:${h}:${c}:${l}`}class _s{constructor(c,l,p){this.persistence=c,this.auth=l,this.userKey=p;const{config:_,name:v}=this.auth;this.fullUserKey=Lo(this.userKey,_.apiKey,v),this.fullPersistenceKey=Lo("persistence",_.apiKey,v),this.boundEventHandler=l._onStorageEvent.bind(l),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(c){return this.persistence._set(this.fullUserKey,c.toJSON())}getCurrentUser(){var c=this;return(0,b.Z)(function*(){const l=yield c.persistence._get(c.fullUserKey);return l?ja._fromJSON(c.auth,l):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(c){var l=this;return(0,b.Z)(function*(){if(l.persistence===c)return;const p=yield l.getCurrentUser();return yield l.removeCurrentUser(),l.persistence=c,p?l.setCurrentUser(p):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(c,l,p="authUser"){return(0,b.Z)(function*(){if(!l.length)return new _s(Jn(Vo),c,p);const _=(yield Promise.all(l.map(function(){var H=(0,b.Z)(function*(ee){if(yield ee._isAvailable())return ee});return function(ee){return H.apply(this,arguments)}}()))).filter(H=>H);let v=_[0]||Jn(Vo);const w=Lo(p,c.config.apiKey,c.name);let S=null;for(const H of l)try{const ee=yield H._get(w);if(ee){const te=ja._fromJSON(c,ee);H!==v&&(S=te),v=H;break}}catch{}const B=_.filter(H=>H._shouldAllowMigration);return v._shouldAllowMigration&&B.length?(v=B[0],S&&(yield v._set(w,S.toJSON())),yield Promise.all(l.map(function(){var H=(0,b.Z)(function*(ee){if(ee!==v)try{yield ee._remove(w)}catch{}});return function(ee){return H.apply(this,arguments)}}())),new _s(v,c,p)):new _s(v,c,p)})()}}function pc(h){const c=h.toLowerCase();if(c.includes("opera/")||c.includes("opr/")||c.includes("opios/"))return"Opera";if(He(c))return"IEMobile";if(c.includes("msie")||c.includes("trident/"))return"IE";if(c.includes("edge/"))return"Edge";if(Kl(c))return"Firefox";if(c.includes("silk/"))return"Silk";if(Wf(c))return"Blackberry";if(pr(c))return"Webos";if(Zl(c))return"Safari";if((c.includes("chrome/")||Z_(c))&&!c.includes("edge/"))return"Chrome";if(Uo(c))return"Android";{const p=h.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===p?.length)return p[1]}return"Other"}function Kl(h=(0,V.z$)()){return/firefox\//i.test(h)}function Zl(h=(0,V.z$)()){const c=h.toLowerCase();return c.includes("safari/")&&!c.includes("chrome/")&&!c.includes("crios/")&&!c.includes("android")}function Z_(h=(0,V.z$)()){return/crios\//i.test(h)}function He(h=(0,V.z$)()){return/iemobile/i.test(h)}function Uo(h=(0,V.z$)()){return/android/i.test(h)}function Wf(h=(0,V.z$)()){return/blackberry/i.test(h)}function pr(h=(0,V.z$)()){return/webos/i.test(h)}function Bo(h=(0,V.z$)()){return/iphone|ipad|ipod/i.test(h)||/macintosh/i.test(h)&&/mobile/i.test(h)}function RT(h=(0,V.z$)()){return Bo(h)||Uo(h)||pr(h)||Wf(h)||/windows phone/i.test(h)||He(h)}function Ql(h,c=[]){let l;switch(h){case"Browser":l=pc((0,V.z$)());break;case"Worker":l=`${pc((0,V.z$)())}-${h}`;break;default:l=h}const p=c.length?c.join(","):"FirebaseCore-web";return`${l}/JsCore/${Se.SDK_VERSION}/${p}`}class Kf{constructor(c){this.auth=c,this.queue=[]}pushCallback(c,l){const p=v=>new Promise((w,S)=>{try{w(c(v))}catch(B){S(B)}});p.onAbort=l,this.queue.push(p);const _=this.queue.length-1;return()=>{this.queue[_]=()=>Promise.resolve()}}runMiddleware(c){var l=this;return(0,b.Z)(function*(){if(l.auth.currentUser===c)return;const p=[];try{for(const _ of l.queue)yield _(c),_.onAbort&&p.push(_.onAbort)}catch(_){p.reverse();for(const v of p)try{v()}catch{}throw l.auth._errorFactory.create("login-blocked",{originalMessage:_?.message})}})()}}function gc(){return(gc=(0,b.Z)(function*(h,c={}){return gt(h,"GET","/v2/passwordPolicy",Et(h,c))})).apply(this,arguments)}class Zf{constructor(c){var l,p,_,v;const w=c.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(l=w.minPasswordLength)&&void 0!==l?l:6,w.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=w.maxPasswordLength),void 0!==w.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=w.containsLowercaseCharacter),void 0!==w.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=w.containsUppercaseCharacter),void 0!==w.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=w.containsNumericCharacter),void 0!==w.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=w.containsNonAlphanumericCharacter),this.enforcementState=c.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(_=null===(p=c.allowedNonAlphanumericCharacters)||void 0===p?void 0:p.join(""))&&void 0!==_?_:"",this.forceUpgradeOnSignin=null!==(v=c.forceUpgradeOnSignin)&&void 0!==v&&v,this.schemaVersion=c.schemaVersion}validatePassword(c){var l,p,_,v,w,S;const B={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(c,B),this.validatePasswordCharacterOptions(c,B),B.isValid&&(B.isValid=null===(l=B.meetsMinPasswordLength)||void 0===l||l),B.isValid&&(B.isValid=null===(p=B.meetsMaxPasswordLength)||void 0===p||p),B.isValid&&(B.isValid=null===(_=B.containsLowercaseLetter)||void 0===_||_),B.isValid&&(B.isValid=null===(v=B.containsUppercaseLetter)||void 0===v||v),B.isValid&&(B.isValid=null===(w=B.containsNumericCharacter)||void 0===w||w),B.isValid&&(B.isValid=null===(S=B.containsNonAlphanumericCharacter)||void 0===S||S),B}validatePasswordLengthOptions(c,l){const p=this.customStrengthOptions.minPasswordLength,_=this.customStrengthOptions.maxPasswordLength;p&&(l.meetsMinPasswordLength=c.length>=p),_&&(l.meetsMaxPasswordLength=c.length<=_)}validatePasswordCharacterOptions(c,l){let p;this.updatePasswordCharacterOptionsStatuses(l,!1,!1,!1,!1);for(let _=0;_<c.length;_++)p=c.charAt(_),this.updatePasswordCharacterOptionsStatuses(l,p>="a"&&p<="z",p>="A"&&p<="Z",p>="0"&&p<="9",this.allowedNonAlphanumericCharacters.includes(p))}updatePasswordCharacterOptionsStatuses(c,l,p,_,v){this.customStrengthOptions.containsLowercaseLetter&&(c.containsLowercaseLetter||(c.containsLowercaseLetter=l)),this.customStrengthOptions.containsUppercaseLetter&&(c.containsUppercaseLetter||(c.containsUppercaseLetter=p)),this.customStrengthOptions.containsNumericCharacter&&(c.containsNumericCharacter||(c.containsNumericCharacter=_)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(c.containsNonAlphanumericCharacter||(c.containsNonAlphanumericCharacter=v))}}class tx{constructor(c,l,p,_){this.app=c,this.heartbeatServiceProvider=l,this.appCheckServiceProvider=p,this.config=_,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new NT(this),this.idTokenSubscription=new NT(this),this.beforeStateQueue=new Kf(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ct,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=c.name,this.clientVersion=_.sdkClientVersion}_initializeWithPersistence(c,l){var p=this;return l&&(this._popupRedirectResolver=Jn(l)),this._initializationPromise=this.queue((0,b.Z)(function*(){var _,v;if(!p._deleted&&(p.persistenceManager=yield _s.create(p,c),!p._deleted)){if(null!==(_=p._popupRedirectResolver)&&void 0!==_&&_._shouldInitProactively)try{yield p._popupRedirectResolver._initialize(p)}catch{}yield p.initializeCurrentUser(l),p.lastNotifiedUid=(null===(v=p.currentUser)||void 0===v?void 0:v.uid)||null,!p._deleted&&(p._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var c=this;return(0,b.Z)(function*(){if(c._deleted)return;const l=yield c.assertedPersistence.getCurrentUser();if(c.currentUser||l){if(c.currentUser&&l&&c.currentUser.uid===l.uid)return c._currentUser._assign(l),void(yield c.currentUser.getIdToken());yield c._updateCurrentUser(l,!0)}})()}initializeCurrentUser(c){var l=this;return(0,b.Z)(function*(){var p;const _=yield l.assertedPersistence.getCurrentUser();let v=_,w=!1;if(c&&l.config.authDomain){yield l.getOrInitRedirectPersistenceManager();const S=null===(p=l.redirectUser)||void 0===p?void 0:p._redirectEventId,B=v?._redirectEventId,H=yield l.tryRedirectSignIn(c);(!S||S===B)&&H?.user&&(v=H.user,w=!0)}if(!v)return l.directlySetCurrentUser(null);if(!v._redirectEventId){if(w)try{yield l.beforeStateQueue.runMiddleware(v)}catch(S){v=_,l._popupRedirectResolver._overrideRedirectResult(l,()=>Promise.reject(S))}return v?l.reloadAndSetCurrentUserOrClear(v):l.directlySetCurrentUser(null)}return K(l._popupRedirectResolver,l,"argument-error"),yield l.getOrInitRedirectPersistenceManager(),l.redirectUser&&l.redirectUser._redirectEventId===v._redirectEventId?l.directlySetCurrentUser(v):l.reloadAndSetCurrentUserOrClear(v)})()}tryRedirectSignIn(c){var l=this;return(0,b.Z)(function*(){let p=null;try{p=yield l._popupRedirectResolver._completeRedirectFn(l,c,!0)}catch{yield l._setRedirectUser(null)}return p})()}reloadAndSetCurrentUserOrClear(c){var l=this;return(0,b.Z)(function*(){try{yield zl(c)}catch(p){if("auth/network-request-failed"!==p?.code)return l.directlySetCurrentUser(null)}return l.directlySetCurrentUser(c)})()}useDeviceLanguage(){this.languageCode=function Ks(){if(typeof navigator>"u")return null;const h=navigator;return h.languages&&h.languages[0]||h.language||null}()}_delete(){var c=this;return(0,b.Z)(function*(){c._deleted=!0})()}updateCurrentUser(c){var l=this;return(0,b.Z)(function*(){const p=c?(0,V.m9)(c):null;return p&&K(p.auth.config.apiKey===l.config.apiKey,l,"invalid-user-token"),l._updateCurrentUser(p&&p._clone(l))})()}_updateCurrentUser(c,l=!1){var p=this;return(0,b.Z)(function*(){if(!p._deleted)return c&&K(p.tenantId===c.tenantId,p,"tenant-id-mismatch"),l||(yield p.beforeStateQueue.runMiddleware(c)),p.queue((0,b.Z)(function*(){yield p.directlySetCurrentUser(c),p.notifyAuthListeners()}))})()}signOut(){var c=this;return(0,b.Z)(function*(){return yield c.beforeStateQueue.runMiddleware(null),(c.redirectPersistenceManager||c._popupRedirectResolver)&&(yield c._setRedirectUser(null)),c._updateCurrentUser(null,!0)})()}setPersistence(c){var l=this;return this.queue((0,b.Z)(function*(){yield l.assertedPersistence.setPersistence(Jn(c))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(c){var l=this;return(0,b.Z)(function*(){l._getPasswordPolicyInternal()||(yield l._updatePasswordPolicy());const p=l._getPasswordPolicyInternal();return p.schemaVersion!==l.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(l._errorFactory.create("unsupported-password-policy-schema-version",{})):p.validatePassword(c)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var c=this;return(0,b.Z)(function*(){const l=yield function Q_(h){return gc.apply(this,arguments)}(c),p=new Zf(l);null===c.tenantId?c._projectPasswordPolicy=p:c._tenantPasswordPolicies[c.tenantId]=p})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(c){this._errorFactory=new V.LL("auth","Firebase",c())}onAuthStateChanged(c,l,p){return this.registerStateListener(this.authStateSubscription,c,l,p)}beforeAuthStateChanged(c,l){return this.beforeStateQueue.pushCallback(c,l)}onIdTokenChanged(c,l,p){return this.registerStateListener(this.idTokenSubscription,c,l,p)}authStateReady(){return new Promise((c,l)=>{if(this.currentUser)c();else{const p=this.onAuthStateChanged(()=>{p(),c()},l)}})}revokeAccessToken(c){var l=this;return(0,b.Z)(function*(){if(l.currentUser){const p=yield l.currentUser.getIdToken(),_={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:c,idToken:p};null!=l.tenantId&&(_.tenantId=l.tenantId),yield function YN(h,c){return K_.apply(this,arguments)}(l,_)}})()}toJSON(){var c;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(c=this._currentUser)||void 0===c?void 0:c.toJSON()}}_setRedirectUser(c,l){var p=this;return(0,b.Z)(function*(){const _=yield p.getOrInitRedirectPersistenceManager(l);return null===c?_.removeCurrentUser():_.setCurrentUser(c)})()}getOrInitRedirectPersistenceManager(c){var l=this;return(0,b.Z)(function*(){if(!l.redirectPersistenceManager){const p=c&&Jn(c)||l._popupRedirectResolver;K(p,l,"argument-error"),l.redirectPersistenceManager=yield _s.create(l,[Jn(p._redirectPersistence)],"redirectUser"),l.redirectUser=yield l.redirectPersistenceManager.getCurrentUser()}return l.redirectPersistenceManager})()}_redirectUserForId(c){var l=this;return(0,b.Z)(function*(){var p,_;return l._isInitialized&&(yield l.queue((0,b.Z)(function*(){}))),(null===(p=l._currentUser)||void 0===p?void 0:p._redirectEventId)===c?l._currentUser:(null===(_=l.redirectUser)||void 0===_?void 0:_._redirectEventId)===c?l.redirectUser:null})()}_persistUserIfCurrent(c){var l=this;return(0,b.Z)(function*(){if(c===l.currentUser)return l.queue((0,b.Z)(function*(){return l.directlySetCurrentUser(c)}))})()}_notifyListenersIfCurrent(c){c===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var c,l;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const p=null!==(l=null===(c=this.currentUser)||void 0===c?void 0:c.uid)&&void 0!==l?l:null;this.lastNotifiedUid!==p&&(this.lastNotifiedUid=p,this.authStateSubscription.next(this.currentUser))}registerStateListener(c,l,p,_){if(this._deleted)return()=>{};const v="function"==typeof l?l:l.next.bind(l);let w=!1;const S=this._isInitialized?Promise.resolve():this._initializationPromise;if(K(S,this,"internal-error"),S.then(()=>{w||v(this.currentUser)}),"function"==typeof l){const B=c.addObserver(l,p,_);return()=>{w=!0,B()}}{const B=c.addObserver(l);return()=>{w=!0,B()}}}directlySetCurrentUser(c){var l=this;return(0,b.Z)(function*(){l.currentUser&&l.currentUser!==c&&l._currentUser._stopProactiveRefresh(),c&&l.isProactiveRefreshEnabled&&c._startProactiveRefresh(),l.currentUser=c,c?yield l.assertedPersistence.setCurrentUser(c):yield l.assertedPersistence.removeCurrentUser()})()}queue(c){return this.operations=this.operations.then(c,c),this.operations}get assertedPersistence(){return K(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(c){!c||this.frameworks.includes(c)||(this.frameworks.push(c),this.frameworks.sort(),this.clientVersion=Ql(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var c=this;return(0,b.Z)(function*(){var l;const p={"X-Client-Version":c.clientVersion};c.app.options.appId&&(p["X-Firebase-gmpid"]=c.app.options.appId);const _=yield null===(l=c.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===l?void 0:l.getHeartbeatsHeader();_&&(p["X-Firebase-Client"]=_);const v=yield c._getAppCheckToken();return v&&(p["X-Firebase-AppCheck"]=v),p})()}_getAppCheckToken(){var c=this;return(0,b.Z)(function*(){var l;const p=yield null===(l=c.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===l?void 0:l.getToken();return p?.error&&function zs(h,...c){Oo.logLevel<=ln.in.WARN&&Oo.warn(`Auth (${Se.SDK_VERSION}): ${h}`,...c)}(`Error while retrieving App Check token: ${p.error}`),p?.token})()}}function Lt(h){return(0,V.m9)(h)}class NT{constructor(c){this.auth=c,this.observer=null,this.addObserver=(0,V.ne)(l=>this.observer=l)}get next(){return K(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Y_(h){return new Promise((c,l)=>{const p=document.createElement("script");p.setAttribute("src",h),p.onload=c,p.onerror=_=>{const v=Ye("internal-error");v.customData=_,l(v)},p.type="text/javascript",p.charset="UTF-8",function nx(){var h,c;return null!==(c=null===(h=document.getElementsByTagName("head"))||void 0===h?void 0:h[0])&&void 0!==c?c:document}().appendChild(p)})}function $a(h){return`__${h}${Math.floor(1e6*Math.random())}`}class X_{constructor(c){this.type="recaptcha-enterprise",this.auth=Lt(c)}verify(c="verify",l=!1){var p=this;return(0,b.Z)(function*(){function v(){return v=(0,b.Z)(function*(S){if(!l){if(null==S.tenantId&&null!=S._agentRecaptchaConfig)return S._agentRecaptchaConfig.siteKey;if(null!=S.tenantId&&void 0!==S._tenantRecaptchaConfigs[S.tenantId])return S._tenantRecaptchaConfigs[S.tenantId].siteKey}return new Promise(function(){var B=(0,b.Z)(function*(H,ee){ae(S,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(te=>{if(void 0!==te.recaptchaKey){const xe=new x(te);return null==S.tenantId?S._agentRecaptchaConfig=xe:S._tenantRecaptchaConfigs[S.tenantId]=xe,H(xe.siteKey)}ee(new Error("recaptcha Enterprise site key undefined"))}).catch(te=>{ee(te)})});return function(H,ee){return B.apply(this,arguments)}}())}),v.apply(this,arguments)}function w(S,B,H){const ee=window.grecaptcha;U(ee)?ee.enterprise.ready(()=>{ee.enterprise.execute(S,{action:c}).then(te=>{B(te)}).catch(()=>{B("NO_RECAPTCHA")})}):H(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((S,B)=>{(function _(S){return v.apply(this,arguments)})(p.auth).then(H=>{if(!l&&U(window.grecaptcha))w(H,S,B);else{if(typeof window>"u")return void B(new Error("RecaptchaVerifier is only supported in browser"));Y_("https://www.google.com/recaptcha/enterprise.js?render="+H).then(()=>{w(H,S,B)}).catch(ee=>{B(ee)})}}).catch(H=>{B(H)})})})()}}function J_(h,c,l){return Xl.apply(this,arguments)}function Xl(){return(Xl=(0,b.Z)(function*(h,c,l,p=!1){const _=new X_(h);let v;try{v=yield _.verify(l)}catch{v=yield _.verify(l,!0)}const w=Object.assign({},c);return Object.assign(w,p?{captchaResp:v}:{captchaResponse:v}),Object.assign(w,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(w,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),w})).apply(this,arguments)}function zi(h,c,l,p){return Yf.apply(this,arguments)}function Yf(){return Yf=(0,b.Z)(function*(h,c,l,p){var _;if(null!==(_=h._getRecaptchaConfig())&&void 0!==_&&_.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const v=yield J_(h,c,l,"getOobCode"===l);return p(h,v)}return p(h,c).catch(function(){var v=(0,b.Z)(function*(w){if("auth/missing-recaptcha-token"===w.code){console.log(`${l} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const S=yield J_(h,c,l,"getOobCode"===l);return p(h,S)}return Promise.reject(w)});return function(w){return v.apply(this,arguments)}}())}),Yf.apply(this,arguments)}function mc(h){const c=h.indexOf(":");return c<0?"":h.substr(0,c+1)}function Ha(h){if(!h)return null;const c=Number(h);return isNaN(c)?null:c}class Ga{constructor(c,l){this.providerId=c,this.signInMethod=l}toJSON(){return _n("not implemented")}_getIdTokenResponse(c){return _n("not implemented")}_linkToIdToken(c,l){return _n("not implemented")}_getReauthenticationResolver(c){return _n("not implemented")}}function ty(h,c){return Si.apply(this,arguments)}function Si(){return(Si=(0,b.Z)(function*(h,c){return gt(h,"POST","/v1/accounts:resetPassword",Et(h,c))})).apply(this,arguments)}function $r(){return($r=(0,b.Z)(function*(h,c){return gt(h,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function Wi(h,c){return st.apply(this,arguments)}function st(){return(st=(0,b.Z)(function*(h,c){return gt(h,"POST","/v1/accounts:signUp",c)})).apply(this,arguments)}function _c(){return(_c=(0,b.Z)(function*(h,c){return gt(h,"POST","/v1/accounts:update",Et(h,c))})).apply(this,arguments)}function ep(h,c){return td.apply(this,arguments)}function td(){return(td=(0,b.Z)(function*(h,c){return si(h,"POST","/v1/accounts:signInWithPassword",Et(h,c))})).apply(this,arguments)}function ai(h,c){return jo.apply(this,arguments)}function jo(){return(jo=(0,b.Z)(function*(h,c){return gt(h,"POST","/v1/accounts:sendOobCode",Et(h,c))})).apply(this,arguments)}function nd(){return(nd=(0,b.Z)(function*(h,c){return ai(h,c)})).apply(this,arguments)}function tp(h,c){return rd.apply(this,arguments)}function rd(){return(rd=(0,b.Z)(function*(h,c){return ai(h,c)})).apply(this,arguments)}function ry(h,c){return $o.apply(this,arguments)}function $o(){return($o=(0,b.Z)(function*(h,c){return ai(h,c)})).apply(this,arguments)}function id(){return(id=(0,b.Z)(function*(h,c){return ai(h,c)})).apply(this,arguments)}function sd(){return(sd=(0,b.Z)(function*(h,c){return si(h,"POST","/v1/accounts:signInWithEmailLink",Et(h,c))})).apply(this,arguments)}function np(){return(np=(0,b.Z)(function*(h,c){return si(h,"POST","/v1/accounts:signInWithEmailLink",Et(h,c))})).apply(this,arguments)}class gr extends Ga{constructor(c,l,p,_=null){super("password",p),this._email=c,this._password=l,this._tenantId=_}static _fromEmailAndPassword(c,l){return new gr(c,l,"password")}static _fromEmailAndCode(c,l,p=null){return new gr(c,l,"emailLink",p)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(c){const l="string"==typeof c?JSON.parse(c):c;if(l?.email&&l?.password){if("password"===l.signInMethod)return this._fromEmailAndPassword(l.email,l.password);if("emailLink"===l.signInMethod)return this._fromEmailAndCode(l.email,l.password,l.tenantId)}return null}_getIdTokenResponse(c){var l=this;return(0,b.Z)(function*(){switch(l.signInMethod){case"password":return zi(c,{returnSecureToken:!0,email:l._email,password:l._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",ep);case"emailLink":return function kT(h,c){return sd.apply(this,arguments)}(c,{email:l._email,oobCode:l._password});default:St(c,"internal-error")}})()}_linkToIdToken(c,l){var p=this;return(0,b.Z)(function*(){switch(p.signInMethod){case"password":return zi(c,{idToken:l,returnSecureToken:!0,email:p._email,password:p._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Wi);case"emailLink":return function OT(h,c){return np.apply(this,arguments)}(c,{idToken:l,email:p._email,oobCode:p._password});default:St(c,"internal-error")}})()}_getReauthenticationResolver(c){return this._getIdTokenResponse(c)}}function ys(h,c){return od.apply(this,arguments)}function od(){return(od=(0,b.Z)(function*(h,c){return si(h,"POST","/v1/accounts:signInWithIdp",Et(h,c))})).apply(this,arguments)}class Ki extends Ga{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(c){const l=new Ki(c.providerId,c.signInMethod);return c.idToken||c.accessToken?(c.idToken&&(l.idToken=c.idToken),c.accessToken&&(l.accessToken=c.accessToken),c.nonce&&!c.pendingToken&&(l.nonce=c.nonce),c.pendingToken&&(l.pendingToken=c.pendingToken)):c.oauthToken&&c.oauthTokenSecret?(l.accessToken=c.oauthToken,l.secret=c.oauthTokenSecret):St("argument-error"),l}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(c){const l="string"==typeof c?JSON.parse(c):c,{providerId:p,signInMethod:_}=l,v=ut(l,["providerId","signInMethod"]);if(!p||!_)return null;const w=new Ki(p,_);return w.idToken=v.idToken||void 0,w.accessToken=v.accessToken||void 0,w.secret=v.secret,w.nonce=v.nonce,w.pendingToken=v.pendingToken||null,w}_getIdTokenResponse(c){return ys(c,this.buildRequest())}_linkToIdToken(c,l){const p=this.buildRequest();return p.idToken=l,ys(c,p)}_getReauthenticationResolver(c){const l=this.buildRequest();return l.autoCreate=!1,ys(c,l)}buildRequest(){const c={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)c.pendingToken=this.pendingToken;else{const l={};this.idToken&&(l.id_token=this.idToken),this.accessToken&&(l.access_token=this.accessToken),this.secret&&(l.oauth_token_secret=this.secret),l.providerId=this.providerId,this.nonce&&!this.pendingToken&&(l.nonce=this.nonce),c.postBody=(0,V.xO)(l)}return c}}function rp(){return(rp=(0,b.Z)(function*(h,c){return gt(h,"POST","/v1/accounts:sendVerificationCode",Et(h,c))})).apply(this,arguments)}function ip(){return(ip=(0,b.Z)(function*(h,c){return si(h,"POST","/v1/accounts:signInWithPhoneNumber",Et(h,c))})).apply(this,arguments)}function sp(){return(sp=(0,b.Z)(function*(h,c){const l=yield si(h,"POST","/v1/accounts:signInWithPhoneNumber",Et(h,c));if(l.temporaryProof)throw T(h,"account-exists-with-different-credential",l);return l})).apply(this,arguments)}const ad={USER_NOT_FOUND:"user-not-found"};function op(){return(op=(0,b.Z)(function*(h,c){return si(h,"POST","/v1/accounts:signInWithPhoneNumber",Et(h,Object.assign(Object.assign({},c),{operation:"REAUTH"})),ad)})).apply(this,arguments)}class Ho extends Ga{constructor(c){super("phone","phone"),this.params=c}static _fromVerification(c,l){return new Ho({verificationId:c,verificationCode:l})}static _fromTokenResponse(c,l){return new Ho({phoneNumber:c,temporaryProof:l})}_getIdTokenResponse(c){return function sy(h,c){return ip.apply(this,arguments)}(c,this._makeVerificationRequest())}_linkToIdToken(c,l){return function LT(h,c){return sp.apply(this,arguments)}(c,Object.assign({idToken:l},this._makeVerificationRequest()))}_getReauthenticationResolver(c){return function UT(h,c){return op.apply(this,arguments)}(c,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:c,phoneNumber:l,verificationId:p,verificationCode:_}=this.params;return c&&l?{temporaryProof:c,phoneNumber:l}:{sessionInfo:p,code:_}}toJSON(){const c={providerId:this.providerId};return this.params.phoneNumber&&(c.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(c.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(c.verificationCode=this.params.verificationCode),this.params.verificationId&&(c.verificationId=this.params.verificationId),c}static fromJSON(c){"string"==typeof c&&(c=JSON.parse(c));const{verificationId:l,verificationCode:p,phoneNumber:_,temporaryProof:v}=c;return p||l||_||v?new Ho({verificationId:l,verificationCode:p,phoneNumber:_,temporaryProof:v}):null}}class qa{constructor(c){var l,p,_,v,w,S;const B=(0,V.zd)((0,V.pd)(c)),H=null!==(l=B.apiKey)&&void 0!==l?l:null,ee=null!==(p=B.oobCode)&&void 0!==p?p:null,te=function er(h){switch(h){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(_=B.mode)&&void 0!==_?_:null);K(H&&ee&&te,"argument-error"),this.apiKey=H,this.operation=te,this.code=ee,this.continueUrl=null!==(v=B.continueUrl)&&void 0!==v?v:null,this.languageCode=null!==(w=B.languageCode)&&void 0!==w?w:null,this.tenantId=null!==(S=B.tenantId)&&void 0!==S?S:null}static parseLink(c){const l=function BT(h){const c=(0,V.zd)((0,V.pd)(h)).link,l=c?(0,V.zd)((0,V.pd)(c)).deep_link_id:null,p=(0,V.zd)((0,V.pd)(h)).deep_link_id;return(p?(0,V.zd)((0,V.pd)(p)).link:null)||p||l||c||h}(c);try{return new qa(l)}catch{return null}}}let tr=(()=>{class h{constructor(){this.providerId=h.PROVIDER_ID}static credential(l,p){return gr._fromEmailAndPassword(l,p)}static credentialWithLink(l,p){const _=qa.parseLink(p);return K(_,"argument-error"),gr._fromEmailAndCode(l,_.code,_.tenantId)}}return h.PROVIDER_ID="password",h.EMAIL_PASSWORD_SIGN_IN_METHOD="password",h.EMAIL_LINK_SIGN_IN_METHOD="emailLink",h})();class ke{constructor(c){this.providerId=c,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(c){this.defaultLanguageCode=c}setCustomParameters(c){return this.customParameters=c,this}getCustomParameters(){return this.customParameters}}class rn extends ke{constructor(){super(...arguments),this.scopes=[]}addScope(c){return this.scopes.includes(c)||this.scopes.push(c),this}getScopes(){return[...this.scopes]}}class vn extends rn{static credentialFromJSON(c){const l="string"==typeof c?JSON.parse(c):c;return K("providerId"in l&&"signInMethod"in l,"argument-error"),Ki._fromParams(l)}credential(c){return this._credential(Object.assign(Object.assign({},c),{nonce:c.rawNonce}))}_credential(c){return K(c.idToken||c.accessToken,"argument-error"),Ki._fromParams(Object.assign(Object.assign({},c),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(c){return vn.oauthCredentialFromTaggedObject(c)}static credentialFromError(c){return vn.oauthCredentialFromTaggedObject(c.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{oauthIdToken:l,oauthAccessToken:p,oauthTokenSecret:_,pendingToken:v,nonce:w,providerId:S}=c;if(!p&&!_&&!l&&!v||!S)return null;try{return new vn(S)._credential({idToken:l,accessToken:p,nonce:w,pendingToken:v})}catch{return null}}}let Go=(()=>{class h extends rn{constructor(){super("facebook.com")}static credential(l){return Ki._fromParams({providerId:h.PROVIDER_ID,signInMethod:h.FACEBOOK_SIGN_IN_METHOD,accessToken:l})}static credentialFromResult(l){return h.credentialFromTaggedObject(l)}static credentialFromError(l){return h.credentialFromTaggedObject(l.customData||{})}static credentialFromTaggedObject({_tokenResponse:l}){if(!l||!("oauthAccessToken"in l)||!l.oauthAccessToken)return null;try{return h.credential(l.oauthAccessToken)}catch{return null}}}return h.FACEBOOK_SIGN_IN_METHOD="facebook.com",h.PROVIDER_ID="facebook.com",h})(),Rr=(()=>{class h extends rn{constructor(){super("google.com"),this.addScope("profile")}static credential(l,p){return Ki._fromParams({providerId:h.PROVIDER_ID,signInMethod:h.GOOGLE_SIGN_IN_METHOD,idToken:l,accessToken:p})}static credentialFromResult(l){return h.credentialFromTaggedObject(l)}static credentialFromError(l){return h.credentialFromTaggedObject(l.customData||{})}static credentialFromTaggedObject({_tokenResponse:l}){if(!l)return null;const{oauthIdToken:p,oauthAccessToken:_}=l;if(!p&&!_)return null;try{return h.credential(p,_)}catch{return null}}}return h.GOOGLE_SIGN_IN_METHOD="google.com",h.PROVIDER_ID="google.com",h})(),ap=(()=>{class h extends rn{constructor(){super("github.com")}static credential(l){return Ki._fromParams({providerId:h.PROVIDER_ID,signInMethod:h.GITHUB_SIGN_IN_METHOD,accessToken:l})}static credentialFromResult(l){return h.credentialFromTaggedObject(l)}static credentialFromError(l){return h.credentialFromTaggedObject(l.customData||{})}static credentialFromTaggedObject({_tokenResponse:l}){if(!l||!("oauthAccessToken"in l)||!l.oauthAccessToken)return null;try{return h.credential(l.oauthAccessToken)}catch{return null}}}return h.GITHUB_SIGN_IN_METHOD="github.com",h.PROVIDER_ID="github.com",h})();class vs extends Ga{constructor(c,l){super(c,c),this.pendingToken=l}_getIdTokenResponse(c){return ys(c,this.buildRequest())}_linkToIdToken(c,l){const p=this.buildRequest();return p.idToken=l,ys(c,p)}_getReauthenticationResolver(c){const l=this.buildRequest();return l.autoCreate=!1,ys(c,l)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(c){const l="string"==typeof c?JSON.parse(c):c,{providerId:p,signInMethod:_,pendingToken:v}=l;return p&&_&&v&&p===_?new vs(p,v):null}static _create(c,l){return new vs(c,l)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class ud extends ke{constructor(c){K(c.startsWith("saml."),"argument-error"),super(c)}static credentialFromResult(c){return ud.samlCredentialFromTaggedObject(c)}static credentialFromError(c){return ud.samlCredentialFromTaggedObject(c.customData||{})}static credentialFromJSON(c){const l=vs.fromJSON(c);return K(l,"argument-error"),l}static samlCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{pendingToken:l,providerId:p}=c;if(!l||!p)return null;try{return vs._create(p,l)}catch{return null}}}let Kt=(()=>{class h extends rn{constructor(){super("twitter.com")}static credential(l,p){return Ki._fromParams({providerId:h.PROVIDER_ID,signInMethod:h.TWITTER_SIGN_IN_METHOD,oauthToken:l,oauthTokenSecret:p})}static credentialFromResult(l){return h.credentialFromTaggedObject(l)}static credentialFromError(l){return h.credentialFromTaggedObject(l.customData||{})}static credentialFromTaggedObject({_tokenResponse:l}){if(!l)return null;const{oauthAccessToken:p,oauthTokenSecret:_}=l;if(!p||!_)return null;try{return h.credential(p,_)}catch{return null}}}return h.TWITTER_SIGN_IN_METHOD="twitter.com",h.PROVIDER_ID="twitter.com",h})();function oe(h,c){return Pe.apply(this,arguments)}function Pe(){return(Pe=(0,b.Z)(function*(h,c){return si(h,"POST","/v1/accounts:signUp",Et(h,c))})).apply(this,arguments)}class Je{constructor(c){this.user=c.user,this.providerId=c.providerId,this._tokenResponse=c._tokenResponse,this.operationType=c.operationType}static _fromIdTokenResponse(c,l,p,_=!1){return(0,b.Z)(function*(){const v=yield ja._fromIdTokenResponse(c,p,_),w=ui(p);return new Je({user:v,providerId:w,_tokenResponse:p,operationType:l})})()}static _forOperation(c,l,p){return(0,b.Z)(function*(){yield c._updateTokensIfNecessary(p,!0);const _=ui(p);return new Je({user:c,providerId:_,_tokenResponse:p,operationType:l})})()}}function ui(h){return h.providerId?h.providerId:"phoneNumber"in h?"phone":null}function Ln(){return(Ln=(0,b.Z)(function*(h){var c;const l=Lt(h);if(yield l._initializationPromise,null!==(c=l.currentUser)&&void 0!==c&&c.isAnonymous)return new Je({user:l.currentUser,providerId:null,operationType:"signIn"});const p=yield oe(l,{returnSecureToken:!0}),_=yield Je._fromIdTokenResponse(l,"signIn",p,!0);return yield l._updateCurrentUser(_.user),_})).apply(this,arguments)}class Es extends V.ZR{constructor(c,l,p,_){var v;super(l.code,l.message),this.operationType=p,this.user=_,Object.setPrototypeOf(this,Es.prototype),this.customData={appName:c.name,tenantId:null!==(v=c.tenantId)&&void 0!==v?v:void 0,_serverResponse:l.customData._serverResponse,operationType:p}}static _fromErrorAndOperation(c,l,p,_){return new Es(c,l,p,_)}}function sn(h,c,l,p){return("reauthenticate"===c?l._getReauthenticationResolver(h):l._getIdTokenResponse(h)).catch(v=>{throw"auth/multi-factor-auth-required"===v.code?Es._fromErrorAndOperation(h,v,c,p):v})}function Is(h){return new Set(h.map(({providerId:c})=>c).filter(c=>!!c))}function Ae(){return Ae=(0,b.Z)(function*(h,c){const l=(0,V.m9)(h);yield ws(!0,l,c);const{providerUserInfo:p}=yield function it(h,c){return q.apply(this,arguments)}(l.auth,{idToken:yield l.getIdToken(),deleteProvider:[c]}),_=Is(p||[]);return l.providerData=l.providerData.filter(v=>_.has(v.providerId)),_.has("phone")||(l.phoneNumber=null),yield l.auth._persistUserIfCurrent(l),l}),Ae.apply(this,arguments)}function qo(h,c){return cd.apply(this,arguments)}function cd(){return(cd=(0,b.Z)(function*(h,c,l=!1){const p=yield Le(h,c._linkToIdToken(h.auth,yield h.getIdToken()),l);return Je._forOperation(h,"link",p)})).apply(this,arguments)}function ws(h,c,l){return Zt.apply(this,arguments)}function Zt(){return(Zt=(0,b.Z)(function*(h,c,l){yield zl(c);const _=!1===h?"provider-already-linked":"no-such-provider";K(Is(c.providerData).has(l)===h,c.auth,_)})).apply(this,arguments)}function Wa(h,c){return Xs.apply(this,arguments)}function Xs(){return(Xs=(0,b.Z)(function*(h,c,l=!1){const{auth:p}=h,_="reauthenticate";try{const v=yield Le(h,sn(p,_,c,h),l);K(v.idToken,p,"internal-error");const w=ve(v.idToken);K(w,p,"internal-error");const{sub:S}=w;return K(h.uid===S,p,"user-mismatch"),Je._forOperation(h,_,v)}catch(v){throw"auth/user-not-found"===v?.code&&St(p,"user-mismatch"),v}})).apply(this,arguments)}function Ri(h,c){return zo.apply(this,arguments)}function zo(){return(zo=(0,b.Z)(function*(h,c,l=!1){const p="signIn",_=yield sn(h,p,c),v=yield Je._fromIdTokenResponse(h,p,_);return l||(yield h._updateCurrentUser(v.user)),v})).apply(this,arguments)}function vc(h,c){return Zi.apply(this,arguments)}function Zi(){return(Zi=(0,b.Z)(function*(h,c){return Ri(Lt(h),c)})).apply(this,arguments)}function Qi(h,c){return Wo.apply(this,arguments)}function Wo(){return(Wo=(0,b.Z)(function*(h,c){const l=(0,V.m9)(h);return yield ws(!1,l,c.providerId),qo(l,c)})).apply(this,arguments)}function Ka(h,c){return $e.apply(this,arguments)}function $e(){return($e=(0,b.Z)(function*(h,c){return Wa((0,V.m9)(h),c)})).apply(this,arguments)}function Ec(){return(Ec=(0,b.Z)(function*(h,c){return si(h,"POST","/v1/accounts:signInWithCustomToken",Et(h,c))})).apply(this,arguments)}function ci(){return ci=(0,b.Z)(function*(h,c){const l=Lt(h),p=yield function rx(h,c){return Ec.apply(this,arguments)}(l,{token:c,returnSecureToken:!0}),_=yield Je._fromIdTokenResponse(l,"signIn",p);return yield l._updateCurrentUser(_.user),_}),ci.apply(this,arguments)}class Js{constructor(c,l){this.factorId=c,this.uid=l.mfaEnrollmentId,this.enrollmentTime=new Date(l.enrolledAt).toUTCString(),this.displayName=l.displayName}static _fromServerResponse(c,l){return"phoneInfo"in l?eo._fromServerResponse(c,l):"totpInfo"in l?Ko._fromServerResponse(c,l):St(c,"internal-error")}}class eo extends Js{constructor(c){super("phone",c),this.phoneNumber=c.phoneInfo}static _fromServerResponse(c,l){return new eo(l)}}class Ko extends Js{constructor(c){super("totp",c)}static _fromServerResponse(c,l){return new Ko(l)}}function En(h,c,l){var p;K((null===(p=l.url)||void 0===p?void 0:p.length)>0,h,"invalid-continue-uri"),K(typeof l.dynamicLinkDomain>"u"||l.dynamicLinkDomain.length>0,h,"invalid-dynamic-link-domain"),c.continueUrl=l.url,c.dynamicLinkDomain=l.dynamicLinkDomain,c.canHandleCodeInApp=l.handleCodeInApp,l.iOS&&(K(l.iOS.bundleId.length>0,h,"missing-ios-bundle-id"),c.iOSBundleId=l.iOS.bundleId),l.android&&(K(l.android.packageName.length>0,h,"missing-android-pkg-name"),c.androidInstallApp=l.android.installApp,c.androidMinimumVersionCode=l.android.minimumVersion,c.androidPackageName=l.android.packageName)}function uy(h){return nr.apply(this,arguments)}function nr(){return(nr=(0,b.Z)(function*(h){const c=Lt(h);c._getPasswordPolicyInternal()&&(yield c._updatePasswordPolicy())})).apply(this,arguments)}function Ic(){return(Ic=(0,b.Z)(function*(h,c,l){const p=Lt(h),_={requestType:"PASSWORD_RESET",email:c,clientType:"CLIENT_TYPE_WEB"};l&&En(p,_,l),yield zi(p,_,"getOobCode",tp)})).apply(this,arguments)}function Za(){return Za=(0,b.Z)(function*(h,c,l){yield ty((0,V.m9)(h),{oobCode:c,newPassword:l}).catch(function(){var p=(0,b.Z)(function*(_){throw"auth/password-does-not-meet-requirements"===_.code&&uy(h),_});return function(_){return p.apply(this,arguments)}}())}),Za.apply(this,arguments)}function wc(){return wc=(0,b.Z)(function*(h,c){yield function ed(h,c){return _c.apply(this,arguments)}((0,V.m9)(h),{oobCode:c})}),wc.apply(this,arguments)}function cy(h,c){return up.apply(this,arguments)}function up(){return(up=(0,b.Z)(function*(h,c){const l=(0,V.m9)(h),p=yield ty(l,{oobCode:c}),_=p.requestType;switch(K(_,l,"internal-error"),_){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":K(p.newEmail,l,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":K(p.mfaInfo,l,"internal-error");default:K(p.email,l,"internal-error")}let v=null;return p.mfaInfo&&(v=Js._fromServerResponse(Lt(l),p.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===p.requestType?p.newEmail:p.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===p.requestType?p.email:p.newEmail)||null,multiFactorInfo:v},operation:_}})).apply(this,arguments)}function cp(){return(cp=(0,b.Z)(function*(h,c){const{data:l}=yield cy((0,V.m9)(h),c);return l.email})).apply(this,arguments)}function ly(){return(ly=(0,b.Z)(function*(h,c,l){const p=Lt(h),w=yield zi(p,{returnSecureToken:!0,email:c,password:l,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",oe).catch(B=>{throw"auth/password-does-not-meet-requirements"===B.code&&uy(h),B}),S=yield Je._fromIdTokenResponse(p,"signIn",w);return yield p._updateCurrentUser(S.user),S})).apply(this,arguments)}function dy(){return(dy=(0,b.Z)(function*(h,c,l){const p=Lt(h),_={requestType:"EMAIL_SIGNIN",email:c,clientType:"CLIENT_TYPE_WEB"};(function v(w,S){K(S.handleCodeInApp,p,"argument-error"),S&&En(p,w,S)})(_,l),yield zi(p,_,"getOobCode",ry)})).apply(this,arguments)}function hy(){return(hy=(0,b.Z)(function*(h,c,l){const p=(0,V.m9)(h),_=tr.credentialWithLink(c,l||Wt());return K(_._tenantId===(p.tenantId||null),p,"tenant-id-mismatch"),vc(p,_)})).apply(this,arguments)}function fy(){return(fy=(0,b.Z)(function*(h,c){return gt(h,"POST","/v1/accounts:createAuthUri",Et(h,c))})).apply(this,arguments)}function py(){return py=(0,b.Z)(function*(h,c){const p={identifier:c,continueUri:fe()?Wt():"http://localhost"},{signinMethods:_}=yield function cx(h,c){return fy.apply(this,arguments)}((0,V.m9)(h),p);return _||[]}),py.apply(this,arguments)}function ld(){return ld=(0,b.Z)(function*(h,c){const l=(0,V.m9)(h),_={requestType:"VERIFY_EMAIL",idToken:yield h.getIdToken()};c&&En(l.auth,_,c);const{email:v}=yield function ny(h,c){return nd.apply(this,arguments)}(l.auth,_);v!==h.email&&(yield h.reload())}),ld.apply(this,arguments)}function my(){return my=(0,b.Z)(function*(h,c,l){const p=(0,V.m9)(h),v={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield h.getIdToken(),newEmail:c};l&&En(p.auth,v,l);const{email:w}=yield function iy(h,c){return id.apply(this,arguments)}(p.auth,v);w!==h.email&&(yield h.reload())}),my.apply(this,arguments)}function _y(){return(_y=(0,b.Z)(function*(h,c){return gt(h,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function Yi(){return Yi=(0,b.Z)(function*(h,{displayName:c,photoURL:l}){if(void 0===c&&void 0===l)return;const p=(0,V.m9)(h),v={idToken:yield p.getIdToken(),displayName:c,photoUrl:l,returnSecureToken:!0},w=yield Le(p,function hx(h,c){return _y.apply(this,arguments)}(p.auth,v));p.displayName=w.displayName||null,p.photoURL=w.photoUrl||null;const S=p.providerData.find(({providerId:B})=>"password"===B);S&&(S.displayName=p.displayName,S.photoURL=p.photoURL),yield p._updateTokensIfNecessary(w)}),Yi.apply(this,arguments)}function Un(h,c,l){return Qa.apply(this,arguments)}function Qa(){return Qa=(0,b.Z)(function*(h,c,l){const{auth:p}=h,v={idToken:yield h.getIdToken(),returnSecureToken:!0};c&&(v.email=c),l&&(v.password=l);const w=yield Le(h,function Jl(h,c){return $r.apply(this,arguments)}(p,v));yield h._updateTokensIfNecessary(w,!0)}),Qa.apply(this,arguments)}class Yo{constructor(c,l,p={}){this.isNewUser=c,this.providerId=l,this.profile=p}}class lp extends Yo{constructor(c,l,p,_){super(c,l,p),this.username=_}}class yy extends Yo{constructor(c,l){super(c,"facebook.com",l)}}class vy extends lp{constructor(c,l){super(c,"github.com",l,"string"==typeof l?.login?l?.login:null)}}class dp extends Yo{constructor(c,l){super(c,"google.com",l)}}class Ey extends lp{constructor(c,l,p){super(c,"twitter.com",l,p)}}function hp(h){const{user:c,_tokenResponse:l}=h;return c.isAnonymous&&!l?{providerId:null,isNewUser:!1,profile:null}:function li(h){var c,l;if(!h)return null;const{providerId:p}=h,_=h.rawUserInfo?JSON.parse(h.rawUserInfo):{},v=h.isNewUser||"identitytoolkit#SignupNewUserResponse"===h.kind;if(!p&&h?.idToken){const w=null===(l=null===(c=ve(h.idToken))||void 0===c?void 0:c.firebase)||void 0===l?void 0:l.sign_in_provider;if(w)return new Yo(v,"anonymous"!==w&&"custom"!==w?w:null)}if(!p)return null;switch(p){case"facebook.com":return new yy(v,_);case"github.com":return new vy(v,_);case"google.com":return new dp(v,_);case"twitter.com":return new Ey(v,_,h.screenName||null);case"custom":case"anonymous":return new Yo(v,null);default:return new Yo(v,p,_)}}(l)}class Ya{constructor(c,l,p){this.type=c,this.credential=l,this.user=p}static _fromIdtoken(c,l){return new Ya("enroll",c,l)}static _fromMfaPendingCredential(c){return new Ya("signin",c)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(c){var l,p;if(c?.multiFactorSession){if(null!==(l=c.multiFactorSession)&&void 0!==l&&l.pendingCredential)return Ya._fromMfaPendingCredential(c.multiFactorSession.pendingCredential);if(null!==(p=c.multiFactorSession)&&void 0!==p&&p.idToken)return Ya._fromIdtoken(c.multiFactorSession.idToken)}return null}}class fd{constructor(c,l,p){this.session=c,this.hints=l,this.signInResolver=p}static _fromError(c,l){const p=Lt(c),_=l.customData._serverResponse,v=(_.mfaInfo||[]).map(S=>Js._fromServerResponse(p,S));K(_.mfaPendingCredential,p,"internal-error");const w=Ya._fromMfaPendingCredential(_.mfaPendingCredential);return new fd(w,v,function(){var S=(0,b.Z)(function*(B){const H=yield B._process(p,w);delete _.mfaInfo,delete _.mfaPendingCredential;const ee=Object.assign(Object.assign({},_),{idToken:H.idToken,refreshToken:H.refreshToken});switch(l.operationType){case"signIn":const te=yield Je._fromIdTokenResponse(p,l.operationType,ee);return yield p._updateCurrentUser(te.user),te;case"reauthenticate":return K(l.user,p,"internal-error"),Je._forOperation(l.user,l.operationType,ee);default:St(p,"internal-error")}});return function(B){return S.apply(this,arguments)}}())}resolveSignIn(c){var l=this;return(0,b.Z)(function*(){return l.signInResolver(c)})()}}class pd{constructor(c){this.user=c,this.enrolledFactors=[],c._onReload(l=>{l.mfaInfo&&(this.enrolledFactors=l.mfaInfo.map(p=>Js._fromServerResponse(c.auth,p)))})}static _fromUser(c){return new pd(c)}getSession(){var c=this;return(0,b.Z)(function*(){return Ya._fromIdtoken(yield c.user.getIdToken(),c.user)})()}enroll(c,l){var p=this;return(0,b.Z)(function*(){const _=c,v=yield p.getSession(),w=yield Le(p.user,_._process(p.user.auth,v,l));return yield p.user._updateTokensIfNecessary(w),p.user.reload()})()}unenroll(c){var l=this;return(0,b.Z)(function*(){const p="string"==typeof c?c:c.uid,_=yield l.user.getIdToken();try{const v=yield Le(l.user,function WT(h,c){return gt(h,"POST","/v2/accounts/mfaEnrollment:withdraw",Et(h,c))}(l.user.auth,{idToken:_,mfaEnrollmentId:p}));l.enrolledFactors=l.enrolledFactors.filter(({uid:w})=>w!==p),yield l.user._updateTokensIfNecessary(v),yield l.user.reload()}catch(v){throw v}})()}}const gd=new WeakMap,md="__sak";class wy{constructor(c,l){this.storageRetriever=c,this.type=l}_isAvailable(){try{return this.storage?(this.storage.setItem(md,"1"),this.storage.removeItem(md),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(c,l){return this.storage.setItem(c,JSON.stringify(l)),Promise.resolve()}_get(c){const l=this.storage.getItem(c);return Promise.resolve(l?JSON.parse(l):null)}_remove(c){return this.storage.removeItem(c),Promise.resolve()}get storage(){return this.storageRetriever()}}const mp=(()=>{class h extends wy{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(l,p)=>this.onStorageEvent(l,p),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Ty(){const h=(0,V.z$)();return Zl(h)||Bo(h)}()&&function re(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=RT(),this._shouldAllowMigration=!0}forAllChangedKeys(l){for(const p of Object.keys(this.listeners)){const _=this.storage.getItem(p),v=this.localCache[p];_!==v&&l(p,v,_)}}onStorageEvent(l,p=!1){if(!l.key)return void this.forAllChangedKeys((S,B,H)=>{this.notifyListeners(S,H)});const _=l.key;if(p?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const S=this.storage.getItem(_);if(l.newValue!==S)null!==l.newValue?this.storage.setItem(_,l.newValue):this.storage.removeItem(_);else if(this.localCache[_]===l.newValue&&!p)return}const v=()=>{const S=this.storage.getItem(_);!p&&this.localCache[_]===S||this.notifyListeners(_,S)},w=this.storage.getItem(_);!function ex(){return(0,V.w1)()&&10===document.documentMode}()||w===l.newValue||l.newValue===l.oldValue?v():setTimeout(v,10)}notifyListeners(l,p){this.localCache[l]=p;const _=this.listeners[l];if(_)for(const v of Array.from(_))v(p&&JSON.parse(p))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((l,p,_)=>{this.onStorageEvent(new StorageEvent("storage",{key:l,oldValue:p,newValue:_}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(l,p){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[l]||(this.listeners[l]=new Set,this.localCache[l]=this.storage.getItem(l)),this.listeners[l].add(p)}_removeListener(l,p){this.listeners[l]&&(this.listeners[l].delete(p),0===this.listeners[l].size&&delete this.listeners[l]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(l,p){var _=()=>super._set,v=this;return(0,b.Z)(function*(){yield _().call(v,l,p),v.localCache[l]=JSON.stringify(p)})()}_get(l){var p=()=>super._get,_=this;return(0,b.Z)(function*(){const v=yield p().call(_,l);return _.localCache[l]=JSON.stringify(v),v})()}_remove(l){var p=()=>super._remove,_=this;return(0,b.Z)(function*(){yield p().call(_,l),delete _.localCache[l]})()}}return h.type="LOCAL",h})(),In=(()=>{class h extends wy{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(l,p){}_removeListener(l,p){}}return h.type="SESSION",h})();let QT=(()=>{class h{constructor(l){this.eventTarget=l,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(l){const p=this.receivers.find(v=>v.isListeningto(l));if(p)return p;const _=new h(l);return this.receivers.push(_),_}isListeningto(l){return this.eventTarget===l}handleEvent(l){var p=this;return(0,b.Z)(function*(){const _=l,{eventId:v,eventType:w,data:S}=_.data,B=p.handlersMap[w];if(!B?.size)return;_.ports[0].postMessage({status:"ack",eventId:v,eventType:w});const H=Array.from(B).map(function(){var te=(0,b.Z)(function*(xe){return xe(_.origin,S)});return function(xe){return te.apply(this,arguments)}}()),ee=yield function by(h){return Promise.all(h.map(function(){var c=(0,b.Z)(function*(l){try{return{fulfilled:!0,value:yield l}}catch(p){return{fulfilled:!1,reason:p}}});return function(l){return c.apply(this,arguments)}}()))}(H);_.ports[0].postMessage({status:"done",eventId:v,eventType:w,response:ee})})()}_subscribe(l,p){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[l]||(this.handlersMap[l]=new Set),this.handlersMap[l].add(p)}_unsubscribe(l,p){this.handlersMap[l]&&p&&this.handlersMap[l].delete(p),(!p||0===this.handlersMap[l].size)&&delete this.handlersMap[l],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return h.receivers=[],h})();function bc(h="",c=10){let l="";for(let p=0;p<c;p++)l+=Math.floor(10*Math.random());return h+l}class Dy{constructor(c){this.target=c,this.handlers=new Set}removeMessageHandler(c){c.messageChannel&&(c.messageChannel.port1.removeEventListener("message",c.onMessage),c.messageChannel.port1.close()),this.handlers.delete(c)}_send(c,l,p=50){var _=this;return(0,b.Z)(function*(){const v=typeof MessageChannel<"u"?new MessageChannel:null;if(!v)throw new Error("connection_unavailable");let w,S;return new Promise((B,H)=>{const ee=bc("",20);v.port1.start();const te=setTimeout(()=>{H(new Error("unsupported_event"))},p);S={messageChannel:v,onMessage(xe){const tt=xe;if(tt.data.eventId===ee)switch(tt.data.status){case"ack":clearTimeout(te),w=setTimeout(()=>{H(new Error("timeout"))},3e3);break;case"done":clearTimeout(w),B(tt.data.response);break;default:clearTimeout(te),clearTimeout(w),H(new Error("invalid_response"))}}},_.handlers.add(S),v.port1.addEventListener("message",S.onMessage),_.target.postMessage({eventType:c,eventId:ee,data:l},[v.port2])}).finally(()=>{S&&_.removeMessageHandler(S)})})()}}function hn(){return window}function Dc(){return typeof hn().WorkerGlobalScope<"u"&&"function"==typeof hn().importScripts}function di(){return(di=(0,b.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Tt="firebaseLocalStorageDb",Xo="firebaseLocalStorage",_r="fbase_key";class Ac{constructor(c){this.request=c}toPromise(){return new Promise((c,l)=>{this.request.addEventListener("success",()=>{c(this.request.result)}),this.request.addEventListener("error",()=>{l(this.request.error)})})}}function Sc(h,c){return h.transaction([Xo],c?"readwrite":"readonly").objectStore(Xo)}function yr(){const h=indexedDB.open(Tt,1);return new Promise((c,l)=>{h.addEventListener("error",()=>{l(h.error)}),h.addEventListener("upgradeneeded",()=>{const p=h.result;try{p.createObjectStore(Xo,{keyPath:_r})}catch(_){l(_)}}),h.addEventListener("success",(0,b.Z)(function*(){const p=h.result;p.objectStoreNames.contains(Xo)?c(p):(p.close(),yield function Xa(){const h=indexedDB.deleteDatabase(Tt);return new Ac(h).toPromise()}(),c(yield yr()))}))})}function Ry(h,c,l){return yp.apply(this,arguments)}function yp(){return(yp=(0,b.Z)(function*(h,c,l){const p=Sc(h,!0).put({[_r]:c,value:l});return new Ac(p).toPromise()})).apply(this,arguments)}function Xi(){return(Xi=(0,b.Z)(function*(h,c){const l=Sc(h,!1).get(c),p=yield new Ac(l).toPromise();return void 0===p?null:p.value})).apply(this,arguments)}function vp(h,c){const l=Sc(h,!0).delete(c);return new Ac(l).toPromise()}const Jo=(()=>{class h{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var l=this;return(0,b.Z)(function*(){return l.db||(l.db=yield yr()),l.db})()}_withRetries(l){var p=this;return(0,b.Z)(function*(){let _=0;for(;;)try{const v=yield p._openDb();return yield l(v)}catch(v){if(_++>3)throw v;p.db&&(p.db.close(),p.db=void 0)}})()}initializeServiceWorkerMessaging(){var l=this;return(0,b.Z)(function*(){return Dc()?l.initializeReceiver():l.initializeSender()})()}initializeReceiver(){var l=this;return(0,b.Z)(function*(){l.receiver=QT._getInstance(function Sy(){return Dc()?self:null}()),l.receiver._subscribe("keyChanged",function(){var p=(0,b.Z)(function*(_,v){return{keyProcessed:(yield l._poll()).includes(v.key)}});return function(_,v){return p.apply(this,arguments)}}()),l.receiver._subscribe("ping",function(){var p=(0,b.Z)(function*(_,v){return["keyChanged"]});return function(_,v){return p.apply(this,arguments)}}())})()}initializeSender(){var l=this;return(0,b.Z)(function*(){var p,_;if(l.activeServiceWorker=yield function XT(){return di.apply(this,arguments)}(),!l.activeServiceWorker)return;l.sender=new Dy(l.activeServiceWorker);const v=yield l.sender._send("ping",{},800);v&&null!==(p=v[0])&&void 0!==p&&p.fulfilled&&null!==(_=v[0])&&void 0!==_&&_.value.includes("keyChanged")&&(l.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(l){var p=this;return(0,b.Z)(function*(){if(p.sender&&p.activeServiceWorker&&function Ay(){var h;return(null===(h=navigator?.serviceWorker)||void 0===h?void 0:h.controller)||null}()===p.activeServiceWorker)try{yield p.sender._send("keyChanged",{key:l},p.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,b.Z)(function*(){try{if(!indexedDB)return!1;const l=yield yr();return yield Ry(l,md,"1"),yield vp(l,md),!0}catch{}return!1})()}_withPendingWrite(l){var p=this;return(0,b.Z)(function*(){p.pendingWrites++;try{yield l()}finally{p.pendingWrites--}})()}_set(l,p){var _=this;return(0,b.Z)(function*(){return _._withPendingWrite((0,b.Z)(function*(){return yield _._withRetries(v=>Ry(v,l,p)),_.localCache[l]=p,_.notifyServiceWorker(l)}))})()}_get(l){var p=this;return(0,b.Z)(function*(){const _=yield p._withRetries(v=>function JT(h,c){return Xi.apply(this,arguments)}(v,l));return p.localCache[l]=_,_})()}_remove(l){var p=this;return(0,b.Z)(function*(){return p._withPendingWrite((0,b.Z)(function*(){return yield p._withRetries(_=>vp(_,l)),delete p.localCache[l],p.notifyServiceWorker(l)}))})()}_poll(){var l=this;return(0,b.Z)(function*(){const p=yield l._withRetries(w=>{const S=Sc(w,!1).getAll();return new Ac(S).toPromise()});if(!p)return[];if(0!==l.pendingWrites)return[];const _=[],v=new Set;if(0!==p.length)for(const{fbase_key:w,value:S}of p)v.add(w),JSON.stringify(l.localCache[w])!==JSON.stringify(S)&&(l.notifyListeners(w,S),_.push(w));for(const w of Object.keys(l.localCache))l.localCache[w]&&!v.has(w)&&(l.notifyListeners(w,null),_.push(w));return _})()}notifyListeners(l,p){this.localCache[l]=p;const _=this.listeners[l];if(_)for(const v of Array.from(_))v(p)}startPolling(){var l=this;this.stopPolling(),this.pollTimer=setInterval((0,b.Z)(function*(){return l._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(l,p){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[l]||(this.listeners[l]=new Set,this._get(l)),this.listeners[l].add(p)}_removeListener(l,p){this.listeners[l]&&(this.listeners[l].delete(p),0===this.listeners[l].size&&delete this.listeners[l]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return h.type="LOCAL",h})(),_d=1e12;class iC{constructor(c){this.auth=c,this.counter=_d,this._widgets=new Map}render(c,l){const p=this.counter;return this._widgets.set(p,new xy(c,this.auth.name,l||{})),this.counter++,p}reset(c){var l;const p=c||_d;null===(l=this._widgets.get(p))||void 0===l||l.delete(),this._widgets.delete(p)}getResponse(c){var l;return(null===(l=this._widgets.get(c||_d))||void 0===l?void 0:l.getResponse())||""}execute(c){var l=this;return(0,b.Z)(function*(){var p;return null===(p=l._widgets.get(c||_d))||void 0===p||p.execute(),""})()}}class xy{constructor(c,l,p){this.params=p,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const _="string"==typeof c?document.getElementById(c):c;K(_,"argument-error",{appName:l}),this.container=_,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Ja(h){const c=[],l="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let p=0;p<h;p++)c.push(l.charAt(Math.floor(62*Math.random())));return c.join("")}(50);const{callback:c,"expired-callback":l}=this.params;if(c)try{c(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,l)try{l()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Ep=$a("rcb"),sC=new Gi(3e4,6e4);class aC{constructor(){var c;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(c=hn().grecaptcha)||void 0===c||!c.render)}load(c,l=""){return K(function uC(h){return h.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(h)}(l),c,"argument-error"),this.shouldResolveImmediately(l)&&P(hn().grecaptcha)?Promise.resolve(hn().grecaptcha):new Promise((p,_)=>{const v=hn().setTimeout(()=>{_(Ye(c,"network-request-failed"))},sC.get());hn()[Ep]=()=>{hn().clearTimeout(v),delete hn()[Ep];const S=hn().grecaptcha;if(!S||!P(S))return void _(Ye(c,"internal-error"));const B=S.render;S.render=(H,ee)=>{const te=B(H,ee);return this.counter++,te},this.hostLanguage=l,p(S)},Y_(`https://www.google.com/recaptcha/api.js??${(0,V.xO)({onload:Ep,render:"explicit",hl:l})}`).catch(()=>{clearTimeout(v),_(Ye(c,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(c){var l;return!(null===(l=hn().grecaptcha)||void 0===l||!l.render)&&(c===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class W{load(c){return(0,b.Z)(function*(){return new iC(c)})()}clearedOneInstance(){}}const et="recaptcha",hi={theme:"light",type:"image"};class fi{constructor(c,l,p=Object.assign({},hi)){this.parameters=p,this.type=et,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Lt(c),this.isInvisible="invisible"===this.parameters.size,K(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const _="string"==typeof l?document.getElementById(l):l;K(_,this.auth,"argument-error"),this.container=_,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new W:new aC,this.validateStartingState()}verify(){var c=this;return(0,b.Z)(function*(){c.assertNotDestroyed();const l=yield c.render(),p=c.getAssertedRecaptcha();return p.getResponse(l)||new Promise(v=>{const w=S=>{S&&(c.tokenChangeListeners.delete(w),v(S))};c.tokenChangeListeners.add(w),c.isInvisible&&p.execute(l)})})()}render(){try{this.assertNotDestroyed()}catch(c){return Promise.reject(c)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(c=>{throw this.renderPromise=null,c})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(c=>{this.container.removeChild(c)})}validateStartingState(){K(!this.parameters.sitekey,this.auth,"argument-error"),K(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),K(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(c){return l=>{if(this.tokenChangeListeners.forEach(p=>p(l)),"function"==typeof c)c(l);else if("string"==typeof c){const p=hn()[c];"function"==typeof p&&p(l)}}}assertNotDestroyed(){K(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var c=this;return(0,b.Z)(function*(){if(yield c.init(),!c.widgetId){let l=c.container;if(!c.isInvisible){const p=document.createElement("div");l.appendChild(p),l=p}c.widgetId=c.getAssertedRecaptcha().render(l,c.parameters)}return c.widgetId})()}init(){var c=this;return(0,b.Z)(function*(){K(fe()&&!Dc(),c.auth,"internal-error"),yield function qn(){let h=null;return new Promise(c=>{"complete"!==document.readyState?(h=()=>c(),window.addEventListener("load",h)):c()}).catch(c=>{throw h&&window.removeEventListener("load",h),c})}(),c.recaptcha=yield c._recaptchaLoader.load(c.auth,c.auth.languageCode||void 0);const l=yield function ge(h){return ce.apply(this,arguments)}(c.auth);K(l,c.auth,"internal-error"),c.parameters.sitekey=l})()}getAssertedRecaptcha(){return K(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class yd{constructor(c,l){this.verificationId=c,this.onConfirmation=l}confirm(c){const l=Ho._fromVerification(this.verificationId,c);return this.onConfirmation(l)}}function pi(){return(pi=(0,b.Z)(function*(h,c,l){const p=Lt(h),_=yield Nc(p,c,(0,V.m9)(l));return new yd(_,v=>vc(p,v))})).apply(this,arguments)}function Pc(){return(Pc=(0,b.Z)(function*(h,c,l){const p=(0,V.m9)(h);yield ws(!1,p,"phone");const _=yield Nc(p.auth,c,(0,V.m9)(l));return new yd(_,v=>Qi(p,v))})).apply(this,arguments)}function My(){return(My=(0,b.Z)(function*(h,c,l){const p=(0,V.m9)(h),_=yield Nc(p.auth,c,(0,V.m9)(l));return new yd(_,v=>Ka(p,v))})).apply(this,arguments)}function Nc(h,c,l){return zn.apply(this,arguments)}function zn(){return zn=(0,b.Z)(function*(h,c,l){var p;const _=yield l.verify();try{let v;if(K("string"==typeof _,h,"argument-error"),K(l.type===et,h,"argument-error"),v="string"==typeof c?{phoneNumber:c}:c,"session"in v){const w=v.session;if("phoneNumber"in v)return K("enroll"===w.type,h,"internal-error"),(yield function zT(h,c){return gt(h,"POST","/v2/accounts/mfaEnrollment:start",Et(h,c))}(h,{idToken:w.credential,phoneEnrollmentInfo:{phoneNumber:v.phoneNumber,recaptchaToken:_}})).phoneSessionInfo.sessionInfo;{K("signin"===w.type,h,"internal-error");const S=(null===(p=v.multiFactorHint)||void 0===p?void 0:p.uid)||v.multiFactorUid;return K(S,h,"missing-multi-factor-info"),(yield function nC(h,c){return gt(h,"POST","/v2/accounts/mfaSignIn:start",Et(h,c))}(h,{mfaPendingCredential:w.credential,mfaEnrollmentId:S,phoneSignInInfo:{recaptchaToken:_}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:w}=yield function VT(h,c){return rp.apply(this,arguments)}(h,{phoneNumber:v.phoneNumber,recaptchaToken:_});return w}}finally{l._reset()}}),zn.apply(this,arguments)}function vd(){return(vd=(0,b.Z)(function*(h,c){yield qo((0,V.m9)(h),c)})).apply(this,arguments)}let Ji=(()=>{class h{constructor(l){this.providerId=h.PROVIDER_ID,this.auth=Lt(l)}verifyPhoneNumber(l,p){return Nc(this.auth,l,(0,V.m9)(p))}static credential(l,p){return Ho._fromVerification(l,p)}static credentialFromResult(l){return h.credentialFromTaggedObject(l)}static credentialFromError(l){return h.credentialFromTaggedObject(l.customData||{})}static credentialFromTaggedObject({_tokenResponse:l}){if(!l)return null;const{phoneNumber:p,temporaryProof:_}=l;return p&&_?Ho._fromTokenResponse(p,_):null}}return h.PROVIDER_ID="phone",h.PHONE_SIGN_IN_METHOD="phone",h})();function vr(h,c){return c?Jn(c):(K(h._popupRedirectResolver,h,"argument-error"),h._popupRedirectResolver)}class wp extends Ga{constructor(c){super("custom","custom"),this.params=c}_getIdTokenResponse(c){return ys(c,this._buildIdpRequest())}_linkToIdToken(c,l){return ys(c,this._buildIdpRequest(l))}_getReauthenticationResolver(c){return ys(c,this._buildIdpRequest())}_buildIdpRequest(c){const l={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return c&&(l.idToken=c),l}}function ky(h){return Ri(h.auth,new wp(h),h.bypassAuthState)}function lC(h){const{auth:c,user:l}=h;return K(l,c,"internal-error"),Wa(l,new wp(h),h.bypassAuthState)}function dC(h){return xc.apply(this,arguments)}function xc(){return(xc=(0,b.Z)(function*(h){const{auth:c,user:l}=h;return K(l,c,"internal-error"),qo(l,new wp(h),h.bypassAuthState)})).apply(this,arguments)}class Ed{constructor(c,l,p,_,v=!1){this.auth=c,this.resolver=p,this.user=_,this.bypassAuthState=v,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(l)?l:[l]}execute(){var c=this;return new Promise(function(){var l=(0,b.Z)(function*(p,_){c.pendingPromise={resolve:p,reject:_};try{c.eventManager=yield c.resolver._initialize(c.auth),yield c.onExecution(),c.eventManager.registerConsumer(c)}catch(v){c.reject(v)}});return function(p,_){return l.apply(this,arguments)}}())}onAuthEvent(c){var l=this;return(0,b.Z)(function*(){const{urlResponse:p,sessionId:_,postBody:v,tenantId:w,error:S,type:B}=c;if(S)return void l.reject(S);const H={auth:l.auth,requestUri:p,sessionId:_,tenantId:w||void 0,postBody:v||void 0,user:l.user,bypassAuthState:l.bypassAuthState};try{l.resolve(yield l.getIdpTask(B)(H))}catch(ee){l.reject(ee)}})()}onError(c){this.reject(c)}getIdpTask(c){switch(c){case"signInViaPopup":case"signInViaRedirect":return ky;case"linkViaPopup":case"linkViaRedirect":return dC;case"reauthViaPopup":case"reauthViaRedirect":return lC;default:St(this.auth,"internal-error")}}resolve(c){An(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(c),this.unregisterAndCleanUp()}reject(c){An(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(c),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Oy=new Gi(2e3,1e4);function Cp(){return(Cp=(0,b.Z)(function*(h,c,l){const p=Lt(h);Sr(h,c,ke);const _=vr(p,l);return new wd(p,"signInViaPopup",c,_).executeNotNull()})).apply(this,arguments)}function Mc(){return(Mc=(0,b.Z)(function*(h,c,l){const p=(0,V.m9)(h);Sr(p.auth,c,ke);const _=vr(p.auth,l);return new wd(p.auth,"reauthViaPopup",c,_,p).executeNotNull()})).apply(this,arguments)}function Id(){return(Id=(0,b.Z)(function*(h,c,l){const p=(0,V.m9)(h);Sr(p.auth,c,ke);const _=vr(p.auth,l);return new wd(p.auth,"linkViaPopup",c,_,p).executeNotNull()})).apply(this,arguments)}let wd=(()=>{class h extends Ed{constructor(l,p,_,v,w){super(l,p,v,w),this.provider=_,this.authWindow=null,this.pollId=null,h.currentPopupAction&&h.currentPopupAction.cancel(),h.currentPopupAction=this}executeNotNull(){var l=this;return(0,b.Z)(function*(){const p=yield l.execute();return K(p,l.auth,"internal-error"),p})()}onExecution(){var l=this;return(0,b.Z)(function*(){An(1===l.filter.length,"Popup operations only handle one event");const p=bc();l.authWindow=yield l.resolver._openPopup(l.auth,l.provider,l.filter[0],p),l.authWindow.associatedEvent=p,l.resolver._originValidation(l.auth).catch(_=>{l.reject(_)}),l.resolver._isIframeWebStorageSupported(l.auth,_=>{_||l.reject(Ye(l.auth,"web-storage-unsupported"))}),l.pollUserCancellation()})()}get eventId(){var l;return(null===(l=this.authWindow)||void 0===l?void 0:l.associatedEvent)||null}cancel(){this.reject(Ye(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,h.currentPopupAction=null}pollUserCancellation(){const l=()=>{var p,_;this.pollId=null!==(_=null===(p=this.authWindow)||void 0===p?void 0:p.window)&&void 0!==_&&_.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Ye(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(l,Oy.get())};l()}}return h.currentPopupAction=null,h})();const Ly="pendingRedirect",ea=new Map;class hC extends Ed{constructor(c,l,p=!1){super(c,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],l,void 0,p),this.eventId=null}execute(){var c=()=>super.execute,l=this;return(0,b.Z)(function*(){let p=ea.get(l.auth._key());if(!p){try{const v=(yield function fC(h,c){return Wn.apply(this,arguments)}(l.resolver,l.auth))?yield c().call(l):null;p=()=>Promise.resolve(v)}catch(_){p=()=>Promise.reject(_)}ea.set(l.auth._key(),p)}return l.bypassAuthState||ea.set(l.auth._key(),()=>Promise.resolve(null)),p()})()}onAuthEvent(c){var l=()=>super.onAuthEvent,p=this;return(0,b.Z)(function*(){if("signInViaRedirect"===c.type)return l().call(p,c);if("unknown"!==c.type){if(c.eventId){const _=yield p.auth._redirectUserForId(c.eventId);if(_)return p.user=_,l().call(p,c);p.resolve(null)}}else p.resolve(null)})()}onExecution(){return(0,b.Z)(function*(){})()}cleanUp(){}}function Wn(){return(Wn=(0,b.Z)(function*(h,c){const l=By(c),p=Uy(h);if(!(yield p._isAvailable()))return!1;const _="true"===(yield p._get(l));return yield p._remove(l),_})).apply(this,arguments)}function Cs(h,c){return kt.apply(this,arguments)}function kt(){return(kt=(0,b.Z)(function*(h,c){return Uy(h)._set(By(c),"true")})).apply(this,arguments)}function bp(h,c){ea.set(h._key(),c)}function Uy(h){return Jn(h._redirectPersistence)}function By(h){return Lo(Ly,h.config.apiKey,h.name)}function jy(h,c,l){return function $y(h,c,l){return eu.apply(this,arguments)}(h,c,l)}function eu(){return(eu=(0,b.Z)(function*(h,c,l){const p=Lt(h);Sr(h,c,ke),yield p._initializationPromise;const _=vr(p,l);return yield Cs(_,p),_._openRedirect(p,c,"signInViaRedirect")})).apply(this,arguments)}function to(h,c,l){return function gC(h,c,l){return tu.apply(this,arguments)}(h,c,l)}function tu(){return(tu=(0,b.Z)(function*(h,c,l){const p=(0,V.m9)(h);Sr(p.auth,c,ke),yield p.auth._initializationPromise;const _=vr(p.auth,l);yield Cs(_,p.auth);const v=yield nu(p);return _._openRedirect(p.auth,c,"reauthViaRedirect",v)})).apply(this,arguments)}function Td(h,c,l){return function Cd(h,c,l){return kc.apply(this,arguments)}(h,c,l)}function kc(){return(kc=(0,b.Z)(function*(h,c,l){const p=(0,V.m9)(h);Sr(p.auth,c,ke),yield p.auth._initializationPromise;const _=vr(p.auth,l);yield ws(!1,p,c.providerId),yield Cs(_,p.auth);const v=yield nu(p);return _._openRedirect(p.auth,c,"linkViaRedirect",v)})).apply(this,arguments)}function bd(){return(bd=(0,b.Z)(function*(h,c){return yield Lt(h)._initializationPromise,Dd(h,c,!1)})).apply(this,arguments)}function Dd(h,c){return no.apply(this,arguments)}function no(){return(no=(0,b.Z)(function*(h,c,l=!1){const p=Lt(h),_=vr(p,c),w=yield new hC(p,_,l).execute();return w&&!l&&(delete w.user._redirectEventId,yield p._persistUserIfCurrent(w.user),yield p._setRedirectUser(null,c)),w})).apply(this,arguments)}function nu(h){return Dp.apply(this,arguments)}function Dp(){return(Dp=(0,b.Z)(function*(h){const c=bc(`${h.uid}:::`);return h._redirectEventId=c,yield h.auth._setRedirectUser(h),yield h.auth._persistUserIfCurrent(h),c})).apply(this,arguments)}class Ad{constructor(c){this.auth=c,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(c){this.consumers.add(c),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,c)&&(this.sendToConsumer(this.queuedRedirectEvent,c),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(c){this.consumers.delete(c)}onEvent(c){if(this.hasEventBeenHandled(c))return!1;let l=!1;return this.consumers.forEach(p=>{this.isEventForConsumer(c,p)&&(l=!0,this.sendToConsumer(c,p),this.saveEventToCache(c))}),this.hasHandledPotentialRedirect||!function _C(h){switch(h.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Gy(h);default:return!1}}(c)||(this.hasHandledPotentialRedirect=!0,l||(this.queuedRedirectEvent=c,l=!0)),l}sendToConsumer(c,l){var p;if(c.error&&!Gy(c)){const _=(null===(p=c.error.code)||void 0===p?void 0:p.split("auth/")[1])||"internal-error";l.onError(Ye(this.auth,_))}else l.onAuthEvent(c)}isEventForConsumer(c,l){const p=null===l.eventId||!!c.eventId&&c.eventId===l.eventId;return l.filter.includes(c.type)&&p}hasEventBeenHandled(c){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(mC(c))}saveEventToCache(c){this.cachedEventUids.add(mC(c)),this.lastProcessedEventTime=Date.now()}}function mC(h){return[h.type,h.eventId,h.sessionId,h.tenantId].filter(c=>c).join("-")}function Gy({type:h,error:c}){return"unknown"===h&&"auth/no-auth-event"===c?.code}function yC(h){return qy.apply(this,arguments)}function qy(){return(qy=(0,b.Z)(function*(h,c={}){return gt(h,"GET","/v1/projects",c)})).apply(this,arguments)}const Ap=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Oc=/^https?/;function ta(){return(ta=(0,b.Z)(function*(h){if(h.config.emulator)return;const{authorizedDomains:c}=yield yC(h);for(const l of c)try{if(Sp(l))return}catch{}St(h,"unauthorized-domain")})).apply(this,arguments)}function Sp(h){const c=Wt(),{protocol:l,hostname:p}=new URL(c);if(h.startsWith("chrome-extension://")){const w=new URL(h);return""===w.hostname&&""===p?"chrome-extension:"===l&&h.replace("chrome-extension://","")===c.replace("chrome-extension://",""):"chrome-extension:"===l&&w.hostname===p}if(!Oc.test(l))return!1;if(Ap.test(h))return p===h;const _=h.replace(/\./g,"\\.");return new RegExp("^(.+\\."+_+"|"+_+")$","i").test(p)}const Sd=new Gi(3e4,6e4);function EC(){const h=hn().___jsl;if(h?.H)for(const c of Object.keys(h.H))if(h.H[c].r=h.H[c].r||[],h.H[c].L=h.H[c].L||[],h.H[c].r=[...h.H[c].L],h.CP)for(let l=0;l<h.CP.length;l++)h.CP[l]=null}let Fc=null;const es=new Gi(5e3,15e3),wC="__/auth/iframe",Rd="emulator/auth/iframe",Rp={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Wy=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Pd(h){const c=h.config;K(c.authDomain,h,"auth-domain-config-required");const l=c.emulator?fr(c,Rd):`https://${h.config.authDomain}/${wC}`,p={apiKey:c.apiKey,appName:h.name,v:Se.SDK_VERSION},_=Wy.get(h.config.apiHost);_&&(p.eid=_);const v=h._getFrameworks();return v.length&&(p.fw=v.join(",")),`${l}?${(0,V.xO)(p).slice(1)}`}function Np(){return Np=(0,b.Z)(function*(h){const c=yield function IC(h){return Fc=Fc||function zy(h){return new Promise((c,l)=>{var p,_,v;function w(){EC(),gapi.load("gapi.iframes",{callback:()=>{c(gapi.iframes.getContext())},ontimeout:()=>{EC(),l(Ye(h,"network-request-failed"))},timeout:Sd.get()})}if(null!==(_=null===(p=hn().gapi)||void 0===p?void 0:p.iframes)&&void 0!==_&&_.Iframe)c(gapi.iframes.getContext());else{if(null===(v=hn().gapi)||void 0===v||!v.load){const S=$a("iframefcb");return hn()[S]=()=>{gapi.load?w():l(Ye(h,"network-request-failed"))},Y_(`https://apis.google.com/js/api.js?onload=${S}`).catch(B=>l(B))}w()}}).catch(c=>{throw Fc=null,c})}(h),Fc}(h),l=hn().gapi;return K(l,h,"internal-error"),c.open({where:document.body,url:Pd(h),messageHandlersFilter:l.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Rp,dontclear:!0},p=>new Promise(function(){var _=(0,b.Z)(function*(v,w){yield p.restyle({setHideOnLeave:!1});const S=Ye(h,"network-request-failed"),B=hn().setTimeout(()=>{w(S)},es.get());function H(){hn().clearTimeout(B),v(p)}p.ping(H).then(H,()=>{w(S)})});return function(v,w){return _.apply(this,arguments)}}()))}),Np.apply(this,arguments)}const Ky={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Vc{constructor(c){this.window=c,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const Xy="__/auth/handler",Jy="emulator/auth/handler",Lc=encodeURIComponent("fac");function xp(h,c,l,p,_,v){return Kn.apply(this,arguments)}function Kn(){return(Kn=(0,b.Z)(function*(h,c,l,p,_,v){K(h.config.authDomain,h,"auth-domain-config-required"),K(h.config.apiKey,h,"invalid-api-key");const w={apiKey:h.config.apiKey,appName:h.name,authType:l,redirectUrl:p,v:Se.SDK_VERSION,eventId:_};if(c instanceof ke){c.setDefaultLanguage(h.languageCode),w.providerId=c.providerId||"",(0,V.xb)(c.getCustomParameters())||(w.customParameters=JSON.stringify(c.getCustomParameters()));for(const[ee,te]of Object.entries(v||{}))w[ee]=te}if(c instanceof rn){const ee=c.getScopes().filter(te=>""!==te);ee.length>0&&(w.scopes=ee.join(","))}h.tenantId&&(w.tid=h.tenantId);const S=w;for(const ee of Object.keys(S))void 0===S[ee]&&delete S[ee];const B=yield h._getAppCheckToken(),H=B?`#${Lc}=${encodeURIComponent(B)}`:"";return`${function bC({config:h}){return h.emulator?fr(h,Jy):`https://${h.authDomain}/${Xy}`}(h)}?${(0,V.xO)(S).slice(1)}${H}`})).apply(this,arguments)}const Pn="webStorageSupport",ev=class Mp{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=In,this._completeRedirectFn=Dd,this._overrideRedirectResult=bp}_openPopup(c,l,p,_){var v=this;return(0,b.Z)(function*(){var w;An(null===(w=v.eventManagers[c._key()])||void 0===w?void 0:w.manager,"_initialize() not called before _openPopup()");const S=yield xp(c,l,p,Wt(),_);return function na(h,c,l,p=500,_=600){const v=Math.max((window.screen.availHeight-_)/2,0).toString(),w=Math.max((window.screen.availWidth-p)/2,0).toString();let S="";const B=Object.assign(Object.assign({},Ky),{width:p.toString(),height:_.toString(),top:v,left:w}),H=(0,V.z$)().toLowerCase();l&&(S=Z_(H)?"_blank":l),Kl(H)&&(c=c||"http://localhost",B.scrollbars="yes");const ee=Object.entries(B).reduce((xe,[tt,Er])=>`${xe}${tt}=${Er},`,"");if(function Rt(h=(0,V.z$)()){var c;return Bo(h)&&!(null===(c=window.navigator)||void 0===c||!c.standalone)}(H)&&"_self"!==S)return function CC(h,c){const l=document.createElement("a");l.href=h,l.target=c;const p=document.createEvent("MouseEvent");p.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),l.dispatchEvent(p)}(c||"",S),new Vc(null);const te=window.open(c||"",S,ee);K(te,h,"popup-blocked");try{te.focus()}catch{}return new Vc(te)}(c,S,bc())})()}_openRedirect(c,l,p,_){var v=this;return(0,b.Z)(function*(){return yield v._originValidation(c),function YT(h){hn().location.href=h}(yield xp(c,l,p,Wt(),_)),new Promise(()=>{})})()}_initialize(c){const l=c._key();if(this.eventManagers[l]){const{manager:_,promise:v}=this.eventManagers[l];return _?Promise.resolve(_):(An(v,"If manager is not set, promise should be"),v)}const p=this.initAndGetManager(c);return this.eventManagers[l]={promise:p},p.catch(()=>{delete this.eventManagers[l]}),p}initAndGetManager(c){var l=this;return(0,b.Z)(function*(){const p=yield function Pp(h){return Np.apply(this,arguments)}(c),_=new Ad(c);return p.register("authEvent",v=>(K(v?.authEvent,c,"invalid-auth-event"),{status:_.onEvent(v.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),l.eventManagers[c._key()]={manager:_},l.iframes[c._key()]=p,_})()}_isIframeWebStorageSupported(c,l){this.iframes[c._key()].send(Pn,{type:Pn},_=>{var v;const w=null===(v=_?.[0])||void 0===v?void 0:v[Pn];void 0!==w&&l(!!w),St(c,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(c){const l=c._key();return this.originValidationPromises[l]||(this.originValidationPromises[l]=function vC(h){return ta.apply(this,arguments)}(c)),this.originValidationPromises[l]}get _shouldInitProactively(){return RT()||Zl()||Bo()}};class tv{constructor(c){this.factorId=c}_process(c,l,p){switch(l.type){case"enroll":return this._finalizeEnroll(c,l.credential,p);case"signin":return this._finalizeSignIn(c,l.credential);default:return _n("unexpected MultiFactorSessionType")}}}class ru extends tv{constructor(c){super("phone"),this.credential=c}static _fromCredential(c){return new ru(c)}_finalizeEnroll(c,l,p){return function gp(h,c){return gt(h,"POST","/v2/accounts/mfaEnrollment:finalize",Et(h,c))}(c,{idToken:l,displayName:p,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(c,l){return function be(h,c){return gt(h,"POST","/v2/accounts/mfaSignIn:finalize",Et(h,c))}(c,{mfaPendingCredential:l,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let iu=(()=>{class h{constructor(){}static assertion(l){return ru._fromCredential(l)}}return h.FACTOR_ID="phone",h})();var ra="@firebase/auth";class AC{constructor(c){this.auth=c,this.internalListeners=new Map}getUid(){var c;return this.assertAuthConfigured(),(null===(c=this.auth.currentUser)||void 0===c?void 0:c.uid)||null}getToken(c){var l=this;return(0,b.Z)(function*(){return l.assertAuthConfigured(),yield l.auth._initializationPromise,l.auth.currentUser?{accessToken:yield l.auth.currentUser.getIdToken(c)}:null})()}addAuthTokenListener(c){if(this.assertAuthConfigured(),this.internalListeners.has(c))return;const l=this.auth.onIdTokenChanged(p=>{c(p?.stsTokenManager.accessToken||null)});this.internalListeners.set(c,l),this.updateProactiveRefresh()}removeAuthTokenListener(c){this.assertAuthConfigured();const l=this.internalListeners.get(c);l&&(this.internalListeners.delete(c),l(),this.updateProactiveRefresh())}assertAuthConfigured(){K(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function ia(){return window}(0,V.Pz)("authIdTokenMaxAge"),function wx(h){(0,Se._registerComponent)(new ms.wA("auth",(c,{options:l})=>{const p=c.getProvider("app").getImmediate(),_=c.getProvider("heartbeat"),v=c.getProvider("app-check-internal"),{apiKey:w,authDomain:S}=p.options;K(w&&!w.includes(":"),"invalid-api-key",{appName:p.name});const B={apiKey:w,authDomain:S,clientPlatform:h,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ql(h)},H=new tx(p,_,v,B);return function ey(h,c){const l=c?.persistence||[],p=(Array.isArray(l)?l:[l]).map(Jn);c?.errorMap&&h._updateErrorMap(c.errorMap),h._initializeWithPersistence(p,c?.popupRedirectResolver)}(H,l),H},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((c,l,p)=>{c.getProvider("auth-internal").initialize()})),(0,Se._registerComponent)(new ms.wA("auth-internal",c=>{const l=Lt(c.getProvider("auth").getImmediate());return new AC(l)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,Se.registerVersion)(ra,"1.5.1",function Ix(h){switch(h){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(h)),(0,Se.registerVersion)(ra,"1.5.1","esm2017")}("Browser");function Op(){return Op=(0,b.Z)(function*(h,c,l){var p;const{BuildInfo:_}=ia();An(c.sessionId,"AuthEvent did not contain a session ID");const v=yield function $c(h){return Vp.apply(this,arguments)}(c.sessionId),w={};return Bo()?w.ibi=_.packageName:Uo()?w.apn=_.packageName:St(h,"operation-not-supported-in-this-environment"),_.displayName&&(w.appDisplayName=_.displayName),w.sessionId=v,xp(h,l,c.type,void 0,null!==(p=c.eventId)&&void 0!==p?p:void 0,w)}),Op.apply(this,arguments)}function Fp(){return(Fp=(0,b.Z)(function*(h){const{BuildInfo:c}=ia(),l={};Bo()?l.iosBundleId=c.packageName:Uo()?l.androidPackageName=c.packageName:St(h,"operation-not-supported-in-this-environment"),yield yC(h,l)})).apply(this,arguments)}function Nd(){return(Nd=(0,b.Z)(function*(h,c,l){const{cordova:p}=ia();let _=()=>{};try{yield new Promise((v,w)=>{let S=null;function B(){var te;v();const xe=null===(te=p.plugins.browsertab)||void 0===te?void 0:te.close;"function"==typeof xe&&xe(),"function"==typeof l?.close&&l.close()}function H(){S||(S=window.setTimeout(()=>{w(Ye(h,"redirect-cancelled-by-user"))},2e3))}function ee(){"visible"===document?.visibilityState&&H()}c.addPassiveListener(B),document.addEventListener("resume",H,!1),Uo()&&document.addEventListener("visibilitychange",ee,!1),_=()=>{c.removePassiveListener(B),document.removeEventListener("resume",H,!1),document.removeEventListener("visibilitychange",ee,!1),S&&window.clearTimeout(S)}})}finally{_()}})).apply(this,arguments)}function Vp(){return(Vp=(0,b.Z)(function*(h){const c=function Dx(h){if(An(/[0-9a-zA-Z]+/.test(h),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(h);const c=new ArrayBuffer(h.length),l=new Uint8Array(c);for(let p=0;p<h.length;p++)l[p]=h.charCodeAt(p);return l}(h),l=yield crypto.subtle.digest("SHA-256",c);return Array.from(new Uint8Array(l)).map(_=>_.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class Ax extends Ad{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(c=>{this.resolveInialized=c})}addPassiveListener(c){this.passiveListeners.add(c)}removePassiveListener(c){this.passiveListeners.delete(c)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(c){return this.resolveInialized(),this.passiveListeners.forEach(l=>l(c)),super.onEvent(c)}initialized(){var c=this;return(0,b.Z)(function*(){yield c.initPromise})()}}function sa(h){return nv.apply(this,arguments)}function nv(){return(nv=(0,b.Z)(function*(h){const c=yield Up()._get(Bp(h));return c&&(yield Up()._remove(Bp(h))),c})).apply(this,arguments)}function NC(){const h=[];for(let l=0;l<20;l++){const p=Math.floor(62*Math.random());h.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(p))}return h.join("")}function Up(){return Jn(mp)}function Bp(h){return Lo("authEvent",h.config.apiKey,h.name)}function Md(h){if(!h?.includes("?"))return{};const[c,...l]=h.split("?");return(0,V.zd)(l.join("?"))}const kC=class kd{constructor(){this._redirectPersistence=In,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Dd,this._overrideRedirectResult=bp}_initialize(c){var l=this;return(0,b.Z)(function*(){const p=c._key();let _=l.eventManagers.get(p);return _||(_=new Ax(c),l.eventManagers.set(p,_),l.attachCallbackListeners(c,_)),_})()}_openPopup(c){St(c,"operation-not-supported-in-this-environment")}_openRedirect(c,l,p,_){var v=this;return(0,b.Z)(function*(){!function xd(h){var c,l,p,_,v,w,S,B,H,ee;const te=ia();K("function"==typeof(null===(c=te?.universalLinks)||void 0===c?void 0:c.subscribe),h,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),K(typeof(null===(l=te?.BuildInfo)||void 0===l?void 0:l.packageName)<"u",h,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),K("function"==typeof(null===(v=null===(_=null===(p=te?.cordova)||void 0===p?void 0:p.plugins)||void 0===_?void 0:_.browsertab)||void 0===v?void 0:v.openUrl),h,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),K("function"==typeof(null===(B=null===(S=null===(w=te?.cordova)||void 0===w?void 0:w.plugins)||void 0===S?void 0:S.browsertab)||void 0===B?void 0:B.isAvailable),h,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),K("function"==typeof(null===(ee=null===(H=te?.cordova)||void 0===H?void 0:H.InAppBrowser)||void 0===ee?void 0:ee.open),h,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(c);const w=yield v._initialize(c);yield w.initialized(),w.resetRedirect(),function pC(){ea.clear()}(),yield v._originValidation(c);const S=function Hr(h,c,l=null){return{type:c,eventId:l,urlResponse:null,sessionId:NC(),postBody:null,tenantId:h.tenantId,error:Ye(h,"no-auth-event")}}(c,p,_);yield function Lp(h,c){return Up()._set(Bp(h),c)}(c,S);const B=yield function Nn(h,c,l){return Op.apply(this,arguments)}(c,S,l),H=yield function gi(h){const{cordova:c}=ia();return new Promise(l=>{c.plugins.browsertab.isAvailable(p=>{let _=null;p?c.plugins.browsertab.openUrl(h):_=c.InAppBrowser.open(h,function JN(h=(0,V.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(h)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(h)}()?"_blank":"_system","location=yes"),l(_)})})}(B);return function ou(h,c,l){return Nd.apply(this,arguments)}(c,w,H)})()}_isIframeWebStorageSupported(c,l){throw new Error("Method not implemented.")}_originValidation(c){const l=c._key();return this.originValidationPromises[l]||(this.originValidationPromises[l]=function jc(h){return Fp.apply(this,arguments)}(c)),this.originValidationPromises[l]}attachCallbackListeners(c,l){const{universalLinks:p,handleOpenURL:_,BuildInfo:v}=ia(),w=setTimeout((0,b.Z)(function*(){yield sa(c),l.onEvent(au())}),500),S=function(){var ee=(0,b.Z)(function*(te){clearTimeout(w);const xe=yield sa(c);let tt=null;xe&&te?.url&&(tt=function rv(h,c){var l,p;const _=function MC(h){const c=Md(h),l=c.link?decodeURIComponent(c.link):void 0,p=Md(l).link,_=c.deep_link_id?decodeURIComponent(c.deep_link_id):void 0;return Md(_).link||_||p||l||h}(c);if(_.includes("/__/auth/callback")){const v=Md(_),w=v.firebaseError?function xC(h){try{return JSON.parse(h)}catch{return null}}(decodeURIComponent(v.firebaseError)):null,S=null===(p=null===(l=w?.code)||void 0===l?void 0:l.split("auth/"))||void 0===p?void 0:p[1],B=S?Ye(S):null;return B?{type:h.type,eventId:h.eventId,tenantId:h.tenantId,error:B,urlResponse:null,sessionId:null,postBody:null}:{type:h.type,eventId:h.eventId,tenantId:h.tenantId,sessionId:h.sessionId,urlResponse:_,postBody:null}}return null}(xe,te.url)),l.onEvent(tt||au())});return function(xe){return ee.apply(this,arguments)}}();typeof p<"u"&&"function"==typeof p.subscribe&&p.subscribe(null,S);const B=_,H=`${v.packageName.toLowerCase()}://`;ia().handleOpenURL=function(){var ee=(0,b.Z)(function*(te){if(te.toLowerCase().startsWith(H)&&S({url:te}),"function"==typeof B)try{B(te)}catch(xe){console.error(xe)}});return function(te){return ee.apply(this,arguments)}}()}};function au(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Ye("no-auth-event")}}function oa(){var h;return(null===(h=self?.location)||void 0===h?void 0:h.protocol)||null}function $p(h=(0,V.z$)()){return!("file:"!==oa()&&"ionic:"!==oa()&&"capacitor:"!==oa()||!h.toLowerCase().match(/iphone|ipad|ipod|android/))}function sv(){try{const h=self.localStorage,c=bc();if(h)return h.setItem(c,"1"),h.removeItem(c),!function Hc(h=(0,V.z$)()){return function LC(){return(0,V.w1)()&&11===document?.documentMode}()||function uu(h=(0,V.z$)()){return/Edge\/\d+/.test(h)}(h)}()||(0,V.hl)()}catch{return ov()&&(0,V.hl)()}return!1}function ov(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Vd(){return(function Fd(){return"http:"===oa()||"https:"===oa()}()||(0,V.ru)()||$p())&&!function VC(){return(0,V.b$)()||(0,V.UG)()}()&&sv()&&!ov()}function av(){return $p()&&typeof document<"u"}function Hp(){return(Hp=(0,b.Z)(function*(){return!!av()&&new Promise(h=>{const c=setTimeout(()=>{h(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(c),h(!0)})})})).apply(this,arguments)}const Gr={LOCAL:"local",NONE:"none",SESSION:"session"},io=K,Gp="persistence";function Ld(h){return uv.apply(this,arguments)}function uv(){return(uv=(0,b.Z)(function*(h){yield h._initializationPromise;const c=jC(),l=Lo(Gp,h.config.apiKey,h.name);c&&c.setItem(l,h._getPersistence())})).apply(this,arguments)}function jC(){var h;try{return(null===(h=function UC(){return typeof window<"u"?window:null}())||void 0===h?void 0:h.sessionStorage)||null}catch{return null}}const $C=K;class so{constructor(){this.browserResolver=Jn(ev),this.cordovaResolver=Jn(kC),this.underlyingResolver=null,this._redirectPersistence=In,this._completeRedirectFn=Dd,this._overrideRedirectResult=bp}_initialize(c){var l=this;return(0,b.Z)(function*(){return yield l.selectUnderlyingResolver(),l.assertedUnderlyingResolver._initialize(c)})()}_openPopup(c,l,p,_){var v=this;return(0,b.Z)(function*(){return yield v.selectUnderlyingResolver(),v.assertedUnderlyingResolver._openPopup(c,l,p,_)})()}_openRedirect(c,l,p,_){var v=this;return(0,b.Z)(function*(){return yield v.selectUnderlyingResolver(),v.assertedUnderlyingResolver._openRedirect(c,l,p,_)})()}_isIframeWebStorageSupported(c,l){this.assertedUnderlyingResolver._isIframeWebStorageSupported(c,l)}_originValidation(c){return this.assertedUnderlyingResolver._originValidation(c)}get _shouldInitProactively(){return av()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return $C(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var c=this;return(0,b.Z)(function*(){if(c.underlyingResolver)return;const l=yield function Sx(){return Hp.apply(this,arguments)}();c.underlyingResolver=l?c.cordovaResolver:c.browserResolver})()}}function Ud(h){return h.unwrap()}function Px(h){return HC(h)}function HC(h){const{_tokenResponse:c}=h instanceof V.ZR?h.customData:h;if(!c)return null;if(!(h instanceof V.ZR)&&"temporaryProof"in c&&"phoneNumber"in c)return Ji.credentialFromResult(h);const l=c.providerId;if(!l||l===Di.PASSWORD)return null;let p;switch(l){case Di.GOOGLE:p=Rr;break;case Di.FACEBOOK:p=Go;break;case Di.GITHUB:p=ap;break;case Di.TWITTER:p=Kt;break;default:const{oauthIdToken:_,oauthAccessToken:v,oauthTokenSecret:w,pendingToken:S,nonce:B}=c;return v||w||_||S?S?l.startsWith("saml.")?vs._create(l,S):Ki._fromParams({providerId:l,signInMethod:l,pendingToken:S,idToken:_,accessToken:v}):new vn(l).credential({idToken:_,accessToken:v,rawNonce:B}):null}return h instanceof V.ZR?p.credentialFromError(h):p.credentialFromResult(h)}function qr(h,c){return c.catch(l=>{throw l instanceof V.ZR&&function qp(h,c){var l;const p=null===(l=c.customData)||void 0===l?void 0:l._tokenResponse;if("auth/multi-factor-auth-required"===c?.code)c.resolver=new Nx(h,function pp(h,c){var l;const p=(0,V.m9)(h),_=c;return K(c.customData.operationType,p,"argument-error"),K(null===(l=_.customData._serverResponse)||void 0===l?void 0:l.mfaPendingCredential,p,"argument-error"),fd._fromError(p,_)}(h,c));else if(p){const _=HC(c),v=c;_&&(v.credential=_,v.tenantId=p.tenantId||void 0,v.email=p.email||void 0,v.phoneNumber=p.phoneNumber||void 0)}}(h,l),l}).then(l=>{const _=l.user;return{operationType:l.operationType,credential:Px(l),additionalUserInfo:hp(l),user:bs.getOrCreate(_)}})}function lv(h,c){return dv.apply(this,arguments)}function dv(){return(dv=(0,b.Z)(function*(h,c){const l=yield c;return{verificationId:l.verificationId,confirm:p=>qr(h,l.confirm(p))}})).apply(this,arguments)}class Nx{constructor(c,l){this.resolver=l,this.auth=function Rx(h){return h.wrapped()}(c)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(c){return qr(Ud(this.auth),this.resolver.resolveSignIn(c))}}class bs{constructor(c){this._delegate=c,this.multiFactor=function KT(h){const c=(0,V.m9)(h);return gd.has(c)||gd.set(c,pd._fromUser(c)),gd.get(c)}(c)}static getOrCreate(c){return bs.USER_MAP.has(c)||bs.USER_MAP.set(c,new bs(c)),bs.USER_MAP.get(c)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(c){return this._delegate.getIdTokenResult(c)}getIdToken(c){return this._delegate.getIdToken(c)}linkAndRetrieveDataWithCredential(c){return this.linkWithCredential(c)}linkWithCredential(c){var l=this;return(0,b.Z)(function*(){return qr(l.auth,Qi(l._delegate,c))})()}linkWithPhoneNumber(c,l){var p=this;return(0,b.Z)(function*(){return lv(p.auth,function Ip(h,c,l){return Pc.apply(this,arguments)}(p._delegate,c,l))})()}linkWithPopup(c){var l=this;return(0,b.Z)(function*(){return qr(l.auth,function Vy(h,c,l){return Id.apply(this,arguments)}(l._delegate,c,so))})()}linkWithRedirect(c){var l=this;return(0,b.Z)(function*(){return yield Ld(Lt(l.auth)),Td(l._delegate,c,so)})()}reauthenticateAndRetrieveDataWithCredential(c){return this.reauthenticateWithCredential(c)}reauthenticateWithCredential(c){var l=this;return(0,b.Z)(function*(){return qr(l.auth,Ka(l._delegate,c))})()}reauthenticateWithPhoneNumber(c,l){return lv(this.auth,function cC(h,c,l){return My.apply(this,arguments)}(this._delegate,c,l))}reauthenticateWithPopup(c){return qr(this.auth,function Fy(h,c,l){return Mc.apply(this,arguments)}(this._delegate,c,so))}reauthenticateWithRedirect(c){var l=this;return(0,b.Z)(function*(){return yield Ld(Lt(l.auth)),to(l._delegate,c,so)})()}sendEmailVerification(c){return function dx(h,c){return ld.apply(this,arguments)}(this._delegate,c)}unlink(c){var l=this;return(0,b.Z)(function*(){return yield function za(h,c){return Ae.apply(this,arguments)}(l._delegate,c),l})()}updateEmail(c){return function fx(h,c){return Un((0,V.m9)(h),c,null)}(this._delegate,c)}updatePassword(c){return function px(h,c){return Un((0,V.m9)(h),null,c)}(this._delegate,c)}updatePhoneNumber(c){return function Ts(h,c){return vd.apply(this,arguments)}(this._delegate,c)}updateProfile(c){return function Qo(h,c){return Yi.apply(this,arguments)}(this._delegate,c)}verifyBeforeUpdateEmail(c,l){return function gy(h,c,l){return my.apply(this,arguments)}(this._delegate,c,l)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}bs.USER_MAP=new WeakMap;const oo=K;let Gc=(()=>{class h{constructor(l,p){if(this.app=l,p.isInitialized())return this._delegate=p.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:_}=l.options;oo(_,"invalid-api-key",{appName:l.name}),oo(_,"invalid-api-key",{appName:l.name});const v=typeof window<"u"?so:void 0;this._delegate=p.initialize({options:{persistence:hv(_,l.name),popupRedirectResolver:v}}),this._delegate._updateErrorMap(cc),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?bs.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(l){this._delegate.languageCode=l}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(l){this._delegate.tenantId=l}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(l,p){!function pe(h,c,l){const p=Lt(h);K(p._canInitEmulator,p,"emulator-config-failed"),K(/^https?:\/\//.test(c),p,"invalid-emulator-scheme");const _=!!l?.disableWarnings,v=mc(c),{host:w,port:S}=function Jf(h){const c=mc(h),l=/(\/\/)?([^?#/]+)/.exec(h.substr(c.length));if(!l)return{host:"",port:null};const p=l[2].split("@").pop()||"",_=/^(\[[^\]]+\])(:|$)/.exec(p);if(_){const v=_[1];return{host:v,port:Ha(p.substr(v.length+1))}}{const[v,w]=p.split(":");return{host:v,port:Ha(w)}}}(c);p.config.emulator={url:`${v}//${w}${null===S?"":`:${S}`}/`},p.settings.appVerificationDisabledForTesting=!0,p.emulatorConfig=Object.freeze({host:w,port:S,protocol:v.replace(":",""),options:Object.freeze({disableWarnings:_})}),_||function MT(){function h(){const c=document.createElement("p"),l=c.style;c.innerText="Running in emulator mode. Do not use with production credentials.",l.position="fixed",l.width="100%",l.backgroundColor="#ffffff",l.border=".1em solid #000000",l.color="#b50000",l.bottom="0px",l.left="0px",l.margin="0px",l.zIndex="10000",l.textAlign="center",c.classList.add("firebase-emulator-warning"),document.body.appendChild(c)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",h):h())}()}(this._delegate,l,p)}applyActionCode(l){return function Pi(h,c){return wc.apply(this,arguments)}(this._delegate,l)}checkActionCode(l){return cy(this._delegate,l)}confirmPasswordReset(l,p){return function Zo(h,c,l){return Za.apply(this,arguments)}(this._delegate,l,p)}createUserWithEmailAndPassword(l,p){var _=this;return(0,b.Z)(function*(){return qr(_._delegate,function $T(h,c,l){return ly.apply(this,arguments)}(_._delegate,l,p))})()}fetchProvidersForEmail(l){return this.fetchSignInMethodsForEmail(l)}fetchSignInMethodsForEmail(l){return function lx(h,c){return py.apply(this,arguments)}(this._delegate,l)}isSignInWithEmailLink(l){return function ax(h,c){const l=qa.parseLink(c);return"EMAIL_SIGNIN"===l?.operation}(0,l)}getRedirectResult(){var l=this;return(0,b.Z)(function*(){oo(Vd(),l._delegate,"operation-not-supported-in-this-environment");const p=yield function Hy(h,c){return bd.apply(this,arguments)}(l._delegate,so);return p?qr(l._delegate,Promise.resolve(p)):{credential:null,user:null}})()}addFrameworkForLogging(l){!function OC(h,c){Lt(h)._logFramework(c)}(this._delegate,l)}onAuthStateChanged(l,p,_){const{next:v,error:w,complete:S}=zp(l,p,_);return this._delegate.onAuthStateChanged(v,w,S)}onIdTokenChanged(l,p,_){const{next:v,error:w,complete:S}=zp(l,p,_);return this._delegate.onIdTokenChanged(v,w,S)}sendSignInLinkToEmail(l,p){return function ox(h,c,l){return dy.apply(this,arguments)}(this._delegate,l,p)}sendPasswordResetEmail(l,p){return function mr(h,c,l){return Ic.apply(this,arguments)}(this._delegate,l,p||void 0)}setPersistence(l){var p=this;return(0,b.Z)(function*(){let _;switch(function BC(h,c){io(Object.values(Gr).includes(c),h,"invalid-persistence-type"),(0,V.b$)()?io(c!==Gr.SESSION,h,"unsupported-persistence-type"):(0,V.UG)()?io(c===Gr.NONE,h,"unsupported-persistence-type"):ov()?io(c===Gr.NONE||c===Gr.LOCAL&&(0,V.hl)(),h,"unsupported-persistence-type"):io(c===Gr.NONE||sv(),h,"unsupported-persistence-type")}(p._delegate,l),l){case Gr.SESSION:_=In;break;case Gr.LOCAL:_=(yield Jn(Jo)._isAvailable())?Jo:mp;break;case Gr.NONE:_=Vo;break;default:return St("argument-error",{appName:p._delegate.name})}return p._delegate.setPersistence(_)})()}signInAndRetrieveDataWithCredential(l){return this.signInWithCredential(l)}signInAnonymously(){return qr(this._delegate,function yc(h){return Ln.apply(this,arguments)}(this._delegate))}signInWithCredential(l){return qr(this._delegate,vc(this._delegate,l))}signInWithCustomToken(l){return qr(this._delegate,function ay(h,c){return ci.apply(this,arguments)}(this._delegate,l))}signInWithEmailAndPassword(l,p){return qr(this._delegate,function sx(h,c,l){return vc((0,V.m9)(h),tr.credential(c,l)).catch(function(){var p=(0,b.Z)(function*(_){throw"auth/password-does-not-meet-requirements"===_.code&&uy(h),_});return function(_){return p.apply(this,arguments)}}())}(this._delegate,l,p))}signInWithEmailLink(l,p){return qr(this._delegate,function ux(h,c,l){return hy.apply(this,arguments)}(this._delegate,l,p))}signInWithPhoneNumber(l,p){return lv(this._delegate,function Rc(h,c,l){return pi.apply(this,arguments)}(this._delegate,l,p))}signInWithPopup(l){var p=this;return(0,b.Z)(function*(){return oo(Vd(),p._delegate,"operation-not-supported-in-this-environment"),qr(p._delegate,function Tp(h,c,l){return Cp.apply(this,arguments)}(p._delegate,l,so))})()}signInWithRedirect(l){var p=this;return(0,b.Z)(function*(){return oo(Vd(),p._delegate,"operation-not-supported-in-this-environment"),yield Ld(p._delegate),jy(p._delegate,l,so)})()}updateCurrentUser(l){return this._delegate.updateCurrentUser(l)}verifyPasswordResetCode(l){return function ix(h,c){return cp.apply(this,arguments)}(this._delegate,l)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return h.Persistence=Gr,h})();function zp(h,c,l){let p=h;"function"!=typeof h&&({next:p,error:c,complete:l}=h);const _=p;return{next:w=>_(w&&bs.getOrCreate(w)),error:c,complete:l}}function hv(h,c){const l=function cv(h,c){const l=jC();if(!l)return[];const p=Lo(Gp,h,c);switch(l.getItem(p)){case Gr.NONE:return[Vo];case Gr.LOCAL:return[Jo,In];case Gr.SESSION:return[In];default:return[]}}(h,c);if(typeof self<"u"&&!l.includes(Jo)&&l.push(Jo),typeof window<"u")for(const p of[mp,In])l.includes(p)||l.push(p);return l.includes(Vo)||l.push(Vo),l}class Bd{constructor(){this.providerId="phone",this._delegate=new Ji(Ud(De.Z.auth()))}static credential(c,l){return Ji.credential(c,l)}verifyPhoneNumber(c,l){return this._delegate.verifyPhoneNumber(c,l)}unwrap(){return this._delegate}}Bd.PHONE_SIGN_IN_METHOD=Ji.PHONE_SIGN_IN_METHOD,Bd.PROVIDER_ID=Ji.PROVIDER_ID;const cu=K;class fv{constructor(c,l,p=De.Z.app()){var _;cu(null===(_=p.options)||void 0===_?void 0:_.apiKey,"invalid-api-key",{appName:p.name}),this._delegate=new fi(p.auth(),c,l),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function jd(h){h.INTERNAL.registerComponent(new ms.wA("auth-compat",c=>{const l=c.getProvider("app-compat").getImmediate(),p=c.getProvider("auth");return new Gc(l,p)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:tr,FacebookAuthProvider:Go,GithubAuthProvider:ap,GoogleAuthProvider:Rr,OAuthProvider:vn,SAMLAuthProvider:ud,PhoneAuthProvider:Bd,PhoneMultiFactorGenerator:iu,RecaptchaVerifier:fv,TwitterAuthProvider:Kt,Auth:Gc,AuthCredential:Ga,Error:V.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),h.registerVersion("@firebase/auth-compat","0.5.1")}(De.Z)},861:(Gs,lr,je)=>{function b(V,Se,ln,xt,mn,Fn,ut){try{var L=V[Fn](ut),J=L.value}catch(ye){return void ln(ye)}L.done?Se(J):Promise.resolve(J).then(xt,mn)}function De(V){return function(){var Se=this,ln=arguments;return new Promise(function(xt,mn){var Fn=V.apply(Se,ln);function ut(J){b(Fn,xt,mn,ut,L,"next",J)}function L(J){b(Fn,xt,mn,ut,L,"throw",J)}ut(void 0)})}}je.d(lr,{Z:()=>De})}},Gs=>{Gs(Gs.s=749)}]);
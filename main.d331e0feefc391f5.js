"use strict";(self.webpackChunkplease_take_your_turn=self.webpackChunkplease_take_your_turn||[]).push([[179],{58:(zr,fi,et)=>{et.d(fi,{BH:()=>Wr,DV:()=>k,Dv:()=>gn,G6:()=>Qo,GJ:()=>Jo,L:()=>Dt,LL:()=>ys,Pz:()=>$e,Sg:()=>ka,UG:()=>Tn,UI:()=>X,US:()=>Bt,Wj:()=>bi,Wl:()=>lu,Yr:()=>Yo,ZB:()=>Me,ZR:()=>uo,aH:()=>Hn,b$:()=>hr,cI:()=>ho,dS:()=>ih,eu:()=>Wi,g5:()=>j,gK:()=>pr,gQ:()=>Q,h$:()=>si,hl:()=>Fa,hu:()=>Be,jU:()=>Qe,lb:()=>Xo,m9:()=>cu,ne:()=>Ht,p$:()=>re,pd:()=>In,r3:()=>N,ru:()=>Sr,tV:()=>$,uI:()=>Gn,ug:()=>Bl,vZ:()=>he,w1:()=>Zo,w9:()=>La,xO:()=>Pt,xb:()=>H,z$:()=>ot,zd:()=>tt});const D={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},Be=function(A,C){if(!A)throw j(C)},j=function(A){return new Error("Firebase Database ("+D.SDK_VERSION+") INTERNAL ASSERT FAILED: "+A)},ze=function(A){const C=[];let x=0;for(let G=0;G<A.length;G++){let V=A.charCodeAt(G);V<128?C[x++]=V:V<2048?(C[x++]=V>>6|192,C[x++]=63&V|128):55296==(64512&V)&&G+1<A.length&&56320==(64512&A.charCodeAt(G+1))?(V=65536+((1023&V)<<10)+(1023&A.charCodeAt(++G)),C[x++]=V>>18|240,C[x++]=V>>12&63|128,C[x++]=V>>6&63|128,C[x++]=63&V|128):(C[x++]=V>>12|224,C[x++]=V>>6&63|128,C[x++]=63&V|128)}return C},Bt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(A,C){if(!Array.isArray(A))throw Error("encodeByteArray takes an array as a parameter");this.init_();const x=C?this.byteToCharMapWebSafe_:this.byteToCharMap_,G=[];for(let V=0;V<A.length;V+=3){const Re=A[V],ge=V+1<A.length,Ie=ge?A[V+1]:0,oi=V+2<A.length,ai=oi?A[V+2]:0;let J=(15&Ie)<<2|ai>>6,vs=63&ai;oi||(vs=64,ge||(J=64)),G.push(x[Re>>2],x[(3&Re)<<4|Ie>>4],x[J],x[vs])}return G.join("")},encodeString(A,C){return this.HAS_NATIVE_SUPPORT&&!C?btoa(A):this.encodeByteArray(ze(A),C)},decodeString(A,C){return this.HAS_NATIVE_SUPPORT&&!C?atob(A):function(A){const C=[];let x=0,G=0;for(;x<A.length;){const V=A[x++];if(V<128)C[G++]=String.fromCharCode(V);else if(V>191&&V<224){const Re=A[x++];C[G++]=String.fromCharCode((31&V)<<6|63&Re)}else if(V>239&&V<365){const oi=((7&V)<<18|(63&A[x++])<<12|(63&A[x++])<<6|63&A[x++])-65536;C[G++]=String.fromCharCode(55296+(oi>>10)),C[G++]=String.fromCharCode(56320+(1023&oi))}else{const Re=A[x++],ge=A[x++];C[G++]=String.fromCharCode((15&V)<<12|(63&Re)<<6|63&ge)}}return C.join("")}(this.decodeStringToByteArray(A,C))},decodeStringToByteArray(A,C){this.init_();const x=C?this.charToByteMapWebSafe_:this.charToByteMap_,G=[];for(let V=0;V<A.length;){const Re=x[A.charAt(V++)],Ie=V<A.length?x[A.charAt(V)]:0;++V;const ai=V<A.length?x[A.charAt(V)]:64;++V;const St=V<A.length?x[A.charAt(V)]:64;if(++V,null==Re||null==Ie||null==ai||null==St)throw new On;G.push(Re<<2|Ie>>4),64!==ai&&(G.push(Ie<<4&240|ai>>2),64!==St&&G.push(ai<<6&192|St))}return G},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let A=0;A<this.ENCODED_VALS.length;A++)this.byteToCharMap_[A]=this.ENCODED_VALS.charAt(A),this.charToByteMap_[this.byteToCharMap_[A]]=A,this.byteToCharMapWebSafe_[A]=this.ENCODED_VALS_WEBSAFE.charAt(A),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[A]]=A,A>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(A)]=A,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(A)]=A)}}};class On extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const si=function(A){const C=ze(A);return Bt.encodeByteArray(C,!0)},Dt=function(A){return si(A).replace(/\./g,"")},$=function(A){try{return Bt.decodeString(A,!0)}catch(C){console.error("base64Decode failed: ",C)}return null};function re(A){return Me(void 0,A)}function Me(A,C){if(!(C instanceof Object))return C;switch(C.constructor){case Date:return new Date(C.getTime());case Object:void 0===A&&(A={});break;case Array:A=[];break;default:return C}for(const x in C)!C.hasOwnProperty(x)||!mt(x)||(A[x]=Me(A[x],C[x]));return A}function mt(A){return"__proto__"!==A}const Ye=()=>{try{return function xe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const A=process.env.__FIREBASE_DEFAULTS__;return A?JSON.parse(A):void 0})()||(()=>{if(typeof document>"u")return;let A;try{A=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const C=A&&$(A[1]);return C&&JSON.parse(C)})()}catch(A){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${A}`)}},Hn=()=>{var A;return null===(A=Ye())||void 0===A?void 0:A.config},$e=A=>{var C;return null===(C=Ye())||void 0===C?void 0:C[`_${A}`]};class Wr{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((C,x)=>{this.resolve=C,this.reject=x})}wrapCallback(C){return(x,G)=>{x?this.reject(x):this.resolve(G),"function"==typeof C&&(this.promise.catch(()=>{}),1===C.length?C(x):C(x,G))}}}function ka(A,C){if(A.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const G=C||"demo-project",V=A.iat||0,Re=A.sub||A.user_id;if(!Re)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const ge=Object.assign({iss:`https://securetoken.google.com/${G}`,aud:G,iat:V,exp:V+3600,auth_time:V,sub:Re,user_id:Re,firebase:{sign_in_provider:"custom",identities:{}}},A);return[Dt(JSON.stringify({alg:"none",type:"JWT"})),Dt(JSON.stringify(ge)),""].join(".")}function ot(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Gn(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ot())}function Tn(){var A;const C=null===(A=Ye())||void 0===A?void 0:A.forceEnvironment;if("node"===C)return!0;if("browser"===C)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function Qe(){return"object"==typeof self&&self.self===self}function Sr(){const A="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof A&&void 0!==A.id}function hr(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Zo(){const A=ot();return A.indexOf("MSIE ")>=0||A.indexOf("Trident/")>=0}function Yo(){return!0===D.NODE_CLIENT||!0===D.NODE_ADMIN}function Qo(){return!Tn()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Fa(){try{return"object"==typeof indexedDB}catch{return!1}}function Wi(){return new Promise((A,C)=>{try{let x=!0;const G="validate-browser-context-for-indexeddb-analytics-module",V=self.indexedDB.open(G);V.onsuccess=()=>{V.result.close(),x||self.indexedDB.deleteDatabase(G),A(!0)},V.onupgradeneeded=()=>{x=!1},V.onerror=()=>{var Re;C((null===(Re=V.error)||void 0===Re?void 0:Re.message)||"")}}catch(x){C(x)}})}class uo extends Error{constructor(C,x,G){super(x),this.code=C,this.customData=G,this.name="FirebaseError",Object.setPrototypeOf(this,uo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ys.prototype.create)}}class ys{constructor(C,x,G){this.service=C,this.serviceName=x,this.errors=G}create(C,...x){const G=x[0]||{},V=`${this.service}/${C}`,Re=this.errors[C],ge=Re?function Ll(A,C){return A.replace(fr,(x,G)=>{const V=C[G];return null!=V?String(V):`<${G}?>`})}(Re,G):"Error";return new uo(V,`${this.serviceName}: ${ge} (${V}).`,G)}}const fr=/\{\$([^}]+)}/g;function ho(A){return JSON.parse(A)}function lu(A){return JSON.stringify(A)}const Pi=function(A){let C={},x={},G={},V="";try{const Re=A.split(".");C=ho($(Re[0])||""),x=ho($(Re[1])||""),V=Re[2],G=x.d||{},delete x.d}catch{}return{header:C,claims:x,data:G,signature:V}},La=function(A){const x=Pi(A).claims;return!!x&&"object"==typeof x&&x.hasOwnProperty("iat")},Jo=function(A){const C=Pi(A).claims;return"object"==typeof C&&!0===C.admin};function N(A,C){return Object.prototype.hasOwnProperty.call(A,C)}function k(A,C){if(Object.prototype.hasOwnProperty.call(A,C))return A[C]}function H(A){for(const C in A)if(Object.prototype.hasOwnProperty.call(A,C))return!1;return!0}function X(A,C,x){const G={};for(const V in A)Object.prototype.hasOwnProperty.call(A,V)&&(G[V]=C.call(x,A[V],V,A));return G}function he(A,C){if(A===C)return!0;const x=Object.keys(A),G=Object.keys(C);for(const V of x){if(!G.includes(V))return!1;const Re=A[V],ge=C[V];if(se(Re)&&se(ge)){if(!he(Re,ge))return!1}else if(Re!==ge)return!1}for(const V of G)if(!x.includes(V))return!1;return!0}function se(A){return null!==A&&"object"==typeof A}function Pt(A){const C=[];for(const[x,G]of Object.entries(A))Array.isArray(G)?G.forEach(V=>{C.push(encodeURIComponent(x)+"="+encodeURIComponent(V))}):C.push(encodeURIComponent(x)+"="+encodeURIComponent(G));return C.length?"&"+C.join("&"):""}function tt(A){const C={};return A.replace(/^\?/,"").split("&").forEach(G=>{if(G){const[V,Re]=G.split("=");C[decodeURIComponent(V)]=decodeURIComponent(Re)}}),C}function In(A){const C=A.indexOf("?");if(!C)return"";const x=A.indexOf("#",C);return A.substring(C,x>0?x:void 0)}class Q{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let C=1;C<this.blockSize;++C)this.pad_[C]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(C,x){x||(x=0);const G=this.W_;if("string"==typeof C)for(let St=0;St<16;St++)G[St]=C.charCodeAt(x)<<24|C.charCodeAt(x+1)<<16|C.charCodeAt(x+2)<<8|C.charCodeAt(x+3),x+=4;else for(let St=0;St<16;St++)G[St]=C[x]<<24|C[x+1]<<16|C[x+2]<<8|C[x+3],x+=4;for(let St=16;St<80;St++){const J=G[St-3]^G[St-8]^G[St-14]^G[St-16];G[St]=4294967295&(J<<1|J>>>31)}let ai,Ar,V=this.chain_[0],Re=this.chain_[1],ge=this.chain_[2],Ie=this.chain_[3],oi=this.chain_[4];for(let St=0;St<80;St++){St<40?St<20?(ai=Ie^Re&(ge^Ie),Ar=1518500249):(ai=Re^ge^Ie,Ar=1859775393):St<60?(ai=Re&ge|Ie&(Re|ge),Ar=2400959708):(ai=Re^ge^Ie,Ar=3395469782);const J=(V<<5|V>>>27)+ai+oi+Ar+G[St]&4294967295;oi=Ie,Ie=ge,ge=4294967295&(Re<<30|Re>>>2),Re=V,V=J}this.chain_[0]=this.chain_[0]+V&4294967295,this.chain_[1]=this.chain_[1]+Re&4294967295,this.chain_[2]=this.chain_[2]+ge&4294967295,this.chain_[3]=this.chain_[3]+Ie&4294967295,this.chain_[4]=this.chain_[4]+oi&4294967295}update(C,x){if(null==C)return;void 0===x&&(x=C.length);const G=x-this.blockSize;let V=0;const Re=this.buf_;let ge=this.inbuf_;for(;V<x;){if(0===ge)for(;V<=G;)this.compress_(C,V),V+=this.blockSize;if("string"==typeof C){for(;V<x;)if(Re[ge]=C.charCodeAt(V),++ge,++V,ge===this.blockSize){this.compress_(Re),ge=0;break}}else for(;V<x;)if(Re[ge]=C[V],++ge,++V,ge===this.blockSize){this.compress_(Re),ge=0;break}}this.inbuf_=ge,this.total_+=x}digest(){const C=[];let x=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let V=this.blockSize-1;V>=56;V--)this.buf_[V]=255&x,x/=256;this.compress_(this.buf_);let G=0;for(let V=0;V<5;V++)for(let Re=24;Re>=0;Re-=8)C[G]=this.chain_[V]>>Re&255,++G;return C}}function Ht(A,C){const x=new cn(A,C);return x.subscribe.bind(x)}class cn{constructor(C,x){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=x,this.task.then(()=>{C(this)}).catch(G=>{this.error(G)})}next(C){this.forEachObserver(x=>{x.next(C)})}error(C){this.forEachObserver(x=>{x.error(C)}),this.close(C)}complete(){this.forEachObserver(C=>{C.complete()}),this.close()}subscribe(C,x,G){let V;if(void 0===C&&void 0===x&&void 0===G)throw new Error("Missing Observer.");V=function ye(A,C){if("object"!=typeof A||null===A)return!1;for(const x of C)if(x in A&&"function"==typeof A[x])return!0;return!1}(C,["next","error","complete"])?C:{next:C,error:x,complete:G},void 0===V.next&&(V.next=vi),void 0===V.error&&(V.error=vi),void 0===V.complete&&(V.complete=vi);const Re=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?V.error(this.finalError):V.complete()}catch{}}),this.observers.push(V),Re}unsubscribeOne(C){void 0===this.observers||void 0===this.observers[C]||(delete this.observers[C],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(C){if(!this.finalized)for(let x=0;x<this.observers.length;x++)this.sendOne(x,C)}sendOne(C,x){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[C])try{x(this.observers[C])}catch(G){typeof console<"u"&&console.error&&console.error(G)}})}close(C){this.finalized||(this.finalized=!0,void 0!==C&&(this.finalError=C),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function vi(){}const gn=function(A,C,x,G){let V;if(G<C?V="at least "+C:G>x&&(V=0===x?"none":"no more than "+x),V)throw new Error(A+" failed: Was called with "+G+(1===G?" argument.":" arguments.")+" Expects "+V+".")};function pr(A,C){return`${A} failed: ${C} argument `}function bi(A,C,x,G){if((!G||x)&&"function"!=typeof x)throw new Error(pr(A,C)+"must be a valid function.")}function Xo(A,C,x,G){if((!G||x)&&("object"!=typeof x||null===x))throw new Error(pr(A,C)+"must be a valid context object.")}const ih=function(A){const C=[];let x=0;for(let G=0;G<A.length;G++){let V=A.charCodeAt(G);if(V>=55296&&V<=56319){const Re=V-55296;G++,Be(G<A.length,"Surrogate pair missing trail surrogate."),V=65536+(Re<<10)+(A.charCodeAt(G)-56320)}V<128?C[x++]=V:V<2048?(C[x++]=V>>6|192,C[x++]=63&V|128):V<65536?(C[x++]=V>>12|224,C[x++]=V>>6&63|128,C[x++]=63&V|128):(C[x++]=V>>18|240,C[x++]=V>>12&63|128,C[x++]=V>>6&63|128,C[x++]=63&V|128)}return C},Bl=function(A){let C=0;for(let x=0;x<A.length;x++){const G=A.charCodeAt(x);G<128?C++:G<2048?C+=2:G>=55296&&G<=56319?(C+=4,x++):C+=3}return C};function cu(A){return A&&A._delegate?A._delegate:A}},357:(zr,fi,et)=>{function D(n){return"function"==typeof n}let Be=!1;const j={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){if(n){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else Be&&console.log("RxJS: Back to a better error behavior. Thank you. <3");Be=n},get useDeprecatedSynchronousErrorHandling(){return Be}};function ze(n){setTimeout(()=>{throw n},0)}const rn={closed:!0,next(n){},error(n){if(j.useDeprecatedSynchronousErrorHandling)throw n;ze(n)},complete(){}},Bt=Array.isArray||(n=>n&&"number"==typeof n.length);function On(n){return null!==n&&"object"==typeof n}const Dt=(()=>{function n(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((t,i)=>`${i+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return n.prototype=Object.create(Error.prototype),n})();class ${constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:t,_ctorUnsubscribe:i,_unsubscribe:r,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,t instanceof $)t.remove(this);else if(null!==t)for(let o=0;o<t.length;++o)t[o].remove(this);if(D(r)){i&&(this._unsubscribe=void 0);try{r.call(this)}catch(o){e=o instanceof Dt?re(o.errors):[o]}}if(Bt(s)){let o=-1,a=s.length;for(;++o<a;){const l=s[o];if(On(l))try{l.unsubscribe()}catch(u){e=e||[],u instanceof Dt?e=e.concat(re(u.errors)):e.push(u)}}}if(e)throw new Dt(e)}add(e){let t=e;if(!e)return $.EMPTY;switch(typeof e){case"function":t=new $(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof $)){const s=t;t=new $,t._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=t;if(null===i)t._parentOrParents=this;else if(i instanceof $){if(i===this)return t;t._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return t;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[t]:r.push(t),t}remove(e){const t=this._subscriptions;if(t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}var n;function re(n){return n.reduce((e,t)=>e.concat(t instanceof Dt?t.errors:t),[])}$.EMPTY=((n=new $).closed=!0,n);const Me="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class xe extends ${constructor(e,t,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=rn;break;case 1:if(!e){this.destination=rn;break}if("object"==typeof e){e instanceof xe?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new $n(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new $n(this,e,t,i)}}[Me](){return this}static create(e,t,i){const r=new xe(e,t,i);return r.syncErrorThrowable=!1,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class $n extends xe{constructor(e,t,i,r){super(),this._parentSubscriber=e;let s,o=this;D(t)?s=t:t&&(s=t.next,i=t.error,r=t.complete,t!==rn&&(o=Object.create(t),D(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=i,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;j.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:i}=j;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):ze(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;ze(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);j.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),j.useDeprecatedSynchronousErrorHandling)throw i;ze(i)}}__tryOrSetError(e,t,i){if(!j.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(r){return j.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(ze(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const Ye="function"==typeof Symbol&&Symbol.observable||"@@observable";function Yn(n){return n}function Hn(n){return 0===n.length?Yn:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let $e=(()=>{class n{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const{operator:s}=this,o=function ut(n,e,t){if(n){if(n instanceof xe)return n;if(n[Me])return n[Me]()}return n||e||t?new xe(n,e,t):new xe(rn)}(t,i,r);if(o.add(s?s.call(o,this.source):this.source||j.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),j.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){j.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=i),function Qt(n){for(;n;){const{closed:e,destination:t,isStopped:i}=n;if(e||i)return!1;n=t&&t instanceof xe?t:null}return!0}(t)?t.error(i):console.warn(i)}}forEach(t,i){return new(i=Wr(i))((r,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),o&&o.unsubscribe()}},s,r)})}_subscribe(t){const{source:i}=this;return i&&i.subscribe(t)}[Ye](){return this}pipe(...t){return 0===t.length?this:Hn(t)(this)}toPromise(t){return new(t=Wr(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function Wr(n){if(n||(n=j.Promise||Promise),!n)throw new Error("no Promise impl found");return n}const ot=(()=>{function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n})();class Gn extends ${constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}class Tn extends xe{constructor(e){super(e),this.destination=e}}let Qe=(()=>{class n extends $e{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[Me](){return new Tn(this)}lift(t){const i=new Sr(this,this);return i.operator=t,i}next(t){if(this.closed)throw new ot;if(!this.isStopped){const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].next(t)}}error(t){if(this.closed)throw new ot;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].error(t);this.observers.length=0}complete(){if(this.closed)throw new ot;this.isStopped=!0;const{observers:t}=this,i=t.length,r=t.slice();for(let s=0;s<i;s++)r[s].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new ot;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new ot;return this.hasError?(t.error(this.thrownError),$.EMPTY):this.isStopped?(t.complete(),$.EMPTY):(this.observers.push(t),new Gn(this,t))}asObservable(){const t=new $e;return t.source=this,t}}return n.create=(e,t)=>new Sr(e,t),n})();class Sr extends Qe{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):$.EMPTY}}function hr(n){return n&&"function"==typeof n.schedule}function Ne(n,e){return function(i){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new Zo(n,e))}}class Zo{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new qr(e,this.project,this.thisArg))}}class qr extends xe{constructor(e,t,i){super(e),this.project=t,this.count=0,this.thisArg=i||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const Yo=n=>e=>{for(let t=0,i=n.length;t<i&&!e.closed;t++)e.next(n[t]);e.complete()},Wi=function Fa(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}(),ys=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Ll(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}const fr=n=>{if(n&&"function"==typeof n[Ye])return(n=>e=>{const t=n[Ye]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)})(n);if(ys(n))return Yo(n);if(Ll(n))return(n=>e=>(n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,ze),e))(n);if(n&&"function"==typeof n[Wi])return(n=>e=>{const t=n[Wi]();for(;;){let i;try{i=t.next()}catch(r){return e.error(r),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof t.return&&e.add(()=>{t.return&&t.return()}),e})(n);{const t=`You provided ${On(n)?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(t)}};function Pi(n,e){return new $e(t=>{const i=new $;let r=0;return i.add(e.schedule(function(){r!==n.length?(t.next(n[r++]),t.closed||i.add(this.schedule())):t.complete()})),i})}function N(n,e){return e?function Jo(n,e){if(null!=n){if(function fo(n){return n&&"function"==typeof n[Ye]}(n))return function ho(n,e){return new $e(t=>{const i=new $;return i.add(e.schedule(()=>{const r=n[Ye]();i.add(r.subscribe({next(s){i.add(e.schedule(()=>t.next(s)))},error(s){i.add(e.schedule(()=>t.error(s)))},complete(){i.add(e.schedule(()=>t.complete()))}}))})),i})}(n,e);if(Ll(n))return function lu(n,e){return new $e(t=>{const i=new $;return i.add(e.schedule(()=>n.then(r=>{i.add(e.schedule(()=>{t.next(r),i.add(e.schedule(()=>t.complete()))}))},r=>{i.add(e.schedule(()=>t.error(r)))}))),i})}(n,e);if(ys(n))return Pi(n,e);if(function La(n){return n&&"function"==typeof n[Wi]}(n)||"string"==typeof n)return function Vl(n,e){if(!n)throw new Error("Iterable cannot be null");return new $e(t=>{const i=new $;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=n[Wi](),i.add(e.schedule(function(){if(t.closed)return;let s,o;try{const a=r.next();s=a.value,o=a.done}catch(a){return void t.error(a)}o?t.complete():(t.next(s),this.schedule())}))})),i})}(n,e)}throw new TypeError((null!==n&&typeof n||n)+" is not observable")}(n,e):n instanceof $e?n:new $e(fr(n))}class k extends xe{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class X extends xe{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function se(n,e){if(e.closed)return;if(n instanceof $e)return n.subscribe(e);let t;try{t=fr(n)(e)}catch(i){e.error(i)}return t}function Ue(n,e,t=Number.POSITIVE_INFINITY){return"function"==typeof e?i=>i.pipe(Ue((r,s)=>N(n(r,s)).pipe(Ne((o,a)=>e(r,o,s,a))),t)):("number"==typeof e&&(t=e),i=>i.lift(new Pt(n,t)))}class Pt{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new tt(e,this.project,this.concurrent))}}class tt extends X{constructor(e,t,i=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t)}_innerSub(e){const t=new k(this),i=this.destination;i.add(t);const r=se(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function Q(n=Number.POSITIVE_INFINITY){return Ue(Yn,n)}function Ht(n,e){return e?Pi(n,e):new $e(Yo(n))}function cn(...n){let e=Number.POSITIVE_INFINITY,t=null,i=n[n.length-1];return hr(i)?(t=n.pop(),n.length>1&&"number"==typeof n[n.length-1]&&(e=n.pop())):"number"==typeof i&&(e=n.pop()),null===t&&1===n.length&&n[0]instanceof $e?n[0]:Q(e)(Ht(n,t))}class un extends Qe{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new ot;return this._value}next(e){super.next(this._value=e)}}function ye(...n){let e=n[n.length-1];return hr(e)?(n.pop(),Pi(n,e)):Ht(n)}function vi(){return function(e){return e.lift(new gn(e))}}class gn{constructor(e){this.connectable=e}call(e,t){const{connectable:i}=this;i._refCount++;const r=new pr(e,i),s=t.subscribe(r);return r.closed||(r.connection=i.connect()),s}}class pr extends xe{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:i}=this,r=e._connection;this.connection=null,r&&(!i||r===i)&&r.unsubscribe()}}class Kr extends $e{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new $,e.add(this.source.subscribe(new Xo(this.getSubject(),this))),e.closed&&(this._connection=null,e=$.EMPTY)),e}refCount(){return vi()(this)}}const bi=(()=>{const n=Kr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:n._subscribe},_isComplete:{value:n._isComplete,writable:!0},getSubject:{value:n.getSubject},connect:{value:n.connect},refCount:{value:n.refCount}}})();class Xo extends Tn{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}class Ut{constructor(e,t){this.subjectFactory=e,this.selector=t}call(e,t){const{selector:i}=this,r=this.subjectFactory(),s=i(r).subscribe(e);return s.add(t.subscribe(r)),s}}function Va(){return new Qe}function Bs(){return n=>vi()(function Gt(n,e){return function(i){let r;if(r="function"==typeof n?n:function(){return n},"function"==typeof e)return i.lift(new Ut(r,e));const s=Object.create(i,bi);return s.source=i,s.subjectFactory=r,s}}(Va)(n))}function Ot(n,e){return"function"==typeof e?t=>t.pipe(Ot((i,r)=>N(n(i,r)).pipe(Ne((s,o)=>e(i,s,r,o))))):t=>t.lift(new Zr(n))}class Zr{constructor(e){this.project=e}call(e,t){return t.subscribe(new Ul(e,this.project))}}class Ul extends X{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const i=new k(this),r=this.destination;r.add(i),this.innerSubscription=se(e,i),this.innerSubscription!==i&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;(!e||e.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}function po(n,e){return t=>t.lift(new cu(n,e))}class cu{constructor(e,t){this.compare=e,this.keySelector=t}call(e,t){return t.subscribe(new A(e,this.compare,this.keySelector))}}class A extends xe{constructor(e,t,i){super(e),this.keySelector=i,this.hasKey=!1,"function"==typeof t&&(this.compare=t)}compare(e,t){return e===t}_next(e){let t;try{const{keySelector:r}=this;t=r?r(e):e}catch(r){return this.destination.error(r)}let i=!1;if(this.hasKey)try{const{compare:r}=this;i=r(this.key,t)}catch(r){return this.destination.error(r)}else this.hasKey=!0;i||(this.key=t,this.destination.next(e))}}function C(n){for(let e in n)if(n[e]===C)return e;throw Error("Could not find renamed property on target object.")}function x(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function G(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(G).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function V(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const Re=C({__forward_ref__:C});function ge(n){return n.__forward_ref__=ge,n.toString=function(){return G(this())},n}function Ie(n){return oi(n)?n():n}function oi(n){return"function"==typeof n&&n.hasOwnProperty(Re)&&n.__forward_ref__===ge}function ai(n){return n&&!!n.\u0275providers}const St="https://g.co/ng/security#xss";class J extends Error{constructor(e,t){super(function vs(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function je(n){return"string"==typeof n?n:null==n?"":String(n)}function Se(n,e){throw new J(-201,!1)}function Yr(n,e){null==n&&function He(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function oe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ht(n){return{providers:n.providers||[],imports:n.imports||[]}}function Oi(n){return Ba(n,du)||Ba(n,ah)}function Ba(n,e){return n.hasOwnProperty(e)?n[e]:null}function go(n){return n&&(n.hasOwnProperty(oh)||n.hasOwnProperty(Nv))?n[oh]:null}const du=C({\u0275prov:C}),oh=C({\u0275inj:C}),ah=C({ngInjectableDef:C}),Nv=C({ngInjectorDef:C});var ft=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ft||{});let ja;function qi(n){const e=ja;return ja=n,e}function $a(n,e,t){const i=Oi(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&ft.Optional?null:void 0!==e?e:void Se(G(n))}const sn=globalThis;class me{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=oe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const $l={},_g="__NG_DI_FLAG__",ch="ngTempTokenPath",Ov=/\n/gm,uh="__source";let Us;function ta(n){const e=Us;return Us=n,e}function vg(n,e=ft.Default){if(void 0===Us)throw new J(-203,!1);return null===Us?$a(n,void 0,e):Us.get(n,e&ft.Optional?null:void 0,e)}function W(n,e=ft.Default){return(function pg(){return ja}()||vg)(Ie(n),e)}function ve(n,e=ft.Default){return W(n,fu(e))}function fu(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function bg(n){const e=[];for(let t=0;t<n.length;t++){const i=Ie(n[t]);if(Array.isArray(i)){if(0===i.length)throw new J(900,!1);let r,s=ft.Default;for(let o=0;o<i.length;o++){const a=i[o],l=HI(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(W(r,s))}else e.push(W(i))}return e}function Hl(n,e){return n[_g]=e,n.prototype[_g]=e,n}function HI(n){return n[_g]}function bs(n){return{toString:n}.toString()}var dh=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(dh||{}),Rr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Rr||{});const js={},At=[],hh=C({\u0275cmp:C}),pu=C({\u0275dir:C}),Eg=C({\u0275pipe:C}),fh=C({\u0275mod:C}),Qr=C({\u0275fac:C}),Ha=C({__NG_ELEMENT_ID__:C}),Lv=C({__NG_ENV_ID__:C});function ph(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function wg(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];Vv(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function gh(n){return 3===n||4===n||6===n}function Vv(n){return 64===n.charCodeAt(0)}function Ga(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||Bv(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function Bv(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const mh="ng-template";function GI(n,e,t){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const o=n[i++];if(t&&"class"===s&&-1!==ph(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function _h(n){return 4===n.type&&n.value!==mh}function zI(n,e,t){return e===(4!==n.type||t?n.value:mh)}function Tg(n,e,t){let i=4;const r=n.attrs||[],s=function $s(n){for(let e=0;e<n.length;e++)if(gh(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!zI(n,l,t)||""===l&&1===e.length){if(Ki(i))return!1;o=!0}}else{const u=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!GI(n.attrs,u,t)){if(Ki(i))return!1;o=!0}continue}const g=mo(8&i?"class":l,r,_h(n),t);if(-1===g){if(Ki(i))return!1;o=!0;continue}if(""!==u){let m;m=g>s?"":r[g+1].toLowerCase();const y=8&i?m:null;if(y&&-1!==ph(y,u,0)||2&i&&u!==m){if(Ki(i))return!1;o=!0}}}}else{if(!o&&!Ki(i)&&!Ki(l))return!1;if(o&&Ki(l))continue;o=!1,i=l|1&i}}return Ki(i)||o}function Ki(n){return 0==(1&n)}function mo(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function qI(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function yh(n,e,t=!1){for(let i=0;i<e.length;i++)if(Tg(n,e[i],t))return!0;return!1}function Ig(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function Uv(n,e){return n?":not("+e.trim()+")":e}function Cg(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Ki(o)&&(e+=Uv(s,r),r=""),i=o,s=s||!Ki(i);t++}return""!==r&&(e+=Uv(s,r)),e}function gr(n){return bs(()=>{const e=Ag(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===dh.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Rr.Emulated,styles:n.styles||At,_:null,schemas:n.schemas||null,tView:null,id:""};jv(t);const i=n.dependencies;return t.directiveDefs=_o(i,!1),t.pipeDefs=_o(i,!0),t.id=function vh(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function Sg(n){return nt(n)||Mn(n)}function za(n){return null!==n}function yt(n){return bs(()=>({type:n.type,bootstrap:n.bootstrap||At,declarations:n.declarations||At,imports:n.imports||At,exports:n.exports||At,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function zl(n,e){if(null==n)return js;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}function _e(n){return bs(()=>{const e=Ag(n);return jv(e),e})}function nt(n){return n[hh]||null}function Mn(n){return n[pu]||null}function Jn(n){return n[Eg]||null}function mr(n,e){const t=n[fh]||null;if(!t&&!0===e)throw new Error(`Type ${G(n)} does not have '\u0275mod' property.`);return t}function Ag(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||js,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||At,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:zl(n.inputs,e),outputs:zl(n.outputs)}}function jv(n){n.features?.forEach(e=>e(n))}function _o(n,e){if(!n)return null;const t=e?Jn:Sg;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(za)}const Cn=0,Te=1,Ke=2,Et=3,Jr=4,gu=5,pi=6,yo=7,kn=8,vo=9,Wl=10,qe=11,qa=12,bh=13,bo=14,Dn=15,ql=16,na=17,Es=18,Ka=19,mu=20,Hs=21,Gs=22,Za=23,Kl=24,dt=25,_u=1,$v=2,Xr=7,ra=9,Xn=11;function ki(n){return Array.isArray(n)&&"object"==typeof n[_u]}function Zi(n){return Array.isArray(n)&&!0===n[_u]}function yu(n){return 0!=(4&n.flags)}function Qa(n){return n.componentOffset>-1}function Zl(n){return 1==(1&n.flags)}function ws(n){return!!n.template}function vu(n){return 0!=(512&n[Ke])}function Ja(n,e){return n.hasOwnProperty(Qr)?n[Qr]:null}let gi=null,Yl=!1;function es(n){const e=gi;return gi=n,e}const Xa={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function Xv(n){if(!bu(n)||n.dirty){if(!n.producerMustRecompute(n)&&!XI(n))return void(n.dirty=!1);n.producerRecomputeValue(n),n.dirty=!1}}function t0(n){n.dirty=!0,function e0(n){if(void 0===n.liveConsumerNode)return;const e=Yl;Yl=!0;try{for(const t of n.liveConsumerNode)t.dirty||t0(t)}finally{Yl=e}}(n),n.consumerMarkedDirty?.(n)}function Og(n){return n&&(n.nextProducerIndex=0),es(n)}function n0(n,e){if(es(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(bu(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Th(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function XI(n){Eu(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(Xv(t),i!==t.version))return!0}return!1}function eC(n){if(Eu(n),bu(n))for(let e=0;e<n.producerNode.length;e++)Th(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function Th(n,e){if(function tC(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),Eu(n),1===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)Th(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];Eu(r),r.producerIndexOfThis[i]=e}}function bu(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Eu(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let Ih=null;const o0=()=>{},cM=(()=>({...Xa,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule(n.ref)},hasRun:!1,cleanupFn:o0}))();class uM{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function dn(){return a0}function a0(n){return n.type.prototype.ngOnChanges&&(n.setInput=wu),oC}function oC(){const n=zn(this),e=n?.current;if(e){const t=n.previous;if(t===js)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function wu(n,e,t,i){const r=this.declaredInputs[t],s=zn(n)||function aC(n,e){return n[l0]=e}(n,{previous:js,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new uM(l&&l.currentValue,e,a===js),n[i]=e}dn.ngInherit=!0;const l0="__ngSimpleChanges__";function zn(n){return n[l0]||null}const ts=function(n,e,t){};function Xt(n){for(;Array.isArray(n);)n=n[Cn];return n}function el(n,e){return Xt(e[n])}function Yi(n,e){return Xt(e[n.index])}function Cu(n,e){return n.data[e]}function Qi(n,e){const t=e[n];return ki(t)?t:t[Cn]}function Ws(n,e){return null==e?null:n[e]}function Ug(n){n[na]=0}function uC(n){1024&n[Ke]||(n[Ke]|=1024,dC(n,1))}function h0(n){1024&n[Ke]&&(n[Ke]&=-1025,dC(n,-1))}function dC(n,e){let t=n[Et];if(null===t)return;t[gu]+=e;let i=t;for(t=t[Et];null!==t&&(1===e&&1===i[gu]||-1===e&&0===i[gu]);)t[gu]+=e,i=t,t=t[Et]}const We={lFrame:Ph(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function p0(){return We.bindingsEnabled}function Xl(){return null!==We.skipHydrationRootTNode}function ee(){return We.lFrame.lView}function wt(){return We.lFrame.tView}function Rt(n){return We.lFrame.contextLView=n,n[kn]}function Nt(n){return We.lFrame.contextLView=null,n}function Ei(){let n=Rh();for(;null!==n&&64===n.type;)n=n.parent;return n}function Rh(){return We.lFrame.currentTNode}function ns(n,e){const t=We.lFrame;t.currentTNode=n,t.isParent=e}function $g(){return We.lFrame.isParent}function Su(){We.lFrame.isParent=!1}function qs(){return We.lFrame.bindingIndex++}function Ji(n){const e=We.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function bC(n,e){const t=We.lFrame;t.bindingIndex=t.bindingRootIndex=n,Ru(e)}function Ru(n){We.lFrame.currentDirectiveIndex=n}function _0(){return We.lFrame.currentQueryIndex}function Gg(n){We.lFrame.currentQueryIndex=n}function zg(n){const e=n[Te];return 2===e.type?e.declTNode:1===e.type?n[pi]:null}function y0(n,e,t){if(t&ft.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&ft.Host||(r=zg(s),null===r||(s=s[bo],10&r.type))););if(null===r)return!1;e=r,n=s}const i=We.lFrame=v0();return i.currentTNode=e,i.lView=n,!0}function Nu(n){const e=v0(),t=n[Te];We.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function v0(){const n=We.lFrame,e=null===n?null:n.child;return null===e?Ph(n):e}function Ph(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Oh(){const n=We.lFrame;return We.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const b0=Oh;function nl(){const n=Oh();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Ti(){return We.lFrame.selectedIndex}function wo(n){We.lFrame.selectedIndex=n}function hn(){const n=We.lFrame;return Cu(n.tView,n.selectedIndex)}let I0=!0;function ec(){return I0}function sa(n){I0=n}function tc(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:u,ngOnDestroy:h}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),null!=h&&(n.destroyHooks??=[]).push(t,h)}}function Mh(n,e,t){C0(n,e,3,t)}function kh(n,e,t,i){(3&n[Ke])===t&&C0(n,e,t,i)}function xu(n,e){let t=n[Ke];(3&t)===e&&(t&=8191,t+=1,n[Ke]=t)}function C0(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[na]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[na]+=65536),(a<s||-1==s)&&(Lh(n,t,e,l),n[na]=(4294901760&n[na])+l+2),l++}function Fh(n,e){ts(4,n,e);const t=es(null);try{e.call(n)}finally{es(t),ts(5,n,e)}}function Lh(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[Ke]>>13<n[na]>>16&&(3&n[Ke])===e&&(n[Ke]+=8192,Fh(a,s)):Fh(a,s)}const oa=-1;class nc{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Kg(n){return n!==oa}function Pu(n){return 32767&n}function il(n,e){let t=function RC(n){return n>>16}(n),i=e;for(;t>0;)i=i[bo],t--;return i}let Zg=!0;function Bh(n){const e=Zg;return Zg=n,e}const A0=255,Ou=5;let xC=0;const Ks={};function Uh(n,e){const t=R0(n,e);if(-1!==t)return t;const i=e[Te];i.firstCreatePass&&(n.injectorIndex=e.length,Yg(i.data,n),Yg(e,null),Yg(i.blueprint,null));const r=jh(n,e),s=n.injectorIndex;if(Kg(r)){const o=Pu(r),a=il(r,e),l=a[Te].data;for(let u=0;u<8;u++)e[s+u]=a[o+u]|l[o+u]}return e[s+8]=r,s}function Yg(n,e){n.push(0,0,0,0,0,0,0,0,e)}function R0(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function jh(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=L0(r),null===i)return oa;if(t++,r=r[bo],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return oa}function Qg(n,e,t){!function PC(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Ha)&&(i=t[Ha]),null==i&&(i=t[Ha]=xC++);const r=i&A0;e.data[n+(r>>Ou)]|=1<<r}(n,e,t)}function N0(n,e,t){if(t&ft.Optional||void 0!==n)return n;Se()}function x0(n,e,t,i){if(t&ft.Optional&&void 0===i&&(i=null),!(t&(ft.Self|ft.Host))){const r=n[vo],s=qi(void 0);try{return r?r.get(e,i,t&ft.Optional):$a(e,i,t&ft.Optional)}finally{qi(s)}}return N0(i,0,t)}function P0(n,e,t,i=ft.Default,r){if(null!==n){if(2048&e[Ke]&&!(i&ft.Self)){const o=function F0(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[Ke]&&!(512&o[Ke]);){const a=O0(s,o,t,i|ft.Self,Ks);if(a!==Ks)return a;let l=s.parent;if(!l){const u=o[mu];if(u){const h=u.get(t,Ks,i);if(h!==Ks)return h}l=L0(o),o=o[bo]}s=l}return r}(n,e,t,i,Ks);if(o!==Ks)return o}const s=O0(n,e,t,i,Ks);if(s!==Ks)return s}return x0(e,t,i,r)}function O0(n,e,t,i,r){const s=function MC(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Ha)?n[Ha]:void 0;return"number"==typeof e?e>=0?e&A0:kC:e}(t);if("function"==typeof s){if(!y0(e,n,i))return i&ft.Host?N0(r,0,i):x0(e,t,i,r);try{let o;if(o=s(i),null!=o||i&ft.Optional)return o;Se()}finally{b0()}}else if("number"==typeof s){let o=null,a=R0(n,e),l=oa,u=i&ft.Host?e[Dn][pi]:null;for((-1===a||i&ft.SkipSelf)&&(l=-1===a?jh(n,e):e[a+8],l!==oa&&k0(i,!1)?(o=e[Te],a=Pu(l),e=il(l,e)):a=-1);-1!==a;){const h=e[Te];if(M0(s,a,h.data)){const g=OC(a,e,t,o,i,u);if(g!==Ks)return g}l=e[a+8],l!==oa&&k0(i,e[Te].data[a+8]===u)&&M0(s,a,e)?(o=h,a=Pu(l),e=il(l,e)):a=-1}}return r}function OC(n,e,t,i,r,s){const o=e[Te],a=o.data[n+8],h=Mu(a,o,t,null==i?Qa(a)&&Zg:i!=o&&0!=(3&a.type),r&ft.Host&&s===a);return null!==h?rl(e,o,h,a):Ks}function Mu(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,h=s>>20,m=r?a+h:n.directiveEnd;for(let y=i?a:a+h;y<m;y++){const b=o[y];if(y<l&&t===b||y>=l&&b.type===t)return y}if(r){const y=o[l];if(y&&ws(y)&&y.type===t)return l}return null}function rl(n,e,t,i){let r=n[t];const s=e.data;if(function qg(n){return n instanceof nc}(r)){const o=r;o.resolving&&function q(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new J(-200,`Circular dependency in DI detected for ${n}${t}`)}(function _t(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():je(n)}(s[t]));const a=Bh(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?qi(o.injectImpl):null;y0(n,i,ft.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function CC(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=a0(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==u&&qi(u),Bh(a),o.resolving=!1,b0()}}return r}function M0(n,e,t){return!!(t[e+(n>>Ou)]&1<<n)}function k0(n,e){return!(n&ft.Self||n&ft.Host&&e)}class Ii{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return P0(this._tNode,this._lView,e,fu(i),t)}}function kC(){return new Ii(Ei(),ee())}function Sn(n){return bs(()=>{const e=n.prototype.constructor,t=e[Qr]||em(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Qr]||em(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function em(n){return oi(n)?()=>{const e=em(Ie(n));return e&&e()}:Ja(n)}function L0(n){const e=n[Te],t=e.type;return 2===t?e.declTNode:1===t?n[pi]:null}function To(n){return function Jg(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(gh(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Ei(),n)}const Fu="__parameters__";function sl(n,e,t){return bs(()=>{const i=function rc(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,u,h){const g=l.hasOwnProperty(Fu)?l[Fu]:Object.defineProperty(l,Fu,{value:[]})[Fu];for(;g.length<=h;)g.push(null);return(g[h]=g[h]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function sc(n,e){n.forEach(t=>Array.isArray(t)?sc(t,e):e(t))}function $h(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Hh(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Bu(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function Nr(n,e,t){let i=al(n,e);return i>=0?n[1|i]=t:(i=~i,function UC(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function sm(n,e){const t=al(n,e);if(t>=0)return n[1|t]}function al(n,e){return function B0(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const oc=Hl(sl("Optional"),8),Wh=Hl(sl("SkipSelf"),4);function Jh(n){return 128==(128&n.flags)}var c=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(c||{});const d=/^>|^->|<!--|-->|--!>|<!-$/g,p=/(<|>)/g,_="\u200b$1\u200b";const I=new Map;let R=0;const Or="__ngContext__";function An(n,e){ki(e)?(n[Or]=e[Ka],function Z(n){I.set(n[Ka],n)}(e)):n[Or]=e}let e1;function t1(n,e){return e1(n,e)}function mm(n){const e=n[Et];return Zi(e)?e[Et]:e}function IM(n){return DM(n[qa])}function CM(n){return DM(n[Jr])}function DM(n){for(;null!==n&&!Zi(n);)n=n[Jr];return n}function tf(n,e,t,i,r){if(null!=i){let s,o=!1;Zi(i)?s=i:ki(i)&&(o=!0,i=i[Cn]);const a=Xt(i);0===n&&null!==t?null==r?NM(e,t,a):$u(e,t,a,r||null,!0):1===n&&null!==t?$u(e,t,a,r||null,!0):2===n?function ob(n,e,t){const i=rb(n,e);i&&function a9(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function u9(n,e,t,i,r){const s=t[Xr];s!==Xt(t)&&tf(e,n,i,s,r);for(let a=Xn;a<t.length;a++){const l=t[a];ym(l[Te],l,n,e,i,s)}}(e,n,s,t,r)}}function n1(n,e){return n.createComment(function v(n){return n.replace(d,e=>e.replace(p,_))}(e))}function nb(n,e,t){return n.createElement(e,t)}function AM(n,e){const t=n[ra],i=t.indexOf(e);h0(e),t.splice(i,1)}function ib(n,e){if(n.length<=Xn)return;const t=Xn+e,i=n[t];if(i){const r=i[ql];null!==r&&r!==n&&AM(r,i),e>0&&(n[t-1][Jr]=i[Jr]);const s=Hh(n,Xn+e);!function X6(n,e){ym(n,e,e[qe],2,null,null),e[Cn]=null,e[pi]=null}(i[Te],i);const o=s[Es];null!==o&&o.detachView(s[Te]),i[Et]=null,i[Jr]=null,i[Ke]&=-129}return i}function i1(n,e){if(!(256&e[Ke])){const t=e[qe];e[Za]&&eC(e[Za]),e[Kl]&&eC(e[Kl]),t.destroyNode&&ym(n,e,t,3,null,null),function n9(n){let e=n[qa];if(!e)return r1(n[Te],n);for(;e;){let t=null;if(ki(e))t=e[qa];else{const i=e[Xn];i&&(t=i)}if(!t){for(;e&&!e[Jr]&&e!==n;)ki(e)&&r1(e[Te],e),e=e[Et];null===e&&(e=n),ki(e)&&r1(e[Te],e),t=e&&e[Jr]}e=t}}(e)}}function r1(n,e){if(!(256&e[Ke])){e[Ke]&=-129,e[Ke]|=256,function o9(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof nc)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];ts(4,a,l);try{l.call(a)}finally{ts(5,a,l)}}else{ts(4,r,s);try{s.call(r)}finally{ts(5,r,s)}}}}}(n,e),function s9(n,e){const t=n.cleanup,i=e[yo];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[yo]=null);const r=e[Hs];if(null!==r){e[Hs]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[Te].type&&e[qe].destroy();const t=e[ql];if(null!==t&&Zi(e[Et])){t!==e[Et]&&AM(t,e);const i=e[Es];null!==i&&i.detachView(n)}!function fe(n){I.delete(n[Ka])}(e)}}function s1(n,e,t){return function RM(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[Cn];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Rr.None||s===Rr.Emulated)return null}return Yi(i,t)}}(n,e.parent,t)}function $u(n,e,t,i,r){n.insertBefore(e,t,i,r)}function NM(n,e,t){n.appendChild(e,t)}function xM(n,e,t,i,r){null!==i?$u(n,e,t,i,r):NM(n,e,t)}function rb(n,e){return n.parentNode(e)}function PM(n,e,t){return MM(n,e,t)}let o1,ab,u1,lb,MM=function OM(n,e,t){return 40&n.type?Yi(n,t):null};function sb(n,e,t,i){const r=s1(n,i,e),s=e[qe],a=PM(i.parent||e[pi],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)xM(s,r,t[l],a,!1);else xM(s,r,t,a,!1);void 0!==o1&&o1(s,i,e,t,r)}function _m(n,e){if(null!==e){const t=e.type;if(3&t)return Yi(e,n);if(4&t)return a1(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return _m(n,i);{const r=n[e.index];return Zi(r)?a1(-1,r):Xt(r)}}if(32&t)return t1(e,n)()||Xt(n[e.index]);{const i=FM(n,e);return null!==i?Array.isArray(i)?i[0]:_m(mm(n[Dn]),i):_m(n,e.next)}}return null}function FM(n,e){return null!==e?n[Dn][pi].projection[e.projection]:null}function a1(n,e){const t=Xn+n+1;if(t<e.length){const i=e[t],r=i[Te].firstChild;if(null!==r)return _m(i,r)}return e[Xr]}function l1(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&An(Xt(a),i),t.flags|=2),32!=(32&t.flags))if(8&l)l1(n,e,t.child,i,r,s,!1),tf(e,n,r,a,s);else if(32&l){const u=t1(t,i);let h;for(;h=u();)tf(e,n,r,h,s);tf(e,n,r,a,s)}else 16&l?VM(n,e,i,t,r,s):tf(e,n,r,a,s);t=o?t.projectionNext:t.next}}function ym(n,e,t,i,r,s){l1(t,i,n.firstChild,e,r,s,!1)}function VM(n,e,t,i,r,s){const o=t[Dn],l=o[pi].projection[i.projection];if(Array.isArray(l))for(let u=0;u<l.length;u++)tf(e,n,r,l[u],s);else{let u=l;const h=o[Et];Jh(i)&&(u.flags|=128),l1(n,e,u,h,r,s,!0)}}function BM(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function UM(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&wg(n,e,i),null!==r&&BM(n,e,r),null!==s&&function h9(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}function nf(n){return function c1(){if(void 0===ab&&(ab=null,sn.trustedTypes))try{ab=sn.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return ab}()?.createHTML(n)||n}function rf(){if(void 0!==u1)return u1;if(typeof document<"u")return document;throw new J(210,!1)}function jM(n){return function d1(){if(void 0===lb&&(lb=null,sn.trustedTypes))try{lb=sn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return lb}()?.createHTML(n)||n}class GM{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${St})`}}function uc(n){return n instanceof GM?n.changingThisBreaksApplicationSecurity:n}class T9{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(nf(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class I9{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=nf(e),t}}const D9=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function h1(n){return(n=String(n)).match(D9)?n:"unsafe:"+n}function cl(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function bm(...n){const e={};for(const t of n)for(const i in t)t.hasOwnProperty(i)&&(e[i]=!0);return e}const WM=cl("area,br,col,hr,img,wbr"),qM=cl("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),KM=cl("rp,rt"),f1=bm(WM,bm(qM,cl("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),bm(KM,cl("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),bm(KM,qM)),p1=cl("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ZM=bm(p1,cl("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),cl("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),S9=cl("script,style,template");class A9{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!f1.hasOwnProperty(t))return this.sanitizedSomething=!0,!S9.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,a=o.toLowerCase();if(!ZM.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;p1[a]&&(l=h1(l)),this.buf.push(" ",o,'="',YM(l),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();f1.hasOwnProperty(t)&&!WM.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(YM(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const R9=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,N9=/([^\#-~ |!])/g;function YM(n){return n.replace(/&/g,"&amp;").replace(R9,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(N9,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let cb;function g1(n){return"content"in n&&function P9(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var sf=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(sf||{});function QM(n){const e=function Em(){const n=ee();return n&&n[Wl].sanitizer}();return e?jM(e.sanitize(sf.HTML,n)||""):function vm(n,e){const t=function w9(n){return n instanceof GM&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${St})`)}return t===e}(n,"HTML")?jM(uc(n)):function x9(n,e){let t=null;try{cb=cb||function zM(n){const e=new I9(n);return function C9(){try{return!!(new window.DOMParser).parseFromString(nf(""),"text/html")}catch{return!1}}()?new T9(e):e}(n);let i=e?String(e):"";t=cb.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=t.innerHTML,t=cb.getInertBodyElement(i)}while(i!==s);return nf((new A9).sanitizeChildren(g1(t)||t))}finally{if(t){const i=g1(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}(rf(),je(n))}const wm=new me("ENVIRONMENT_INITIALIZER"),tk=new me("INJECTOR",-1),nk=new me("INJECTOR_DEF_TYPES");class m1{get(e,t=$l){if(t===$l){const i=new Error(`NullInjectorError: No provider for ${G(e)}!`);throw i.name="NullInjectorError",i}return t}}function V9(...n){return{\u0275providers:rk(0,n),\u0275fromNgModule:!0}}function rk(n,...e){const t=[],i=new Set;let r;const s=o=>{t.push(o)};return sc(e,o=>{const a=o;ub(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&sk(r,s),t}function sk(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];_1(r,s=>{e(s,i)})}}function ub(n,e,t,i){if(!(n=Ie(n)))return!1;let r=null,s=go(n);const o=!s&&nt(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=go(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const u of l)ub(u,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let u;i.add(r);try{sc(s.imports,h=>{ub(h,e,t,i)&&(u||=[],u.push(h))})}finally{}void 0!==u&&sk(u,e)}if(!a){const u=Ja(r)||(()=>new r);e({provide:r,useFactory:u,deps:At},r),e({provide:nk,useValue:r,multi:!0},r),e({provide:wm,useValue:()=>W(r),multi:!0},r)}const l=s.providers;if(null!=l&&!a){const u=n;_1(l,h=>{e(h,u)})}}}return r!==n&&void 0!==n.providers}function _1(n,e){for(let t of n)ai(t)&&(t=t.\u0275providers),Array.isArray(t)?_1(t,e):e(t)}const B9=C({provide:String,useValue:C});function y1(n){return null!==n&&"object"==typeof n&&B9 in n}function Hu(n){return"function"==typeof n}const v1=new me("Set Injector scope."),db={},j9={};let b1;function hb(){return void 0===b1&&(b1=new m1),b1}class ss{}class af extends ss{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,w1(e,o=>this.processProvider(o)),this.records.set(tk,lf(void 0,this)),r.has("environment")&&this.records.set(ss,lf(void 0,this));const s=this.records.get(v1);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(nk.multi,At,ft.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=ta(this),i=qi(void 0);try{return e()}finally{ta(t),qi(i)}}get(e,t=$l,i=ft.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(Lv))return e[Lv](this);i=fu(i);const s=ta(this),o=qi(void 0);try{if(!(i&ft.SkipSelf)){let l=this.records.get(e);if(void 0===l){const u=function W9(n){return"function"==typeof n||"object"==typeof n&&n instanceof me}(e)&&Oi(e);l=u&&this.injectableDefInScope(u)?lf(E1(e),db):null,this.records.set(e,l)}if(null!=l)return this.hydrate(e,l)}return(i&ft.Self?hb():this.parent).get(e,t=i&ft.Optional&&t===$l?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[ch]=a[ch]||[]).unshift(G(e)),s)throw a;return function Gl(n,e,t,i){const r=n[ch];throw e[uh]&&r.unshift(e[uh]),n.message=function Fv(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=G(e);if(Array.isArray(e))r=e.map(G).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):G(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(Ov,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[ch]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{qi(o),ta(s)}}resolveInjectorInitializers(){const e=ta(this),t=qi(void 0);try{const r=this.get(wm.multi,At,ft.Self);for(const s of r)s()}finally{ta(e),qi(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(G(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new J(205,!1)}processProvider(e){let t=Hu(e=Ie(e))?e:Ie(e&&e.provide);const i=function H9(n){return y1(n)?lf(void 0,n.useValue):lf(lk(n),db)}(e);if(Hu(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=lf(void 0,db,!0),r.factory=()=>bg(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===db&&(t.value=j9,t.value=t.factory()),"object"==typeof t.value&&t.value&&function z9(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Ie(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function E1(n){const e=Oi(n),t=null!==e?e.factory:Ja(n);if(null!==t)return t;if(n instanceof me)throw new J(204,!1);if(n instanceof Function)return function $9(n){const e=n.length;if(e>0)throw Bu(e,"?"),new J(204,!1);const t=function Ua(n){return n&&(n[du]||n[ah])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new J(204,!1)}function lk(n,e,t){let i;if(Hu(n)){const r=Ie(n);return Ja(r)||E1(r)}if(y1(n))i=()=>Ie(n.useValue);else if(function ak(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...bg(n.deps||[]));else if(function ok(n){return!(!n||!n.useExisting)}(n))i=()=>W(Ie(n.useExisting));else{const r=Ie(n&&(n.useClass||n.provide));if(!function G9(n){return!!n.deps}(n))return Ja(r)||E1(r);i=()=>new r(...bg(n.deps))}return i}function lf(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function w1(n,e){for(const t of n)Array.isArray(t)?w1(t,e):t&&ai(t)?w1(t.\u0275providers,e):e(t)}const fb=new me("AppId",{providedIn:"root",factory:()=>q9}),q9="ng",ck=new me("Platform Initializer"),Co=new me("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),uk=new me("CSP nonce",{providedIn:"root",factory:()=>rf().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let dk=(n,e,t)=>null;function N1(n,e,t=!1){return dk(n,e,t)}class iq{}class pk{}class sq{resolveComponentFactory(e){throw function rq(n){const e=Error(`No component factory found for ${G(n)}.`);return e.ngComponent=n,e}(e)}}let vb=(()=>{class n{static#e=this.NULL=new sq}return n})();function oq(){return df(Ei(),ee())}function df(n,e){return new zt(Yi(n,e))}let zt=(()=>{class n{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=oq}return n})();function aq(n){return n instanceof zt?n.nativeElement:n}class O1{}let Ts=(()=>{class n{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function lq(){const n=ee(),t=Qi(Ei().index,n);return(ki(t)?t:n)[qe]}()}return n})(),cq=(()=>{class n{static#e=this.\u0275prov=oe({token:n,providedIn:"root",factory:()=>null})}return n})();class hf{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const mk=new hf("16.2.12"),M1={};function bk(n,e=null,t=null,i){const r=Ek(n,e,t,i);return r.resolveInjectorInitializers(),r}function Ek(n,e=null,t=null,i,r=new Set){const s=[t||At,V9(n)];return i=i||("object"==typeof n?void 0:G(n)),new af(s,e||hb(),i||null,r)}let er=(()=>{class n{static#e=this.THROW_IF_NOT_FOUND=$l;static#t=this.NULL=new m1;static create(t,i){if(Array.isArray(t))return bk({name:""},i,t,"");{const r=t.name??"";return bk({name:r},t.parent,t.providers,r)}}static#n=this.\u0275prov=oe({token:n,providedIn:"any",factory:()=>W(tk)});static#i=this.__NG_ELEMENT_ID__=-1}return n})();function k1(n){return n.ngOriginalError}class ul{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&k1(e);for(;t&&k1(t);)t=k1(t);return t||null}}function F1(n){return e=>{setTimeout(n,void 0,e)}}const Fe=class _q extends Qe{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=F1(s),r&&(r=F1(r)),o&&(o=F1(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof $&&e.add(a),a}};function Tk(...n){}class rt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Fe(!1),this.onMicrotaskEmpty=new Fe(!1),this.onStable=new Fe(!1),this.onError=new Fe(!1),typeof Zone>"u")throw new J(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function yq(){const n="function"==typeof sn.requestAnimationFrame;let e=sn[n?"requestAnimationFrame":"setTimeout"],t=sn[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function Eq(n){const e=()=>{!function bq(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(sn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,V1(n),n.isCheckStableRunning=!0,L1(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),V1(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{if(function Tq(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(a))return t.invokeTask(r,s,o,a);try{return Ik(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),Ck(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return Ik(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),Ck(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,V1(n),L1(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!rt.isInAngularZone())throw new J(909,!1)}static assertNotInAngularZone(){if(rt.isInAngularZone())throw new J(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,vq,Tk,Tk);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const vq={};function L1(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function V1(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function Ik(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Ck(n){n._nesting--,L1(n)}class wq{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Fe,this.onMicrotaskEmpty=new Fe,this.onStable=new Fe,this.onError=new Fe}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const Dk=new me("",{providedIn:"root",factory:Sk});function Sk(){const n=ve(rt);let e=!0;return cn(new $e(r=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(e),r.complete()})}),new $e(r=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{rt.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,r.next(!0))})})});const o=n.onUnstable.subscribe(()=>{rt.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(Bs()))}function dl(n){return n instanceof Function?n():n}let B1=(()=>{class n{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=oe({token:n,providedIn:"root",factory:()=>new n})}return n})();function Cm(n){for(;n;){n[Ke]|=64;const e=mm(n);if(vu(n)&&!e)return n;n=e}return null}const Pk=new me("",{providedIn:"root",factory:()=>!1});let wb=null;function Fk(n,e){return n[e]??Bk()}function Lk(n,e){const t=Bk();t.producerNode?.length&&(n[e]=wb,t.lView=n,wb=Vk())}const Oq={...Xa,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Cm(n.lView)},lView:null};function Vk(){return Object.create(Oq)}function Bk(){return wb??=Vk(),wb}const it={};function le(n){Uk(wt(),ee(),Ti()+n,!1)}function Uk(n,e,t,i){if(!i)if(3==(3&e[Ke])){const s=n.preOrderCheckHooks;null!==s&&Mh(e,s,t)}else{const s=n.preOrderHooks;null!==s&&kh(e,s,0,t)}wo(t)}function O(n,e=ft.Default){const t=ee();return null===t?W(n,e):P0(Ei(),t,Ie(n),e)}function Tb(n,e,t,i,r,s,o,a,l,u,h){const g=e.blueprint.slice();return g[Cn]=r,g[Ke]=140|i,(null!==u||n&&2048&n[Ke])&&(g[Ke]|=2048),Ug(g),g[Et]=g[bo]=n,g[kn]=t,g[Wl]=o||n&&n[Wl],g[qe]=a||n&&n[qe],g[vo]=l||n&&n[vo]||null,g[pi]=s,g[Ka]=function z(){return R++}(),g[Gs]=h,g[mu]=u,g[Dn]=2==e.type?n[Dn]:g,g}function mf(n,e,t,i,r){let s=n.data[e];if(null===s)s=function U1(n,e,t,i,r){const s=Rh(),o=$g(),l=n.data[e]=function jq(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return Xl()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(n,e,t,i,r),function Hg(){return We.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Du(){const n=We.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return ns(s,!0),s}function Dm(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function $k(n,e,t,i,r){const s=Fk(e,Za),o=Ti(),a=2&i;try{wo(-1),a&&e.length>dt&&Uk(n,e,dt,!1),ts(a?2:0,r);const u=a?s:null,h=Og(u);try{null!==u&&(u.dirty=!1),t(i,r)}finally{n0(u,h)}}finally{a&&null===e[Za]&&Lk(e,Za),wo(o),ts(a?3:1,r)}}function j1(n,e,t){if(yu(e)){const i=es(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{es(i)}}}function $1(n,e,t){p0()&&(function Kq(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Qa(t)&&function t7(n,e,t){const i=Yi(e,n),r=Hk(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=Ib(n,Tb(n,r,null,o,i,e,null,n[Wl].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=a}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Uh(t,e),An(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],u=rl(e,n,a,t);An(u,e),null!==o&&n7(0,a-r,u,l,0,o),ws(l)&&(Qi(t.index,e)[kn]=rl(e,n,a,t))}}(n,e,t,Yi(t,e)),64==(64&t.flags)&&Kk(n,e,t))}function H1(n,e,t=Yi){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function Hk(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=G1(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function G1(n,e,t,i,r,s,o,a,l,u,h){const g=dt+i,m=g+r,y=function kq(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:it);return t}(g,m),b="function"==typeof u?u():u;return y[Te]={type:n,blueprint:y,template:t,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,g),bindingStartIndex:g,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:b,incompleteFirstPass:!1,ssrId:h}}let Gk=n=>null;function zk(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?Wk(t,e,r,s):i.hasOwnProperty(r)&&Wk(t,e,i[r],s)}return t}function Wk(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function Is(n,e,t,i,r,s,o,a){const l=Yi(e,t);let h,u=e.inputs;!a&&null!=u&&(h=u[i])?(Z1(n,t,h,i,r),Qa(e)&&function Gq(n,e){const t=Qi(e,n);16&t[Ke]||(t[Ke]|=64)}(t,e.index)):3&e.type&&(i=function Hq(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(l,i,r))}function z1(n,e,t,i){if(p0()){const r=null===i?null:{"":-1},s=function Yq(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(yh(e,o.selectors,!1))if(i||(i=[]),ws(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),W1(n,e,a.length)}else i.unshift(o),W1(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&qk(n,e,t,o,r,a),r&&function Qq(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new J(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=Ga(t.mergedAttrs,t.attrs)}function qk(n,e,t,i,r,s){for(let u=0;u<i.length;u++)Qg(Uh(t,e),n,i[u].type);!function Xq(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let u=0;u<i.length;u++){const h=i[u];h.providersResolver&&h.providersResolver(h)}let o=!1,a=!1,l=Dm(n,e,i.length,null);for(let u=0;u<i.length;u++){const h=i[u];t.mergedAttrs=Ga(t.mergedAttrs,h.hostAttrs),e7(n,t,e,l,h),Jq(l,h,r),null!==h.contentQueries&&(t.flags|=4),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(t.flags|=64);const g=h.type.prototype;!o&&(g.ngOnChanges||g.ngOnInit||g.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(g.ngOnChanges||g.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}!function $q(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let l=null,u=null;for(let h=e.directiveStart;h<r;h++){const g=s[h],m=t?t.get(g):null,b=m?m.outputs:null;l=zk(g.inputs,h,l,m?m.inputs:null),u=zk(g.outputs,h,u,b);const w=null===l||null===o||_h(e)?null:i7(l,h,o);a.push(w)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=u}(n,t,s)}function Kk(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function EC(){return We.lFrame.currentDirectiveIndex}();try{wo(s);for(let a=i;a<r;a++){const l=n.data[a],u=e[a];Ru(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&Zq(l,u)}}finally{wo(-1),Ru(o)}}function Zq(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function W1(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function Jq(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;ws(e)&&(t[""]=n)}}function e7(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=Ja(r.type)),o=new nc(s,ws(r),O);n.blueprint[i]=o,t[i]=o,function Wq(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function qq(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,Dm(n,t,r.hostVars,it),r)}function da(n,e,t,i,r,s){const o=Yi(n,e);!function q1(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?je(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[qe],o,s,n.value,t,i,r)}function n7(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)Zk(i,t,o[a++],o[a++],o[a++])}function Zk(n,e,t,i,r){const s=es(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(i)&&(r=o[i].call(e,r)),null!==n.setInput?n.setInput(e,r,t,i):e[i]=r}finally{es(s)}}function i7(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function Yk(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null,null]}function Qk(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const o=n.data[s];Gg(t[i]),o.contentQueries(2,e[s],s)}}}function Ib(n,e){return n[qa]?n[bh][Jr]=e:n[qa]=e,n[bh]=e,e}function K1(n,e,t){Gg(0);const i=es(null);try{e(n,t)}finally{es(i)}}function Jk(n){return n[yo]||(n[yo]=[])}function Xk(n){return n.cleanup||(n.cleanup=[])}function tF(n,e){const t=n[vo],i=t?t.get(ul,null):null;i&&i.handleError(e)}function Z1(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];Zk(n.data[o],e[o],i,a,r)}}function r7(n,e){const t=Qi(e,n),i=t[Te];!function s7(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[Cn];null!==r&&null===t[Gs]&&(t[Gs]=N1(r,t[vo])),Y1(i,t,t[kn])}function Y1(n,e,t){Nu(e);try{const i=n.viewQuery;null!==i&&K1(1,i,t);const r=n.template;null!==r&&$k(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Qk(n,e),n.staticViewQueries&&K1(2,n.viewQuery,t);const s=n.components;null!==s&&function o7(n,e){for(let t=0;t<e.length;t++)r7(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Ke]&=-5,nl()}}let nF=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const s=typeof Zone>"u"?null:Zone.current,o=function sC(n,e,t){const i=Object.create(cM);t&&(i.consumerAllowSignalWrites=!0),i.fn=n,i.schedule=e;const r=o=>{i.cleanupFn=o};return i.ref={notify:()=>t0(i),run:()=>{if(i.dirty=!1,i.hasRun&&!XI(i))return;i.hasRun=!0;const o=Og(i);try{i.cleanupFn(),i.cleanupFn=o0,i.fn(r)}finally{n0(i,o)}},cleanup:()=>i.cleanupFn()},i.ref}(t,u=>{this.all.has(u)&&this.queue.set(u,s)},r);let a;this.all.add(o),o.notify();const l=()=>{o.cleanup(),a?.(),this.all.delete(o),this.queue.delete(o)};return a=i?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=oe({token:n,providedIn:"root",factory:()=>new n})}return n})();function Cb(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=V(r,a):2==s&&(i=V(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function Sm(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];null!==s&&i.push(Xt(s)),Zi(s)&&iF(s,i);const o=t.type;if(8&o)Sm(n,e,t.child,i);else if(32&o){const a=t1(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=FM(e,t);if(Array.isArray(a))i.push(...a);else{const l=mm(e[Dn]);Sm(l[Te],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function iF(n,e){for(let t=Xn;t<n.length;t++){const i=n[t],r=i[Te].firstChild;null!==r&&Sm(i[Te],i,r,e)}n[Xr]!==n[Cn]&&e.push(n[Xr])}function Db(n,e,t,i=!0){const r=e[Wl],s=r.rendererFactory,o=r.afterRenderEventManager;s.begin?.(),o?.begin();try{rF(n,e,n.template,t)}catch(l){throw i&&tF(e,l),l}finally{s.end?.(),r.effectManager?.flush(),o?.end()}}function rF(n,e,t,i){const r=e[Ke];if(256!=(256&r)){e[Wl].effectManager?.flush(),Nu(e);try{Ug(e),function Nh(n){return We.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&$k(n,e,t,2,i);const o=3==(3&r);if(o){const u=n.preOrderCheckHooks;null!==u&&Mh(e,u,null)}else{const u=n.preOrderHooks;null!==u&&kh(e,u,0,null),xu(e,0)}if(function c7(n){for(let e=IM(n);null!==e;e=CM(e)){if(!e[$v])continue;const t=e[ra];for(let i=0;i<t.length;i++){uC(t[i])}}}(e),sF(e,2),null!==n.contentQueries&&Qk(n,e),o){const u=n.contentCheckHooks;null!==u&&Mh(e,u)}else{const u=n.contentHooks;null!==u&&kh(e,u,1),xu(e,1)}!function Mq(n,e){const t=n.hostBindingOpCodes;if(null===t)return;const i=Fk(e,Kl);try{for(let r=0;r<t.length;r++){const s=t[r];if(s<0)wo(~s);else{const o=s,a=t[++r],l=t[++r];bC(a,o),i.dirty=!1;const u=Og(i);try{l(2,e[o])}finally{n0(i,u)}}}}finally{null===e[Kl]&&Lk(e,Kl),wo(-1)}}(n,e);const a=n.components;null!==a&&aF(e,a,0);const l=n.viewQuery;if(null!==l&&K1(2,l,i),o){const u=n.viewCheckHooks;null!==u&&Mh(e,u)}else{const u=n.viewHooks;null!==u&&kh(e,u,2),xu(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[Ke]&=-73,h0(e)}finally{nl()}}}function sF(n,e){for(let t=IM(n);null!==t;t=CM(t))for(let i=Xn;i<t.length;i++)oF(t[i],e)}function u7(n,e,t){oF(Qi(e,n),t)}function oF(n,e){if(!function Bg(n){return 128==(128&n[Ke])}(n))return;const t=n[Te],i=n[Ke];if(80&i&&0===e||1024&i||2===e)rF(t,n,t.template,n[kn]);else if(n[gu]>0){sF(n,1);const r=t.components;null!==r&&aF(n,r,1)}}function aF(n,e,t){for(let i=0;i<e.length;i++)u7(n,e[i],t)}class Am{get rootNodes(){const e=this._lView,t=e[Te];return Sm(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[kn]}set context(e){this._lView[kn]=e}get destroyed(){return 256==(256&this._lView[Ke])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Et];if(Zi(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(ib(e,i),Hh(t,i))}this._attachedToViewContainer=!1}i1(this._lView[Te],this._lView)}onDestroy(e){!function tl(n,e){if(256==(256&n[Ke]))throw new J(911,!1);null===n[Hs]&&(n[Hs]=[]),n[Hs].push(e)}(this._lView,e)}markForCheck(){Cm(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ke]&=-129}reattach(){this._lView[Ke]|=128}detectChanges(){Db(this._lView[Te],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new J(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function t9(n,e){ym(n,e,e[qe],2,null,null)}(this._lView[Te],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new J(902,!1);this._appRef=e}}class d7 extends Am{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Db(e[Te],e,e[kn],!1)}checkNoChanges(){}get context(){return null}}class lF extends vb{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=nt(e);return new Rm(t,this.ngModule)}}function cF(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class f7{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=fu(i);const r=this.injector.get(e,M1,i);return r!==M1||t===M1?r:this.parentInjector.get(e,t,i)}}class Rm extends pk{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=cF(e.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return cF(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function KI(n){return n.map(Cg).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof ss?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new f7(e,s):e,a=o.get(O1,null);if(null===a)throw new J(407,!1);const g={rendererFactory:a,sanitizer:o.get(cq,null),effectManager:o.get(nF,null),afterRenderEventManager:o.get(B1,null)},m=a.createRenderer(null,this.componentDef),y=this.componentDef.selectors[0][0]||"div",b=i?function Fq(n,e,t,i){const s=i.get(Pk,!1)||t===Rr.ShadowDom,o=n.selectRootElement(e,s);return function Lq(n){Gk(n)}(o),o}(m,i,this.componentDef.encapsulation,o):nb(m,y,function h7(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(y)),P=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let S=null;null!==b&&(S=N1(b,o,!0));const M=G1(0,null,null,1,0,null,null,null,null,null,null),L=Tb(null,M,null,P,null,null,g,m,o,null,S);let Y,pe;Nu(L);try{const Oe=this.componentDef;let Ge,ln=null;Oe.findHostDirectiveDefs?(Ge=[],ln=new Map,Oe.findHostDirectiveDefs(Oe,Ge,ln),Ge.push(Oe)):Ge=[Oe];const jn=function g7(n,e){const t=n[Te],i=dt;return n[i]=e,mf(t,i,2,"#host",null)}(L,b),zi=function m7(n,e,t,i,r,s,o){const a=r[Te];!function _7(n,e,t,i){for(const r of n)e.mergedAttrs=Ga(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Cb(e,e.mergedAttrs,!0),null!==t&&UM(i,t,e))}(i,n,e,o);let l=null;null!==e&&(l=N1(e,r[vo]));const u=s.rendererFactory.createRenderer(e,t);let h=16;t.signals?h=4096:t.onPush&&(h=64);const g=Tb(r,Hk(t),null,h,r[n.index],n,s,u,null,null,l);return a.firstCreatePass&&W1(a,n,i.length-1),Ib(r,g),r[n.index]=g}(jn,b,Oe,Ge,L,g,m);pe=Cu(M,dt),b&&function v7(n,e,t,i){if(i)wg(n,t,["ng-version",mk.full]);else{const{attrs:r,classes:s}=function Dg(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Ki(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&wg(n,t,r),s&&s.length>0&&BM(n,t,s.join(" "))}}(m,Oe,b,i),void 0!==t&&function b7(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(pe,this.ngContentSelectors,t),Y=function y7(n,e,t,i,r,s){const o=Ei(),a=r[Te],l=Yi(o,r);qk(a,r,o,t,null,i);for(let h=0;h<t.length;h++)An(rl(r,a,o.directiveStart+h,o),r);Kk(a,r,o),l&&An(l,r);const u=rl(r,a,o.directiveStart+o.componentOffset,o);if(n[kn]=r[kn]=u,null!==s)for(const h of s)h(u,e);return j1(a,o,n),u}(zi,Oe,Ge,ln,L,[E7]),Y1(M,L,null)}finally{nl()}return new p7(this.componentType,Y,df(pe,L),L,pe)}}class p7 extends iq{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new d7(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;Z1(s[Te],s,r,e,t),this.previousInputValues.set(e,t),Cm(Qi(this._tNode.index,s))}}get injector(){return new Ii(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function E7(){const n=Ei();tc(ee()[Te],n)}function Wt(n){let e=function uF(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(ws(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new J(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=Sb(n.inputs),o.inputTransforms=Sb(n.inputTransforms),o.declaredInputs=Sb(n.declaredInputs),o.outputs=Sb(n.outputs);const a=r.hostBindings;a&&C7(n,a);const l=r.viewQuery,u=r.contentQueries;if(l&&T7(n,l),u&&I7(n,u),x(n.inputs,r.inputs),x(n.declaredInputs,r.declaredInputs),x(n.outputs,r.outputs),null!==r.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),x(o.inputTransforms,r.inputTransforms)),ws(r)&&r.data.animation){const h=n.data;h.animation=(h.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===Wt&&(t=!1)}}e=Object.getPrototypeOf(e)}!function w7(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Ga(r.hostAttrs,t=Ga(t,r.hostAttrs))}}(i)}function Sb(n){return n===js?{}:n===At?[]:n}function T7(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function I7(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function C7(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function Ab(n){return!!Q1(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function Q1(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function _r(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function qt(n,e,t,i){const r=ee();return _r(r,qs(),e)&&(wt(),da(hn(),r,n,e,t,i)),qt}function De(n,e,t,i,r,s,o,a){const l=ee(),u=wt(),h=n+dt,g=u.firstCreatePass?function Z7(n,e,t,i,r,s,o,a,l){const u=e.consts,h=mf(e,n,4,o||null,Ws(u,a));z1(e,t,h,Ws(u,l)),tc(e,h);const g=h.tView=G1(2,h,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return null!==e.queries&&(e.queries.template(e,h),g.queries=e.queries.embeddedTView(h)),h}(h,u,l,e,t,i,r,s,o):u.data[h];ns(g,!1);const m=SF(u,l,g,n);ec()&&sb(u,l,m,g),An(m,l),Ib(l,l[h]=Yk(m,l,m,g)),Zl(g)&&$1(u,l,g),null!=o&&H1(l,g,a)}let SF=function AF(n,e,t,i){return sa(!0),e[qe].createComment("")};function ce(n,e,t){const i=ee();return _r(i,qs(),e)&&Is(wt(),hn(),i,n,e,i[qe],t,!1),ce}function iD(n,e,t,i,r){const o=r?"class":"style";Z1(n,t,e.inputs[o],o,i)}function ue(n,e,t,i){const r=ee(),s=wt(),o=dt+n,a=r[qe],l=s.firstCreatePass?function X7(n,e,t,i,r,s){const o=e.consts,l=mf(e,n,2,i,Ws(o,r));return z1(e,t,l,Ws(o,s)),null!==l.attrs&&Cb(l,l.attrs,!1),null!==l.mergedAttrs&&Cb(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,e,t,i):s.data[o],u=RF(s,r,l,a,e,n);r[o]=u;const h=Zl(l);return ns(l,!0),UM(a,u,l),32!=(32&l.flags)&&ec()&&sb(s,r,u,l),0===function fC(){return We.lFrame.elementDepthCount}()&&An(u,r),function Ah(){We.lFrame.elementDepthCount++}(),h&&($1(s,r,l),j1(s,l,r)),null!==i&&H1(r,l),ue}function de(){let n=Ei();$g()?Su():(n=n.parent,ns(n,!1));const e=n;(function jg(n){return We.skipHydrationRootTNode===n})(e)&&function yC(){We.skipHydrationRootTNode=null}(),function pC(){We.lFrame.elementDepthCount--}();const t=wt();return t.firstCreatePass&&(tc(t,n),yu(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function D0(n){return 0!=(8&n.flags)}(e)&&iD(t,e,ee(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function SC(n){return 0!=(16&n.flags)}(e)&&iD(t,e,ee(),e.stylesWithoutHost,!1),de}function tr(n,e,t,i){return ue(n,e,t,i),de(),tr}let RF=(n,e,t,i,r,s)=>(sa(!0),nb(i,r,function T0(){return We.lFrame.currentNamespace}()));function Ob(n,e,t){const i=ee(),r=wt(),s=n+dt,o=r.firstCreatePass?function nK(n,e,t,i,r){const s=e.consts,o=Ws(s,i),a=mf(e,n,8,"ng-container",o);return null!==o&&Cb(a,o,!0),z1(e,t,a,Ws(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,i,e,t):r.data[s];ns(o,!0);const a=NF(r,i,o,n);return i[s]=a,ec()&&sb(r,i,a,o),An(a,i),Zl(o)&&($1(r,i,o),j1(r,o,i)),null!=t&&H1(i,o),Ob}function Mb(){let n=Ei();const e=wt();return $g()?Su():(n=n.parent,ns(n,!1)),e.firstCreatePass&&(tc(e,n),yu(n)&&e.queries.elementEnd(n)),Mb}function rD(n,e,t){return Ob(n,e,t),Mb(),rD}let NF=(n,e,t,i)=>(sa(!0),n1(e[qe],""));function Fi(){return ee()}function km(n){return!!n&&"function"==typeof n.then}function xF(n){return!!n&&"function"==typeof n.subscribe}function Ve(n,e,t,i){const r=ee(),s=wt(),o=Ei();return function OF(n,e,t,i,r,s,o){const a=Zl(i),u=n.firstCreatePass&&Xk(n),h=e[kn],g=Jk(e);let m=!0;if(3&i.type||o){const w=Yi(i,e),T=o?o(w):w,P=g.length,S=o?L=>o(Xt(L[i.index])):i.index;let M=null;if(!o&&a&&(M=function sK(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[yo],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==M)(M.__ngLastListenerFn__||M).__ngNextListenerFn__=s,M.__ngLastListenerFn__=s,m=!1;else{s=kF(i,e,h,s,!1);const L=t.listen(T,r,s);g.push(s,L),u&&u.push(r,S,P,P+1)}}else s=kF(i,e,h,s,!1);const y=i.outputs;let b;if(m&&null!==y&&(b=y[r])){const w=b.length;if(w)for(let T=0;T<w;T+=2){const Y=e[b[T]][b[T+1]].subscribe(s),pe=g.length;g.push(s,Y),u&&u.push(r,i.index,pe,-(pe+1))}}}(s,r,r[qe],o,n,e,i),Ve}function MF(n,e,t,i){try{return ts(6,e,t),!1!==t(i)}catch(r){return tF(n,r),!1}finally{ts(7,e,t)}}function kF(n,e,t,i,r){return function s(o){if(o===Function)return i;Cm(n.componentOffset>-1?Qi(n.index,e):e);let l=MF(e,t,i,o),u=s.__ngNextListenerFn__;for(;u;)l=MF(e,t,u,o)&&l,u=u.__ngNextListenerFn__;return r&&!1===l&&o.preventDefault(),l}}function be(n=1){return function wC(n){return(We.lFrame.contextLView=function TC(n,e){for(;n>0;)e=e[bo],n--;return e}(n,We.lFrame.contextLView))[kn]}(n)}function oK(n,e){let t=null;const i=function WI(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?yh(n,s,!0):Ig(i,s))return r}else t=r}return t}function Fb(n,e){return n<<17|e<<2}function dc(n){return n>>17&32767}function oD(n){return 2|n}function zu(n){return(131068&n)>>2}function aD(n,e){return-131069&n|e<<2}function lD(n){return 1|n}function WF(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?dc(s):zu(s),l=!1;for(;0!==a&&(!1===l||o);){const h=n[a+1];hK(n[a],e)&&(l=!0,n[a+1]=i?lD(h):oD(h)),a=i?dc(h):zu(h)}l&&(n[t+1]=i?oD(s):lD(s))}function hK(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&al(n,e)>=0}const Ci={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function qF(n){return n.substring(Ci.key,Ci.keyEnd)}function KF(n,e){const t=Ci.textEnd;return t===e?-1:(e=Ci.keyEnd=function mK(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,Ci.key=e,t),Df(n,e,t))}function Df(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function Wu(n,e,t){return So(n,e,t,!1),Wu}function Mt(n,e){return So(n,e,null,!0),Mt}function qu(n){!function Ao(n,e,t,i){const r=wt(),s=Ji(2);r.firstUpdatePass&&e2(r,null,s,i);const o=ee();if(t!==it&&_r(o,s,t)){const a=r.data[Ti()];if(r2(a,i)&&!XF(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=V(l,t||"")),iD(r,a,o,t,i)}else!function DK(n,e,t,i,r,s,o,a){r===it&&(r=At);let l=0,u=0,h=0<r.length?r[0]:null,g=0<s.length?s[0]:null;for(;null!==h||null!==g;){const m=l<r.length?r[l+1]:void 0,y=u<s.length?s[u+1]:void 0;let w,b=null;h===g?(l+=2,u+=2,m!==y&&(b=g,w=y)):null===g||null!==h&&h<g?(l+=2,b=h):(u+=2,b=g,w=y),null!==b&&n2(n,e,t,i,b,w,o,a),h=l<r.length?r[l]:null,g=u<s.length?s[u]:null}}(r,a,o,o[qe],o[s+1],o[s+1]=function IK(n,e,t){if(null==t||""===t)return At;const i=[],r=uc(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(CK,pa,n,!0)}function pa(n,e){for(let t=function pK(n){return function YF(n){Ci.key=0,Ci.keyEnd=0,Ci.value=0,Ci.valueEnd=0,Ci.textEnd=n.length}(n),KF(n,Df(n,0,Ci.textEnd))}(e);t>=0;t=KF(e,t))Nr(n,qF(e),!0)}function So(n,e,t,i){const r=ee(),s=wt(),o=Ji(2);s.firstUpdatePass&&e2(s,n,o,i),e!==it&&_r(r,o,e)&&n2(s,s.data[Ti()],r,r[qe],n,r[o+1]=function SK(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=G(uc(n)))),n}(e,t),i,o)}function XF(n,e){return e>=n.expandoStartIndex}function e2(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Ti()],o=XF(n,t);r2(s,i)&&null===e&&!o&&(e=!1),e=function bK(n,e,t,i){const r=function xh(n){const e=We.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=Fm(t=cD(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=cD(r,n,e,t,i),null===s){let l=function EK(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==zu(i))return n[dc(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=cD(null,n,e,l[1],i),l=Fm(l,e.attrs,i),function wK(n,e,t,i){n[dc(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function TK(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=Fm(i,n[s].hostAttrs,t);return Fm(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function uK(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=dc(o),l=zu(o);n[i]=t;let h,u=!1;if(Array.isArray(t)?(h=t[1],(null===h||al(t,h)>0)&&(u=!0)):h=t,r)if(0!==l){const m=dc(n[a+1]);n[i+1]=Fb(m,a),0!==m&&(n[m+1]=aD(n[m+1],i)),n[a+1]=function lK(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=Fb(a,0),0!==a&&(n[a+1]=aD(n[a+1],i)),a=i;else n[i+1]=Fb(l,0),0===a?a=i:n[l+1]=aD(n[l+1],i),l=i;u&&(n[i+1]=oD(n[i+1])),WF(n,h,i,!0),WF(n,h,i,!1),function dK(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&al(s,e)>=0&&(t[i+1]=lD(t[i+1]))}(e,h,n,i,s),o=Fb(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function cD(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=Fm(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function Fm(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Nr(n,o,!!t||e[++s]))}return void 0===n?null:n}function CK(n,e,t){const i=String(e);""!==i&&!i.includes(" ")&&Nr(n,i,t)}function n2(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,u=l[a+1],h=function cK(n){return 1==(1&n)}(u)?i2(l,e,t,r,zu(u),o):void 0;Lb(h)||(Lb(s)||function aK(n){return 2==(2&n)}(u)&&(s=i2(l,null,t,r,a,o)),function d9(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:c.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=c.Important),n.setStyle(t,i,r,s))}}(i,o,el(Ti(),t),r,s))}function i2(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],u=Array.isArray(l),h=u?l[1]:l,g=null===h;let m=t[r+1];m===it&&(m=g?At:void 0);let y=g?sm(m,i):h===i?m:void 0;if(u&&!Lb(y)&&(y=sm(l,i)),Lb(y)&&(a=y,o))return a;const b=n[r+1];r=o?dc(b):zu(b)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=sm(l,i))}return a}function Lb(n){return void 0!==n}function r2(n,e){return 0!=(n.flags&(e?8:16))}function It(n,e=""){const t=ee(),i=wt(),r=n+dt,s=i.firstCreatePass?mf(i,r,1,e,null):i.data[r],o=s2(i,t,s,e,n);t[r]=o,ec()&&sb(i,t,o,s),ns(s,!1)}let s2=(n,e,t,i,r)=>(sa(!0),function tb(n,e){return n.createText(e)}(e[qe],i));function Ro(n,e,t){const i=ee(),r=function yf(n,e,t,i){return _r(n,qs(),t)?e+je(t)+i:it}(i,n,e,t);return r!==it&&function hl(n,e,t){const i=el(e,n);!function SM(n,e,t){n.setValue(e,t)}(n[qe],i,t)}(i,Ti(),r),Ro}function Ys(n,e,t){const i=ee();return _r(i,qs(),e)&&Is(wt(),hn(),i,n,e,i[qe],t,!0),Ys}const Ku=void 0;var ZK=["en",[["a","p"],["AM","PM"],Ku],[["AM","PM"],Ku,Ku],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Ku,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Ku,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Ku,"{1} 'at' {0}",Ku],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function KK(n){const t=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let Sf={};function Mr(n){const e=function YK(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=C2(e);if(t)return t;const i=e.split("-")[0];if(t=C2(i),t)return t;if("en"===i)return ZK;throw new J(701,!1)}function C2(n){return n in Sf||(Sf[n]=sn.ng&&sn.ng.common&&sn.ng.common.locales&&sn.ng.common.locales[n]),Sf[n]}var _n=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(_n||{});const Af="en-US";let D2=Af;function hD(n,e,t,i,r){if(n=Ie(n),Array.isArray(n))for(let s=0;s<n.length;s++)hD(n[s],e,t,i,r);else{const s=wt(),o=ee(),a=Ei();let l=Hu(n)?n:Ie(n.provide);const u=lk(n),h=1048575&a.providerIndexes,g=a.directiveStart,m=a.providerIndexes>>20;if(Hu(n)||!n.multi){const y=new nc(u,r,O),b=pD(l,e,r?h:h+m,g);-1===b?(Qg(Uh(a,o),s,l),fD(s,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(y),o.push(y)):(t[b]=y,o[b]=y)}else{const y=pD(l,e,h+m,g),b=pD(l,e,h,h+m),T=b>=0&&t[b];if(r&&!T||!r&&!(y>=0&&t[y])){Qg(Uh(a,o),s,l);const P=function qZ(n,e,t,i,r){const s=new nc(n,t,O);return s.multi=[],s.index=e,s.componentProviders=0,Q2(s,r,i&&!t),s}(r?WZ:zZ,t.length,r,i,u);!r&&T&&(t[b].providerFactory=P),fD(s,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(P),o.push(P)}else fD(s,n,y>-1?y:b,Q2(t[r?b:y],u,!r&&i));!r&&i&&T&&t[b].componentProviders++}}}function fD(n,e,t,i){const r=Hu(e),s=function U9(n){return!!n.useClass}(e);if(r||s){const l=(s?Ie(e.useClass):e).prototype.ngOnDestroy;if(l){const u=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const h=u.indexOf(t);-1===h?u.push(t,[i,l]):u[h+1].push(i,l)}else u.push(t,l)}}}function Q2(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function pD(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function zZ(n,e,t,i){return gD(this.multi,[])}function WZ(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=rl(t,t[Te],this.providerFactory.index,i);s=a.slice(0,o),gD(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],gD(r,s);return s}function gD(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function on(n,e=[]){return t=>{t.providersResolver=(i,r)=>function GZ(n,e,t){const i=wt();if(i.firstCreatePass){const r=ws(n);hD(t,i.data,i.blueprint,r,!0),hD(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class Zu{}class J2{}class mD extends Zu{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new lF(this);const r=mr(e);this._bootstrapComponents=dl(r.bootstrap),this._r3Injector=Ek(e,t,[{provide:Zu,useValue:this},{provide:vb,useValue:this.componentFactoryResolver},...i],G(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class _D extends J2{constructor(e){super(),this.moduleType=e}create(e){return new mD(this.moduleType,e,[])}}class X2 extends Zu{constructor(e){super(),this.componentFactoryResolver=new lF(this),this.instance=null;const t=new af([...e.providers,{provide:Zu,useValue:this},{provide:vb,useValue:this.componentFactoryResolver}],e.parent||hb(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function yD(n,e,t=null){return new X2({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let YZ=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=rk(0,t.type),r=i.length>0?yD([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=oe({token:n,providedIn:"environment",factory:()=>new n(W(ss))})}return n})();function Cs(n){n.getStandaloneInjector=e=>e.get(YZ).getOrCreateStandaloneInjector(n)}function Rf(n,e,t,i){return function oL(n,e,t,i,r,s){const o=e+t;return _r(n,o,r)?function ha(n,e,t){return n[e]=t}(n,o+1,s?i.call(s,r):i(r)):function Gm(n,e){const t=n[e];return t===it?void 0:t}(n,o+1)}(ee(),function wi(){const n=We.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}(),n,e,t,i)}function vY(){return this._results[Symbol.iterator]()}class ED{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new Fe)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=ED.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=vY)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=function is(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function im(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function EY(n,e,t,i=!0){const r=e[Te];if(function i9(n,e,t,i){const r=Xn+i,s=t.length;i>0&&(t[r-1][Jr]=e),i<s-Xn?(e[Jr]=t[r],$h(t,Xn+i,e)):(t.push(e),e[Jr]=null),e[Et]=t;const o=e[ql];null!==o&&t!==o&&function r9(n,e){const t=n[ra];e[Dn]!==e[Et][Et][Dn]&&(n[$v]=!0),null===t?n[ra]=[e]:t.push(e)}(o,e);const a=e[Es];null!==a&&a.insertView(n),e[Ke]|=128}(r,e,n,t),i){const s=a1(t,n),o=e[qe],a=rb(o,n[Xr]);null!==a&&function e9(n,e,t,i,r,s){i[Cn]=r,i[pi]=e,ym(n,i,t,1,r,s)}(r,n[pi],o,e,a,s)}}let Wn=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=IY}return n})();const wY=Wn,TY=class extends wY{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=function bY(n,e,t,i){const r=e.tView,a=Tb(n,r,t,4096&n[Ke]?4096:16,null,e,null,null,null,i?.injector??null,i?.hydrationInfo??null);a[ql]=n[e.index];const u=n[Es];return null!==u&&(a[Es]=u.createEmbeddedView(r)),Y1(r,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:i});return new Am(r)}};function IY(){return $b(Ei(),ee())}function $b(n,e){return 4&n.type?new TY(e,n,df(n,e)):null}let Qs=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=NY}return n})();function NY(){return _L(Ei(),ee())}const xY=Qs,gL=class extends xY{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return df(this._hostTNode,this._hostLView)}get injector(){return new Ii(this._hostTNode,this._hostLView)}get parentInjector(){const e=jh(this._hostTNode,this._hostLView);if(Kg(e)){const t=il(e,this._hostLView),i=Pu(e);return new Ii(t[Te].data[i+8],t)}return new Ii(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=mL(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Xn}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,r,false),a}createComponent(e,t,i,r,s){const o=e&&!function Vu(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const w=t||{};a=w.index,i=w.injector,r=w.projectableNodes,s=w.environmentInjector||w.ngModuleRef}const l=o?e:new Rm(nt(e)),u=i||this.parentInjector;if(!s&&null==l.ngModule){const T=(o?u:this.parentInjector).get(ss,null);T&&(s=T)}nt(l.componentType??{});const y=l.create(u,r,null,s);return this.insertImpl(y.hostView,a,false),y}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,i){const r=e._lView;if(function cC(n){return Zi(n[Et])}(r)){const l=this.indexOf(e);if(-1!==l)this.detach(l);else{const u=r[Et],h=new gL(u,u[pi],u[Et]);h.detach(h.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;return EY(a,r,o,!i),e.attachToViewContainerRef(),$h(wD(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=mL(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=ib(this._lContainer,t);i&&(Hh(wD(this._lContainer),t),i1(i[Te],i))}detach(e){const t=this._adjustIndex(e,-1),i=ib(this._lContainer,t);return i&&null!=Hh(wD(this._lContainer),t)?new Am(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function mL(n){return n[8]}function wD(n){return n[8]||(n[8]=[])}function _L(n,e){let t;const i=e[n.index];return Zi(i)?t=i:(t=Yk(i,e,null,n),e[n.index]=t,Ib(e,t)),yL(t,e,n,i),new gL(t,n,e)}let yL=function vL(n,e,t,i){if(n[Xr])return;let r;r=8&t.type?Xt(i):function PY(n,e){const t=n[qe],i=t.createComment(""),r=Yi(e,n);return $u(t,rb(t,r),i,function l9(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[Xr]=r};class TD{constructor(e){this.queryList=e,this.matches=null}clone(){return new TD(this.queryList)}setDirty(){this.queryList.setDirty()}}class ID{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new ID(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==IL(e,t).matches&&this.queries[t].setDirty()}}class bL{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class CD{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new CD(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class DD{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new DD(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,kY(t,s)),this.matchTNodeWithReadOption(e,t,Mu(t,e,s,!1,!1))}else i===Wn?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Mu(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===zt||r===Qs||r===Wn&&4&t.type)this.addMatch(t.index,-2);else{const s=Mu(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function kY(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function LY(n,e,t,i){return-1===t?function FY(n,e){return 11&n.type?df(n,e):4&n.type?$b(n,e):null}(e,n):-2===t?function VY(n,e,t){return t===zt?df(e,n):t===Wn?$b(e,n):t===Qs?_L(e,n):void 0}(n,e,i):rl(n,n[Te],t,e)}function EL(n,e,t,i){const r=e[Es].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const u=o[l];a.push(u<0?null:LY(e,s[u],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function SD(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=EL(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const u=s[a+1],h=e[-l];for(let g=Xn;g<h.length;g++){const m=h[g];m[ql]===m[Et]&&SD(m[Te],m,u,i)}if(null!==h[ra]){const g=h[ra];for(let m=0;m<g.length;m++){const y=g[m];SD(y[Te],y,u,i)}}}}}return i}function Kt(n){const e=ee(),t=wt(),i=_0();Gg(i+1);const r=IL(t,i);if(n.dirty&&function d0(n){return 4==(4&n[Ke])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?SD(t,e,i,[]):EL(t,e,r,i);n.reset(s,aq),n.notifyOnChanges()}return!0}return!1}function hc(n,e,t){const i=wt();i.firstCreatePass&&(TL(i,new bL(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),wL(i,ee(),e)}function qn(n,e,t,i){const r=wt();if(r.firstCreatePass){const s=Ei();TL(r,new bL(e,t,i),s.index),function UY(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}wL(r,ee(),t)}function Zt(){return function BY(n,e){return n[Es].queries[e].queryList}(ee(),_0())}function wL(n,e,t){const i=new ED(4==(4&t));(function Uq(n,e,t,i){const r=Jk(e);r.push(t),n.firstCreatePass&&Xk(n).push(i,r.length-1)})(n,e,i,i.destroy),null===e[Es]&&(e[Es]=new ID),e[Es].queries.push(new TD(i))}function TL(n,e,t){null===n.queries&&(n.queries=new CD),n.queries.track(new DD(e,t))}function IL(n,e){return n.queries.getByIndex(e)}const OD=new me("Application Initializer");let MD=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=ve(OD,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(km(s))t.push(s);else if(xF(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),jL=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const Ds=new me("LocaleId",{providedIn:"root",factory:()=>ve(Ds,ft.Optional|ft.SkipSelf)||function aQ(){return typeof $localize<"u"&&$localize.locale||Af}()});let $L=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new un(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class uQ{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let HL=(()=>{class n{compileModuleSync(t){return new _D(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=dl(mr(t).declarations).reduce((o,a)=>{const l=nt(a);return l&&o.push(new Rm(l)),o},[]);return new uQ(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const qL=new me(""),Wb=new me("");let BD,LD=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,BD||(function PQ(n){BD=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{rt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||n)(W(rt),W(VD),W(Wb))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac})}return n})(),VD=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return BD?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),fc=null;const KL=new me("AllowMultipleToken"),UD=new me("PlatformDestroyListeners"),jD=new me("appBootstrapListener");class YL{constructor(e,t){this.name=e,this.token=t}}function JL(n,e,t=[]){const i=`Platform: ${e}`,r=new me(i);return(s=[])=>{let o=$D();if(!o||o.injector.get(KL,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function kQ(n){if(fc&&!fc.get(KL,!1))throw new J(400,!1);(function ZL(){!function nC(n){Ih=n}(()=>{throw new J(600,!1)})})(),fc=n;const e=n.get(eV);(function QL(n){n.get(ck,null)?.forEach(t=>t())})(n)}(function XL(n=[],e){return er.create({name:e,providers:[{provide:v1,useValue:"platform"},{provide:UD,useValue:new Set([()=>fc=null])},...n]})}(a,i))}return function LQ(n){const e=$D();if(!e)throw new J(401,!1);return e}()}}function $D(){return fc?.get(eV)??null}let eV=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function VQ(n="zone.js",e){return"noop"===n?new wq:"zone.js"===n?new rt(e):n}(i?.ngZone,function tV(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const s=function ZZ(n,e,t){return new mD(n,e,t)}(t.moduleType,this.injector,function oV(n){return[{provide:rt,useFactory:n},{provide:wm,multi:!0,useFactory:()=>{const e=ve(UQ,{optional:!0});return()=>e.initialize()}},{provide:sV,useFactory:BQ},{provide:Dk,useFactory:Sk}]}(()=>r)),o=s.injector.get(ul,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:l=>{o.handleError(l)}});s.onDestroy(()=>{qb(this._modules,s),a.unsubscribe()})}),function nV(n,e,t){try{const i=t();return km(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(o,r,()=>{const a=s.injector.get(MD);return a.runInitializers(),a.donePromise.then(()=>(function S2(n){Yr(n,"Expected localeId to be defined"),"string"==typeof n&&(D2=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(Ds,Af)||Af),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,i=[]){const r=iV({},i);return function OQ(n,e,t){const i=new _D(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(pc);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new J(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new J(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(UD,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||n)(W(er))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function iV(n,e){return Array.isArray(e)?e.reduce(iV,n):{...n,...e}}let pc=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ve(sV),this.zoneIsStable=ve(Dk),this.componentTypes=[],this.components=[],this.isStable=ve($L).hasPendingTasks.pipe(Ot(t=>t?ye(!1):this.zoneIsStable),po(),Bs()),this._injector=ve(ss)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof pk;if(!this._injector.get(MD).done)throw!r&&function Wa(n){const e=nt(n)||Mn(n)||Jn(n);return null!==e&&e.standalone}(t),new J(405,!1);let o;o=r?t:this._injector.get(vb).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function MQ(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Zu),u=o.create(er.NULL,[],i||o.selector,a),h=u.location.nativeElement,g=u.injector.get(qL,null);return g?.registerApplication(h),u.onDestroy(()=>{this.detachView(u.hostView),qb(this.components,u),g?.unregisterApplication(h)}),this._loadComponent(u),u}tick(){if(this._runningTick)throw new J(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;qb(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(jD,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>qb(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new J(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function qb(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const sV=new me("",{providedIn:"root",factory:()=>ve(ul).handleError.bind(void 0)});function BQ(){const n=ve(rt),e=ve(ul);return t=>n.runOutsideAngular(()=>e.handleError(t))}let UQ=(()=>{class n{constructor(){this.zone=ve(rt),this.applicationRef=ve(pc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();let Js=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=$Q}return n})();function $Q(n){return function HQ(n,e,t){if(Qa(n)&&!t){const i=Qi(n.index,e);return new Am(i,i)}return 47&n.type?new Am(e[Dn],e):null}(Ei(),ee(),16==(16&n))}class dV{constructor(){}supports(e){return Ab(e)}create(e){return new ZQ(e)}}const KQ=(n,e)=>e;class ZQ{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||KQ}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<fV(i,r,s)?t:i,a=fV(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const u=a-r,h=l-r;if(u!=h){for(let m=0;m<u;m++){const y=m<s.length?s[m]:s[m]=0,b=y+m;h<=b&&b<u&&(s[m]=y+1)}s[o.previousIndex]=h-u}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Ab(e))throw new J(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function x7(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new YQ(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new hV),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new hV),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class YQ{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class QQ{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class hV{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new QQ,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function fV(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class pV{constructor(){}supports(e){return e instanceof Map||Q1(e)}create(){return new JQ}}class JQ{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||Q1(e)))throw new J(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new XQ(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class XQ{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function gV(){return new Yb([new dV])}let Yb=(()=>{class n{static#e=this.\u0275prov=oe({token:n,providedIn:"root",factory:gV});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||gV()),deps:[[n,new Wh,new oc]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new J(901,!1)}}return n})();function mV(){return new Km([new pV])}let Km=(()=>{class n{static#e=this.\u0275prov=oe({token:n,providedIn:"root",factory:mV});constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||mV()),deps:[[n,new Wh,new oc]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new J(901,!1)}}return n})();const nJ=JL(null,"core",[]);let iJ=(()=>{class n{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||n)(W(pc))};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})();function KD(n,e){const t=nt(n),i=e.elementInjector||hb();return new Rm(t).create(i,e.projectableNodes,e.hostElement,e.environmentInjector)}let ZD=null;function gc(){return ZD}class _J{}const Di=new me("DocumentToken");let YD=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:function(){return ve(vJ)},providedIn:"platform"})}return n})();const yJ=new me("Location Initialized");let vJ=(()=>{class n extends YD{constructor(){super(),this._doc=ve(Di),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return gc().getBaseHref(this._doc)}onPopState(t){const i=gc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=gc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:function(){return new n},providedIn:"platform"})}return n})();function QD(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function CV(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function pl(n){return n&&"?"!==n[0]?"?"+n:n}let Qu=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:function(){return ve(SV)},providedIn:"root"})}return n})();const DV=new me("appBaseHref");let SV=(()=>{class n extends Qu{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??ve(Di).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return QD(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+pl(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+pl(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+pl(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(W(YD),W(DV,8))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),bJ=(()=>{class n extends Qu{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=QD(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+pl(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+pl(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||n)(W(YD),W(DV,8))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac})}return n})(),JD=(()=>{class n{constructor(t){this._subject=new Fe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function TJ(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(CV(AV(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+pl(i))}normalize(t){return n.stripTrailingSlash(function wJ(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,AV(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+pl(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+pl(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=pl;static#t=this.joinWithSlash=QD;static#n=this.stripTrailingSlash=CV;static#i=this.\u0275fac=function(i){return new(i||n)(W(Qu))};static#r=this.\u0275prov=oe({token:n,factory:function(){return function EJ(){return new JD(W(Qu))}()},providedIn:"root"})}return n})();function AV(n){return n.replace(/\/index.html$/,"")}var Li=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(Li||{}),Lt=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(Lt||{}),Ss=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(Ss||{}),ci=function(n){return n[n.Decimal=0]="Decimal",n[n.Group=1]="Group",n[n.List=2]="List",n[n.PercentSign=3]="PercentSign",n[n.PlusSign=4]="PlusSign",n[n.MinusSign=5]="MinusSign",n[n.Exponential=6]="Exponential",n[n.SuperscriptingExponent=7]="SuperscriptingExponent",n[n.PerMille=8]="PerMille",n[n.Infinity=9]="Infinity",n[n.NaN=10]="NaN",n[n.TimeSeparator=11]="TimeSeparator",n[n.CurrencyDecimal=12]="CurrencyDecimal",n[n.CurrencyGroup=13]="CurrencyGroup",n}(ci||{});function Xb(n,e){return eo(Mr(n)[_n.DateFormat],e)}function eE(n,e){return eo(Mr(n)[_n.TimeFormat],e)}function tE(n,e){return eo(Mr(n)[_n.DateTimeFormat],e)}function Xs(n,e){const t=Mr(n),i=t[_n.NumberSymbols][e];if(typeof i>"u"){if(e===ci.CurrencyDecimal)return t[_n.NumberSymbols][ci.Decimal];if(e===ci.CurrencyGroup)return t[_n.NumberSymbols][ci.Group]}return i}function xV(n){if(!n[_n.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[_n.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function eo(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function tS(n){const[e,t]=n.split(":");return{hours:+e,minutes:+t}}const kJ=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Zm={},FJ=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var gl=function(n){return n[n.Short=0]="Short",n[n.ShortGMT=1]="ShortGMT",n[n.Long=2]="Long",n[n.Extended=3]="Extended",n}(gl||{}),jt=function(n){return n[n.FullYear=0]="FullYear",n[n.Month=1]="Month",n[n.Date=2]="Date",n[n.Hours=3]="Hours",n[n.Minutes=4]="Minutes",n[n.Seconds=5]="Seconds",n[n.FractionalSeconds=6]="FractionalSeconds",n[n.Day=7]="Day",n}(jt||{}),$t=function(n){return n[n.DayPeriods=0]="DayPeriods",n[n.Days=1]="Days",n[n.Months=2]="Months",n[n.Eras=3]="Eras",n}($t||{});function nS(n,e,t,i){let r=function zJ(n){if(MV(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[r,s=1,o=1]=n.split("-").map(a=>+a);return nE(r,s-1,o)}const t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(kJ))return function WJ(n){const e=new Date(0);let t=0,i=0;const r=n[8]?e.setUTCFullYear:e.setFullYear,s=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));const o=Number(n[4]||0)-t,a=Number(n[5]||0)-i,l=Number(n[6]||0),u=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return s.call(e,o,a,l,u),e}(i)}const e=new Date(n);if(!MV(e))throw new Error(`Unable to convert "${n}" into a date`);return e}(n);e=ml(t,e)||e;let a,o=[];for(;e;){if(a=FJ.exec(e),!a){o.push(e);break}{o=o.concat(a.slice(1));const h=o.pop();if(!h)break;e=h}}let l=r.getTimezoneOffset();i&&(l=OV(i,l),r=function GJ(n,e,t){const i=t?-1:1,r=n.getTimezoneOffset();return function HJ(n,e){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+e),n}(n,i*(OV(e,r)-r))}(r,i,!0));let u="";return o.forEach(h=>{const g=function $J(n){if(rS[n])return rS[n];let e;switch(n){case"G":case"GG":case"GGG":e=yn($t.Eras,Lt.Abbreviated);break;case"GGGG":e=yn($t.Eras,Lt.Wide);break;case"GGGGG":e=yn($t.Eras,Lt.Narrow);break;case"y":e=mi(jt.FullYear,1,0,!1,!0);break;case"yy":e=mi(jt.FullYear,2,0,!0,!0);break;case"yyy":e=mi(jt.FullYear,3,0,!1,!0);break;case"yyyy":e=mi(jt.FullYear,4,0,!1,!0);break;case"Y":e=oE(1);break;case"YY":e=oE(2,!0);break;case"YYY":e=oE(3);break;case"YYYY":e=oE(4);break;case"M":case"L":e=mi(jt.Month,1,1);break;case"MM":case"LL":e=mi(jt.Month,2,1);break;case"MMM":e=yn($t.Months,Lt.Abbreviated);break;case"MMMM":e=yn($t.Months,Lt.Wide);break;case"MMMMM":e=yn($t.Months,Lt.Narrow);break;case"LLL":e=yn($t.Months,Lt.Abbreviated,Li.Standalone);break;case"LLLL":e=yn($t.Months,Lt.Wide,Li.Standalone);break;case"LLLLL":e=yn($t.Months,Lt.Narrow,Li.Standalone);break;case"w":e=iS(1);break;case"ww":e=iS(2);break;case"W":e=iS(1,!0);break;case"d":e=mi(jt.Date,1);break;case"dd":e=mi(jt.Date,2);break;case"c":case"cc":e=mi(jt.Day,1);break;case"ccc":e=yn($t.Days,Lt.Abbreviated,Li.Standalone);break;case"cccc":e=yn($t.Days,Lt.Wide,Li.Standalone);break;case"ccccc":e=yn($t.Days,Lt.Narrow,Li.Standalone);break;case"cccccc":e=yn($t.Days,Lt.Short,Li.Standalone);break;case"E":case"EE":case"EEE":e=yn($t.Days,Lt.Abbreviated);break;case"EEEE":e=yn($t.Days,Lt.Wide);break;case"EEEEE":e=yn($t.Days,Lt.Narrow);break;case"EEEEEE":e=yn($t.Days,Lt.Short);break;case"a":case"aa":case"aaa":e=yn($t.DayPeriods,Lt.Abbreviated);break;case"aaaa":e=yn($t.DayPeriods,Lt.Wide);break;case"aaaaa":e=yn($t.DayPeriods,Lt.Narrow);break;case"b":case"bb":case"bbb":e=yn($t.DayPeriods,Lt.Abbreviated,Li.Standalone,!0);break;case"bbbb":e=yn($t.DayPeriods,Lt.Wide,Li.Standalone,!0);break;case"bbbbb":e=yn($t.DayPeriods,Lt.Narrow,Li.Standalone,!0);break;case"B":case"BB":case"BBB":e=yn($t.DayPeriods,Lt.Abbreviated,Li.Format,!0);break;case"BBBB":e=yn($t.DayPeriods,Lt.Wide,Li.Format,!0);break;case"BBBBB":e=yn($t.DayPeriods,Lt.Narrow,Li.Format,!0);break;case"h":e=mi(jt.Hours,1,-12);break;case"hh":e=mi(jt.Hours,2,-12);break;case"H":e=mi(jt.Hours,1);break;case"HH":e=mi(jt.Hours,2);break;case"m":e=mi(jt.Minutes,1);break;case"mm":e=mi(jt.Minutes,2);break;case"s":e=mi(jt.Seconds,1);break;case"ss":e=mi(jt.Seconds,2);break;case"S":e=mi(jt.FractionalSeconds,1);break;case"SS":e=mi(jt.FractionalSeconds,2);break;case"SSS":e=mi(jt.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=rE(gl.Short);break;case"ZZZZZ":e=rE(gl.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=rE(gl.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=rE(gl.Long);break;default:return null}return rS[n]=e,e}(h);u+=g?g(r,t,l):"''"===h?"'":h.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}function nE(n,e,t){const i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function ml(n,e){const t=function CJ(n){return Mr(n)[_n.LocaleId]}(n);if(Zm[t]=Zm[t]||{},Zm[t][e])return Zm[t][e];let i="";switch(e){case"shortDate":i=Xb(n,Ss.Short);break;case"mediumDate":i=Xb(n,Ss.Medium);break;case"longDate":i=Xb(n,Ss.Long);break;case"fullDate":i=Xb(n,Ss.Full);break;case"shortTime":i=eE(n,Ss.Short);break;case"mediumTime":i=eE(n,Ss.Medium);break;case"longTime":i=eE(n,Ss.Long);break;case"fullTime":i=eE(n,Ss.Full);break;case"short":const r=ml(n,"shortTime"),s=ml(n,"shortDate");i=iE(tE(n,Ss.Short),[r,s]);break;case"medium":const o=ml(n,"mediumTime"),a=ml(n,"mediumDate");i=iE(tE(n,Ss.Medium),[o,a]);break;case"long":const l=ml(n,"longTime"),u=ml(n,"longDate");i=iE(tE(n,Ss.Long),[l,u]);break;case"full":const h=ml(n,"fullTime"),g=ml(n,"fullDate");i=iE(tE(n,Ss.Full),[h,g])}return i&&(Zm[t][e]=i),i}function iE(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return null!=e&&i in e?e[i]:t})),n}function xo(n,e,t="-",i,r){let s="";(n<0||r&&n<=0)&&(r?n=1-n:(n=-n,s=t));let o=String(n);for(;o.length<e;)o="0"+o;return i&&(o=o.slice(o.length-e)),s+o}function mi(n,e,t=0,i=!1,r=!1){return function(s,o){let a=function VJ(n,e){switch(n){case jt.FullYear:return e.getFullYear();case jt.Month:return e.getMonth();case jt.Date:return e.getDate();case jt.Hours:return e.getHours();case jt.Minutes:return e.getMinutes();case jt.Seconds:return e.getSeconds();case jt.FractionalSeconds:return e.getMilliseconds();case jt.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,s);if((t>0||a>-t)&&(a+=t),n===jt.Hours)0===a&&-12===t&&(a=12);else if(n===jt.FractionalSeconds)return function LJ(n,e){return xo(n,3).substring(0,e)}(a,e);const l=Xs(o,ci.MinusSign);return xo(a,e,l,i,r)}}function yn(n,e,t=Li.Format,i=!1){return function(r,s){return function BJ(n,e,t,i,r,s){switch(t){case $t.Months:return function XD(n,e,t){const i=Mr(n),s=eo([i[_n.MonthsFormat],i[_n.MonthsStandalone]],e);return eo(s,t)}(e,r,i)[n.getMonth()];case $t.Days:return function NV(n,e,t){const i=Mr(n),s=eo([i[_n.DaysFormat],i[_n.DaysStandalone]],e);return eo(s,t)}(e,r,i)[n.getDay()];case $t.DayPeriods:const o=n.getHours(),a=n.getMinutes();if(s){const u=function NJ(n){const e=Mr(n);return xV(e),(e[_n.ExtraData][2]||[]).map(i=>"string"==typeof i?tS(i):[tS(i[0]),tS(i[1])])}(e),h=function xJ(n,e,t){const i=Mr(n);xV(i);const s=eo([i[_n.ExtraData][0],i[_n.ExtraData][1]],e)||[];return eo(s,t)||[]}(e,r,i),g=u.findIndex(m=>{if(Array.isArray(m)){const[y,b]=m,w=o>=y.hours&&a>=y.minutes,T=o<b.hours||o===b.hours&&a<b.minutes;if(y.hours<b.hours){if(w&&T)return!0}else if(w||T)return!0}else if(m.hours===o&&m.minutes===a)return!0;return!1});if(-1!==g)return h[g]}return function DJ(n,e,t){const i=Mr(n),s=eo([i[_n.DayPeriodsFormat],i[_n.DayPeriodsStandalone]],e);return eo(s,t)}(e,r,i)[o<12?0:1];case $t.Eras:return function SJ(n,e){return eo(Mr(n)[_n.Eras],e)}(e,i)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(r,s,n,e,t,i)}}function rE(n){return function(e,t,i){const r=-1*i,s=Xs(t,ci.MinusSign),o=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case gl.Short:return(r>=0?"+":"")+xo(o,2,s)+xo(Math.abs(r%60),2,s);case gl.ShortGMT:return"GMT"+(r>=0?"+":"")+xo(o,1,s);case gl.Long:return"GMT"+(r>=0?"+":"")+xo(o,2,s)+":"+xo(Math.abs(r%60),2,s);case gl.Extended:return 0===i?"Z":(r>=0?"+":"")+xo(o,2,s)+":"+xo(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}const UJ=0,sE=4;function PV(n){return nE(n.getFullYear(),n.getMonth(),n.getDate()+(sE-n.getDay()))}function iS(n,e=!1){return function(t,i){let r;if(e){const s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,o=t.getDate();r=1+Math.floor((o+s)/7)}else{const s=PV(t),o=function jJ(n){const e=nE(n,UJ,1).getDay();return nE(n,0,1+(e<=sE?sE:sE+7)-e)}(s.getFullYear()),a=s.getTime()-o.getTime();r=1+Math.round(a/6048e5)}return xo(r,n,Xs(i,ci.MinusSign))}}function oE(n,e=!1){return function(t,i){return xo(PV(t).getFullYear(),n,Xs(i,ci.MinusSign),e)}}const rS={};function OV(n,e){n=n.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function MV(n){return n instanceof Date&&!isNaN(n.valueOf())}const uS=/\s+/,VV=[];let BV=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this.initialClasses=VV,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(uS):VV}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(uS):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(uS).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||n)(O(Yb),O(Km),O(zt),O(Ts))};static#t=this.\u0275dir=_e({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return n})();class oX{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let _l=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new oX(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),jV(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{jV(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(O(Qs),O(Wn),O(Yb))};static#t=this.\u0275dir=_e({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return n})();function jV(n,e){n.context.$implicit=e.item}let yl=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new aX,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){$V("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){$V("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(O(Qs),O(Wn))};static#t=this.\u0275dir=_e({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return n})();class aX{constructor(){this.$implicit=null,this.ngIf=null}}function $V(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${G(e)}'.`)}let Ju=(()=>{class n{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(t){if(t.ngTemplateOutlet||t.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:s,ngTemplateOutletInjector:o}=this;this._viewRef=i.createEmbeddedView(r,s,o?{injector:o}:void 0)}else this._viewRef=null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}static#e=this.\u0275fac=function(i){return new(i||n)(O(Qs))};static#t=this.\u0275dir=_e({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[dn]})}return n})(),gS=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})();function lE(n){return"server"===n}let LX=(()=>{class n{static#e=this.\u0275prov=oe({token:n,providedIn:"root",factory:()=>new VX(W(Di),window)})}return n})();class VX{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function BX(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class cee extends _J{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class yS extends cee{static makeCurrent(){!function mJ(n){ZD||(ZD=n)}(new yS)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function uee(){return Jm=Jm||document.querySelector("base"),Jm?Jm.getAttribute("href"):null}();return null==t?null:function dee(n){dE=dE||document.createElement("a"),dE.setAttribute("href",n);const e=dE.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Jm=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function rX(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let dE,Jm=null,fee=(()=>{class n{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac})}return n})();const vS=new me("EventManagerPlugins");let YV=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new J(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||n)(W(vS),W(rt))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac})}return n})();class QV{constructor(e){this._doc=e}}const bS="ng-app-id";let JV=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=lE(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${bS}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(bS),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(bS,this.appId),o}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||n)(W(Di),W(fb),W(uk,8),W(Co))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac})}return n})();const ES={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},wS=/%COMP%/g,_ee=new me("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function eB(n,e){return e.map(t=>t.replace(wS,n))}let tB=(()=>{class n{constructor(t,i,r,s,o,a,l,u=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=lE(a),this.defaultRenderer=new TS(t,o,l,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Rr.ShadowDom&&(i={...i,encapsulation:Rr.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof iB?r.applyToHost(t):r instanceof IS&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,g=this.platformIsServer;switch(i.encapsulation){case Rr.Emulated:s=new iB(l,u,i,this.appId,h,o,a,g);break;case Rr.ShadowDom:return new Eee(l,u,t,i,o,a,this.nonce,g);default:s=new IS(l,u,i,h,o,a,g)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||n)(W(YV),W(JV),W(fb),W(_ee),W(Di),W(Co),W(rt),W(uk))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac})}return n})();class TS{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(ES[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(nB(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(nB(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new J(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=ES[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=ES[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(c.DashCase|c.Important)?e.style.setProperty(t,i,r&c.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&c.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=gc().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function nB(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Eee extends TS{constructor(e,t,i,r,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=eB(r.id,r.styles);for(const h of u){const g=document.createElement("style");a&&g.setAttribute("nonce",a),g.textContent=h,this.shadowRoot.appendChild(g)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class IS extends TS{constructor(e,t,i,r,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=l?eB(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class iB extends IS{constructor(e,t,i,r,s,o,a,l){const u=r+"-"+i.id;super(e,t,i,s,o,a,l,u),this.contentAttr=function yee(n){return"_ngcontent-%COMP%".replace(wS,n)}(u),this.hostAttr=function vee(n){return"_nghost-%COMP%".replace(wS,n)}(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let wee=(()=>{class n extends QV{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||n)(W(Di))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac})}return n})();const rB=["alt","control","meta","shift"],Tee={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Iee={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Cee=(()=>{class n extends QV{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>gc().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),rB.forEach(u=>{const h=i.indexOf(u);h>-1&&(i.splice(h,1),o+=u+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=Tee[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),rB.forEach(o=>{o!==r&&(0,Iee[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||n)(W(Di))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac})}return n})();const oB=[{provide:Co,useValue:"browser"},{provide:ck,useValue:function Dee(){yS.makeCurrent()},multi:!0},{provide:Di,useFactory:function Aee(){return function m9(n){u1=n}(document),document},deps:[]}],Ree=JL(nJ,"browser",oB),Nee=new me(""),aB=[{provide:Wb,useClass:class hee{addToWindow(e){sn.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new J(5103,!1);return s},sn.getAllAngularTestabilities=()=>e.getAllTestabilities(),sn.getAllAngularRootElements=()=>e.getAllRootElements(),sn.frameworkStabilizers||(sn.frameworkStabilizers=[]),sn.frameworkStabilizers.push(i=>{const r=sn.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(l=>{l.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?gc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:qL,useClass:LD,deps:[rt,VD,Wb]},{provide:LD,useClass:LD,deps:[rt,VD,Wb]}],lB=[{provide:v1,useValue:"root"},{provide:ul,useFactory:function See(){return new ul},deps:[]},{provide:vS,useClass:wee,multi:!0,deps:[Di,rt,Co]},{provide:vS,useClass:Cee,multi:!0,deps:[Di]},tB,JV,YV,{provide:O1,useExisting:tB},{provide:class UX{},useClass:fee,deps:[]},[]];let xee=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:fb,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||n)(W(Nee,12))};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({providers:[...lB,...aB],imports:[gS,iJ]})}return n})(),cB=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(i){return new(i||n)(W(Di))};static#t=this.\u0275prov=oe({token:n,factory:function(i){let r=null;return r=i?new i:function Oee(){return new cB(W(Di))}(),r},providedIn:"root"})}return n})();typeof window<"u"&&window;class DS extends xe{notifyNext(e,t,i,r,s){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class Bee extends xe{constructor(e,t,i){super(),this.parent=e,this.outerValue=t,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function SS(n,e,t,i,r=new Bee(n,t,i)){if(!r.closed)return e instanceof $e?e.subscribe(r):fr(e)(r)}const fB={};function AS(...n){let e,t;return hr(n[n.length-1])&&(t=n.pop()),"function"==typeof n[n.length-1]&&(e=n.pop()),1===n.length&&Bt(n[0])&&(n=n[0]),Ht(n,t).lift(new Uee(e))}class Uee{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new jee(e,this.resultSelector))}}class jee extends DS{constructor(e,t){super(e),this.resultSelector=t,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(fB),this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(let i=0;i<t;i++)this.add(SS(this,e[i],void 0,i))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,t,i){const r=this.values,o=this.toRespond?r[i]===fB?--this.toRespond:this.toRespond:0;r[i]=t,0===o&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))}_tryResultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const hE=(()=>{function n(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return n.prototype=Object.create(Error.prototype),n})();function fE(...n){return function $ee(){return Q(1)}()(ye(...n))}const _c=new $e(n=>n.complete());function pE(n){return n?function Hee(n){return new $e(e=>n.schedule(()=>e.complete()))}(n):_c}function pB(n){return new $e(e=>{let t;try{t=n()}catch(r){return void e.error(r)}return(t?N(t):pE()).subscribe(e)})}function Mf(n,e){return new $e(e?t=>e.schedule(Gee,0,{error:n,subscriber:t}):t=>t.error(n))}function Gee({error:n,subscriber:e}){e.error(n)}const gB=(()=>{function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n})();function nr(n){return e=>0===n?pE():e.lift(new zee(n))}class zee{constructor(e){if(this.total=e,this.total<0)throw new gB}call(e,t){return t.subscribe(new Wee(e,this.total))}}class Wee extends xe{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}function Xm(...n){const e=n[n.length-1];return hr(e)?(n.pop(),t=>fE(n,t,e)):t=>fE(n,t)}function _i(n,e){return function(i){return i.lift(new qee(n,e))}}class qee{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new Kee(e,this.predicate,this.thisArg))}}class Kee extends xe{constructor(e,t,i){super(e),this.predicate=t,this.thisArg=i,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}function gE(n=null){return e=>e.lift(new Zee(n))}class Zee{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new Yee(e,this.defaultValue))}}class Yee extends xe{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function mB(n=Xee){return e=>e.lift(new Qee(n))}class Qee{constructor(e){this.errorFactory=e}call(e,t){return t.subscribe(new Jee(e,this.errorFactory))}}class Jee extends xe{constructor(e,t){super(e),this.errorFactory=t,this.hasValue=!1}_next(e){this.hasValue=!0,this.destination.next(e)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}}function Xee(){return new hE}function yc(n,e){const t=arguments.length>=2;return i=>i.pipe(n?_i((r,s)=>n(r,s,i)):Yn,nr(1),t?gE(e):mB(()=>new hE))}function e_(n,e){return Ue(n,e,1)}function vc(){}function Si(n,e,t){return function(r){return r.lift(new ete(n,e,t))}}class ete{constructor(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}call(e,t){return t.subscribe(new tte(e,this.nextOrObserver,this.error,this.complete))}}class tte extends xe{constructor(e,t,i,r){super(e),this._tapNext=vc,this._tapError=vc,this._tapComplete=vc,this._tapError=i||vc,this._tapComplete=r||vc,D(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||vc,this._tapError=t.error||vc,this._tapComplete=t.complete||vc)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}function kf(n){return function(t){const i=new nte(n),r=t.lift(i);return i.caught=r}}class nte{constructor(e){this.selector=e}call(e,t){return t.subscribe(new ite(e,this.selector,this.caught))}}class ite extends X{constructor(e,t,i){super(e),this.selector=t,this.caught=i}error(e){if(!this.isStopped){let t;try{t=this.selector(e,this.caught)}catch(s){return void super.error(s)}this._unsubscribeAndRecycle();const i=new k(this);this.add(i);const r=se(t,i);r!==i&&this.add(r)}}}function Ff(n,e){let t=!1;return arguments.length>=2&&(t=!0),function(r){return r.lift(new rte(n,e,t))}}class rte{constructor(e,t,i=!1){this.accumulator=e,this.seed=t,this.hasSeed=i}call(e,t){return t.subscribe(new ste(e,this.accumulator,this.seed,this.hasSeed))}}class ste extends xe{constructor(e,t,i,r){super(e),this.accumulator=t,this._seed=i,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(e){this.hasSeed=!0,this._seed=e}_next(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}_tryNext(e){const t=this.index++;let i;try{i=this.accumulator(this.seed,e,t)}catch(r){this.destination.error(r)}this.seed=i,this.destination.next(i)}}function RS(n){return function(t){return 0===n?pE():t.lift(new ote(n))}}class ote{constructor(e){if(this.total=e,this.total<0)throw new gB}call(e,t){return t.subscribe(new ate(e,this.total))}}class ate extends xe{constructor(e,t){super(e),this.total=t,this.ring=new Array,this.count=0}_next(e){const t=this.ring,i=this.total,r=this.count++;t.length<i?t.push(e):t[r%i]=e}_complete(){const e=this.destination;let t=this.count;if(t>0){const i=this.count>=this.total?this.total:this.count,r=this.ring;for(let s=0;s<i;s++){const o=t++%i;e.next(r[o])}}e.complete()}}class ute{constructor(e){this.value=e}call(e,t){return t.subscribe(new dte(e,this.value))}}class dte extends xe{constructor(e,t){super(e),this.value=t}_next(e){this.destination.next(this.value)}}function NS(n){return e=>e.lift(new hte(n))}class hte{constructor(e){this.callback=e}call(e,t){return t.subscribe(new fte(e,this.callback))}}class fte extends xe{constructor(e,t){super(e),this.add(new $(t))}}function ti(n){return e=>e.lift(new pte(n))}class pte{constructor(e){this.notifier=e}call(e,t){const i=new gte(e),r=se(this.notifier,new k(i));return r&&!i.seenValue?(i.add(r),t.subscribe(i)):i}}class gte extends X{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}const lt="primary",t_=Symbol("RouteTitle");class mte{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Lf(n){return new mte(n)}function _te(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function ga(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!_B(n[r],e[r]))return!1;return!0}function _B(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function yB(n){return n.length>0?n[n.length-1]:null}function bc(n){return function Vee(n){return!!n&&(n instanceof $e||"function"==typeof n.lift&&"function"==typeof n.subscribe)}(n)?n:km(n)?N(Promise.resolve(n)):ye(n)}const vte={exact:function EB(n,e,t){if(!Xu(n.segments,e.segments)||!mE(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!EB(n.children[i],e.children[i],t))return!1;return!0},subset:wB},vB={exact:function bte(n,e){return ga(n,e)},subset:function Ete(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>_B(n[t],e[t]))},ignored:()=>!0};function bB(n,e,t){return vte[t.paths](n.root,e.root,t.matrixParams)&&vB[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function wB(n,e,t){return TB(n,e,e.segments,t)}function TB(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!Xu(r,t)||e.hasChildren()||!mE(r,t,i))}if(n.segments.length===t.length){if(!Xu(n.segments,t)||!mE(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!wB(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(Xu(n.segments,r)&&mE(n.segments,r,i)&&n.children[lt])&&TB(n.children[lt],e,s,i)}}function mE(n,e,t){return e.every((i,r)=>vB[t](n[r].parameters,i.parameters))}class Vf{constructor(e=new en([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Lf(this.queryParams)),this._queryParamMap}toString(){return Ite.serialize(this)}}class en{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return _E(this)}}class n_{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Lf(this.parameters)),this._parameterMap}toString(){return DB(this)}}function Xu(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let i_=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:function(){return new xS},providedIn:"root"})}return n})();class xS{parse(e){const t=new kte(e);return new Vf(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${r_(e.root,!0)}`,i=function Ste(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${yE(t)}=${yE(r)}`).join("&"):`${yE(t)}=${yE(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams),r="string"==typeof e.fragment?`#${function Cte(n){return encodeURI(n)}(e.fragment)}`:"";return`${t}${i}${r}`}}const Ite=new xS;function _E(n){return n.segments.map(e=>DB(e)).join("/")}function r_(n,e){if(!n.hasChildren())return _E(n);if(e){const t=n.children[lt]?r_(n.children[lt],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==lt&&i.push(`${r}:${r_(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function Tte(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===lt&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==lt&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===lt?[r_(n.children[lt],!1)]:[`${r}:${r_(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[lt]?`${_E(n)}/${t[0]}`:`${_E(n)}/(${t.join("//")})`}}function IB(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function yE(n){return IB(n).replace(/%3B/gi,";")}function PS(n){return IB(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function vE(n){return decodeURIComponent(n)}function CB(n){return vE(n.replace(/\+/g,"%20"))}function DB(n){return`${PS(n.path)}${function Dte(n){return Object.keys(n).map(e=>`;${PS(e)}=${PS(n[e])}`).join("")}(n.parameters)}`}const Ate=/^[^\/()?;#]+/;function OS(n){const e=n.match(Ate);return e?e[0]:""}const Rte=/^[^\/()?;=#]+/,xte=/^[^=?&#]+/,Ote=/^[^&#]+/;class kte{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new en([],{}):new en([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[lt]=new en(e,t)),i}parseSegment(){const e=OS(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new J(4009,!1);return this.capture(e),new n_(vE(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function Nte(n){const e=n.match(Rte);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=OS(this.remaining);r&&(i=r,this.capture(i))}e[vE(t)]=vE(i)}parseQueryParam(e){const t=function Pte(n){const e=n.match(xte);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function Mte(n){const e=n.match(Ote);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=CB(t),s=CB(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=OS(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new J(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=lt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[lt]:new en([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new J(4011,!1)}}function SB(n){return n.segments.length>0?new en([],{[lt]:n}):n}function AB(n){const e={};for(const i of Object.keys(n.children)){const s=AB(n.children[i]);if(i===lt&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function Fte(n){if(1===n.numberOfChildren&&n.children[lt]){const e=n.children[lt];return new en(n.segments.concat(e.segments),e.children)}return n}(new en(n.segments,e))}function ed(n){return n instanceof Vf}function RB(n){let e;const r=SB(function t(s){const o={};for(const l of s.children){const u=t(l);o[l.outlet]=u}const a=new en(s.url,o);return s===n&&(e=a),a}(n.root));return e??r}function NB(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return MS(r,r,r,t,i);const s=function Vte(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new PB(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([l,u])=>{a[l]="string"==typeof u?u.split("/"):u}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new PB(t,e,i)}(e);if(s.toRoot())return MS(r,r,new en([],{}),t,i);const o=function Bte(n,e,t){if(n.isAbsolute)return new EE(e,!0,0);if(!t)return new EE(e,!1,NaN);if(null===t.parent)return new EE(t,!0,0);const i=bE(n.commands[0])?0:1;return function Ute(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new J(4005,!1);r=i.segments.length}return new EE(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),a=o.processChildren?o_(o.segmentGroup,o.index,s.commands):OB(o.segmentGroup,o.index,s.commands);return MS(r,o.segmentGroup,a,t,i)}function bE(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function s_(n){return"object"==typeof n&&null!=n&&n.outlets}function MS(n,e,t,i,r){let o,s={};i&&Object.entries(i).forEach(([l,u])=>{s[l]=Array.isArray(u)?u.map(h=>`${h}`):`${u}`}),o=n===e?t:xB(n,e,t);const a=SB(AB(o));return new Vf(a,s,r)}function xB(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:xB(s,e,t)}),new en(n.segments,i)}class PB{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&bE(i[0]))throw new J(4003,!1);const r=i.find(s_);if(r&&r!==yB(i))throw new J(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class EE{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function OB(n,e,t){if(n||(n=new en([],{})),0===n.segments.length&&n.hasChildren())return o_(n,e,t);const i=function $te(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(s_(a))break;const l=`${a}`,u=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&u&&"object"==typeof u&&void 0===u.outlets){if(!kB(l,u,o))return s;i+=2}else{if(!kB(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new en(n.segments.slice(0,i.pathIndex),{});return s.children[lt]=new en(n.segments.slice(i.pathIndex),n.children),o_(s,0,r)}return i.match&&0===r.length?new en(n.segments,{}):i.match&&!n.hasChildren()?kS(n,e,t):i.match?o_(n,0,r):kS(n,e,t)}function o_(n,e,t){if(0===t.length)return new en(n.segments,{});{const i=function jte(n){return s_(n[0])?n[0].outlets:{[lt]:n}}(t),r={};if(Object.keys(i).some(s=>s!==lt)&&n.children[lt]&&1===n.numberOfChildren&&0===n.children[lt].segments.length){const s=o_(n.children[lt],e,t);return new en(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=OB(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new en(n.segments,r)}}function kS(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(s_(s)){const l=Hte(s.outlets);return new en(i,l)}if(0===r&&bE(t[0])){i.push(new n_(n.segments[e].path,MB(t[0]))),r++;continue}const o=s_(s)?s.outlets[lt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&bE(a)?(i.push(new n_(o,MB(a))),r+=2):(i.push(new n_(o,{})),r++)}return new en(i,{})}function Hte(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=kS(new en([],{}),0,i))}),e}function MB(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function kB(n,e,t){return n==t.path&&ga(e,t.parameters)}const a_="imperative";class ma{constructor(e,t){this.id=e,this.url=t}}class wE extends ma{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ec extends ma{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class l_ extends ma{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Bf extends ma{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class TE extends ma{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class FB extends ma{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Gte extends ma{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zte extends ma{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Wte extends ma{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class qte extends ma{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Kte{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Zte{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Yte{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Qte{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Jte{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Xte{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class LB{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class FS{}class LS{constructor(e){this.url=e}}class ene{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new c_,this.attachRef=null}}let c_=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new ene,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class VB{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=VS(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=VS(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=BS(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return BS(e,this._root).map(t=>t.value)}}function VS(n,e){if(n===e.value)return e;for(const t of e.children){const i=VS(n,t);if(i)return i}return null}function BS(n,e){if(n===e.value)return[e];for(const t of e.children){const i=BS(n,t);if(i.length)return i.unshift(e),i}return[]}class vl{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Uf(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class BB extends VB{constructor(e,t){super(e),this.snapshot=t,US(this,e)}toString(){return this.snapshot.toString()}}function UB(n,e){const t=function tne(n,e){const o=new IE([],{},{},"",{},lt,e,null,{});return new $B("",new vl(o,[]))}(0,e),i=new un([new n_("",{})]),r=new un({}),s=new un({}),o=new un({}),a=new un(""),l=new jf(i,r,o,a,s,lt,e,t.root);return l.snapshot=t.root,new BB(new vl(l,[]),t)}class jf{constructor(e,t,i,r,s,o,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Ne(u=>u[t_]))??ye(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Ne(e=>Lf(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Ne(e=>Lf(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function jB(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function nne(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class IE{get title(){return this.data?.[t_]}constructor(e,t,i,r,s,o,a,l,u){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Lf(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Lf(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class $B extends VB{constructor(e,t){super(t),this.url=e,US(this,t)}toString(){return HB(this._root)}}function US(n,e){e.value._routerState=n,e.children.forEach(t=>US(n,t))}function HB(n){const e=n.children.length>0?` { ${n.children.map(HB).join(", ")} } `:"";return`${n.value}${e}`}function jS(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,ga(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),ga(e.params,t.params)||n.paramsSubject.next(t.params),function yte(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!ga(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),ga(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function $S(n,e){const t=ga(n.params,e.params)&&function wte(n,e){return Xu(n,e)&&n.every((t,i)=>ga(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||$S(n.parent,e.parent))}let GB=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=lt,this.activateEvents=new Fe,this.deactivateEvents=new Fe,this.attachEvents=new Fe,this.detachEvents=new Fe,this.parentContexts=ve(c_),this.location=ve(Qs),this.changeDetector=ve(Js),this.environmentInjector=ve(ss),this.inputBinder=ve(CE,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new J(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new J(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new J(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new J(4013,!1);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new ine(t,a,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=_e({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[dn]})}return n})();class ine{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===jf?this.route:e===c_?this.childContexts:this.parent.get(e,t)}}const CE=new me("");let zB=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=AS([i.queryParams,i.params,i.data]).pipe(Ot(([s,o,a],l)=>(a={...s,...o,...a},0===l?ye(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const o=function gJ(n){const e=nt(n);if(!e)return null;const t=new Rm(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(o)for(const{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac})}return n})();function u_(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function sne(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return u_(n,i,r);return u_(n,i)})}(n,e,t);return new vl(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>u_(n,a)),o}}const i=function one(n){return new jf(new un(n.url),new un(n.params),new un(n.queryParams),new un(n.fragment),new un(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>u_(n,s));return new vl(i,r)}}const HS="ngNavigationCancelingError";function WB(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=ed(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=qB(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function qB(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[HS]=!0,i.cancellationCode=e,t&&(i.url=t),i}function KB(n){return n&&n[HS]}let ZB=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=gr({type:n,selectors:[["ng-component"]],standalone:!0,features:[Cs],decls:1,vars:0,template:function(i,r){1&i&&tr(0,"router-outlet")},dependencies:[GB],encapsulation:2})}return n})();function GS(n){const e=n.children&&n.children.map(GS),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==lt&&(t.component=ZB),t}function Oo(n){return n.outlet||lt}function d_(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class pne{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),jS(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=Uf(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Uf(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Uf(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=Uf(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new Xte(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Qte(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(jS(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),jS(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=d_(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class YB{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class DE{constructor(e,t){this.component=e,this.route=t}}function gne(n,e,t){const i=n._root;return h_(i,e?e._root:null,t,[i.value])}function $f(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function GO(n){return null!==Oi(n)}(n)?e.get(n):n:i}function h_(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Uf(e);return n.children.forEach(o=>{(function _ne(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function yne(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Xu(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Xu(n.url,e.url)||!ga(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!$S(n,e)||!ga(n.queryParams,e.queryParams);default:return!$S(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new YB(i)):(s.data=o.data,s._resolvedData=o._resolvedData),h_(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new DE(a.outlet.component,o))}else o&&f_(e,a,r),r.canActivateChecks.push(new YB(i)),h_(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>f_(a,t.getContext(o),r)),r}function f_(n,e,t){const i=Uf(n),r=n.value;Object.entries(i).forEach(([s,o])=>{f_(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new DE(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function p_(n){return"function"==typeof n}function QB(n){return n instanceof hE||"EmptyError"===n?.name}const SE=Symbol("INITIAL_VALUE");function Hf(){return Ot(n=>AS(n.map(e=>e.pipe(nr(1),Xm(SE)))).pipe(Ne(e=>{for(const t of e)if(!0!==t){if(t===SE)return SE;if(!1===t||t instanceof Vf)return t}return!0}),_i(e=>e!==SE),nr(1)))}function JB(n){return function xi(...n){return Hn(n)}(Si(e=>{if(ed(e))throw WB(0,e)}),Ne(e=>!0===e))}class AE{constructor(e){this.segmentGroup=e||null}}class XB{constructor(e){this.urlTree=e}}function Gf(n){return Mf(new AE(n))}function eU(n){return Mf(new XB(n))}class Vne{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new J(4002,!1)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return ye(i);if(r.numberOfChildren>1||!r.children[lt])return Mf(new J(4e3,!1));r=r.children[lt]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Vf(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);i[r]=t[a]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Object.entries(t.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,i,r)}),new en(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new J(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const zS={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Bne(n,e,t,i,r){const s=WS(n,e,t);return s.matched?(i=function lne(n,e){return n.providers&&!n._injector&&(n._injector=yD(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function kne(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?ye(r.map(o=>{const a=$f(o,n);return bc(function Ine(n){return n&&p_(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(Hf(),JB()):ye(!0)}(i,e,t).pipe(Ne(o=>!0===o?s:{...zS}))):ye(s)}function WS(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...zS}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||_te)(t,n,e);if(!r)return{...zS};const s={};Object.entries(r.posParams??{}).forEach(([a,l])=>{s[a]=l.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function tU(n,e,t,i){return t.length>0&&function $ne(n,e,t){return t.some(i=>RE(n,e,i)&&Oo(i)!==lt)}(n,t,i)?{segmentGroup:new en(e,jne(i,new en(t,n.children))),slicedSegments:[]}:0===t.length&&function Hne(n,e,t){return t.some(i=>RE(n,e,i))}(n,t,i)?{segmentGroup:new en(n.segments,Une(n,0,t,i,n.children)),slicedSegments:t}:{segmentGroup:new en(n.segments,n.children),slicedSegments:t}}function Une(n,e,t,i,r){const s={};for(const o of i)if(RE(n,t,o)&&!r[Oo(o)]){const a=new en([],{});s[Oo(o)]=a}return{...r,...s}}function jne(n,e){const t={};t[lt]=e;for(const i of n)if(""===i.path&&Oo(i)!==lt){const r=new en([],{});t[Oo(i)]=r}return t}function RE(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class qne{constructor(e,t,i,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new Vne(this.urlSerializer,this.urlTree)}noMatchError(e){return new J(4002,!1)}recognize(){const e=tU(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,lt).pipe(kf(t=>{if(t instanceof XB)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof AE?this.noMatchError(t):t}),Ne(t=>{const i=new IE([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},lt,this.rootComponentType,null,{}),r=new vl(i,t),s=new $B("",r),o=function Lte(n,e,t=null,i=null){return NB(RB(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,lt).pipe(kf(i=>{throw i instanceof AE?this.noMatchError(i):i}))}inheritParamsAndData(e){const t=e.value,i=jB(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0)}processChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return N(r).pipe(e_(s=>{const o=i.children[s],a=function hne(n,e){const t=n.filter(i=>Oo(i)===e);return t.push(...n.filter(i=>Oo(i)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),Ff((s,o)=>(s.push(...o),s)),gE(null),function lte(n,e){const t=arguments.length>=2;return i=>i.pipe(n?_i((r,s)=>n(r,s,i)):Yn,RS(1),t?gE(e):mB(()=>new hE))}(),Ue(s=>{if(null===s)return Gf(i);const o=nU(s);return function Kne(n){n.sort((e,t)=>e.value.outlet===lt?-1:t.value.outlet===lt?1:e.value.outlet.localeCompare(t.value.outlet))}(o),ye(o)}))}processSegment(e,t,i,r,s,o){return N(t).pipe(e_(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,i,r,s,o).pipe(kf(l=>{if(l instanceof AE)return ye(null);throw l}))),yc(a=>!!a),kf(a=>{if(QB(a))return function zne(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?ye([]):Gf(i);throw a}))}processSegmentAgainstRoute(e,t,i,r,s,o,a){return function Gne(n,e,t,i){return!!(Oo(n)===i||i!==lt&&RE(e,t,n))&&("**"===n.path||WS(e,n,t).matched)}(i,r,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o):Gf(r):Gf(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?eU(s):this.applyRedirects.lineralizeSegments(i,s).pipe(Ue(o=>{const a=new en(o,{});return this.processSegment(e,t,a,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:u,positionalParamSegments:h}=WS(t,r,s);if(!a)return Gf(t);const g=this.applyRedirects.applyRedirectCommands(l,r.redirectTo,h);return r.redirectTo.startsWith("/")?eU(g):this.applyRedirects.lineralizeSegments(r,g).pipe(Ue(m=>this.processSegment(e,i,t,m.concat(u),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s,o){let a;if("**"===i.path){const l=r.length>0?yB(r).parameters:{};a=ye({snapshot:new IE(r,l,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,iU(i),Oo(i),i.component??i._loadedComponent??null,i,rU(i)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=Bne(t,i,r,e).pipe(Ne(({matched:l,consumedSegments:u,remainingSegments:h,parameters:g})=>l?{snapshot:new IE(u,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,iU(i),Oo(i),i.component??i._loadedComponent??null,i,rU(i)),consumedSegments:u,remainingSegments:h}:null));return a.pipe(Ot(l=>null===l?Gf(t):this.getChildConfig(e=i._injector??e,i,r).pipe(Ot(({routes:u})=>{const h=i._loadedInjector??e,{snapshot:g,consumedSegments:m,remainingSegments:y}=l,{segmentGroup:b,slicedSegments:w}=tU(t,m,y,u);if(0===w.length&&b.hasChildren())return this.processChildren(h,u,b).pipe(Ne(P=>null===P?null:[new vl(g,P)]));if(0===u.length&&0===w.length)return ye([new vl(g,[])]);const T=Oo(i)===s;return this.processSegment(h,u,b,w,T?lt:s,!0).pipe(Ne(P=>[new vl(g,P)]))}))))}getChildConfig(e,t,i){return t.children?ye({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?ye({routes:t._loadedRoutes,injector:t._loadedInjector}):function Mne(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?ye(!0):ye(r.map(o=>{const a=$f(o,n);return bc(function bne(n){return n&&p_(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(Hf(),JB())}(e,t,i).pipe(Ue(r=>r?this.configLoader.loadChildren(e,t).pipe(Si(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function Lne(n){return Mf(qB(!1,3))}())):ye({routes:[],injector:e})}}function Zne(n){const e=n.value.routeConfig;return e&&""===e.path}function nU(n){const e=[],t=new Set;for(const i of n){if(!Zne(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=nU(i.children);e.push(new vl(i.value,r))}return e.filter(i=>!t.has(i))}function iU(n){return n.data||{}}function rU(n){return n.resolve||{}}function sU(n){return"string"==typeof n.title||null===n.title}function qS(n){return Ot(e=>{const t=n(e);return t?N(t).pipe(Ne(()=>e)):ye(e)})}const zf=new me("ROUTES");let KS=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ve(HL)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return ye(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=bc(t.loadComponent()).pipe(Ne(oU),Si(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),NS(()=>{this.componentLoaders.delete(t)})),r=new Kr(i,()=>new Qe).pipe(vi());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return ye({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=function nie(n,e,t,i){return bc(n.loadChildren()).pipe(Ne(oU),Ue(r=>r instanceof J2||Array.isArray(r)?ye(r):N(e.compileModuleAsync(r))),Ne(r=>{i&&i(n);let s,o,a=!1;return Array.isArray(r)?(o=r,!0):(s=r.create(t).injector,o=s.get(zf,[],{optional:!0,self:!0}).flat()),{routes:o.map(GS),injector:s}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(NS(()=>{this.childrenLoaders.delete(i)})),o=new Kr(s,()=>new Qe).pipe(vi());return this.childrenLoaders.set(i,o),o}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function oU(n){return function iie(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let NE=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Qe,this.transitionAbortSubject=new Qe,this.configLoader=ve(KS),this.environmentInjector=ve(ss),this.urlSerializer=ve(i_),this.rootContexts=ve(c_),this.inputBindingEnabled=null!==ve(CE,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>ye(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new Zte(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new Kte(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new un({id:0,currentUrlTree:i,currentRawUrl:i,currentBrowserUrl:i,extractedUrl:t.urlHandlingStrategy.extract(i),urlAfterRedirects:t.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:a_,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(_i(s=>0!==s.id),Ne(s=>({...s,extractedUrl:t.urlHandlingStrategy.extract(s.rawUrl)})),Ot(s=>{this.currentTransition=s;let o=!1,a=!1;return ye(s).pipe(Si(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Ot(l=>{const u=l.currentBrowserUrl.toString(),h=!t.navigated||l.extractedUrl.toString()!==u||u!==l.currentUrlTree.toString();if(!h&&"reload"!==(l.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const m="";return this.events.next(new Bf(l.id,this.urlSerializer.serialize(l.rawUrl),m,0)),l.resolve(null),_c}if(t.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return ye(l).pipe(Ot(m=>{const y=this.transitions?.getValue();return this.events.next(new wE(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),y!==this.transitions?.getValue()?_c:Promise.resolve(m)}),function Yne(n,e,t,i,r,s){return Ue(o=>function Wne(n,e,t,i,r,s,o="emptyOnly"){return new qne(n,e,t,i,r,o,s).recognize()}(n,e,t,i,o.extractedUrl,r,s).pipe(Ne(({state:a,tree:l})=>({...o,targetSnapshot:a,urlAfterRedirects:l}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),Si(m=>{s.targetSnapshot=m.targetSnapshot,s.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects};const y=new FB(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(y)}));if(h&&t.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){const{id:m,extractedUrl:y,source:b,restoredState:w,extras:T}=l,P=new wE(m,this.urlSerializer.serialize(y),b,w);this.events.next(P);const S=UB(0,this.rootComponentType).snapshot;return this.currentTransition=s={...l,targetSnapshot:S,urlAfterRedirects:y,extras:{...T,skipLocationChange:!1,replaceUrl:!1}},ye(s)}{const m="";return this.events.next(new Bf(l.id,this.urlSerializer.serialize(l.extractedUrl),m,1)),l.resolve(null),_c}}),Si(l=>{const u=new Gte(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),Ne(l=>(this.currentTransition=s={...l,guards:gne(l.targetSnapshot,l.currentSnapshot,this.rootContexts)},s)),function Dne(n,e){return Ue(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?ye({...t,guardsResult:!0}):function Sne(n,e,t,i){return N(n).pipe(Ue(r=>function One(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?ye(s.map(a=>{const l=d_(e)??r,u=$f(a,l);return bc(function Tne(n){return n&&p_(n.canDeactivate)}(u)?u.canDeactivate(n,e,t,i):l.runInContext(()=>u(n,e,t,i))).pipe(yc())})).pipe(Hf()):ye(!0)}(r.component,r.route,t,e,i)),yc(r=>!0!==r,!0))}(o,i,r,n).pipe(Ue(a=>a&&function vne(n){return"boolean"==typeof n}(a)?function Ane(n,e,t,i){return N(e).pipe(e_(r=>fE(function Nne(n,e){return null!==n&&e&&e(new Yte(n)),ye(!0)}(r.route.parent,i),function Rne(n,e){return null!==n&&e&&e(new Jte(n)),ye(!0)}(r.route,i),function Pne(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function mne(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>pB(()=>ye(o.guards.map(l=>{const u=d_(o.node)??t,h=$f(l,u);return bc(function wne(n){return n&&p_(n.canActivateChild)}(h)?h.canActivateChild(i,n):u.runInContext(()=>h(i,n))).pipe(yc())})).pipe(Hf())));return ye(s).pipe(Hf())}(n,r.path,t),function xne(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return ye(!0);const r=i.map(s=>pB(()=>{const o=d_(e)??t,a=$f(s,o);return bc(function Ene(n){return n&&p_(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(yc())}));return ye(r).pipe(Hf())}(n,r.route,t))),yc(r=>!0!==r,!0))}(i,s,n,e):ye(a)),Ne(a=>({...t,guardsResult:a})))})}(this.environmentInjector,l=>this.events.next(l)),Si(l=>{if(s.guardsResult=l.guardsResult,ed(l.guardsResult))throw WB(0,l.guardsResult);const u=new zte(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),_i(l=>!!l.guardsResult||(this.cancelNavigationTransition(l,"",3),!1)),qS(l=>{if(l.guards.canActivateChecks.length)return ye(l).pipe(Si(u=>{const h=new Wte(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}),Ot(u=>{let h=!1;return ye(u).pipe(function Qne(n,e){return Ue(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return ye(t);let s=0;return N(r).pipe(e_(o=>function Jne(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!sU(r)&&(s[t_]=r.title),function Xne(n,e,t,i){const r=function eie(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return ye({});const s={};return N(r).pipe(Ue(o=>function tie(n,e,t,i){const r=d_(e)??i,s=$f(n,r);return bc(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[o],e,t,i).pipe(yc(),Si(a=>{s[o]=a}))),RS(1),function cte(n){return e=>e.lift(new ute(n))}(s),kf(o=>QB(o)?_c:Mf(o)))}(s,n,e,i).pipe(Ne(o=>(n._resolvedData=o,n.data=jB(n,t).resolve,r&&sU(r)&&(n.data[t_]=r.title),null)))}(o.route,i,n,e)),Si(()=>s++),RS(1),Ue(o=>s===r.length?ye(t):_c))})}(t.paramsInheritanceStrategy,this.environmentInjector),Si({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(u,"",2)}}))}),Si(u=>{const h=new qte(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}))}),qS(l=>{const u=h=>{const g=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(h.routeConfig).pipe(Si(m=>{h.component=m}),Ne(()=>{})));for(const m of h.children)g.push(...u(m));return g};return AS(u(l.targetSnapshot.root)).pipe(gE(),nr(1))}),qS(()=>this.afterPreactivation()),Ne(l=>{const u=function rne(n,e,t){const i=u_(n,e._root,t?t._root:void 0);return new BB(i,e)}(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s={...l,targetRouterState:u},s}),Si(()=>{this.events.next(new FS)}),((n,e,t,i)=>Ne(r=>(new pne(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),nr(1),Si({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ec(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),t.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),ti(this.transitionAbortSubject.pipe(Si(l=>{throw l}))),NS(()=>{o||a||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),kf(l=>{if(a=!0,KB(l))this.events.next(new l_(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),function ane(n){return KB(n)&&ed(n.url)}(l)?this.events.next(new LS(l.url)):s.resolve(!1);else{this.events.next(new TE(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(l))}catch(u){s.reject(u)}}return _c}))}))}cancelNavigationTransition(t,i,r){const s=new l_(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function aU(n){return n!==a_}let lU=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===lt);return i}getResolvedTitleForRoute(t){return t.data[t_]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:function(){return ve(rie)},providedIn:"root"})}return n})(),rie=(()=>{class n extends lU{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||n)(W(cB))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),sie=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:function(){return ve(aie)},providedIn:"root"})}return n})();class oie{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let aie=(()=>{class n extends oie{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=Sn(n)))(r||n)}}();static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const xE=new me("",{providedIn:"root",factory:()=>({})});let lie=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:function(){return ve(cie)},providedIn:"root"})}return n})(),cie=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var g_=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(g_||{});function cU(n,e){n.events.pipe(_i(t=>t instanceof Ec||t instanceof l_||t instanceof TE||t instanceof Bf),Ne(t=>t instanceof Ec||t instanceof Bf?g_.COMPLETE:t instanceof l_&&(0===t.code||1===t.code)?g_.REDIRECTING:g_.FAILED),_i(t=>t!==g_.REDIRECTING),nr(1)).subscribe(()=>{e()})}function uie(n){throw n}function die(n,e,t){return e.parse("/")}const hie={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},fie={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let to=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=ve(jL),this.isNgZoneEnabled=!1,this._events=new Qe,this.options=ve(xE,{optional:!0})||{},this.pendingTasks=ve($L),this.errorHandler=this.options.errorHandler||uie,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||die,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=ve(lie),this.routeReuseStrategy=ve(sie),this.titleStrategy=ve(lU),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=ve(zf,{optional:!0})?.flat()??[],this.navigationTransitions=ve(NE),this.urlSerializer=ve(i_),this.location=ve(JD),this.componentInputBindingEnabled=!!ve(CE,{optional:!0}),this.eventsSubscription=new $,this.isNgZoneEnabled=ve(rt)instanceof rt&&rt.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Vf,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=UB(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const{currentTransition:r}=this.navigationTransitions;if(null===r)return void(uU(i)&&this._events.next(i));if(i instanceof wE)aU(r.source)&&(this.browserUrlTree=r.extractedUrl);else if(i instanceof Bf)this.rawUrlTree=r.rawUrl;else if(i instanceof FB){if("eager"===this.urlUpdateStrategy){if(!r.extras.skipLocationChange){const s=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl);this.setBrowserUrl(s,r)}this.browserUrlTree=r.urlAfterRedirects}}else if(i instanceof FS)this.currentUrlTree=r.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r),this.browserUrlTree=r.urlAfterRedirects);else if(i instanceof l_)0!==i.code&&1!==i.code&&(this.navigated=!0),(3===i.code||2===i.code)&&this.restoreHistory(r);else if(i instanceof LS){const s=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),o={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||aU(r.source)};this.scheduleNavigation(s,a_,null,o,{resolve:r.resolve,reject:r.reject,promise:r.promise})}i instanceof TE&&this.restoreHistory(r,!0),i instanceof Ec&&(this.navigated=!0),uU(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),a_,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(GS),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,u=l?this.currentUrlTree.fragment:o;let g,h=null;switch(a){case"merge":h={...this.currentUrlTree.queryParams,...s};break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=s||null}null!==h&&(h=this.removeEmptyProps(h));try{g=RB(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),g=this.currentUrlTree.root}return NB(g,t,h,u??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=ed(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,a_,null,i)}navigate(t,i={skipLocationChange:!1}){return function pie(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new J(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...hie}:!1===i?{...fie}:i,ed(t))return bB(this.currentUrlTree,t,r);const s=this.parseUrl(t);return bB(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,u;o?(a=o.resolve,l=o.reject,u=o.promise):u=new Promise((g,m)=>{a=g,l=m});const h=this.pendingTasks.add();return cU(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(g=>Promise.reject(g))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",o)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function uU(n){return!(n instanceof FS||n instanceof LS)}class dU{}let _ie=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(_i(t=>t instanceof Ec),e_(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=yD(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return N(r).pipe(Q())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):ye(null);const s=r.pipe(Ue(o=>null===o?ye(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?N([s,this.loader.loadComponent(i)]).pipe(Q()):s})}static#e=this.\u0275fac=function(i){return new(i||n)(W(to),W(HL),W(ss),W(dU),W(KS))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const YS=new me("");let hU=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof wE?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Ec?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Bf&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof LB&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new LB(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){!function jk(){throw new Error("invalid")}()};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac})}return n})();function bl(n,e){return{\u0275kind:n,\u0275providers:e}}function pU(){const n=ve(er);return e=>{const t=n.get(pc);if(e!==t.components[0])return;const i=n.get(to),r=n.get(gU);1===n.get(QS)&&i.initialNavigation(),n.get(mU,null,ft.Optional)?.setUpPreloading(),n.get(YS,null,ft.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const gU=new me("",{factory:()=>new Qe}),QS=new me("",{providedIn:"root",factory:()=>1}),mU=new me("");function Eie(n){return bl(0,[{provide:mU,useExisting:_ie},{provide:dU,useExisting:n}])}const _U=new me("ROUTER_FORROOT_GUARD"),Tie=[JD,{provide:i_,useClass:xS},to,c_,{provide:jf,useFactory:function fU(n){return n.routerState.root},deps:[to]},KS,[]];function Iie(){return new YL("Router",to)}let yU=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[Tie,[],{provide:zf,multi:!0,useValue:t},{provide:_U,useFactory:Aie,deps:[[to,new oc,new Wh]]},{provide:xE,useValue:i||{}},i?.useHash?{provide:Qu,useClass:bJ}:{provide:Qu,useClass:SV},{provide:YS,useFactory:()=>{const n=ve(LX),e=ve(rt),t=ve(xE),i=ve(NE),r=ve(i_);return t.scrollOffset&&n.setOffset(t.scrollOffset),new hU(r,i,n,e,t)}},i?.preloadingStrategy?Eie(i.preloadingStrategy).\u0275providers:[],{provide:YL,multi:!0,useFactory:Iie},i?.initialNavigation?Rie(i):[],i?.bindToComponentInputs?bl(8,[zB,{provide:CE,useExisting:zB}]).\u0275providers:[],[{provide:vU,useFactory:pU},{provide:jD,multi:!0,useExisting:vU}]]}}static forChild(t){return{ngModule:n,providers:[{provide:zf,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||n)(W(_U,8))};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})();function Aie(n){return"guarded"}function Rie(n){return["disabled"===n.initialNavigation?bl(3,[{provide:OD,multi:!0,useFactory:()=>{const e=ve(to);return()=>{e.setUpLocationChangeListener()}}},{provide:QS,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?bl(2,[{provide:QS,useValue:0},{provide:OD,multi:!0,deps:[er],useFactory:e=>{const t=e.get(yJ,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(to),s=e.get(gU);cU(r,()=>{i(!0)}),e.get(NE).afterPreactivation=()=>(i(!0),s.closed?ye(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const vU=new me(""),xie=[];let Pie=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({imports:[yU.forRoot(xie),yU]})}return n})();class bU{constructor(e){this.key="",this.players=[],this.secondsPerTurn=60,this.minutesForGame=60,this.playerCount=2,this.startTime=null,this.endTime=null,this.inProgress=!1,e?(this.key=e.key,this.code=e.code,this.secondsPerTurn=e.secondsPerTurn,this.minutesForGame=e.minutesForGame,this.inProgress=e.inProgress,this.startTime=e.startTime??null,this.endTime=e.endTime??null,this.players=e.players):this.code=Math.random().toString(36).slice(2,7).toString().toUpperCase()}addPlayer(){const e=new Oie(this.getNextPlayerNumber());return this.players.push(e),e}findPlayer(e){return this.players.find(t=>t.number===e)}getNextPlayerNumber(){return(Math.max(0,...this.players.map(e=>+e.number))+1).toString()}}class Oie{constructor(e){this.number="",this.name="",this.color="",this.myTurn=!1,this.number=e,this.color="#"+((1<<24)*Math.random()|0).toString(16).padStart(6,"0")}}var ls=et(534);(0,ls.registerVersion)("firebase","10.7.1","app");class Fie extends ${constructor(e,t){super()}schedule(e,t=0){return this}}class PE extends Fie{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),r}_unsubscribe(){const e=this.id,t=this.scheduler,i=t.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let EU=(()=>{class n{constructor(t,i=n.now){this.SchedulerAction=t,this.now=i}schedule(t,i=0,r){return new this.SchedulerAction(this,t).schedule(r,i)}}return n.now=()=>Date.now(),n})();class Mo extends EU{constructor(e,t=EU.now){super(e,()=>Mo.delegate&&Mo.delegate!==this?Mo.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,i){return Mo.delegate&&Mo.delegate!==this?Mo.delegate.schedule(e,t,i):super.schedule(e,t,i)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const wU=new class Vie extends Mo{}(class Lie extends PE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(e,t,i):e.flush(this)}}),Bie=wU,OE=new Mo(PE),JS=OE;class cs{constructor(e,t,i){this.kind=e,this.value=t,this.error=i,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}}accept(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)}toObservable(){switch(this.kind){case"N":return ye(this.value);case"E":return Mf(this.error);case"C":return pE()}throw new Error("unexpected notification kind value")}static createNext(e){return typeof e<"u"?new cs("N",e):cs.undefinedValueNotification}static createError(e){return new cs("E",void 0,e)}static createComplete(){return cs.completeNotification}}function Wf(n,e=0){return function(i){return i.lift(new jie(n,e))}}cs.completeNotification=new cs("C"),cs.undefinedValueNotification=new cs("N",void 0);class jie{constructor(e,t=0){this.scheduler=e,this.delay=t}call(e,t){return t.subscribe(new ME(e,this.scheduler,this.delay))}}class ME extends xe{constructor(e,t,i=0){super(e),this.scheduler=t,this.delay=i}static dispatch(e){const{notification:t,destination:i}=e;t.observe(i),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(ME.dispatch,this.delay,new $ie(e,this.destination)))}_next(e){this.scheduleMessage(cs.createNext(e))}_error(e){this.scheduleMessage(cs.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(cs.createComplete()),this.unsubscribe()}}class $ie{constructor(e,t){this.notification=e,this.destination=t}}let Hie=1;const Gie=Promise.resolve(),kE={};function TU(n){return n in kE&&(delete kE[n],!0)}const IU={setImmediate(n){const e=Hie++;return kE[e]=!0,Gie.then(()=>TU(e)&&n()),e},clearImmediate(n){TU(n)}},XS=new class Wie extends Mo{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class zie extends PE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=IU.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(IU.clearImmediate(t),e.scheduled=void 0)}});function eA(n){return!Bt(n)&&n-parseFloat(n)+1>=0}class FE extends $e{constructor(e,t=0,i=XS){super(),this.source=e,this.delayTime=t,this.scheduler=i,(!eA(t)||t<0)&&(this.delayTime=0),(!i||"function"!=typeof i.schedule)&&(this.scheduler=XS)}static create(e,t=0,i=XS){return new FE(e,t,i)}static dispatch(e){const{source:t,subscriber:i}=e;return this.add(t.subscribe(i))}_subscribe(e){return this.scheduler.schedule(FE.dispatch,this.delayTime,{source:this.source,subscriber:e})}}function LE(n,e=0){return function(i){return i.lift(new qie(n,e))}}class qie{constructor(e,t){this.scheduler=e,this.delay=t}call(e,t){return new FE(t,this.delay,this.scheduler).subscribe(e)}}const m_=new hf("ANGULARFIRE2_VERSION");class VE{constructor(){return((n,e)=>{const t=(0,ls.getApps)(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(o=>{i.includes(o)||i.push(o)})}),i})(Zie)}}const Zie="app-check";function qf(){}class DU{zone;delegate;constructor(e,t=wU){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){const r=this.zone;return this.delegate.schedule(function(o){r.runGuarded(()=>{e.apply(this,[o])})},t,i)}}class Yie{zone;task=null;constructor(e){this.zone=e}call(e,t){const i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",qf,{},qf,qf)),t.pipe(Si({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let BE=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new DU(Zone.current)),this.insideAngular=t.run(()=>new DU(Zone.current,OE)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||n)(W(rt))};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Kf(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function SU(n){return n.pipe(Wf(Kf().outsideAngular))}function ui(n){return function Jie(n){return function(t){return(t=t.lift(new Yie(n.ngZone))).pipe(LE(n.outsideAngular),Wf(n.insideAngular))}}(Kf())(n)}var no=et(106);no.Z.registerVersion("firebase","10.7.1","app-compat");const nre=["ngOnDestroy"];class AU{constructor(e){return e}}const Zf=new me("angularfire2.app.options"),Yf=new me("angularfire2.app.name");function __(n,e,t){const r="object"==typeof t&&t||{};r.name=r.name||"string"==typeof t&&t||"[DEFAULT]";const o=no.Z.apps.filter(a=>a&&a.name===r.name)[0]||e.runOutsideAngular(()=>no.Z.initializeApp(n,r));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){const a=!!module.hot;sre("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new AU(o)}const sre=(n,...e)=>{},ore={provide:AU,useFactory:__,deps:[Zf,rt,[new oc,Yf]]};let are=(()=>{class n{static initializeApp(t,i){return{ngModule:n,providers:[{provide:Zf,useValue:t},{provide:Yf,useValue:i}]}}constructor(t){no.Z.registerVersion("angularfire",m_.full,"core"),no.Z.registerVersion("angularfire",m_.full,"app-compat"),no.Z.registerVersion("angular",mk.full,t.toString())}static \u0275fac=function(i){return new(i||n)(W(Co))};static \u0275mod=yt({type:n});static \u0275inj=ht({providers:[ore]})}return n})();function UE(n,e,t,i,r){const[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(s)return function lre(n,e){try{return n.toString()===e.toString()}catch{return n===e}}(r,o)||(RU("error",`${e} was already initialized on the ${t} Firebase App with different settings.${cre?" You may need to reload as Firebase is not HMR aware.":""}`),RU("warn",{is:r,was:o})),s;{const a=i();return globalThis.\u0275AngularfireInstanceCache.push([n,a,r]),a}}const cre=typeof module<"u"&&!!module.hot,RU=(n,...e)=>{};globalThis.\u0275AngularfireInstanceCache||=[],et(980);class ure extends Qe{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new dre(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,i=t?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,s=i.length;let o;if(this.closed)throw new ot;if(this.isStopped||this.hasError?o=$.EMPTY:(this.observers.push(e),o=new Gn(this,e)),r&&e.add(e=new ME(e,r)),t)for(let a=0;a<s&&!e.closed;a++)e.next(i[a]);else for(let a=0;a<s&&!e.closed;a++)e.next(i[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}_getNow(){return(this.scheduler||Bie).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,i=this._windowTime,r=this._events,s=r.length;let o=0;for(;o<s&&!(e-r[o].time<i);)o++;return s>t&&(o=Math.max(o,s-t)),o>0&&r.splice(0,o),r}}class dre{constructor(e,t){this.time=e,this.value=t}}function NU(n,e,t){let i;return i=n&&"object"==typeof n?n:{bufferSize:n,windowTime:e,refCount:!1,scheduler:t},r=>r.lift(function hre({bufferSize:n=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:t,scheduler:i}){let r,o,s=0,a=!1,l=!1;return function(h){let g;s++,!r||a?(a=!1,r=new ure(n,e,i),g=r.subscribe(this),o=h.subscribe({next(m){r.next(m)},error(m){a=!0,r.error(m)},complete(){l=!0,o=void 0,r.complete()}}),l&&(o=void 0)):g=r.subscribe(this),this.add(()=>{s--,g.unsubscribe(),g=void 0,o&&!l&&t&&0===s&&(o.unsubscribe(),o=void 0,r=void 0)})}}(i))}function xU(n,e){return e?Ot(()=>n,e):Ot(()=>n)}const tA=new me("angularfire2.auth.use-emulator"),nA=new me("angularfire2.auth.settings"),iA=new me("angularfire2.auth.tenant-id"),rA=new me("angularfire2.auth.langugage-code"),sA=new me("angularfire2.auth.use-device-language"),oA=new me("angularfire.auth.persistence"),aA=(n,e,t,i,r,s,o,a)=>UE(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const l=e.runOutsideAngular(()=>n.auth());if(t&&l.useEmulator(...t),i&&(l.tenantId=i),l.languageCode=r,s&&l.useDeviceLanguage(),o)for(const[u,h]of Object.entries(o))l.settings[u]=h;return a&&l.setPersistence(a),l},[t,i,r,s,o,a]);let lA=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,i,r,s,o,a,l,u,h,g,m,y){const b=new Qe,w=ye(void 0).pipe(Wf(o.outsideAngular),Ot(()=>s.runOutsideAngular(()=>Promise.resolve().then(et.bind(et,980)))),Ne(()=>__(t,s,i)),Ne(T=>aA(T,s,a,u,h,g,l,m)),NU({bufferSize:1,refCount:!1}));if(lE(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=ye(null);else{w.pipe(yc()).subscribe();const T=w.pipe(Ot(M=>M.getRedirectResult().then(L=>L,()=>null)),ui,NU({bufferSize:1,refCount:!1})),P=w.pipe(Ot(M=>new $e(L=>({unsubscribe:s.runOutsideAngular(()=>M.onAuthStateChanged(Y=>L.next(Y),Y=>L.error(Y),()=>L.complete()))})))),S=w.pipe(Ot(M=>new $e(L=>({unsubscribe:s.runOutsideAngular(()=>M.onIdTokenChanged(Y=>L.next(Y),Y=>L.error(Y),()=>L.complete()))}))));this.authState=T.pipe(xU(P),LE(o.outsideAngular),Wf(o.insideAngular)),this.user=T.pipe(xU(S),LE(o.outsideAngular),Wf(o.insideAngular)),this.idToken=this.user.pipe(Ot(M=>M?N(M.getIdToken()):ye(null))),this.idTokenResult=this.user.pipe(Ot(M=>M?N(M.getIdTokenResult()):ye(null))),this.credential=cn(T,b,this.authState.pipe(_i(M=>!M))).pipe(Ne(M=>M?.user?M:null),LE(o.outsideAngular),Wf(o.insideAngular))}return((n,e,t,i={})=>new Proxy(n,{get:(r,s)=>t.runOutsideAngular(()=>{if(n[s])return i?.spy?.get&&i.spy.get(s,n[s]),n[s];if(nre.indexOf(s)>-1)return()=>{};const o=e.toPromise().then(a=>{const l=a?.[s];return"function"==typeof l?l.bind(a):l?.then?l.then(u=>t.run(()=>u)):t.run(()=>l)});return new Proxy(()=>{},{get:(a,l)=>o[l],apply:(a,l,u)=>o.then(h=>{const g=h?.(...u);return i?.spy?.apply&&i.spy.apply(s,u,g),g})})})}))(this,w,s,{spy:{apply:(T,P,S)=>{(T.startsWith("signIn")||T.startsWith("createUser"))&&S.then(M=>b.next(M))}}})}static \u0275fac=function(i){return new(i||n)(W(Zf),W(Yf,8),W(Co),W(rt),W(BE),W(tA,8),W(nA,8),W(iA,8),W(rA,8),W(sA,8),W(oA,8),W(VE,8))};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();function jE(...n){return e=>{let t;return"function"==typeof n[n.length-1]&&(t=n.pop()),e.lift(new pre(n,t))}}class pre{constructor(e,t){this.observables=e,this.project=t}call(e,t){return t.subscribe(new gre(e,this.observables,this.project))}}class gre extends DS{constructor(e,t,i){super(e),this.observables=t,this.project=i,this.toRespond=[];const r=t.length;this.values=new Array(r);for(let s=0;s<r;s++)this.toRespond.push(s);for(let s=0;s<r;s++)this.add(SS(this,t[s],void 0,s))}notifyNext(e,t,i){this.values[i]=t;const r=this.toRespond;if(r.length>0){const s=r.indexOf(i);-1!==s&&r.splice(s,1)}}notifyComplete(){}_next(e){if(0===this.toRespond.length){const t=[e,...this.values];this.project?this._tryProject(t):this.destination.next(t)}}_tryProject(e){let t;try{t=this.project.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}class _re{constructor(e){this.predicate=e}call(e,t){return t.subscribe(new yre(e,this.predicate))}}class yre extends xe{constructor(e,t){super(e),this.predicate=t,this.skipping=!0,this.index=0}_next(e){const t=this.destination;this.skipping&&this.tryCallPredicate(e),this.skipping||t.next(e)}tryCallPredicate(e){try{const t=this.predicate(e,this.index++);this.skipping=!!t}catch(t){this.destination.error(t)}}}var ko=et(537),K=et(861),E=et(58),As=et(879);const PU="@firebase/database";let cA="";function uA(n){cA=n}class vre{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,E.Wl)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,E.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class bre{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,E.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const MU=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new vre(e)}}catch{}return new bre},nd=MU("localStorage"),dA=MU("sessionStorage"),Qf=new As.Yd("@firebase/database"),kU=function(){let n=1;return function(){return n++}}(),FU=function(n){const e=(0,E.dS)(n),t=new E.gQ;t.update(e);const i=t.digest();return E.US.encodeByteArray(i)},y_=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?e+=y_.apply(null,i):e+="object"==typeof i?(0,E.Wl)(i):i,e+=" "}return e};let id=null,LU=!0;const VU=function(n,e){(0,E.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(Qf.logLevel=As.in.VERBOSE,id=Qf.log.bind(Qf),e&&dA.set("logging_enabled",!0)):"function"==typeof n?id=n:(id=null,dA.remove("logging_enabled"))},Vi=function(...n){if(!0===LU&&(LU=!1,null===id&&!0===dA.get("logging_enabled")&&VU(!0)),id){const e=y_.apply(null,n);id(e)}},v_=function(n){return function(...e){Vi(n,...e)}},hA=function(...n){const e="FIREBASE INTERNAL ERROR: "+y_(...n);Qf.error(e)},_a=function(...n){const e=`FIREBASE FATAL ERROR: ${y_(...n)}`;throw Qf.error(e),new Error(e)},yr=function(...n){const e="FIREBASE WARNING: "+y_(...n);Qf.warn(e)},$E=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},wc="[MIN_NAME]",El="[MAX_NAME]",rd=function(n,e){if(n===e)return 0;if(n===wc||e===El)return-1;if(e===wc||n===El)return 1;{const t=jU(n),i=jU(e);return null!==t?null!==i?t-i==0?n.length-e.length:t-i:-1:null!==i?1:n<e?-1:1}},Tre=function(n,e){return n===e?0:n<e?-1:1},b_=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,E.Wl)(e))},fA=function(n){if("object"!=typeof n||null===n)return(0,E.Wl)(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)0!==i&&(t+=","),t+=(0,E.Wl)(e[i]),t+=":",t+=fA(n[e[i]]);return t+="}",t},BU=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let r=0;r<t;r+=e)i.push(n.substring(r,r+e>t?t:r+e));return i};function Bi(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const UU=function(n){(0,E.hu)(!$E(n),"Invalid JSON number");const i=1023;let r,s,o,a,l;0===n?(s=0,o=0,r=1/n==-1/0?1:0):(r=n<0,(n=Math.abs(n))>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),i),s=a+i,o=Math.round(n*Math.pow(2,52-a)-Math.pow(2,52))):(s=0,o=Math.round(n/Math.pow(2,-1074))));const u=[];for(l=52;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(l=11;l;l-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(r?1:0),u.reverse();const h=u.join("");let g="";for(l=0;l<64;l+=8){let m=parseInt(h.substr(l,8),2).toString(16);1===m.length&&(m="0"+m),g+=m}return g.toLowerCase()},Sre=new RegExp("^-?(0*)\\d{1,10}$"),jU=function(n){if(Sre.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},Jf=function(n){try{n()}catch(e){setTimeout(()=>{throw yr("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},E_=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class xre{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){yr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Pre{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(Vi("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',yr(e)}}let w_=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const WU=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ZU="websocket",YU="long_polling";class gA{constructor(e,t,i,r,s=!1,o="",a=!1,l=!1){this.secure=t,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=nd.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&nd.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function QU(n,e,t){let i;if((0,E.hu)("string"==typeof e,"typeof type must == string"),(0,E.hu)("object"==typeof t,"typeof params must == object"),e===ZU)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==YU)throw new Error("Unknown connection type: "+e);i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function Ore(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const r=[];return Bi(t,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}class Mre{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,E.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,E.p$)(this.counters_)}}const mA={},_A={};function yA(n){const e=n.toString();return mA[e]||(mA[e]=new Mre),mA[e]}class Fre{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&Jf(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Tc{constructor(e,t,i,r,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=v_(e),this.stats_=yA(t),this.urlFn=l=>(this.appCheckToken&&(l.ac=this.appCheckToken),QU(t,YU,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Fre(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,E.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new vA((...s)=>{const[o,a,l,u,h]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===o)this.id=a,this.password=l;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const i={start:"t"};i.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(i.cb=this.scriptTagHolder.uniqueCallbackIdentifier),i.v="5",this.transportSessionId&&(i.s=this.transportSessionId),this.lastSessionId&&(i.ls=this.lastSessionId),this.applicationId&&(i.p=this.applicationId),this.appCheckToken&&(i.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&WU.test(location.hostname)&&(i.r="f");const r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Tc.forceAllow_=!0}static forceDisallow(){Tc.forceDisallow_=!0}static isAvailable(){return!((0,E.Yr)()||!Tc.forceAllow_&&(Tc.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,E.Wl)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=(0,E.h$)(t),r=BU(i,1840);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,E.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const i={dframe:"t"};i.id=e,i.pw=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,E.Wl)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class vA{constructor(e,t,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,E.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=kU(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=vA.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Vi("frame writing exception"),a.stack&&Vi(a.stack),Vi(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Vi("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+i.length<=1870;){const o=this.pendingSegs.shift();i=i+"&seg"+r+"="+o.seg+"&ts"+r+"="+o.ts+"&d"+r+"="+o.d,r++}return t+=i,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(i,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(r),i()})}addTag(e,t){(0,E.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const r=i.readyState;(!r||"loaded"===r||"complete"===r)&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{Vi("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}let GE=null;typeof MozWebSocket<"u"?GE=MozWebSocket:typeof WebSocket<"u"&&(GE=WebSocket);let Xf=(()=>{class n{constructor(t,i,r,s,o,a,l){this.connId=t,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=v_(this.connId),this.stats_=yA(i),this.connURL=n.connectionURL_(i,a,l,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(t,i,r,s,o){const a={v:"5"};return!(0,E.Yr)()&&typeof location<"u"&&location.hostname&&WU.test(location.hostname)&&(a.r="f"),i&&(a.s=i),r&&(a.ls=r),s&&(a.ac=s),o&&(a.p=o),QU(t,ZU,a)}open(t,i){this.onDisconnect=i,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,nd.set("previous_websocket_failure",!0);try{let r;if((0,E.Yr)()){r={headers:{"User-Agent":`Firebase/5/${cA}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);const o=process.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(r.proxy={origin:a})}this.mySock=new GE(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&null!==GE&&!n.forceDisallow_}static previouslyFailed(){return nd.isInMemoryStorage||!0===nd.get("previous_websocket_failure")}markConnectionHealthy(){nd.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const i=this.frames.join("");this.frames=null;const r=(0,E.cI)(i);this.onMessage(r)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,E.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const i=Number(t);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const i=t.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(i);else{const r=this.extractFrameCount_(i);null!==r&&this.appendFrame_(r)}}send(t){this.resetKeepAlive();const i=(0,E.Wl)(t);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);const r=BU(i,16384);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),rj=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Tc,Xf]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const i=Xf&&Xf.isAvailable();let r=i&&!Xf.previouslyFailed();if(t.webSocketOnly&&(i||yr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Xf];else{const s=this.transports_=[];for(const o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class dj{constructor(e,t,i,r,s,o,a,l,u,h){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=v_("c:"+this.id+":"),this.transportManager_=new rj(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=E_(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=b_("t",e),i=b_("d",e);if("c"===t)this.onSecondaryControl_(i);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(i)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=b_("t",e),i=b_("d",e);"c"===t?this.onControl_(i):"d"===t&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=b_("t",e);if("d"in e){const i=e.d;if("h"===t){const r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(i):"r"===t?this.onReset_(i):"e"===t?hA("Server Error: "+i):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):hA("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==i&&yr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),E_(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):E_(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(nd.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class hj{put(e,t,i,r){}merge(e,t,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}class fj{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,E.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const r=this.getInitialEvent(e);r&&t.apply(i,r)}off(e,t,i){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===t&&(!i||i===r[s].context))return void r.splice(s,1)}validateEventType_(e){(0,E.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class zE extends fj{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,E.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new zE}getInitialEvent(e){return(0,E.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class Yt{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Vt(){return new Yt("")}function pt(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Ic(n){return n.pieces_.length-n.pieceNum_}function fn(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Yt(n.pieces_,e)}function EA(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function T_(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function mj(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Yt(e,0)}function Fn(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof Yt)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&t.push(i[r])}return new Yt(t,0)}function gt(n){return n.pieceNum_>=n.pieces_.length}function Fr(n,e){const t=pt(n),i=pt(e);if(null===t)return e;if(t===i)return Fr(fn(n),fn(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function rse(n,e){const t=T_(n,0),i=T_(e,0);for(let r=0;r<t.length&&r<i.length;r++){const s=rd(t[r],i[r]);if(0!==s)return s}return t.length===i.length?0:t.length<i.length?-1:1}function wA(n,e){if(Ic(n)!==Ic(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function io(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(Ic(n)>Ic(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class sse{constructor(e,t){this.errorPrefix_=t,this.parts_=T_(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=(0,E.ug)(this.parts_[i]);_j(this)}}function _j(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+sd(n))}function sd(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class TA extends fj{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new TA}getInitialEvent(e){return(0,E.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const I_=1e3;let qE,od=(()=>{class n extends hj{constructor(t,i,r,s,o,a,l,u){if(super(),this.repoInfo_=t,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=v_("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=I_,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!(0,E.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");TA.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&zE.getInstance().on("online",this.onOnline_,this)}sendRequest(t,i,r){const s=++this.requestNumber_,o={r:s,a:t,b:i};this.log_((0,E.Wl)(o)),(0,E.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(t){this.initConnection_();const i=new E.BH,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{const l=a.d;"ok"===a.s?i.resolve(l):i.reject(l)}};return this.outstandingGets_.push(s),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),i.promise}listen(t,i,r,s){this.initConnection_();const o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),(0,E.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,E.hu)(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:i,query:t,tag:r};this.listens.get(a).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(t){const i=this.outstandingGets_[t];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(t){const i=t.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);const o={p:r};t.tag&&(o.q=i._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest("q",o,l=>{const u=l.d,h=l.s;n.warnOnListenWarnings_(u,i),(this.listens.get(r)&&this.listens.get(r).get(s))===t&&(this.log_("listen response",l),"ok"!==h&&this.removeListen_(r,s),t.onComplete&&t.onComplete(h,u))})}static warnOnListenWarnings_(t,i){if(t&&"object"==typeof t&&(0,E.r3)(t,"w")){const r=(0,E.DV)(t,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();yr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,E.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,i=(0,E.w9)(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{const o=s.s,a=s.d||"error";this.authToken_===t&&("ok"===o?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const i=t.s,r=t.d||"error";"ok"===i?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(t,i){const r=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),(0,E.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,t._queryObject,i)}sendUnlisten_(t,i,r,s){this.log_("Unlisten on "+t+" for "+i);const o={p:t};s&&(o.q=r,o.t=s),this.sendRequest("n",o)}onDisconnectPut(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:i,onComplete:r})}onDisconnectMerge(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:i,onComplete:r})}onDisconnectCancel(t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(t,i,r,s){const o={p:i,d:r};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,i,r,s){this.putInternal("p",t,i,r,s)}merge(t,i,r,s){this.putInternal("m",t,i,r,s)}putInternal(t,i,r,s,o){this.initConnection_();const a={p:i,d:r};void 0!==o&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+i)}sendPut_(t){const i=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(i,r,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){const i={c:t};this.log_("reportStats",i),this.sendRequest("s",i,r=>{"ok"!==r.s&&this.log_("reportStats","Error sending stats: "+r.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,E.Wl)(t));const i=t.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,i){this.log_("handleServerMessage",t,i),"d"===t?this.onDataUpdate_(i.p,i.d,!1,i.t):"m"===t?this.onDataUpdate_(i.p,i.d,!0,i.t):"c"===t?this.onListenRevoked_(i.p,i.q):"ac"===t?this.onAuthRevoked_(i.s,i.d):"apc"===t?this.onAppCheckRevoked_(i.s,i.d):"sd"===t?this.onSecurityDebugPacket_(i):hA("Unrecognized action received from server: "+(0,E.Wl)(t)+"\nAre you using the latest client?")}onReady_(t,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,E.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=I_,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=I_,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=I_),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let i=Math.max(0,this.reconnectDelay_-t);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,K.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const i=t.onDataMessage_.bind(t),r=t.onReady_.bind(t),s=t.onRealtimeDisconnect_.bind(t),o=t.id+":"+n.nextConnectionId_++,a=t.lastSessionId;let l=!1,u=null;const h=function(){u?u.close():(l=!0,s())};t.realtime_={close:h,sendRequest:function(y){(0,E.hu)(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(y)}};const m=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[y,b]=yield Promise.all([t.authTokenProvider_.getToken(m),t.appCheckTokenProvider_.getToken(m)]);l?Vi("getToken() completed but was canceled"):(Vi("getToken() completed. Creating connection."),t.authToken_=y&&y.accessToken,t.appCheckToken_=b&&b.token,u=new dj(o,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,i,r,s,w=>{yr(w+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},a))}catch(y){t.log_("Failed to get token: "+y),l||(t.repoInfo_.nodeAdmin&&yr(y),h())}}})()}interrupt(t){Vi("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Vi("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,E.xb)(this.interruptReasons_)&&(this.reconnectDelay_=I_,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const i=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const i=this.outstandingPuts_[t];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,i){let r;r=i?i.map(o=>fA(o)).join("$"):"default";const s=this.removeListen_(t,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,i){const r=new Yt(t).toString();let s;if(this.listens.has(r)){const o=this.listens.get(r);s=o.get(i),o.delete(i),0===o.size&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(t,i){Vi("Auth token revoked: "+t+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,i){Vi("App check token revoked: "+t+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const i of t.values())this.sendListen_(i);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let i="js";(0,E.Yr)()&&(i=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+i+"."+cA.replace(/\./g,"-")]=1,(0,E.uI)()?t["framework.cordova"]=1:(0,E.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=zE.getInstance().currentlyOnline();return(0,E.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class vt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new vt(e,t)}}class WE{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new vt(wc,e),r=new vt(wc,t);return 0!==this.compare(i,r)}minPost(){return vt.MIN}}class bj extends WE{static get __EMPTY_NODE(){return qE}static set __EMPTY_NODE(e){qE=e}compare(e,t){return rd(e.name,t.name)}isDefinedOn(e){throw(0,E.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return vt.MIN}maxPost(){return new vt(El,qE)}makePost(e,t){return(0,E.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new vt(e,qE)}toString(){return".key"}}const ya=new bj;class KE{constructor(e,t,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let CA,Fo=(()=>{class n{constructor(t,i,r,s,o){this.key=t,this.value=i,this.color=r??n.RED,this.left=s??us.EMPTY_NODE,this.right=o??us.EMPTY_NODE}copy(t,i,r,s,o){return new n(t??this.key,i??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,r){let s=this;const o=r(t,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(t,i,r),null):0===o?s.copy(null,i,null,null,null):s.copy(null,null,null,null,s.right.insert(t,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return us.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,i){let r,s;if(r=this,i(t,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(t,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),0===i(t,r.key)){if(r.right.isEmpty())return us.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(t,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class us{constructor(e,t=us.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new us(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Fo.BLACK,null,null))}remove(e){return new us(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Fo.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),0===t)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,r=null;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),0===t){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}t<0?i=i.left:t>0&&(r=i,i=i.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new KE(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new KE(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new KE(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new KE(this.root_,null,this.comparator_,!0,e)}}function fse(n,e){return rd(n.name,e.name)}function IA(n,e){return rd(n,e)}us.EMPTY_NODE=new class hse{copy(e,t,i,r,s){return this}insert(e,t,i){return new Fo(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Ej=function(n){return"number"==typeof n?"number:"+UU(n):"string:"+n},wj=function(n){if(n.isLeafNode()){const e=n.val();(0,E.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,E.r3)(e,".sv"),"Priority must be a string or number.")}else(0,E.hu)(n===CA||n.isEmpty(),"priority of unexpected type.");(0,E.hu)(n===CA||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Tj,Ij,Cj,ep=(()=>{class n{constructor(t,i=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=i,this.lazyHash_=null,(0,E.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),wj(this.priorityNode_)}static set __childrenNodeConstructor(t){Tj=t}static get __childrenNodeConstructor(){return Tj}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return gt(t)?this:".priority"===pt(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,i){return null}updateImmediateChild(t,i){return".priority"===t?this.updatePriority(i):i.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,i).updatePriority(this.priorityNode_)}updateChild(t,i){const r=pt(t);return null===r?i:i.isEmpty()&&".priority"!==r?this:((0,E.hu)(".priority"!==r||1===Ic(t),".priority must be the last token in a path"),this.updateImmediateChild(r,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(fn(t),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,i){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Ej(this.priorityNode_.val())+":");const i=typeof this.value_;t+=i+":",t+="number"===i?UU(this.value_):this.value_,this.lazyHash_=FU(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,E.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const i=typeof t.value_,r=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(i),o=n.VALUE_TYPE_ORDER.indexOf(r);return(0,E.hu)(s>=0,"Unknown leaf type: "+i),(0,E.hu)(o>=0,"Unknown leaf type: "+r),s===o?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){return t===this||!!t.isLeafNode()&&(this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const vn=new class _se extends WE{compare(e,t){const i=e.node.getPriority(),r=t.node.getPriority(),s=i.compareTo(r);return 0===s?rd(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return vt.MIN}maxPost(){return new vt(El,new ep("[PRIORITY-POST]",Cj))}makePost(e,t){const i=Ij(e);return new vt(t,new ep("[PRIORITY-POST]",i))}toString(){return".priority"}},yse=Math.log(2);class vse{constructor(e){this.count=parseInt(Math.log(e+1)/yse,10),this.current_=this.count-1;const r=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ZE=function(n,e,t,i){n.sort(e);const r=function(l,u){const h=u-l;let g,m;if(0===h)return null;if(1===h)return g=n[l],m=t?t(g):g,new Fo(m,g.node,Fo.BLACK,null,null);{const y=parseInt(h/2,10)+l,b=r(l,y),w=r(y+1,u);return g=n[y],m=t?t(g):g,new Fo(m,g.node,Fo.BLACK,b,w)}},a=function(l){let u=null,h=null,g=n.length;const m=function(b,w){const T=g-b,P=g;g-=b;const S=r(T+1,P),M=n[T],L=t?t(M):M;y(new Fo(L,M.node,w,null,S))},y=function(b){u?(u.left=b,u=b):(h=b,u=b)};for(let b=0;b<l.count;++b){const w=l.nextBitIsOne(),T=Math.pow(2,l.count-(b+1));w?m(T,Fo.BLACK):(m(T,Fo.BLACK),m(T,Fo.RED))}return h}(new vse(n.length));return new us(i||e,a)};let DA;const tp={};class wl{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,E.hu)(tp&&vn,"ChildrenNode.ts has not been loaded"),DA=DA||new wl({".priority":tp},{".priority":vn}),DA}get(e){const t=(0,E.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof us?t:null}hasIndex(e){return(0,E.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,E.hu)(e!==ya,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const s=t.getIterator(vt.Wrap);let a,o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();a=r?ZE(i,e.getCompare()):tp;const l=e.toString(),u=Object.assign({},this.indexSet_);u[l]=e;const h=Object.assign({},this.indexes_);return h[l]=a,new wl(h,u)}addToIndexes(e,t){const i=(0,E.UI)(this.indexes_,(r,s)=>{const o=(0,E.DV)(this.indexSet_,s);if((0,E.hu)(o,"Missing index implementation for "+s),r===tp){if(o.isDefinedOn(e.node)){const a=[],l=t.getIterator(vt.Wrap);let u=l.getNext();for(;u;)u.name!==e.name&&a.push(u),u=l.getNext();return a.push(e),ZE(a,o.getCompare())}return tp}{const a=t.get(e.name);let l=r;return a&&(l=l.remove(new vt(e.name,a))),l.insert(e,e.node)}});return new wl(i,this.indexSet_)}removeFromIndexes(e,t){const i=(0,E.UI)(this.indexes_,r=>{if(r===tp)return r;{const s=t.get(e.name);return s?r.remove(new vt(e.name,s)):r}});return new wl(i,this.indexSet_)}}let C_,st=(()=>{class n{constructor(t,i,r){this.children_=t,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&wj(this.priorityNode_),this.children_.isEmpty()&&(0,E.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return C_||(C_=new n(new us(IA),null,wl.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||C_}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const i=this.children_.get(t);return null===i?C_:i}}getChild(t){const i=pt(t);return null===i?this:this.getImmediateChild(i).getChild(fn(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,i){if((0,E.hu)(i,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(i);{const r=new vt(t,i);let s,o;i.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(t,i),o=this.indexMap_.addToIndexes(r,this.children_));const a=s.isEmpty()?C_:this.priorityNode_;return new n(s,a,o)}}updateChild(t,i){const r=pt(t);if(null===r)return i;{(0,E.hu)(".priority"!==pt(t)||1===Ic(t),".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(fn(t),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const i={};let r=0,s=0,o=!0;if(this.forEachChild(vn,(a,l)=>{i[a]=l.val(t),r++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*r){const a=[];for(const l in i)a[l]=i[l];return a}return t&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+Ej(this.getPriority().val())+":"),this.forEachChild(vn,(i,r)=>{const s=r.hash();""!==s&&(t+=":"+i+":"+s)}),this.lazyHash_=""===t?"":FU(t)}return this.lazyHash_}getPredecessorChildName(t,i,r){const s=this.resolveIndex_(r);if(s){const o=s.getPredecessorKey(new vt(t,i));return o?o.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const i=this.resolveIndex_(t);if(i){const r=i.minKey();return r&&r.name}return this.children_.minKey()}getFirstChild(t){const i=this.getFirstChildName(t);return i?new vt(i,this.children_.get(i)):null}getLastChildName(t){const i=this.resolveIndex_(t);if(i){const r=i.maxKey();return r&&r.name}return this.children_.maxKey()}getLastChild(t){const i=this.getLastChildName(t);return i?new vt(i,this.children_.get(i)):null}forEachChild(t,i){const r=this.resolveIndex_(t);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,i){const r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(t,s=>s);{const s=this.children_.getIteratorFrom(t.name,vt.Wrap);let o=s.peek();for(;null!=o&&i.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,i){const r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(t,s=>s);{const s=this.children_.getReverseIteratorFrom(t.name,vt.Wrap);let o=s.peek();for(;null!=o&&i.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===D_?-1:0}withIndex(t){if(t===ya||this.indexMap_.hasIndex(t))return this;{const i=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,i)}}isIndexed(t){return t===ya||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const i=t;if(this.getPriority().equals(i.getPriority())){if(this.children_.count()===i.children_.count()){const r=this.getIterator(vn),s=i.getIterator(vn);let o=r.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=r.getNext(),a=s.getNext()}return null===o&&null===a}return!1}return!1}}resolveIndex_(t){return t===ya?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const D_=new class bse extends st{constructor(){super(new us(IA),st.EMPTY_NODE,wl.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return st.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(vt,{MIN:{value:new vt(wc,st.EMPTY_NODE)},MAX:{value:new vt(El,D_)}}),bj.__EMPTY_NODE=st.EMPTY_NODE,ep.__childrenNodeConstructor=st,function pse(n){CA=n}(D_),function mse(n){Cj=n}(D_);const Ese=!0;function Kn(n,e=null){if(null===n)return st.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,E.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new ep(n,Kn(e));if(n instanceof Array||!Ese){let t=st.EMPTY_NODE;return Bi(n,(i,r)=>{if((0,E.r3)(n,i)&&"."!==i.substring(0,1)){const s=Kn(r);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(i,s))}}),t.updatePriority(Kn(e))}{const t=[];let i=!1;if(Bi(n,(o,a)=>{if("."!==o.substring(0,1)){const l=Kn(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),t.push(new vt(o,l)))}}),0===t.length)return st.EMPTY_NODE;const s=ZE(t,fse,o=>o.name,IA);if(i){const o=ZE(t,vn.getCompare());return new st(s,Kn(e),new wl({".priority":o},{".priority":vn}))}return new st(s,Kn(e),wl.Default)}}!function gse(n){Ij=n}(Kn);class SA extends WE{constructor(e){super(),this.indexPath_=e,(0,E.hu)(!gt(e)&&".priority"!==pt(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),r=this.extractChild(t.node),s=i.compareTo(r);return 0===s?rd(e.name,t.name):s}makePost(e,t){const i=Kn(e),r=st.EMPTY_NODE.updateChild(this.indexPath_,i);return new vt(t,r)}maxPost(){const e=st.EMPTY_NODE.updateChild(this.indexPath_,D_);return new vt(El,e)}toString(){return T_(this.indexPath_,0).join("/")}}const AA=new class wse extends WE{compare(e,t){const i=e.node.compareTo(t.node);return 0===i?rd(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return vt.MIN}maxPost(){return vt.MAX}makePost(e,t){const i=Kn(e);return new vt(t,i)}toString(){return".value"}};function Dj(n){return{type:"value",snapshotNode:n}}function np(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function S_(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function A_(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class RA{constructor(e){this.index_=e}updateChild(e,t,i,r,s,o){(0,E.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(r).equals(i.getChild(r))&&a.isEmpty()===i.isEmpty()||(null!=o&&(i.isEmpty()?e.hasChild(t)?o.trackChildChange(S_(t,a)):(0,E.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(np(t,i)):o.trackChildChange(A_(t,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return null!=i&&(e.isLeafNode()||e.forEachChild(vn,(r,s)=>{t.hasChild(r)||i.trackChildChange(S_(r,s))}),t.isLeafNode()||t.forEachChild(vn,(r,s)=>{if(e.hasChild(r)){const o=e.getImmediateChild(r);o.equals(s)||i.trackChildChange(A_(r,s,o))}else i.trackChildChange(np(r,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?st.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class R_{constructor(e){this.indexedFilter_=new RA(e.getIndex()),this.index_=e.getIndex(),this.startPost_=R_.getStartPost_(e),this.endPost_=R_.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,r,s,o){return this.matches(new vt(t,i))||(i=st.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,r,s,o)}updateFullNode(e,t,i){t.isLeafNode()&&(t=st.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(st.EMPTY_NODE);const s=this;return t.forEachChild(vn,(o,a)=>{s.matches(new vt(o,a))||(r=r.updateImmediateChild(o,st.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Ise{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new R_(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,r,s,o){return this.rangedFilter_.matches(new vt(t,i))||(i=st.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,r,s,o):this.fullLimitUpdateChild_(e,t,i,s,o)}updateFullNode(e,t,i){let r;if(t.isLeafNode()||t.isEmpty())r=st.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let s;r=st.EMPTY_NODE.withIndex(this.index_),s=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a)){if(!this.withinDirectionalEnd(a))break;r=r.updateImmediateChild(a.name,a.node),o++}}}else{let s;r=t.withIndex(this.index_),r=r.updatePriority(st.EMPTY_NODE),s=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:r=r.updateImmediateChild(a.name,st.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,r,s){let o;if(this.reverse_){const g=this.index_.getCompare();o=(m,y)=>g(y,m)}else o=this.index_.getCompare();const a=e;(0,E.hu)(a.numChildren()===this.limit_,"");const l=new vt(t,i),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(l);if(a.hasChild(t)){const g=a.getImmediateChild(t);let m=r.getChildAfterChild(this.index_,u,this.reverse_);for(;null!=m&&(m.name===t||a.hasChild(m.name));)m=r.getChildAfterChild(this.index_,m,this.reverse_);const y=null==m?1:o(m,l);if(h&&!i.isEmpty()&&y>=0)return s?.trackChildChange(A_(t,i,g)),a.updateImmediateChild(t,i);{s?.trackChildChange(S_(t,g));const w=a.updateImmediateChild(t,st.EMPTY_NODE);return null!=m&&this.rangedFilter_.matches(m)?(s?.trackChildChange(np(m.name,m.node)),w.updateImmediateChild(m.name,m.node)):w}}return i.isEmpty()?e:h&&o(u,l)>=0?(null!=s&&(s.trackChildChange(S_(u.name,u.node)),s.trackChildChange(np(t,i))),a.updateImmediateChild(t,i).updateImmediateChild(u.name,st.EMPTY_NODE)):e}}class YE{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=vn}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,E.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,E.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:wc}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,E.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,E.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:El}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,E.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===vn}copy(){const e=new YE;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function NA(n,e,t){const i=n.copy();return i.startSet_=!0,void 0===e&&(e=null),i.indexStartValue_=e,null!=t?(i.startNameSet_=!0,i.indexStartName_=t):(i.startNameSet_=!1,i.indexStartName_=""),i}function xA(n,e,t){const i=n.copy();return i.endSet_=!0,void 0===e&&(e=null),i.indexEndValue_=e,void 0!==t?(i.endNameSet_=!0,i.indexEndName_=t):(i.endNameSet_=!1,i.indexEndName_=""),i}function QE(n,e){const t=n.copy();return t.index_=e,t}function Sj(n){const e={};if(n.isDefault())return e;let t;if(n.index_===vn?t="$priority":n.index_===AA?t="$value":n.index_===ya?t="$key":((0,E.hu)(n.index_ instanceof SA,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,E.Wl)(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=(0,E.Wl)(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+(0,E.Wl)(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=(0,E.Wl)(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+(0,E.Wl)(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function Aj(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==vn&&(e.i=n.index_.toString()),e}class JE extends hj{constructor(e,t,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=v_("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,E.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,r){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=JE.getListenId_(e,i),a={};this.listens_[o]=a;const l=Sj(e._queryParams);this.restRequest_(s+".json",l,(u,h)=>{let g=h;if(404===u&&(g=null,u=null),null===u&&this.onDataUpdate_(s,g,!1,i),(0,E.DV)(this.listens_,o)===a){let m;m=u?401===u?"permission_denied":"rest_error:"+u:"ok",r(m,null)}})}unlisten(e,t){const i=JE.getListenId_(e,t);delete this.listens_[i]}get(e){const t=Sj(e._queryParams),i=e._path.toString(),r=new E.BH;return this.restRequest_(i+".json",t,(s,o)=>{let a=o;404===s&&(a=null,s=null),null===s?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,E.xO)(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=(0,E.cI)(a.responseText)}catch{yr("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else 401!==a.status&&404!==a.status&&yr("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}}class Nse{constructor(){this.rootNode_=st.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function XE(){return{value:null,children:new Map}}function ip(n,e,t){if(gt(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const i=pt(e);n.children.has(i)||n.children.set(i,XE()),ip(n.children.get(i),e=fn(e),t)}}function PA(n,e){if(gt(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(vn,(i,r)=>{ip(n,new Yt(i),r)}),PA(n,e)}}if(n.children.size>0){const t=pt(e);return e=fn(e),n.children.has(t)&&PA(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function OA(n,e,t){null!==n.value?t(e,n.value):function xse(n,e){n.children.forEach((t,i)=>{e(i,t)})}(n,(i,r)=>{OA(r,new Yt(e.toString()+"/"+i),t)})}class Pse{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Bi(this.last_,(i,r)=>{t[i]=t[i]-r}),this.last_=e,t}}class kse{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Pse(e);const i=1e4+2e4*Math.random();E_(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;Bi(e,(r,s)=>{s>0&&(0,E.r3)(this.statsToReport_,r)&&(t[r]=s,i=!0)}),i&&this.server_.reportStats(t),E_(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var va=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(va||{});function FA(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class ew{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=va.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(gt(this.path)){if(null!=this.affectedTree.value)return(0,E.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Yt(e));return new ew(Vt(),t,this.revert)}}return(0,E.hu)(pt(this.path)===e,"operationForChild called for unrelated child."),new ew(fn(this.path),this.affectedTree,this.revert)}}class N_{constructor(e,t){this.source=e,this.path=t,this.type=va.LISTEN_COMPLETE}operationForChild(e){return gt(this.path)?new N_(this.source,Vt()):new N_(this.source,fn(this.path))}}class ad{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=va.OVERWRITE}operationForChild(e){return gt(this.path)?new ad(this.source,Vt(),this.snap.getImmediateChild(e)):new ad(this.source,fn(this.path),this.snap)}}class rp{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=va.MERGE}operationForChild(e){if(gt(this.path)){const t=this.children.subtree(new Yt(e));return t.isEmpty()?null:t.value?new ad(this.source,Vt(),t.value):new rp(this.source,Vt(),t)}return(0,E.hu)(pt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new rp(this.source,fn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Cc{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(gt(e))return this.isFullyInitialized()&&!this.filtered_;const t=pt(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Fse{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function x_(n,e,t,i,r,s){const o=i.filter(a=>a.type===t);o.sort((a,l)=>function Bse(n,e,t){if(null==e.childName||null==t.childName)throw(0,E.g5)("Should only compare child_ events.");const i=new vt(e.childName,e.snapshotNode),r=new vt(t.childName,t.snapshotNode);return n.index_.compare(i,r)}(n,a,l)),o.forEach(a=>{const l=function Vse(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,a,s);r.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(l,n.query_))})})}function tw(n,e){return{eventCache:n,serverCache:e}}function P_(n,e,t,i){return tw(new Cc(e,t,i),n.serverCache)}function Nj(n,e,t,i){return tw(n.eventCache,new Cc(e,t,i))}function nw(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function ld(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let LA;class bn{constructor(e,t=(()=>(LA||(LA=new us(Tre)),LA))()){this.value=e,this.children=t}static fromObject(e){let t=new bn(null);return Bi(e,(i,r)=>{t=t.set(new Yt(i),r)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Vt(),value:this.value};if(gt(e))return null;{const i=pt(e),r=this.children.get(i);if(null!==r){const s=r.findRootMostMatchingPathAndValue(fn(e),t);return null!=s?{path:Fn(new Yt(i),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(gt(e))return this;{const t=pt(e),i=this.children.get(t);return null!==i?i.subtree(fn(e)):new bn(null)}}set(e,t){if(gt(e))return new bn(t,this.children);{const i=pt(e),s=(this.children.get(i)||new bn(null)).set(fn(e),t),o=this.children.insert(i,s);return new bn(this.value,o)}}remove(e){if(gt(e))return this.children.isEmpty()?new bn(null):new bn(null,this.children);{const t=pt(e),i=this.children.get(t);if(i){const r=i.remove(fn(e));let s;return s=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&s.isEmpty()?new bn(null):new bn(this.value,s)}return this}}get(e){if(gt(e))return this.value;{const t=pt(e),i=this.children.get(t);return i?i.get(fn(e)):null}}setTree(e,t){if(gt(e))return t;{const i=pt(e),s=(this.children.get(i)||new bn(null)).setTree(fn(e),t);let o;return o=s.isEmpty()?this.children.remove(i):this.children.insert(i,s),new bn(this.value,o)}}fold(e){return this.fold_(Vt(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(Fn(e,r),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,Vt(),t)}findOnPath_(e,t,i){const r=!!this.value&&i(t,this.value);if(r)return r;if(gt(e))return null;{const s=pt(e),o=this.children.get(s);return o?o.findOnPath_(fn(e),Fn(t,s),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Vt(),t)}foreachOnPath_(e,t,i){if(gt(e))return this;{this.value&&i(t,this.value);const r=pt(e),s=this.children.get(r);return s?s.foreachOnPath_(fn(e),Fn(t,r),i):new bn(null)}}foreach(e){this.foreach_(Vt(),e)}foreach_(e,t){this.children.inorderTraversal((i,r)=>{r.foreach_(Fn(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}class Lo{constructor(e){this.writeTree_=e}static empty(){return new Lo(new bn(null))}}function O_(n,e,t){if(gt(e))return new Lo(new bn(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(null!=i){const r=i.path;let s=i.value;const o=Fr(r,e);return s=s.updateChild(o,t),new Lo(n.writeTree_.set(r,s))}{const r=new bn(t),s=n.writeTree_.setTree(e,r);return new Lo(s)}}}function VA(n,e,t){let i=n;return Bi(t,(r,s)=>{i=O_(i,Fn(e,r),s)}),i}function xj(n,e){if(gt(e))return Lo.empty();{const t=n.writeTree_.setTree(e,new bn(null));return new Lo(t)}}function BA(n,e){return null!=cd(n,e)}function cd(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(Fr(t.path,e)):null}function Pj(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(vn,(i,r)=>{e.push(new vt(i,r))}):n.writeTree_.children.inorderTraversal((i,r)=>{null!=r.value&&e.push(new vt(i,r.value))}),e}function Dc(n,e){if(gt(e))return n;{const t=cd(n,e);return new Lo(null!=t?new bn(t):n.writeTree_.subtree(e))}}function UA(n){return n.writeTree_.isEmpty()}function sp(n,e){return Oj(Vt(),n.writeTree_,e)}function Oj(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{".priority"===r?((0,E.hu)(null!==s.value,"Priority writes must always be leaf nodes"),i=s.value):t=Oj(Fn(n,r),s,t)}),!t.getChild(n).isEmpty()&&null!==i&&(t=t.updateChild(Fn(n,".priority"),i)),t}}function iw(n,e){return Vj(e,n)}function zse(n,e){if(n.snap)return io(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&io(Fn(n.path,t),e))return!0;return!1}function qse(n){return n.visible}function Mj(n,e,t){let i=Lo.empty();for(let r=0;r<n.length;++r){const s=n[r];if(e(s)){const o=s.path;let a;if(s.snap)io(t,o)?(a=Fr(t,o),i=O_(i,a,s.snap)):io(o,t)&&(a=Fr(o,t),i=O_(i,Vt(),s.snap.getChild(a)));else{if(!s.children)throw(0,E.g5)("WriteRecord should have .snap or .children");if(io(t,o))a=Fr(t,o),i=VA(i,a,s.children);else if(io(o,t))if(a=Fr(o,t),gt(a))i=VA(i,Vt(),s.children);else{const l=(0,E.DV)(s.children,pt(a));if(l){const u=l.getChild(fn(a));i=O_(i,Vt(),u)}}}}}return i}function kj(n,e,t,i,r){if(i||r){const s=Dc(n.visibleWrites,e);return!r&&UA(s)?t:r||null!=t||BA(s,Vt())?sp(Mj(n.allWrites,function(u){return(u.visible||r)&&(!i||!~i.indexOf(u.writeId))&&(io(u.path,e)||io(e,u.path))},e),t||st.EMPTY_NODE):null}{const s=cd(n.visibleWrites,e);if(null!=s)return s;{const o=Dc(n.visibleWrites,e);return UA(o)?t:null!=t||BA(o,Vt())?sp(o,t||st.EMPTY_NODE):null}}}function rw(n,e,t,i){return kj(n.writeTree,n.treePath,e,t,i)}function jA(n,e){return function Kse(n,e,t){let i=st.EMPTY_NODE;const r=cd(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(vn,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(t){const s=Dc(n.visibleWrites,e);return t.forEachChild(vn,(o,a)=>{const l=sp(Dc(s,new Yt(o)),a);i=i.updateImmediateChild(o,l)}),Pj(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}return Pj(Dc(n.visibleWrites,e)).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}(n.writeTree,n.treePath,e)}function Fj(n,e,t,i){return function Zse(n,e,t,i,r){(0,E.hu)(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=Fn(e,t);if(BA(n.visibleWrites,s))return null;{const o=Dc(n.visibleWrites,s);return UA(o)?r.getChild(t):sp(o,r.getChild(t))}}(n.writeTree,n.treePath,e,t,i)}function sw(n,e){return function Qse(n,e){return cd(n.visibleWrites,e)}(n.writeTree,Fn(n.treePath,e))}function $A(n,e,t){return function Yse(n,e,t,i){const r=Fn(e,t),s=cd(n.visibleWrites,r);return null!=s?s:i.isCompleteForChild(t)?sp(Dc(n.visibleWrites,r),i.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function Lj(n,e){return Vj(Fn(n.treePath,e),n.writeTree)}function Vj(n,e){return{treePath:n,writeTree:e}}class toe{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;(0,E.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,E.hu)(".priority"!==i,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(i);if(r){const s=r.type;if("child_added"===t&&"child_removed"===s)this.changeMap.set(i,A_(i,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===s)this.changeMap.delete(i);else if("child_removed"===t&&"child_changed"===s)this.changeMap.set(i,S_(i,r.oldSnap));else if("child_changed"===t&&"child_added"===s)this.changeMap.set(i,np(i,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==s)throw(0,E.g5)("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(i,A_(i,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}const Bj=new class noe{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}};class HA{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=null!=this.optCompleteServerCache_?new Cc(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return $A(this.writes_,e,i)}}getChildAfterChild(e,t,i){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:ld(this.viewCache_),s=function eoe(n,e,t,i,r,s){return function Jse(n,e,t,i,r,s,o){let a;const l=Dc(n.visibleWrites,e),u=cd(l,Vt());if(null!=u)a=u;else{if(null==t)return[];a=sp(l,t)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const h=[],g=o.getCompare(),m=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let y=m.getNext();for(;y&&h.length<r;)0!==g(y,i)&&h.push(y),y=m.getNext();return h}}(n.writeTree,n.treePath,e,t,i,r,s)}(this.writes_,r,t,1,i,e);return 0===s.length?null:s[0]}}function Uj(n,e,t,i,r,s){const o=e.eventCache;if(null!=sw(i,t))return e;{let a,l;if(gt(t))if((0,E.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=ld(e),g=jA(i,u instanceof st?u:st.EMPTY_NODE);a=n.filter.updateFullNode(e.eventCache.getNode(),g,s)}else{const u=rw(i,ld(e));a=n.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{const u=pt(t);if(".priority"===u){(0,E.hu)(1===Ic(t),"Can't have a priority with additional path components");const h=o.getNode();l=e.serverCache.getNode();const g=Fj(i,t,h,l);a=null!=g?n.filter.updatePriority(h,g):o.getNode()}else{const h=fn(t);let g;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();const m=Fj(i,t,o.getNode(),l);g=null!=m?o.getNode().getImmediateChild(u).updateChild(h,m):o.getNode().getImmediateChild(u)}else g=$A(i,u,e.serverCache);a=null!=g?n.filter.updateChild(o.getNode(),u,g,h,r,s):o.getNode()}}return P_(e,a,o.isFullyInitialized()||gt(t),n.filter.filtersNodes())}}function ow(n,e,t,i,r,s,o,a){const l=e.serverCache;let u;const h=o?n.filter:n.filter.getIndexedFilter();if(gt(t))u=h.updateFullNode(l.getNode(),i,null);else if(h.filtersNodes()&&!l.isFiltered()){const y=l.getNode().updateChild(t,i);u=h.updateFullNode(l.getNode(),y,null)}else{const y=pt(t);if(!l.isCompleteForPath(t)&&Ic(t)>1)return e;const b=fn(t),T=l.getNode().getImmediateChild(y).updateChild(b,i);u=".priority"===y?h.updatePriority(l.getNode(),T):h.updateChild(l.getNode(),y,T,b,Bj,null)}const g=Nj(e,u,l.isFullyInitialized()||gt(t),h.filtersNodes());return Uj(n,g,t,r,new HA(r,g,s),a)}function GA(n,e,t,i,r,s,o){const a=e.eventCache;let l,u;const h=new HA(r,e,s);if(gt(t))u=n.filter.updateFullNode(e.eventCache.getNode(),i,o),l=P_(e,u,!0,n.filter.filtersNodes());else{const g=pt(t);if(".priority"===g)u=n.filter.updatePriority(e.eventCache.getNode(),i),l=P_(e,u,a.isFullyInitialized(),a.isFiltered());else{const m=fn(t),y=a.getNode().getImmediateChild(g);let b;if(gt(m))b=i;else{const w=h.getCompleteChild(g);b=null!=w?".priority"===EA(m)&&w.getChild(mj(m)).isEmpty()?w:w.updateChild(m,i):st.EMPTY_NODE}l=y.equals(b)?e:P_(e,n.filter.updateChild(a.getNode(),g,b,m,h,o),a.isFullyInitialized(),n.filter.filtersNodes())}}return l}function jj(n,e){return n.eventCache.isCompleteForChild(e)}function $j(n,e,t){return t.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function zA(n,e,t,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u,l=e;u=gt(t)?i:new bn(null).setTree(t,i);const h=e.serverCache.getNode();return u.children.inorderTraversal((g,m)=>{if(h.hasChild(g)){const b=$j(0,e.serverCache.getNode().getImmediateChild(g),m);l=ow(n,l,new Yt(g),b,r,s,o,a)}}),u.children.inorderTraversal((g,m)=>{const y=!e.serverCache.isCompleteForChild(g)&&null===m.value;if(!h.hasChild(g)&&!y){const w=$j(0,e.serverCache.getNode().getImmediateChild(g),m);l=ow(n,l,new Yt(g),w,r,s,o,a)}}),l}class doe{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,r=new RA(i.getIndex()),s=function Cse(n){return n.loadsAllData()?new RA(n.getIndex()):n.hasLimit()?new Ise(n):new R_(n)}(i);this.processor_=function ioe(n){return{filter:n}}(s);const o=t.serverCache,a=t.eventCache,l=r.updateFullNode(st.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(st.EMPTY_NODE,a.getNode(),null),h=new Cc(l,o.isFullyInitialized(),r.filtersNodes()),g=new Cc(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=tw(g,h),this.eventGenerator_=new Fse(this.query_)}get query(){return this.query_}}function poe(n,e){const t=ld(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!gt(e)&&!t.getImmediateChild(pt(e)).isEmpty())?t.getChild(e):null}function Hj(n){return 0===n.eventRegistrations_.length}function Gj(n,e,t){const i=[];if(t){(0,E.hu)(null==e,"A cancel should cancel all event registrations.");const r=n.query._path;n.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(t,r);o&&i.push(o)})}if(e){let r=[];for(let s=0;s<n.eventRegistrations_.length;++s){const o=n.eventRegistrations_[s];if(o.matches(e)){if(e.hasAnyCallback()){r=r.concat(n.eventRegistrations_.slice(s+1));break}}else r.push(o)}n.eventRegistrations_=r}else n.eventRegistrations_=[];return i}function zj(n,e,t,i){e.type===va.MERGE&&null!==e.source.queryId&&((0,E.hu)(ld(n.viewCache_),"We should always have a full cache before handling merges"),(0,E.hu)(nw(n.viewCache_),"Missing event cache, even though we have a server cache"));const r=n.viewCache_,s=function soe(n,e,t,i,r){const s=new toe;let o,a;if(t.type===va.OVERWRITE){const u=t;u.source.fromUser?o=GA(n,e,u.path,u.snap,i,r,s):((0,E.hu)(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!gt(u.path),o=ow(n,e,u.path,u.snap,i,r,a,s))}else if(t.type===va.MERGE){const u=t;u.source.fromUser?o=function aoe(n,e,t,i,r,s,o){let a=e;return i.foreach((l,u)=>{const h=Fn(t,l);jj(e,pt(h))&&(a=GA(n,a,h,u,r,s,o))}),i.foreach((l,u)=>{const h=Fn(t,l);jj(e,pt(h))||(a=GA(n,a,h,u,r,s,o))}),a}(n,e,u.path,u.children,i,r,s):((0,E.hu)(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=zA(n,e,u.path,u.children,i,r,a,s))}else if(t.type===va.ACK_USER_WRITE){const u=t;o=u.revert?function uoe(n,e,t,i,r,s){let o;if(null!=sw(i,t))return e;{const a=new HA(i,e,r),l=e.eventCache.getNode();let u;if(gt(t)||".priority"===pt(t)){let h;if(e.serverCache.isFullyInitialized())h=rw(i,ld(e));else{const g=e.serverCache.getNode();(0,E.hu)(g instanceof st,"serverChildren would be complete if leaf node"),h=jA(i,g)}u=n.filter.updateFullNode(l,h,s)}else{const h=pt(t);let g=$A(i,h,e.serverCache);null==g&&e.serverCache.isCompleteForChild(h)&&(g=l.getImmediateChild(h)),u=null!=g?n.filter.updateChild(l,h,g,fn(t),a,s):e.eventCache.getNode().hasChild(h)?n.filter.updateChild(l,h,st.EMPTY_NODE,fn(t),a,s):l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=rw(i,ld(e)),o.isLeafNode()&&(u=n.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||null!=sw(i,Vt()),P_(e,u,o,n.filter.filtersNodes())}}(n,e,u.path,i,r,s):function loe(n,e,t,i,r,s,o){if(null!=sw(r,t))return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(null!=i.value){if(gt(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return ow(n,e,t,l.getNode().getChild(t),r,s,a,o);if(gt(t)){let u=new bn(null);return l.getNode().forEachChild(ya,(h,g)=>{u=u.set(new Yt(h),g)}),zA(n,e,t,u,r,s,a,o)}return e}{let u=new bn(null);return i.foreach((h,g)=>{const m=Fn(t,h);l.isCompleteForPath(m)&&(u=u.set(h,l.getNode().getChild(m)))}),zA(n,e,t,u,r,s,a,o)}}(n,e,u.path,u.affectedTree,i,r,s)}else{if(t.type!==va.LISTEN_COMPLETE)throw(0,E.g5)("Unknown operation type: "+t.type);o=function coe(n,e,t,i,r){const s=e.serverCache;return Uj(n,Nj(e,s.getNode(),s.isFullyInitialized()||gt(t),s.isFiltered()),t,i,Bj,r)}(n,e,t.path,i,s)}const l=s.getChanges();return function ooe(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=nw(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&t.push(Dj(nw(e)))}}(e,o,l),{viewCache:o,changes:l}}(n.processor_,r,e,t,i);return function roe(n,e){(0,E.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,E.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,s.viewCache),(0,E.hu)(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,Wj(n,s.changes,s.viewCache.eventCache.getNode(),null)}function Wj(n,e,t,i){return function Lse(n,e,t,i){const r=[],s=[];return e.forEach(o=>{"child_changed"===o.type&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(function Tse(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(o.childName,o.snapshotNode))}),x_(n,r,"child_removed",e,i,t),x_(n,r,"child_added",e,i,t),x_(n,r,"child_moved",s,i,t),x_(n,r,"child_changed",e,i,t),x_(n,r,"value",e,i,t),r}(n.eventGenerator_,e,t,i?[i]:n.eventRegistrations_)}let aw,cw;class qj{constructor(){this.views=new Map}}function WA(n,e,t,i){const r=e.source.queryId;if(null!==r){const s=n.views.get(r);return(0,E.hu)(null!=s,"SyncTree gave us an op for an invalid query."),zj(s,e,t,i)}{let s=[];for(const o of n.views.values())s=s.concat(zj(o,e,t,i));return s}}function Kj(n,e,t,i,r){const o=n.views.get(e._queryIdentifier);if(!o){let a=rw(t,r?i:null),l=!1;a?l=!0:i instanceof st?(a=jA(t,i),l=!1):(a=st.EMPTY_NODE,l=!1);const u=tw(new Cc(a,l,!1),new Cc(i,r,!1));return new doe(e,u)}return o}function Zj(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Sc(n,e){let t=null;for(const i of n.views.values())t=t||poe(i,e);return t}function Yj(n,e){return e._queryParams.loadsAllData()?lw(n):n.views.get(e._queryIdentifier)}function Qj(n,e){return null!=Yj(n,e)}function Ac(n){return null!=lw(n)}function lw(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let Ioe=1;class Jj{constructor(e){this.listenProvider_=e,this.syncPointTree_=new bn(null),this.pendingWriteTree_=function Xse(){return{visibleWrites:Lo.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function qA(n,e,t,i,r){return function jse(n,e,t,i,r){(0,E.hu)(i>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:r}),r&&(n.visibleWrites=O_(n.visibleWrites,e,t)),n.lastWriteId=i}(n.pendingWriteTree_,e,t,i,r),r?op(n,new ad({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function Rc(n,e,t=!1){const i=function Hse(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}(n.pendingWriteTree_,e);if(function Gse(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);(0,E.hu)(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let r=i.visible,s=!1,o=n.allWrites.length-1;for(;r&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=t&&zse(a,i.path)?r=!1:io(i.path,a.path)&&(s=!0)),o--}return!!r&&(s?(function Wse(n){n.visibleWrites=Mj(n.allWrites,qse,Vt()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(i.snap?n.visibleWrites=xj(n.visibleWrites,i.path):Bi(i.children,l=>{n.visibleWrites=xj(n.visibleWrites,Fn(i.path,l))}),!0))}(n.pendingWriteTree_,e)){let s=new bn(null);return null!=i.snap?s=s.set(Vt(),!0):Bi(i.children,o=>{s=s.set(new Yt(o),!0)}),op(n,new ew(i.path,s,t))}return[]}function M_(n,e,t){return op(n,new ad({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function uw(n,e,t,i,r=!1){const s=e._path,o=n.syncPointTree_.get(s);let a=[];if(o&&("default"===e._queryIdentifier||Qj(o,e))){const l=function Eoe(n,e,t,i){const r=e._queryIdentifier,s=[];let o=[];const a=Ac(n);if("default"===r)for(const[l,u]of n.views.entries())o=o.concat(Gj(u,t,i)),Hj(u)&&(n.views.delete(l),u.query._queryParams.loadsAllData()||s.push(u.query));else{const l=n.views.get(r);l&&(o=o.concat(Gj(l,t,i)),Hj(l)&&(n.views.delete(r),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!Ac(n)&&s.push(new(function yoe(){return(0,E.hu)(aw,"Reference.ts has not been loaded"),aw}())(e._repo,e._path)),{removed:s,events:o}}(o,e,t,i);(function voe(n){return 0===n.views.size})(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const u=l.removed;if(a=l.events,!r){const h=-1!==u.findIndex(m=>m._queryParams.loadsAllData()),g=n.syncPointTree_.findOnPath(s,(m,y)=>Ac(y));if(h&&!g){const m=n.syncPointTree_.subtree(s);if(!m.isEmpty()){const y=function xoe(n){return n.fold((e,t,i)=>{if(t&&Ac(t))return[lw(t)];{let r=[];return t&&(r=Zj(t)),Bi(i,(s,o)=>{r=r.concat(o)}),r}})}(m);for(let b=0;b<y.length;++b){const w=y[b],T=w.query,P=n$(n,w);n.listenProvider_.startListening(F_(T),k_(n,T),P.hashFn,P.onComplete)}}}!g&&u.length>0&&!i&&(h?n.listenProvider_.stopListening(F_(e),null):u.forEach(m=>{const y=n.queryToTagMap.get(hw(m));n.listenProvider_.stopListening(F_(m),y)}))}!function Poe(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const r=hw(i),s=n.queryToTagMap.get(r);n.queryToTagMap.delete(r),n.tagToQueryMap.delete(s)}}}(n,u)}return a}function Xj(n,e,t,i){const r=ZA(n,i);if(null!=r){const s=YA(r),o=s.path,a=s.queryId,l=Fr(o,e);return QA(n,o,new ad(FA(a),l,t))}return[]}function KA(n,e,t,i=!1){const r=e._path;let s=null,o=!1;n.syncPointTree_.foreachOnPath(r,(m,y)=>{const b=Fr(m,r);s=s||Sc(y,b),o=o||Ac(y)});let l,a=n.syncPointTree_.get(r);a?(o=o||Ac(a),s=s||Sc(a,Vt())):(a=new qj,n.syncPointTree_=n.syncPointTree_.set(r,a)),null!=s?l=!0:(l=!1,s=st.EMPTY_NODE,n.syncPointTree_.subtree(r).foreachChild((y,b)=>{const w=Sc(b,Vt());w&&(s=s.updateImmediateChild(y,w))}));const u=Qj(a,e);if(!u&&!e._queryParams.loadsAllData()){const m=hw(e);(0,E.hu)(!n.queryToTagMap.has(m),"View does not exist, but we have a tag");const y=function Ooe(){return Ioe++}();n.queryToTagMap.set(m,y),n.tagToQueryMap.set(y,m)}let g=function boe(n,e,t,i,r,s){const o=Kj(n,e,i,r,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),function goe(n,e){n.eventRegistrations_.push(e)}(o,t),function moe(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(vn,(s,o)=>{i.push(np(s,o))}),t.isFullyInitialized()&&i.push(Dj(t.getNode())),Wj(n,i,t.getNode(),e)}(o,t)}(a,e,t,iw(n.pendingWriteTree_,r),s,l);if(!u&&!o&&!i){const m=Yj(a,e);g=g.concat(function Moe(n,e,t){const i=e._path,r=k_(n,e),s=n$(n,t),o=n.listenProvider_.startListening(F_(e),r,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(i);if(r)(0,E.hu)(!Ac(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((u,h,g)=>{if(!gt(u)&&h&&Ac(h))return[lw(h).query];{let m=[];return h&&(m=m.concat(Zj(h).map(y=>y.query))),Bi(g,(y,b)=>{m=m.concat(b)}),m}});for(let u=0;u<l.length;++u){const h=l[u];n.listenProvider_.stopListening(F_(h),k_(n,h))}}return o}(n,e,m))}return g}function dw(n,e,t){const r=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{const u=Sc(a,Fr(o,e));if(u)return u});return kj(r,e,s,t,!0)}function op(n,e){return e$(e,n.syncPointTree_,null,iw(n.pendingWriteTree_,Vt()))}function e$(n,e,t,i){if(gt(n.path))return t$(n,e,t,i);{const r=e.get(Vt());null==t&&null!=r&&(t=Sc(r,Vt()));let s=[];const o=pt(n.path),a=n.operationForChild(o),l=e.children.get(o);if(l&&a){const u=t?t.getImmediateChild(o):null,h=Lj(i,o);s=s.concat(e$(a,l,u,h))}return r&&(s=s.concat(WA(r,n,i,t))),s}}function t$(n,e,t,i){const r=e.get(Vt());null==t&&null!=r&&(t=Sc(r,Vt()));let s=[];return e.children.inorderTraversal((o,a)=>{const l=t?t.getImmediateChild(o):null,u=Lj(i,o),h=n.operationForChild(o);h&&(s=s.concat(t$(h,a,l,u)))}),r&&(s=s.concat(WA(r,n,i,t))),s}function n$(n,e){const t=e.query,i=k_(n,t);return{hashFn:()=>(function hoe(n){return n.viewCache_.serverCache.getNode()}(e)||st.EMPTY_NODE).hash(),onComplete:r=>{if("ok"===r)return i?function Aoe(n,e,t){const i=ZA(n,t);if(i){const r=YA(i),s=r.path,o=r.queryId,a=Fr(s,e);return QA(n,s,new N_(FA(o),a))}return[]}(n,t._path,i):function Soe(n,e){return op(n,new N_({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const s=function Dre(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}(r,t);return uw(n,t,null,s)}}}}function k_(n,e){const t=hw(e);return n.queryToTagMap.get(t)}function hw(n){return n._path.toString()+"$"+n._queryIdentifier}function ZA(n,e){return n.tagToQueryMap.get(e)}function YA(n){const e=n.indexOf("$");return(0,E.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Yt(n.substr(0,e))}}function QA(n,e,t){const i=n.syncPointTree_.get(e);return(0,E.hu)(i,"Missing sync point for query tag that we're tracking"),WA(i,t,iw(n.pendingWriteTree_,e),null)}function F_(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function Toe(){return(0,E.hu)(cw,"Reference.ts has not been loaded"),cw}())(n._repo,n._path):n}class JA{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new JA(t)}node(){return this.node_}}class XA{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Fn(this.path_,e);return new XA(this.syncTree_,t)}node(){return dw(this.syncTree_,this.path_)}}const koe=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},i$=function(n,e,t){return n&&"object"==typeof n?((0,E.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?Foe(n[".sv"],e,t):"object"==typeof n[".sv"]?Loe(n[".sv"],e):void(0,E.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},Foe=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,E.hu)(!1,"Unexpected server value: "+n)},Loe=function(n,e,t){n.hasOwnProperty("increment")||(0,E.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;"number"!=typeof i&&(0,E.hu)(!1,"Unexpected increment value: "+i);const r=e.node();if((0,E.hu)(null!==r&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const o=r.getValue();return"number"!=typeof o?i:o+i},r$=function(n,e,t,i){return tR(e,new XA(t,n),i)},eR=function(n,e,t){return tR(n,new JA(e),t)};function tR(n,e,t){const i=n.getPriority().val(),r=i$(i,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,a=i$(o.getValue(),e,t);return a!==o.getValue()||r!==o.getPriority().val()?new ep(a,Kn(r)):n}{const o=n;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new ep(r))),o.forEachChild(vn,(a,l)=>{const u=tR(l,e.getImmediateChild(a),t);u!==l&&(s=s.updateImmediateChild(a,u))}),s}}class nR{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function fw(n,e){let t=e instanceof Yt?e:new Yt(e),i=n,r=pt(t);for(;null!==r;){const s=(0,E.DV)(i.node.children,r)||{children:{},childCount:0};i=new nR(r,i,s),t=fn(t),r=pt(t)}return i}function ud(n){return n.node.value}function iR(n,e){n.node.value=e,rR(n)}function s$(n){return n.node.childCount>0}function pw(n,e){Bi(n.node.children,(t,i)=>{e(new nR(t,n,i))})}function o$(n,e,t,i){t&&!i&&e(n),pw(n,r=>{o$(r,e,!0,i)}),t&&i&&e(n)}function L_(n){return new Yt(null===n.parent?n.name:L_(n.parent)+"/"+n.name)}function rR(n){null!==n.parent&&function Uoe(n,e,t){const i=function Voe(n){return void 0===ud(n)&&!s$(n)}(t),r=(0,E.r3)(n.node.children,e);i&&r?(delete n.node.children[e],n.node.childCount--,rR(n)):!i&&!r&&(n.node.children[e]=t.node,n.node.childCount++,rR(n))}(n.parent,n.name,n)}const joe=/[\[\].#$\/\u0000-\u001F\u007F]/,$oe=/[\[\].#$\u0000-\u001F\u007F]/,sR=10485760,gw=function(n){return"string"==typeof n&&0!==n.length&&!joe.test(n)},a$=function(n){return"string"==typeof n&&0!==n.length&&!$oe.test(n)},V_=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!$E(n)||n&&"object"==typeof n&&(0,E.r3)(n,".sv")},ba=function(n,e,t,i){i&&void 0===e||B_((0,E.gK)(n,"value"),e,t)},B_=function(n,e,t){const i=t instanceof Yt?new sse(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+sd(i));if("function"==typeof e)throw new Error(n+"contains a function "+sd(i)+" with contents = "+e.toString());if($E(e))throw new Error(n+"contains "+e.toString()+" "+sd(i));if("string"==typeof e&&e.length>sR/3&&(0,E.ug)(e)>sR)throw new Error(n+"contains a string greater than "+sR+" utf8 bytes "+sd(i)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let r=!1,s=!1;if(Bi(e,(o,a)=>{if(".value"===o)r=!0;else if(".priority"!==o&&".sv"!==o&&(s=!0,!gw(o)))throw new Error(n+" contains an invalid key ("+o+") "+sd(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function ose(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,E.ug)(e),_j(n)})(i,o),B_(n,a,i),function ase(n){const e=n.parts_.pop();n.byteLength_-=(0,E.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(i)}),r&&s)throw new Error(n+' contains ".value" child '+sd(i)+" in addition to actual children.")}},l$=function(n,e,t,i){if(i&&void 0===e)return;const r=(0,E.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");const s=[];Bi(e,(o,a)=>{const l=new Yt(o);if(B_(r,a,Fn(t,l)),".priority"===EA(l)&&!V_(a))throw new Error(r+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),function(n,e){let t,i;for(t=0;t<e.length;t++){i=e[t];const s=T_(i);for(let o=0;o<s.length;o++)if((".priority"!==s[o]||o!==s.length-1)&&!gw(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+i.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(rse);let r=null;for(t=0;t<e.length;t++){if(i=e[t],null!==r&&io(r,i))throw new Error(n+"contains a path "+r.toString()+" that is ancestor of another path "+i.toString());r=i}}(r,s)},oR=function(n,e,t){if(!t||void 0!==e){if($E(e))throw new Error((0,E.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!V_(e))throw new Error((0,E.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},U_=function(n,e,t,i){if(!(i&&void 0===t||gw(t)))throw new Error((0,E.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},j_=function(n,e,t,i){if(!(i&&void 0===t||a$(t)))throw new Error((0,E.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},zoe=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),j_(n,e,t,i)},ro=function(n,e){if(".info"===pt(e))throw new Error(n+" failed = Can't modify data under /.info/")},c$=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!gw(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),a$(n)}(t))throw new Error((0,E.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Woe{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function mw(n,e){let t=null;for(let i=0;i<e.length;i++){const r=e[i],s=r.getPath();null!==t&&!wA(s,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:s}),t.events.push(r)}t&&n.eventLists_.push(t)}function u$(n,e,t){mw(n,t),d$(n,i=>wA(i,e))}function Rs(n,e,t){mw(n,t),d$(n,i=>io(i,e)||io(e,i))}function d$(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const r=n.eventLists_[i];r&&(e(r.path)?(qoe(n.eventLists_[i]),n.eventLists_[i]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function qoe(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const i=t.getEventRunner();id&&Vi("event: "+t.toString()),Jf(i)}}}const h$="repo_interrupt",Koe=25;class Zoe{constructor(e,t,i,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Woe,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=XE(),this.transactionQueueTree_=new nR,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function f$(n){const t=n.infoData_.getNode(new Yt(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function $_(n){return koe({timestamp:f$(n)})}function p$(n,e,t,i,r){n.dataUpdateCount++;const s=new Yt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(r)if(i){const l=(0,E.UI)(t,u=>Kn(u));o=function Roe(n,e,t,i){const r=ZA(n,i);if(r){const s=YA(r),o=s.path,a=s.queryId,l=Fr(o,e),u=bn.fromObject(t);return QA(n,o,new rp(FA(a),l,u))}return[]}(n.serverSyncTree_,s,l,r)}else{const l=Kn(t);o=Xj(n.serverSyncTree_,s,l,r)}else if(i){const l=(0,E.UI)(t,u=>Kn(u));o=function Doe(n,e,t){const i=bn.fromObject(t);return op(n,new rp({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,s,l)}else{const l=Kn(t);o=M_(n.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=lp(n,s)),Rs(n.eventQueue_,a,o)}function g$(n,e){aR(n,"connected",e),!1===e&&function eae(n){ap(n,"onDisconnectEvents");const e=$_(n),t=XE();OA(n.onDisconnect_,Vt(),(r,s)=>{const o=r$(r,s,n.serverSyncTree_,e);ip(t,r,o)});let i=[];OA(t,Vt(),(r,s)=>{i=i.concat(M_(n.serverSyncTree_,r,s));const o=dR(n,r);lp(n,o)}),n.onDisconnect_=XE(),Rs(n.eventQueue_,Vt(),i)}(n)}function aR(n,e,t){const i=new Yt("/.info/"+e),r=Kn(t);n.infoData_.updateSnapshot(i,r);const s=M_(n.infoSyncTree_,i,r);Rs(n.eventQueue_,i,s)}function _w(n){return n.nextWriteId_++}function lR(n,e,t,i,r){ap(n,"set",{path:e.toString(),value:t,priority:i});const s=$_(n),o=Kn(t,i),a=dw(n.serverSyncTree_,e),l=eR(o,a,s),u=_w(n),h=qA(n.serverSyncTree_,e,l,u,!0);mw(n.eventQueue_,h),n.server_.put(e.toString(),o.val(!0),(m,y)=>{const b="ok"===m;b||yr("set at "+e+" failed: "+m);const w=Rc(n.serverSyncTree_,u,!b);Rs(n.eventQueue_,e,w),Nc(0,r,m,y)});const g=dR(n,e);lp(n,g),Rs(n.eventQueue_,g,[])}function tae(n,e,t){n.server_.onDisconnectCancel(e.toString(),(i,r)=>{"ok"===i&&PA(n.onDisconnect_,e),Nc(0,t,i,r)})}function m$(n,e,t,i){const r=Kn(t);n.server_.onDisconnectPut(e.toString(),r.val(!0),(s,o)=>{"ok"===s&&ip(n.onDisconnect_,e,r),Nc(0,i,s,o)})}function cR(n,e,t){let i;i=".info"===pt(e._path)?uw(n.infoSyncTree_,e,t):uw(n.serverSyncTree_,e,t),u$(n.eventQueue_,e._path,i)}function _$(n){n.persistentConnection_&&n.persistentConnection_.interrupt(h$)}function ap(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Vi(t,...e)}function Nc(n,e,t,i){e&&Jf(()=>{if("ok"===t)e(null);else{const r=(t||"error").toUpperCase();let s=r;i&&(s+=": "+i);const o=new Error(s);o.code=r,e(o)}})}function uR(n,e,t){return dw(n.serverSyncTree_,e,t)||st.EMPTY_NODE}function yw(n,e=n.transactionQueueTree_){if(e||vw(n,e),ud(e)){const t=v$(n,e);(0,E.hu)(t.length>0,"Sending zero length transaction queue"),t.every(r=>0===r.status)&&function aae(n,e,t){const i=t.map(u=>u.currentWriteId),r=uR(n,e,i);let s=r;const o=r.hash();for(let u=0;u<t.length;u++){const h=t[u];(0,E.hu)(0===h.status,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const g=Fr(e,h.path);s=s.updateChild(g,h.currentOutputSnapshotRaw)}const a=s.val(!0),l=e;n.server_.put(l.toString(),a,u=>{ap(n,"transaction put response",{path:l.toString(),status:u});let h=[];if("ok"===u){const g=[];for(let m=0;m<t.length;m++)t[m].status=2,h=h.concat(Rc(n.serverSyncTree_,t[m].currentWriteId)),t[m].onComplete&&g.push(()=>t[m].onComplete(null,!0,t[m].currentOutputSnapshotResolved)),t[m].unwatcher();vw(n,fw(n.transactionQueueTree_,e)),yw(n,n.transactionQueueTree_),Rs(n.eventQueue_,e,h);for(let m=0;m<g.length;m++)Jf(g[m])}else{if("datastale"===u)for(let g=0;g<t.length;g++)t[g].status=3===t[g].status?4:0;else{yr("transaction at "+l.toString()+" failed: "+u);for(let g=0;g<t.length;g++)t[g].status=4,t[g].abortReason=u}lp(n,e)}},o)}(n,L_(e),t)}else s$(e)&&pw(e,t=>{yw(n,t)})}function lp(n,e){const t=y$(n,e),i=L_(t);return function lae(n,e,t){if(0===e.length)return;const i=[];let r=[];const o=e.filter(a=>0===a.status).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],u=Fr(t,l.path);let g,h=!1;if((0,E.hu)(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)h=!0,g=l.abortReason,r=r.concat(Rc(n.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=Koe)h=!0,g="maxretry",r=r.concat(Rc(n.serverSyncTree_,l.currentWriteId,!0));else{const m=uR(n,l.path,o);l.currentInputSnapshot=m;const y=e[a].update(m.val());if(void 0!==y){B_("transaction failed: Data returned ",y,l.path);let b=Kn(y);"object"==typeof y&&null!=y&&(0,E.r3)(y,".priority")||(b=b.updatePriority(m.getPriority()));const T=l.currentWriteId,P=$_(n),S=eR(b,m,P);l.currentOutputSnapshotRaw=b,l.currentOutputSnapshotResolved=S,l.currentWriteId=_w(n),o.splice(o.indexOf(T),1),r=r.concat(qA(n.serverSyncTree_,l.path,S,l.currentWriteId,l.applyLocally)),r=r.concat(Rc(n.serverSyncTree_,T,!0))}else h=!0,g="nodata",r=r.concat(Rc(n.serverSyncTree_,l.currentWriteId,!0))}Rs(n.eventQueue_,t,r),r=[],h&&(e[a].status=2,setTimeout(e[a].unwatcher,Math.floor(0)),e[a].onComplete&&i.push("nodata"===g?()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot):()=>e[a].onComplete(new Error(g),!1,null)))}vw(n,n.transactionQueueTree_);for(let a=0;a<i.length;a++)Jf(i[a]);yw(n,n.transactionQueueTree_)}(n,v$(n,t),i),i}function y$(n,e){let t,i=n.transactionQueueTree_;for(t=pt(e);null!==t&&void 0===ud(i);)i=fw(i,t),t=pt(e=fn(e));return i}function v$(n,e){const t=[];return b$(n,e,t),t.sort((i,r)=>i.order-r.order),t}function b$(n,e,t){const i=ud(e);if(i)for(let r=0;r<i.length;r++)t.push(i[r]);pw(e,r=>{b$(n,r,t)})}function vw(n,e){const t=ud(e);if(t){let i=0;for(let r=0;r<t.length;r++)2!==t[r].status&&(t[i]=t[r],i++);t.length=i,iR(e,t.length>0?t:void 0)}pw(e,i=>{vw(n,i)})}function dR(n,e){const t=L_(y$(n,e)),i=fw(n.transactionQueueTree_,e);return function Boe(n,e,t){let i=t?n:n.parent;for(;null!==i;){if(e(i))return!0;i=i.parent}}(i,r=>{hR(n,r)}),hR(n,i),o$(i,r=>{hR(n,r)}),t}function hR(n,e){const t=ud(e);if(t){const i=[];let r=[],s=-1;for(let o=0;o<t.length;o++)3===t[o].status||(1===t[o].status?((0,E.hu)(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):((0,E.hu)(0===t[o].status,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(Rc(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&i.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));-1===s?iR(e,void 0):t.length=s+1,Rs(n.eventQueue_,L_(e),r);for(let o=0;o<i.length;o++)Jf(i[o])}}const fR=function(n,e){const t=dae(n),i=t.namespace;return"firebase.com"===t.domain&&_a(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||"undefined"===i)&&"localhost"!==t.domain&&_a("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&yr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new gA(t.host,t.secure,i,"ws"===t.scheme||"wss"===t.scheme,e,"",i!==t.subdomain),path:new Yt(t.pathString)}},dae=function(n){let e="",t="",i="",r="",s="",o=!0,a="https",l=443;if("string"==typeof n){let u=n.indexOf("//");u>=0&&(a=n.substring(0,u-1),n=n.substring(u+2));let h=n.indexOf("/");-1===h&&(h=n.length);let g=n.indexOf("?");-1===g&&(g=n.length),e=n.substring(0,Math.min(h,g)),h<g&&(r=function cae(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let r=t[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}(n.substring(h,g)));const m=function uae(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const i=t.split("=");2===i.length?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):yr(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,g)));u=e.indexOf(":"),u>=0?(o="https"===a||"wss"===a,l=parseInt(e.substring(u+1),10)):u=e.length;const y=e.slice(0,u);if("localhost"===y.toLowerCase())t="localhost";else if(y.split(".").length<=2)t=y;else{const b=e.indexOf(".");i=e.substring(0,b).toLowerCase(),t=e.substring(b+1),s=i}"ns"in m&&(s=m.ns)}return{host:e,port:l,domain:t,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}},E$="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",hae=function(){let n=0;const e=[];return function(t){const i=t===n;let r;n=t;const s=new Array(8);for(r=7;r>=0;r--)s[r]=E$.charAt(t%64),t=Math.floor(t/64);(0,E.hu)(0===t,"Cannot push at time == 0");let o=s.join("");if(i){for(r=11;r>=0&&63===e[r];r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)o+=E$.charAt(e[r]);return(0,E.hu)(20===o.length,"nextPushId: Length should be 20."),o}}();class w${constructor(e,t,i,r){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,E.Wl)(this.snapshot.exportVal())}}class T${constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class pR{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,E.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class I${constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new E.BH;return tae(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){ro("OnDisconnect.remove",this._path);const e=new E.BH;return m$(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){ro("OnDisconnect.set",this._path),ba("OnDisconnect.set",e,this._path,!1);const t=new E.BH;return m$(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){ro("OnDisconnect.setWithPriority",this._path),ba("OnDisconnect.setWithPriority",e,this._path,!1),oR("OnDisconnect.setWithPriority",t,!1);const i=new E.BH;return function nae(n,e,t,i,r){const s=Kn(t,i);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{"ok"===o&&ip(n.onDisconnect_,e,s),Nc(0,r,o,a)})}(this._repo,this._path,e,t,i.wrapCallback(()=>{})),i.promise}update(e){ro("OnDisconnect.update",this._path),l$("OnDisconnect.update",e,this._path,!1);const t=new E.BH;return function iae(n,e,t,i){if((0,E.xb)(t))return Vi("onDisconnect().update() called with empty data.  Don't do anything."),void Nc(0,i,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(r,s)=>{"ok"===r&&Bi(t,(o,a)=>{const l=Kn(a);ip(n.onDisconnect_,Fn(e,o),l)}),Nc(0,i,r,s)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class ds{constructor(e,t,i,r){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=r}get key(){return gt(this._path)?null:EA(this._path)}get ref(){return new so(this._repo,this._path)}get _queryIdentifier(){const e=Aj(this._queryParams),t=fA(e);return"{}"===t?"default":t}get _queryObject(){return Aj(this._queryParams)}isEqual(e){if(!((e=(0,E.m9)(e))instanceof ds))return!1;const t=this._repo===e._repo,i=wA(this._path,e._path);return t&&i&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function ise(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function bw(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function xc(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===ya){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==wc)throw new Error(i);if("string"!=typeof e)throw new Error(r)}if(n.hasEnd()){if(n.getIndexEndName()!==El)throw new Error(i);if("string"!=typeof t)throw new Error(r)}}else if(n.getIndex()===vn){if(null!=e&&!V_(e)||null!=t&&!V_(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,E.hu)(n.getIndex()instanceof SA||n.getIndex()===AA,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Ew(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class so extends ds{constructor(e,t){super(e,t,new YE,!1)}get parent(){const e=mj(this._path);return null===e?null:new so(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class dd{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Yt(e),i=hd(this.ref,e);return new dd(this._node.getChild(t),i,vn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(i,r)=>e(new dd(r,hd(this.ref,i),vn)))}hasChild(e){const t=new Yt(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function C$(n,e){return(n=(0,E.m9)(n))._checkNotDeleted("ref"),void 0!==e?hd(n._root,e):n._root}function D$(n,e){(n=(0,E.m9)(n))._checkNotDeleted("refFromURL");const t=fR(e,n._repo.repoInfo_.nodeAdmin);c$("refFromURL",t);const i=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&i.host!==n._repo.repoInfo_.host&&_a("refFromURL: Host name does not match the current database: (found "+i.host+" but expected "+n._repo.repoInfo_.host+")"),C$(n,t.path.toString())}function hd(n,e){return null===pt((n=(0,E.m9)(n))._path)?zoe("child","path",e,!1):j_("child","path",e,!1),new so(n._repo,Fn(n._path,e))}function gR(n,e){n=(0,E.m9)(n),ro("set",n._path),ba("set",e,n._path,!1);const t=new E.BH;return lR(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function _ae(n,e){l$("update",e,n._path,!1);const t=new E.BH;return function Xoe(n,e,t,i){ap(n,"update",{path:e.toString(),value:t});let r=!0;const s=$_(n),o={};if(Bi(t,(a,l)=>{r=!1,o[a]=r$(Fn(e,a),Kn(l),n.serverSyncTree_,s)}),r)Vi("update() called with empty data.  Don't do anything."),Nc(0,i,"ok",void 0);else{const a=_w(n),l=function Coe(n,e,t,i){!function $se(n,e,t,i){(0,E.hu)(i>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:i,visible:!0}),n.visibleWrites=VA(n.visibleWrites,e,t),n.lastWriteId=i}(n.pendingWriteTree_,e,t,i);const r=bn.fromObject(t);return op(n,new rp({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,e,o,a);mw(n.eventQueue_,l),n.server_.merge(e.toString(),t,(u,h)=>{const g="ok"===u;g||yr("update at "+e+" failed: "+u);const m=Rc(n.serverSyncTree_,a,!g),y=m.length>0?lp(n,e):e;Rs(n.eventQueue_,y,m),Nc(0,i,u,h)}),Bi(t,u=>{const h=dR(n,Fn(e,u));lp(n,h)}),Rs(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function yae(n){n=(0,E.m9)(n);const e=new pR(()=>{}),t=new H_(e);return function Joe(n,e,t){const i=function Noe(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(u,h)=>{const g=Fr(u,t);i=i||Sc(h,g)});let r=n.syncPointTree_.get(t);r?i=i||Sc(r,Vt()):(r=new qj,n.syncPointTree_=n.syncPointTree_.set(t,r));const s=null!=i,o=s?new Cc(i,!0,!1):null;return function foe(n){return nw(n.viewCache_)}(Kj(r,e,iw(n.pendingWriteTree_,e._path),s?o.getNode():st.EMPTY_NODE,s))}(n.serverSyncTree_,e);return null!=i?Promise.resolve(i):n.server_.get(e).then(r=>{const s=Kn(r).withIndex(e._queryParams.getIndex());let o;if(KA(n.serverSyncTree_,e,t,!0),e._queryParams.loadsAllData())o=M_(n.serverSyncTree_,e._path,s);else{const a=k_(n.serverSyncTree_,e);o=Xj(n.serverSyncTree_,e._path,s,a)}return Rs(n.eventQueue_,e._path,o),uw(n.serverSyncTree_,e,t,null,!0),s},r=>(ap(n,"get for query "+(0,E.Wl)(e)+" failed: "+r),Promise.reject(new Error(r))))}(n._repo,n,t).then(i=>new dd(i,new so(n._repo,n._path),n._queryParams.getIndex()))}class H_{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const i=t._queryParams.getIndex();return new w$("value",this,new dd(e.snapshotNode,new so(t._repo,t._path),i))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new T$(this,e,t):null}matches(e){return e instanceof H_&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class ww{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new T$(this,e,t):null}createEvent(e,t){(0,E.hu)(null!=e.childName,"Child events should have a childName.");const i=hd(new so(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new w$(e.type,this,new dd(e.snapshotNode,i,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof ww&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function G_(n,e,t,i,r){let s;if("object"==typeof i&&(s=void 0,r=i),"function"==typeof i&&(s=i),r&&r.onlyOnce){const l=t,u=(h,g)=>{cR(n._repo,n,a),l(h,g)};u.userCallback=t.userCallback,u.context=t.context,t=u}const o=new pR(t,s||void 0),a="value"===e?new H_(o):new ww(e,o);return function rae(n,e,t){let i;i=".info"===pt(e._path)?KA(n.infoSyncTree_,e,t):KA(n.serverSyncTree_,e,t),u$(n.eventQueue_,e._path,i)}(n._repo,n,a),()=>cR(n._repo,n,a)}function mR(n,e,t,i){return G_(n,"value",e,t,i)}function S$(n,e,t,i){return G_(n,"child_added",e,t,i)}function A$(n,e,t,i){return G_(n,"child_changed",e,t,i)}function R$(n,e,t,i){return G_(n,"child_moved",e,t,i)}function N$(n,e,t,i){return G_(n,"child_removed",e,t,i)}function x$(n,e,t){let i=null;const r=t?new pR(t):null;"value"===e?i=new H_(r):e&&(i=new ww(e,r)),cR(n._repo,n,i)}class Vo{}class P$ extends Vo{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ba("endAt",this._value,e._path,!0);const t=xA(e._queryParams,this._value,this._key);if(Ew(t),xc(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ds(e._repo,e._path,t,e._orderByCalled)}}class bae extends Vo{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ba("endBefore",this._value,e._path,!1);const t=function Rse(n,e,t){let i;return i=xA(n,e,n.index_===ya||t?t:wc),i.endBeforeSet_=!0,i}(e._queryParams,this._value,this._key);if(Ew(t),xc(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ds(e._repo,e._path,t,e._orderByCalled)}}class O$ extends Vo{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ba("startAt",this._value,e._path,!0);const t=NA(e._queryParams,this._value,this._key);if(Ew(t),xc(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new ds(e._repo,e._path,t,e._orderByCalled)}}class Tae extends Vo{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ba("startAfter",this._value,e._path,!1);const t=function Ase(n,e,t){let i;return i=NA(n,e,n.index_===ya||t?t:El),i.startAfterSet_=!0,i}(e._queryParams,this._value,this._key);if(Ew(t),xc(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new ds(e._repo,e._path,t,e._orderByCalled)}}class Cae extends Vo{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new ds(e._repo,e._path,function Dse(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class Sae extends Vo{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new ds(e._repo,e._path,function Sse(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class Rae extends Vo{constructor(e){super(),this._path=e}_apply(e){bw(e,"orderByChild");const t=new Yt(this._path);if(gt(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const i=new SA(t),r=QE(e._queryParams,i);return xc(r),new ds(e._repo,e._path,r,!0)}}class xae extends Vo{_apply(e){bw(e,"orderByKey");const t=QE(e._queryParams,ya);return xc(t),new ds(e._repo,e._path,t,!0)}}class Oae extends Vo{_apply(e){bw(e,"orderByPriority");const t=QE(e._queryParams,vn);return xc(t),new ds(e._repo,e._path,t,!0)}}class kae extends Vo{_apply(e){bw(e,"orderByValue");const t=QE(e._queryParams,AA);return xc(t),new ds(e._repo,e._path,t,!0)}}class Lae extends Vo{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(ba("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new P$(this._value,this._key)._apply(new O$(this._value,this._key)._apply(e))}}function Bo(n,...e){let t=(0,E.m9)(n);for(const i of e)t=i._apply(t);return t}(function _oe(n){(0,E.hu)(!aw,"__referenceConstructor has already been defined"),aw=n})(so),function woe(n){(0,E.hu)(!cw,"__referenceConstructor has already been defined"),cw=n}(so);const _R={};function yR(n,e,t,i,r){let s=i||n.options.databaseURL;void 0===s&&(n.options.projectId||_a("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Vi("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let l,u,o=fR(s,r),a=o.repoInfo;typeof process<"u"&&process.env&&(u=process.env.FIREBASE_DATABASE_EMULATOR_HOST),u?(l=!0,s=`http://${u}?ns=${a.namespace}`,o=fR(s,r),a=o.repoInfo):l=!o.repoInfo.secure;const h=r&&l?new w_(w_.OWNER):new Pre(n.name,n.options,e);c$("Invalid Firebase Database URL",o),gt(o.path)||_a("Database URL must point to the root of a Firebase Database (not including a child path).");const g=function $ae(n,e,t,i){let r=_R[e.name];r||(r={},_R[e.name]=r);let s=r[n.toURLString()];return s&&_a("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Zoe(n,false,t,i),r[n.toURLString()]=s,s}(a,n,h,new xre(n.name,t));return new Gae(g,n)}class Gae{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function Yoe(n,e,t){if(n.stats_=yA(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new JE(n.repoInfo_,(i,r,s,o)=>{p$(n,i,r,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>g$(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,E.Wl)(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new od(n.repoInfo_,e,(i,r,s,o)=>{p$(n,i,r,s,o)},i=>{g$(n,i)},i=>{!function Qoe(n,e){Bi(e,(t,i)=>{aR(n,t,i)})}(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=function kre(n,e){const t=n.toString();return _A[t]||(_A[t]=e()),_A[t]}(n.repoInfo_,()=>new kse(n.stats_,n.server_)),n.infoData_=new Nse,n.infoSyncTree_=new Jj({startListening:(i,r,s,o)=>{let a=[];const l=n.infoData_.getNode(i._path);return l.isEmpty()||(a=M_(n.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),aR(n,"connected",!1),n.serverSyncTree_=new Jj({startListening:(i,r,s,o)=>(n.server_.listen(i,s,r,(a,l)=>{const u=o(a,l);Rs(n.eventQueue_,i._path,u)}),[]),stopListening:(i,r)=>{n.server_.unlisten(i,r)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new so(this._repo,Vt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function jae(n,e){const t=_R[e];(!t||t[n.key]!==n)&&_a(`Database ${e}(${n.repoInfo_}) has already been deleted.`),_$(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&_a("Cannot call "+e+" on a deleted database.")}}function k$(){rj.IS_TRANSPORT_INITIALIZED&&yr("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function zae(){k$(),Tc.forceDisallow()}function Wae(){k$(),Xf.forceDisallow(),Tc.forceAllow()}function Zae(n,e){VU(n,e)}const Qae={".sv":"timestamp"};class ele{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}od.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},od.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function Yae(n){uA(ls.SDK_VERSION),(0,ls._registerComponent)(new ko.wA("database",(e,{instanceIdentifier:t})=>yR(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,ls.registerVersion)(PU,"1.0.2",n),(0,ls.registerVersion)(PU,"1.0.2","esm2017")}();const rle=new As.Yd("@firebase/database-compat"),L$=function(n){rle.warn("FIREBASE WARNING: "+n)};class ale{constructor(e){this._delegate=e}cancel(e){(0,E.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,E.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),i=>e(i)),t}remove(e){(0,E.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,E.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),i=>e(i)),t}set(e,t){(0,E.Dv)("OnDisconnect.set",1,2,arguments.length),(0,E.Wj)("OnDisconnect.set","onComplete",t,!0);const i=this._delegate.set(e);return t&&i.then(()=>t(null),r=>t(r)),i}setWithPriority(e,t,i){(0,E.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,E.Wj)("OnDisconnect.setWithPriority","onComplete",i,!0);const r=this._delegate.setWithPriority(e,t);return i&&r.then(()=>i(null),s=>i(s)),r}update(e,t){if((0,E.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const r={};for(let s=0;s<e.length;++s)r[""+s]=e[s];e=r,L$("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,E.Wj)("OnDisconnect.update","onComplete",t,!0);const i=this._delegate.update(e);return t&&i.then(()=>t(null),r=>t(r)),i}}class lle{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,E.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class Pc{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,E.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,E.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,E.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,E.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,E.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),j_("DataSnapshot.child","path",e,!1),new Pc(this._database,this._delegate.child(e))}hasChild(e){return(0,E.Dv)("DataSnapshot.hasChild",1,1,arguments.length),j_("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,E.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,E.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,E.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new Pc(this._database,t)))}hasChildren(){return(0,E.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,E.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,E.Dv)("DataSnapshot.ref",0,0,arguments.length),new Ns(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class ir{constructor(e,t){this.database=e,this._delegate=t}on(e,t,i,r){var s;(0,E.Dv)("Query.on",2,4,arguments.length),(0,E.Wj)("Query.on","callback",t,!1);const o=ir.getCancelAndContextArgs_("Query.on",i,r),a=(u,h)=>{t.call(o.context,new Pc(this.database,u),h)};a.userCallback=t,a.context=o.context;const l=null===(s=o.cancel)||void 0===s?void 0:s.bind(o.context);switch(e){case"value":return mR(this._delegate,a,l),t;case"child_added":return S$(this._delegate,a,l),t;case"child_removed":return N$(this._delegate,a,l),t;case"child_changed":return A$(this._delegate,a,l),t;case"child_moved":return R$(this._delegate,a,l),t;default:throw new Error((0,E.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,i){if((0,E.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,E.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,E.Wj)("Query.off","callback",t,!0),(0,E.lb)("Query.off","context",i,!0),t){const r=()=>{};r.userCallback=t,r.context=i,x$(this._delegate,e,r)}else x$(this._delegate,e)}get(){return yae(this._delegate).then(e=>new Pc(this.database,e))}once(e,t,i,r){(0,E.Dv)("Query.once",1,4,arguments.length),(0,E.Wj)("Query.once","callback",t,!0);const s=ir.getCancelAndContextArgs_("Query.once",i,r),o=new E.BH,a=(u,h)=>{const g=new Pc(this.database,u);t&&t.call(s.context,g,h),o.resolve(g)};a.userCallback=t,a.context=s.context;const l=u=>{s.cancel&&s.cancel.call(s.context,u),o.reject(u)};switch(e){case"value":mR(this._delegate,a,l,{onlyOnce:!0});break;case"child_added":S$(this._delegate,a,l,{onlyOnce:!0});break;case"child_removed":N$(this._delegate,a,l,{onlyOnce:!0});break;case"child_changed":A$(this._delegate,a,l,{onlyOnce:!0});break;case"child_moved":R$(this._delegate,a,l,{onlyOnce:!0});break;default:throw new Error((0,E.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return(0,E.Dv)("Query.limitToFirst",1,1,arguments.length),new ir(this.database,Bo(this._delegate,function Dae(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Cae(n)}(e)))}limitToLast(e){return(0,E.Dv)("Query.limitToLast",1,1,arguments.length),new ir(this.database,Bo(this._delegate,function Aae(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Sae(n)}(e)))}orderByChild(e){return(0,E.Dv)("Query.orderByChild",1,1,arguments.length),new ir(this.database,Bo(this._delegate,function Nae(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return j_("orderByChild","path",n,!1),new Rae(n)}(e)))}orderByKey(){return(0,E.Dv)("Query.orderByKey",0,0,arguments.length),new ir(this.database,Bo(this._delegate,function Pae(){return new xae}()))}orderByPriority(){return(0,E.Dv)("Query.orderByPriority",0,0,arguments.length),new ir(this.database,Bo(this._delegate,function Mae(){return new Oae}()))}orderByValue(){return(0,E.Dv)("Query.orderByValue",0,0,arguments.length),new ir(this.database,Bo(this._delegate,function Fae(){return new kae}()))}startAt(e=null,t){return(0,E.Dv)("Query.startAt",0,2,arguments.length),new ir(this.database,Bo(this._delegate,function wae(n=null,e){return U_("startAt","key",e,!0),new O$(n,e)}(e,t)))}startAfter(e=null,t){return(0,E.Dv)("Query.startAfter",0,2,arguments.length),new ir(this.database,Bo(this._delegate,function Iae(n,e){return U_("startAfter","key",e,!0),new Tae(n,e)}(e,t)))}endAt(e=null,t){return(0,E.Dv)("Query.endAt",0,2,arguments.length),new ir(this.database,Bo(this._delegate,function vae(n,e){return U_("endAt","key",e,!0),new P$(n,e)}(e,t)))}endBefore(e=null,t){return(0,E.Dv)("Query.endBefore",0,2,arguments.length),new ir(this.database,Bo(this._delegate,function Eae(n,e){return U_("endBefore","key",e,!0),new bae(n,e)}(e,t)))}equalTo(e,t){return(0,E.Dv)("Query.equalTo",1,2,arguments.length),new ir(this.database,Bo(this._delegate,function Vae(n,e){return U_("equalTo","key",e,!0),new Lae(n,e)}(e,t)))}toString(){return(0,E.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,E.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,E.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof ir))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,i){const r={cancel:void 0,context:void 0};if(t&&i)r.cancel=t,(0,E.Wj)(e,"cancel",r.cancel,!0),r.context=i,(0,E.lb)(e,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error((0,E.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}get ref(){return new Ns(this.database,new so(this._delegate._repo,this._delegate._path))}}class Ns extends ir{constructor(e,t){super(e,new ds(t._repo,t._path,new YE,!1)),this.database=e,this._delegate=t}getKey(){return(0,E.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,E.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new Ns(this.database,hd(this._delegate,e))}getParent(){(0,E.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Ns(this.database,e):null}getRoot(){return(0,E.Dv)("Reference.root",0,0,arguments.length),new Ns(this.database,this._delegate.root)}set(e,t){(0,E.Dv)("Reference.set",1,2,arguments.length),(0,E.Wj)("Reference.set","onComplete",t,!0);const i=gR(this._delegate,e);return t&&i.then(()=>t(null),r=>t(r)),i}update(e,t){if((0,E.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const r={};for(let s=0;s<e.length;++s)r[""+s]=e[s];e=r,L$("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ro("Reference.update",this._delegate._path),(0,E.Wj)("Reference.update","onComplete",t,!0);const i=_ae(this._delegate,e);return t&&i.then(()=>t(null),r=>t(r)),i}setWithPriority(e,t,i){(0,E.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,E.Wj)("Reference.setWithPriority","onComplete",i,!0);const r=function mae(n,e,t){if(ro("setWithPriority",n._path),ba("setWithPriority",e,n._path,!1),oR("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const i=new E.BH;return lR(n._repo,n._path,e,t,i.wrapCallback(()=>{})),i.promise}(this._delegate,e,t);return i&&r.then(()=>i(null),s=>i(s)),r}remove(e){(0,E.Dv)("Reference.remove",0,1,arguments.length),(0,E.Wj)("Reference.remove","onComplete",e,!0);const t=function pae(n){return ro("remove",n._path),gR(n,null)}(this._delegate);return e&&t.then(()=>e(null),i=>e(i)),t}transaction(e,t,i){(0,E.Dv)("Reference.transaction",1,3,arguments.length),(0,E.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,E.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,i){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,E.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,i);const r=function tle(n,e,t){var i;if(n=(0,E.m9)(n),ro("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const r=null===(i=t?.applyLocally)||void 0===i||i,s=new E.BH,a=mR(n,()=>{});return function oae(n,e,t,i,r,s){ap(n,"transaction on "+e);const o={path:e,update:t,onComplete:i,status:null,order:kU(),applyLocally:s,retryCount:0,unwatcher:r,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=uR(n,e,void 0);o.currentInputSnapshot=a;const l=o.update(a.val());if(void 0===l)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{B_("transaction failed: Data returned ",l,o.path),o.status=0;const u=fw(n.transactionQueueTree_,e),h=ud(u)||[];let g;h.push(o),iR(u,h),"object"==typeof l&&null!==l&&(0,E.r3)(l,".priority")?(g=(0,E.DV)(l,".priority"),(0,E.hu)(V_(g),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):g=(dw(n.serverSyncTree_,e)||st.EMPTY_NODE).getPriority().val();const m=$_(n),y=Kn(l,g),b=eR(y,a,m);o.currentOutputSnapshotRaw=y,o.currentOutputSnapshotResolved=b,o.currentWriteId=_w(n);const w=qA(n.serverSyncTree_,e,b,o.currentWriteId,o.applyLocally);Rs(n.eventQueue_,e,w),yw(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(l,u,h)=>{let g=null;l?s.reject(l):(g=new dd(h,new so(n._repo,n._path),vn),s.resolve(new ele(u,g)))},a,r),s.promise}(this._delegate,e,{applyLocally:i}).then(s=>new lle(s.committed,new Pc(this.database,s.snapshot)));return t&&r.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),r}setPriority(e,t){(0,E.Dv)("Reference.setPriority",1,2,arguments.length),(0,E.Wj)("Reference.setPriority","onComplete",t,!0);const i=function gae(n,e){n=(0,E.m9)(n),ro("setPriority",n._path),oR("setPriority",e,!1);const t=new E.BH;return lR(n._repo,Fn(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&i.then(()=>t(null),r=>t(r)),i}push(e,t){(0,E.Dv)("Reference.push",0,2,arguments.length),(0,E.Wj)("Reference.push","onComplete",t,!0);const i=function fae(n,e){n=(0,E.m9)(n),ro("push",n._path),ba("push",e,n._path,!0);const t=f$(n._repo),i=hae(t),r=hd(n,i),s=hd(n,i);let o;return o=null!=e?gR(s,e).then(()=>s):Promise.resolve(s),r.then=o.then.bind(o),r.catch=o.then.bind(o,void 0),r}(this._delegate,e),r=i.then(o=>new Ns(this.database,o));t&&r.then(()=>t(null),o=>t(o));const s=new Ns(this.database,i);return s.then=r.then.bind(r),s.catch=r.catch.bind(r,void 0),s}onDisconnect(){return ro("Reference.onDisconnect",this._delegate._path),new ale(new I$(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class z_{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:zae,forceLongPolling:Wae}}useEmulator(e,t,i={}){!function F$(n,e,t,i={}){(n=(0,E.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&_a("Cannot call useEmulator() after instance has already been initialized.");const r=n._repoInternal;let s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&_a('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new w_(w_.OWNER);else if(i.mockUserToken){const o="string"==typeof i.mockUserToken?i.mockUserToken:(0,E.Sg)(i.mockUserToken,n.app.options.projectId);s=new w_(o)}!function Uae(n,e,t,i){n.repoInfo_=new gA(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}(r,e,t,s)}(this._delegate,e,t,i)}ref(e){if((0,E.Dv)("database.ref",0,1,arguments.length),e instanceof Ns){const t=D$(this._delegate,e.toString());return new Ns(this,t)}{const t=C$(this._delegate,e);return new Ns(this,t)}}refFromURL(e){(0,E.Dv)("database.refFromURL",1,1,arguments.length);const i=D$(this._delegate,e);return new Ns(this,i)}goOffline(){return(0,E.Dv)("database.goOffline",0,0,arguments.length),function qae(n){(n=(0,E.m9)(n))._checkNotDeleted("goOffline"),_$(n._repo)}(this._delegate)}goOnline(){return(0,E.Dv)("database.goOnline",0,0,arguments.length),function Kae(n){(n=(0,E.m9)(n))._checkNotDeleted("goOnline"),function sae(n){n.persistentConnection_&&n.persistentConnection_.resume(h$)}(n._repo)}(this._delegate)}}z_.ServerValue={TIMESTAMP:function Jae(){return Qae}(),increment:n=>function Xae(n){return{".sv":{increment:n}}}(n)};var ule=Object.freeze({__proto__:null,initStandalone:function cle({app:n,url:e,version:t,customAuthImpl:i,customAppCheckImpl:r,namespace:s,nodeAdmin:o=!1}){uA(t);const a=new ko.H0("database-standalone"),l=new ko.zt("auth-internal",a);let u;return l.setComponent(new ko.wA("auth-internal",()=>i,"PRIVATE")),r&&(u=new ko.zt("app-check-internal",a),u.setComponent(new ko.wA("app-check-internal",()=>r,"PRIVATE"))),{instance:new z_(yR(n,l,u,e,o),n),namespace:s}}});const dle=z_.ServerValue;function W_(n,e,t="on",i=OE){return new $e(r=>{let s=null;return s=n[t](e,(o,a)=>{i.schedule(()=>{r.next({snapshot:o,prevKey:a})}),"once"===t&&i.schedule(()=>r.complete())},o=>{i.schedule(()=>r.error(o))}),"on"===t?{unsubscribe(){null!=s&&n.off(e,s)}}:{unsubscribe(){}}}).pipe(Ne(r=>{const{snapshot:s,prevKey:o}=r;let a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Bs())}function V$(n){return null==n}function B$(n){return"function"==typeof n.set}function U$(n,e){return B$(e)?e:n.ref(e)}function j$(n,e){if(function fle(n){return"string"==typeof n}(n))return e.stringCase();if(B$(n))return e.firebaseCase();if(function ple(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function $$(n){return(V$(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function H$(n,e,t){return cn(...(e=$$(e)).map(r=>W_(n,r,"on",t)))}function G$(n,e){return function(i,r){return j$(i,{stringCase:()=>n.child(i)[e](r),firebaseCase:()=>i[e](r),snapshotCase:()=>i.ref[e](r)})}}function yle(n){return function(t){return t?j$(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function z$(n,e){const t=n.length;for(let i=0;i<t;i++)if(n[i].payload.key===e)return i;return-1}function Ele(n,e){const{payload:t,prevKey:i,key:r}=e,s=z$(n,r),o=function ble(n,e){if(V$(e))return 0;{const t=z$(n,e);return-1===t?n.length:t+1}}(n,i);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(l=>{const u={payload:l,type:"value",prevKey:a,key:l.key};return a=l.key,n=[...n,u],!1})}return n;case"child_added":if(s>-1)(n[s-1]?.key||null)!==i&&(n=n.filter(l=>l.payload.key!==t.key)).splice(o,0,e);else{if(null==i)return[e,...n];(n=n.slice()).splice(o,0,e)}return n;case"child_removed":return n.filter(a=>a.payload.key!==t.key);case"child_changed":return n.map(a=>a.payload.key===r?e:a);case"child_moved":if(s>-1){const a=n.splice(s,1)[0];return(n=n.slice()).splice(o,0,a),n}return n;default:return n}}function W$(n,e,t){return function vle(n,e,t){return W_(n,"value","once",t).pipe(Ot(i=>{const r=[ye(i)];return e.forEach(s=>r.push(W_(n,s,"on",t))),cn(...r).pipe(Ff(Ele,[]))}),po())}(n,e=$$(e),t)}function q$(n,e){return function(){return W_(n,"value","on",e)}}!function hle(n){n.INTERNAL.registerComponent(new ko.wA("database-compat",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database").getImmediate({identifier:t});return new z_(r,i)},"PUBLIC").setServiceProps({Reference:Ns,Query:ir,Database:z_,DataSnapshot:Pc,enableLogging:Zae,INTERNAL:ule,ServerValue:dle}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","1.0.2")}(no.Z);const Ile=new me("angularfire2.realtimeDatabaseURL"),Cle=new me("angularfire2.database.use-emulator");let K$=(()=>{class n{schedulers;database;constructor(t,i,r,s,o,a,l,u,h,g,m,y,b,w,T){this.schedulers=a;const P=l,S=__(t,o,i);u&&aA(S,o,h,m,y,b,g,w),this.database=UE(`${S.name}.database.${r}`,"AngularFireDatabase",S.name,()=>{const M=o.runOutsideAngular(()=>S.database(r||void 0));return P&&M.useEmulator(...P),M},[P])}list(t,i){const r=this.schedulers.ngZone.runOutsideAngular(()=>U$(this.database,t));let s=r;return i&&(s=i(r)),function wle(n,e){const t=e.schedulers.outsideAngular,i=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:G$(i,"update"),set:G$(i,"set"),push:r=>i.push(r),remove:yle(i),snapshotChanges:r=>W$(n,r,t).pipe(ui),stateChanges:r=>H$(n,r,t).pipe(ui),auditTrail:r=>function gle(n,e,t){return function _le(n,e,t){return function mle(n,e){return W_(n,"value","on",e).pipe(Ne(t=>{let i;return t.payload.forEach(r=>(i=r.key,!1)),{data:t,lastKeyToLoad:i}}))}(n,t).pipe(jE(e),Ne(([r,s])=>{const o=r.lastKeyToLoad,a=s.map(l=>l.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),function mre(n){return e=>e.lift(new _re(n))}(r=>-1===r.loadedKeys.indexOf(r.lastKeyToLoad)),Ne(r=>r.actions))}(n,H$(n,e).pipe(Ff((r,s)=>[...r,s],[])),t)}(n,r,t).pipe(ui),valueChanges:(r,s)=>W$(n,r,t).pipe(Ne(a=>a.map(l=>s&&s.idField?{...l.payload.val(),[s.idField]:l.key}:l.payload.val())),ui)}}(s,this)}object(t){return function Tle(n,e){return{query:n,snapshotChanges:()=>q$(n,e.schedulers.outsideAngular)().pipe(ui),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>q$(n,e.schedulers.outsideAngular)().pipe(ui,Ne(i=>i.payload.exists()?i.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>U$(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(i){return new(i||n)(W(Zf),W(Yf,8),W(Ile,8),W(Co),W(rt),W(BE),W(Cle,8),W(lA,8),W(tA,8),W(nA,8),W(iA,8),W(rA,8),W(sA,8),W(oA,8),W(VE,8))};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Dle=(()=>{class n{constructor(){no.Z.registerVersion("angularfire",m_.full,"rtdb-compat")}static \u0275fac=function(i){return new(i||n)};static \u0275mod=yt({type:n});static \u0275inj=ht({providers:[K$]})}return n})(),vR=(()=>{class n{constructor(t){this.db=t,this.games=t.list("games").snapshotChanges().pipe(Ne(i=>i.map(r=>({...r.payload.val(),key:r.payload.key}))))}get games$(){return this.games.pipe(Ne(t=>t.map(i=>new bU(i))))}addGame(t){this.db.list("games").push(t)}updateGame(t){console.log("updateGame"),this.db.list("games").update(t.key,t)}static#e=this.\u0275fac=function(i){return new(i||n)(W(K$))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),bR=(()=>{class n{constructor(t){this.dbSvc=t,this.gameSubject=new un(null),this.game$=this.gameSubject.asObservable(),this.dbSvc.games$.subscribe(i=>{this.game=i.find(r=>r.code===this.game?.code)??null})}get games$(){return this.dbSvc.games$}get game(){return this.gameSubject.value}set game(t){this.gameSubject.next(t)}startGame(){console.log("startGame");const t=this.game;t&&(t.startTime=new Date,t.endTime=new Date(t.startTime.getTime()+6e4*t.minutesForGame),t.players[0].myTurn=!0,t.inProgress=!0,this.updateGame(t))}findGame(t){this.games$.pipe(nr(1)).subscribe(i=>{this.game=i.find(r=>r.code.toLowerCase()===t.toLowerCase())??null})}createGame(t){t&&(this.dbSvc.addGame(t),this.games$.pipe(nr(1)).subscribe(i=>{this.game=i.find(r=>r.code===t.code)??null}))}updateGame(t){t&&(this.dbSvc.updateGame(t),this.game=t)}getCurrentPlayer(){return(this.game?.players??[]).find(t=>t.myTurn)??this.game?.findPlayer("1")}nextPlayer(){const t=this.game;if(t){const i=t.players.findIndex(s=>!!s.myTurn);let r=t.players[i+1];r||(r=t.players[0]),t.players.forEach(s=>{s.myTurn=s.number===r.number}),this.updateGame(t)}}static#e=this.\u0275fac=function(i){return new(i||n)(W(vR))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Z$=(()=>{class n{constructor(t,i){this.gameStore=t,this.dbSvc=i,this.playerSubject=new un(null),this.player$=this.playerSubject.asObservable(),this.gameStore.game$.subscribe(r=>{if(r){const s=r.findPlayer(this.player?.number??"");JSON.stringify(s)!==JSON.stringify(this.player)&&(this.player=s??null)}})}get player(){return this.playerSubject.value}set player(t){this.playerSubject.next(t)}get isPlayer1(){return"1"===this.player?.number}updatePlayer(t){if(t){const i=this.gameStore.game;i&&(i.players.forEach(r=>{r.number===t.number&&Object.assign(r,t)}),this.dbSvc.updateGame(i)),this.player=t}}startGame(){this.player&&this.isPlayer1&&(this.player.myTurn=!0,this.updatePlayer(this.player))}createPlayer(){const t=this.gameStore.game;if(t){const i=t.addPlayer();return this.gameStore.updateGame(t),i}return null}static#e=this.\u0275fac=function(i){return new(i||n)(W(bR),W(vR))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Tw(n,e){return new $e(t=>{const i=n.length;if(0===i)return void t.complete();const r=new Array(i);let s=0,o=0;for(let a=0;a<i;a++){const l=N(n[a]);let u=!1;t.add(l.subscribe({next:h=>{u||(u=!0,o++),r[a]=h},error:h=>t.error(h),complete:()=>{s++,(s===i||!u)&&(o===i&&t.next(e?e.reduce((h,g,m)=>(h[g]=r[m],h),{}):r),t.complete())}}))}})}let Y$=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(i){return new(i||n)(O(Ts),O(zt))};static#t=this.\u0275dir=_e({type:n})}return n})(),fd=(()=>{class n extends Y${static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=Sn(n)))(r||n)}}();static#t=this.\u0275dir=_e({type:n,features:[Wt]})}return n})();const oo=new me("NgValueAccessor"),Rle={provide:oo,useExisting:ge(()=>Iw),multi:!0},xle=new me("CompositionEventMode");let Iw=(()=>{class n extends Y${constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Nle(){const n=gc()?gc().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(i){return new(i||n)(O(Ts),O(zt),O(xle,8))};static#t=this.\u0275dir=_e({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&Ve("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[on([Rle]),Wt]})}return n})();const rr=new me("NgValidators"),Mc=new me("NgAsyncValidators");function aH(n){return null!=n}function lH(n){return km(n)?N(n):n}function cH(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function uH(n,e){return e.map(t=>t(n))}function dH(n){return n.map(e=>function Ole(n){return!n.validate}(e)?e:t=>e.validate(t))}function ER(n){return null!=n?function hH(n){if(!n)return null;const e=n.filter(aH);return 0==e.length?null:function(t){return cH(uH(t,e))}}(dH(n)):null}function wR(n){return null!=n?function fH(n){if(!n)return null;const e=n.filter(aH);return 0==e.length?null:function(t){return function Sle(...n){if(1===n.length){const e=n[0];if(Bt(e))return Tw(e,null);if(On(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return Tw(t.map(i=>e[i]),t)}}if("function"==typeof n[n.length-1]){const e=n.pop();return Tw(n=1===n.length&&Bt(n[0])?n[0]:n,null).pipe(Ne(t=>e(...t)))}return Tw(n,null)}(uH(t,e).map(lH)).pipe(Ne(cH))}}(dH(n)):null}function pH(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function TR(n){return n?Array.isArray(n)?n:[n]:[]}function Dw(n,e){return Array.isArray(n)?n.includes(e):n===e}function _H(n,e){const t=TR(e);return TR(n).forEach(r=>{Dw(t,r)||t.push(r)}),t}function yH(n,e){return TR(e).filter(t=>!Dw(n,t))}class vH{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=ER(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=wR(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Lr extends vH{get formDirective(){return null}get path(){return null}}class kc extends vH{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class bH{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let EH=(()=>{class n extends bH{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||n)(O(kc,2))};static#t=this.\u0275dir=_e({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&Mt("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Wt]})}return n})();const q_="VALID",Aw="INVALID",cp="PENDING",K_="DISABLED";function Rw(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class CH{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===q_}get invalid(){return this.status===Aw}get pending(){return this.status==cp}get disabled(){return this.status===K_}get enabled(){return this.status!==K_}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(_H(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(_H(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(yH(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(yH(e,this._rawAsyncValidators))}hasValidator(e){return Dw(this._rawValidators,e)}hasAsyncValidator(e){return Dw(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=cp,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=K_,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=q_,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===q_||this.status===cp)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?K_:q_}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=cp,this._hasOwnPendingAsyncValidator=!0;const t=lH(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Fe,this.statusChanges=new Fe}_calculateStatus(){return this._allControlsDisabled()?K_:this.errors?Aw:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(cp)?cp:this._anyControlsHaveStatus(Aw)?Aw:q_}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Rw(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function Vle(n){return Array.isArray(n)?ER(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function Ble(n){return Array.isArray(n)?wR(n):n||null}(this._rawAsyncValidators)}}const up=new me("CallSetDisabledState",{providedIn:"root",factory:()=>Nw}),Nw="always";function Z_(n,e,t=Nw){(function RR(n,e){const t=function gH(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(pH(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function mH(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(pH(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();Ow(e._rawValidators,r),Ow(e._rawAsyncValidators,r)})(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function $le(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&DH(n,e)})}(n,e),function Gle(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function Hle(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&DH(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function jle(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function Ow(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function DH(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function RH(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function NH(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const xH=class extends CH{constructor(e=null,t,i){super(function DR(n){return(Rw(n)?n.validators:n)||null}(t),function SR(n,e){return(Rw(e)?e.asyncValidators:n)||null}(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Rw(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=NH(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){RH(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){RH(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){NH(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},Jle={provide:kc,useExisting:ge(()=>MR)},MH=(()=>Promise.resolve())();let MR=(()=>{class n extends kc{constructor(t,i,r,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new xH,this._registered=!1,this.name="",this.update=new Fe,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function PR(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===Iw?t=s:function qle(n){return Object.getPrototypeOf(n.constructor)===fd}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function xR(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Z_(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){MH.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&function Pf(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}(i);MH.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function xw(n,e){return[...e.path,n]}(t,this._parent):[t]}static#e=this.\u0275fac=function(i){return new(i||n)(O(Lr,9),O(rr,10),O(Mc,10),O(oo,10),O(Js,8),O(up,8))};static#t=this.\u0275dir=_e({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[on([Jle]),Wt,dn]})}return n})();const tce={provide:oo,useExisting:ge(()=>kR),multi:!0};let FH=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})(),nce=(()=>{class n{constructor(){this._accessors=[]}add(t,i){this._accessors.push([t,i])}remove(t){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===t)return void this._accessors.splice(i,1)}select(t){this._accessors.forEach(i=>{this._isSameGroup(i,t)&&i[1]!==t&&i[1].fireUncheck(t.value)})}_isSameGroup(t,i){return!!t[0].control&&t[0]._parent===i._control._parent&&t[1].name===i.name}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:FH})}return n})(),kR=(()=>{class n extends fd{constructor(t,i,r,s){super(t,i),this._registry=r,this._injector=s,this.setDisabledStateFired=!1,this.onChange=()=>{},this.callSetDisabledState=ve(up,{optional:!0})??Nw}ngOnInit(){this._control=this._injector.get(kc),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this.setProperty("checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}setDisabledState(t){(this.setDisabledStateFired||t||"whenDisabledForLegacyCode"===this.callSetDisabledState)&&this.setProperty("disabled",t),this.setDisabledStateFired=!0}fireUncheck(t){this.writeValue(t)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}static#e=this.\u0275fac=function(i){return new(i||n)(O(Ts),O(zt),O(nce),O(er))};static#t=this.\u0275dir=_e({type:n,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(i,r){1&i&&Ve("change",function(){return r.onChange()})("blur",function(){return r.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[on([tce]),Wt]})}return n})(),Tce=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({imports:[FH]})}return n})(),Cce=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:up,useValue:t.callSetDisabledState??Nw}]}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({imports:[Tce]})}return n})();function Dce(n,e){if(1&n&&(Ob(0),tr(1,"span",2),Mb()),2&n){const t=be();le(1),ce("innerHTML",t.i.text,QM)}}function Sce(n,e){1&n&&rD(0)}const Ace=function(n){return{$implicit:n}};var vr=function(n){return n[n.ing=0]="ing",n[n.pause=1]="pause",n[n.stop=2]="stop",n[n.done=3]="done",n}(vr||{});let XH=(()=>{class n{constructor(t){this.ngZone=t,this.fns=[],this.commands=[],this.nextTime=0,this.ing=!1}start(){!0!==this.ing&&(this.ing=!0,this.nextTime=+new Date,this.ngZone.runOutsideAngular(()=>{this.process()}))}process(){for(;this.commands.length;)this.commands.shift()();let t=+new Date-this.nextTime;const i=1+Math.floor(t/100);t=100-t%100,this.nextTime+=100*i;for(let r=0,s=this.fns.length;r<s;r+=2){let o=this.fns[r+1];if(0===o)this.fns[r](i);else{o+=2*i-1;const a=Math.floor(o/20);a>0&&this.fns[r](a),this.fns[r+1]=o%20+1}}this.ing&&setTimeout(()=>this.process(),t)}add(t,i){return this.commands.push(()=>{this.fns.push(t),this.fns.push(1e3===i?1:0),this.ing=!0}),this}remove(t){return this.commands.push(()=>{const i=this.fns.indexOf(t);-1!==i&&this.fns.splice(i,2),this.ing=this.fns.length>0}),this}static#e=this.\u0275fac=function(i){return new(i||n)(W(rt))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac})}return n})(),e3=(()=>{class n{constructor(t){this.locale=t,this.demand=!1,this.leftTime=0,this.format="HH:mm:ss",this.timezone="+0000",this.formatDate=({date:i,formatStr:r,timezone:s})=>nS(new Date(i),r,this.locale,s||this.timezone||"+0000")}static#e=this.\u0275fac=function(i){return new(i||n)(W(Ds))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),t3=(()=>{class n{set config(t){null!=t.notify&&!Array.isArray(t.notify)&&t.notify>0&&(t.notify=[t.notify]),this._config=t}get config(){return this._config}constructor(t,i,r,s,o){this.locale=t,this.timer=i,this.defCog=r,this.cdr=s,this.ngZone=o,this.frequency=1e3,this._notify={},this.status=vr.ing,this.isDestroy=!1,this.i={},this.left=0,this.event=new Fe}begin(){this.status=vr.ing,this.callEvent("start")}restart(){this.status!==vr.stop&&this.destroy(),this.init(),this.callEvent("restart")}stop(){this.status!==vr.stop&&(this.status=vr.stop,this.destroy(),this.callEvent("stop"))}pause(){this.status===vr.stop||this.status===vr.pause||(this.status=vr.pause,this.callEvent("pause"))}resume(){this.status===vr.stop||this.status!==vr.pause||(this.status=vr.ing,this.callEvent("resume"))}callEvent(t){this.event.emit({action:t,left:this.left,status:this.status,text:this.i.text})}init(){const{locale:t,defCog:i}=this,r=this.config={...new e3(t),...i,...this.config},s=this.frequency=~r.format.indexOf("S")?100:1e3;this.status=r.demand?vr.pause:vr.ing,this.getLeft();const o=this.reflow;this.reflow=(a=0,l=!1)=>o.apply(this,[a,l]),Array.isArray(r.notify)&&r.notify.forEach(a=>{if(a<1)throw new Error("The notify config must be a positive integer.");a*=1e3,this._notify[a-=a%s]=!0}),this.timer.add(this.reflow,s).start(),this.reflow(0,!0)}destroy(){return this.timer.remove(this.reflow),this}reflow(t=0,i=!1){if(this.isDestroy)return;const{status:r,config:s,_notify:o}=this;if(!i&&r!==vr.ing)return;let a=this.left=this.left-this.frequency*t;a<1&&(a=0),this.i={value:a,text:s.formatDate({date:a,formatStr:s.format,timezone:s.timezone})},"function"==typeof s.prettyText&&(this.i.text=s.prettyText(this.i.text)),this.cdr.detectChanges(),(0===s.notify||o[a])&&this.ngZone.run(()=>{this.callEvent("notify")}),0===a&&this.ngZone.run(()=>{this.status=vr.done,this.destroy(),this.callEvent("done")})}getLeft(){const{config:t,frequency:i}=this;let r=1e3*t.leftTime;const s=t.stopTime;!r&&s&&(r=s-(new Date).getTime()),this.left=r-r%i}ngOnInit(){this.init(),this.config.demand||this.begin()}ngOnDestroy(){this.isDestroy=!0,this.destroy()}ngOnChanges(t){t.config.firstChange||this.restart()}static#e=this.\u0275fac=function(i){return new(i||n)(O(Ds),O(XH),O(e3),O(Js),O(rt))};static#t=this.\u0275cmp=gr({type:n,selectors:[["countdown"]],hostVars:2,hostBindings:function(i,r){2&i&&Mt("count-down",!0)},inputs:{config:"config",render:"render"},outputs:{event:"event"},standalone:!0,features:[on([XH]),dn,Cs],decls:2,vars:5,consts:[[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"innerHTML"]],template:function(i,r){1&i&&(De(0,Dce,2,1,"ng-container",0),De(1,Sce,1,0,"ng-container",1)),2&i&&(ce("ngIf",!r.render),le(1),ce("ngTemplateOutlet",r.render)("ngTemplateOutletContext",Rf(3,Ace,r.i)))},dependencies:[gS,yl,Ju],encapsulation:2,changeDetection:0})}return n})(),Rce=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({imports:[t3]})}return n})();function br(n,e,t,i){return D(t)&&(i=t,t=void 0),i?br(n,e,t).pipe(Ne(r=>Bt(r)?i(...r):i(r))):new $e(r=>{n3(n,e,function s(o){r.next(arguments.length>1?Array.prototype.slice.call(arguments):o)},r,t)})}function n3(n,e,t,i,r){let s;if(function Pce(n){return n&&"function"==typeof n.addEventListener&&"function"==typeof n.removeEventListener}(n)){const o=n;n.addEventListener(e,t,r),s=()=>o.removeEventListener(e,t,r)}else if(function xce(n){return n&&"function"==typeof n.on&&"function"==typeof n.off}(n)){const o=n;n.on(e,t),s=()=>o.off(e,t)}else if(function Nce(n){return n&&"function"==typeof n.addListener&&"function"==typeof n.removeListener}(n)){const o=n;n.addListener(e,t),s=()=>o.removeListener(e,t)}else{if(!n||!n.length)throw new TypeError("Invalid event target");for(let o=0,a=n.length;o<a;o++)n3(n[o],e,t,i,r)}i.add(s)}function Mce(n){const{index:e,period:t,subscriber:i}=n;if(i.next(e),!i.closed){if(-1===t)return i.complete();n.index=e+1,this.schedule(n,t)}}class kce{call(e,t){return t.subscribe(new Fce(e))}}class Fce extends DS{constructor(e){super(e),this.hasFirst=!1,this.observables=[],this.subscriptions=[]}_next(e){this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{for(let i=0;i<t&&!this.hasFirst;i++){const s=SS(this,e[i],void 0,i);this.subscriptions&&this.subscriptions.push(s),this.add(s)}this.observables=null}}notifyNext(e,t,i){if(!this.hasFirst){this.hasFirst=!0;for(let r=0;r<this.subscriptions.length;r++)if(r!==i){let s=this.subscriptions[r];s.unsubscribe(),this.remove(s)}this.subscriptions=null}this.destination.next(t)}}function $R(...n){const e=n[n.length-1];return"function"==typeof e&&n.pop(),Ht(n,void 0).lift(new Lce(e))}class Lce{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new Vce(e,this.resultSelector))}}class Vce extends xe{constructor(e,t,i=Object.create(null)){super(e),this.resultSelector=t,this.iterators=[],this.active=0,this.resultSelector="function"==typeof t?t:void 0}_next(e){const t=this.iterators;Bt(e)?t.push(new Uce(e)):t.push("function"==typeof e[Wi]?new Bce(e[Wi]()):new jce(this.destination,this,e))}_complete(){const e=this.iterators,t=e.length;if(this.unsubscribe(),0!==t){this.active=t;for(let i=0;i<t;i++){let r=e[i];r.stillUnsubscribed?this.destination.add(r.subscribe()):this.active--}}else this.destination.complete()}notifyInactive(){this.active--,0===this.active&&this.destination.complete()}checkIterators(){const e=this.iterators,t=e.length,i=this.destination;for(let o=0;o<t;o++){let a=e[o];if("function"==typeof a.hasValue&&!a.hasValue())return}let r=!1;const s=[];for(let o=0;o<t;o++){let a=e[o],l=a.next();if(a.hasCompleted()&&(r=!0),l.done)return void i.complete();s.push(l.value)}this.resultSelector?this._tryresultSelector(s):i.next(s),r&&i.complete()}_tryresultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}class Bce{constructor(e){this.iterator=e,this.nextResult=e.next()}hasValue(){return!0}next(){const e=this.nextResult;return this.nextResult=this.iterator.next(),e}hasCompleted(){const e=this.nextResult;return!(!e||!e.done)}}class Uce{constructor(e){this.array=e,this.index=0,this.length=0,this.length=e.length}[Wi](){return this}next(e){const t=this.index++;return t<this.length?{value:this.array[t],done:!1}:{value:null,done:!0}}hasValue(){return this.array.length>this.index}hasCompleted(){return this.array.length===this.index}}class jce extends X{constructor(e,t,i){super(e),this.parent=t,this.observable=i,this.stillUnsubscribed=!0,this.buffer=[],this.isComplete=!1}[Wi](){return this}next(){const e=this.buffer;return 0===e.length&&this.isComplete?{value:null,done:!0}:{value:e.shift(),done:!1}}hasValue(){return this.buffer.length>0}hasCompleted(){return 0===this.buffer.length&&this.isComplete}notifyComplete(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()}notifyNext(e){this.buffer.push(e),this.parent.checkIterators()}subscribe(){return se(this.observable,new k(this))}}class Kce{constructor(e){this.total=e}call(e,t){return t.subscribe(new Zce(e,this.total))}}class Zce extends xe{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){++this.count>this.total&&this.destination.next(e)}}Math,Math,Math;const wde=["*"],x3=function(n){return{$implicit:n}},Jde=["dialog"],Xde=["ngbNavOutlet",""];function ehe(n,e){}function the(n,e){if(1&n&&(ue(0,"div",2),De(1,ehe,0,0,"ng-template",3),de()),2&n){const t=be().$implicit,i=be();ce("item",t)("nav",i.nav)("role",i.paneRole),le(1),ce("ngTemplateOutlet",(null==t.contentTpl?null:t.contentTpl.templateRef)||null)("ngTemplateOutletContext",Rf(5,x3,t.active||i.isPanelTransitioning(t)))}}function nhe(n,e){if(1&n&&De(0,the,2,7,"div",1),2&n){const t=e.$implicit,i=be();ce("ngIf",t.isPanelInDom()||i.isPanelTransitioning(t))}}function _d(n){return"string"==typeof n}function yd(n){return null!=n}function mp(n){return(n||document.body).getBoundingClientRect()}const k3={animation:!0,transitionTimerDelayMs:5},Ghe=()=>{},{transitionTimerDelayMs:zhe}=k3,ry=new Map,ps=(n,e,t,i)=>{let r=i.context||{};const s=ry.get(e);if(s)switch(i.runningTransition){case"continue":return _c;case"stop":n.run(()=>s.transition$.complete()),r=Object.assign(s.context,r),ry.delete(e)}const o=t(e,i.animation,r)||Ghe;if(!i.animation||"none"===window.getComputedStyle(e).transitionProperty)return n.run(()=>o()),ye(void 0).pipe(function $he(n){return e=>new $e(t=>e.subscribe({next:o=>n.run(()=>t.next(o)),error:o=>n.run(()=>t.error(o)),complete:()=>n.run(()=>t.complete())}))}(n));const a=new Qe,l=new Qe,u=a.pipe(function $ce(...n){return e=>fE(e,ye(...n))}(!0));ry.set(e,{transition$:a,complete:()=>{l.next(),l.complete()},context:r});const h=function Hhe(n){const{transitionDelay:e,transitionDuration:t}=window.getComputedStyle(n);return 1e3*(parseFloat(e)+parseFloat(t))}(e);return n.runOutsideAngular(()=>{const g=br(e,"transitionend").pipe(ti(u),_i(({target:y})=>y===e)),m=function Oce(n=0,e,t){let i=-1;return eA(e)?i=Number(e)<1?1:Number(e):hr(e)&&(t=e),hr(t)||(t=JS),new $e(r=>{const s=eA(n)?n:+n-t.now();return t.schedule(Mce,s,{index:0,period:i,subscriber:r})})}(h+zhe).pipe(ti(u));(function r3(...n){if(1===n.length){if(!Bt(n[0]))return n[0];n=n[0]}return Ht(n,void 0).lift(new kce)})(m,g,l).pipe(ti(u)).subscribe(()=>{ry.delete(e),n.run(()=>{o(),a.next(),a.complete()})})}),a.asObservable()};let $w=(()=>{class n{constructor(){this.animation=k3.animation}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),G3=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})(),z3=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})(),K3=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})(),Z3=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})();var pn=function(n){return n[n.Tab=9]="Tab",n[n.Enter=13]="Enter",n[n.Escape=27]="Escape",n[n.Space=32]="Space",n[n.PageUp=33]="PageUp",n[n.PageDown=34]="PageDown",n[n.End=35]="End",n[n.Home=36]="Home",n[n.ArrowLeft=37]="ArrowLeft",n[n.ArrowUp=38]="ArrowUp",n[n.ArrowRight=39]="ArrowRight",n[n.ArrowDown=40]="ArrowDown",n}(pn||{});typeof navigator<"u"&&navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));const n4=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function i4(n){const e=Array.from(n.querySelectorAll(n4)).filter(t=>-1!==t.tabIndex);return[e[0],e[e.length-1]]}new Date(1882,10,12),new Date(2174,10,25);let m4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})(),v4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})();class Td{constructor(e,t,i){this.nodes=e,this.viewRef=t,this.componentRef=i}}let Gfe=(()=>{class n{constructor(t,i){this._el=t,this._zone=i}ngOnInit(){this._zone.onStable.asObservable().pipe(nr(1)).subscribe(()=>{ps(this._zone,this._el.nativeElement,(t,i)=>{i&&mp(t),t.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return ps(this._zone,this._el.nativeElement,({classList:t})=>t.remove("show"),{animation:this.animation,runningTransition:"stop"})}static#e=this.\u0275fac=function(i){return new(i||n)(O(zt),O(rt))};static#t=this.\u0275cmp=gr({type:n,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1055"],hostVars:6,hostBindings:function(i,r){2&i&&(qu("modal-backdrop"+(r.backdropClass?" "+r.backdropClass:"")),Mt("show",!r.animation)("fade",r.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},standalone:!0,features:[Cs],decls:0,vars:0,template:function(i,r){},encapsulation:2})}return n})();class b4{update(e){}close(e){}dismiss(e){}}const zfe=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","fullscreen","keyboard","scrollable","size","windowClass","modalDialogClass"],Wfe=["animation","backdropClass"];class qfe{_applyWindowOptions(e,t){zfe.forEach(i=>{yd(t[i])&&(e[i]=t[i])})}_applyBackdropOptions(e,t){Wfe.forEach(i=>{yd(t[i])&&(e[i]=t[i])})}update(e){this._applyWindowOptions(this._windowCmptRef.instance,e),this._backdropCmptRef&&this._backdropCmptRef.instance&&this._applyBackdropOptions(this._backdropCmptRef.instance,e)}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(ti(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(ti(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}constructor(e,t,i,r){this._windowCmptRef=e,this._contentRef=t,this._backdropCmptRef=i,this._beforeDismiss=r,this._closed=new Qe,this._dismissed=new Qe,this._hidden=new Qe,e.instance.dismissEvent.subscribe(s=>{this.dismiss(s)}),this.result=new Promise((s,o)=>{this._resolve=s,this._reject=o}),this.result.then(null,()=>{})}close(e){this._windowCmptRef&&(this._closed.next(e),this._resolve(e),this._removeModalElements())}_dismiss(e){this._dismissed.next(e),this._reject(e),this._removeModalElements()}dismiss(e){if(this._windowCmptRef)if(this._beforeDismiss){const t=this._beforeDismiss();!function P3(n){return n&&n.then}(t)?!1!==t&&this._dismiss(e):t.then(i=>{!1!==i&&this._dismiss(e)},()=>{})}else this._dismiss(e)}_removeModalElements(){const e=this._windowCmptRef.instance.hide(),t=this._backdropCmptRef?this._backdropCmptRef.instance.hide():ye(void 0);e.subscribe(()=>{const{nativeElement:i}=this._windowCmptRef.location;i.parentNode.removeChild(i),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),t.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:i}=this._backdropCmptRef.location;i.parentNode.removeChild(i),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),$R(e,t).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var _N=function(n){return n[n.BACKDROP_CLICK=0]="BACKDROP_CLICK",n[n.ESC=1]="ESC",n}(_N||{});let Kfe=(()=>{class n{constructor(t,i,r){this._document=t,this._elRef=i,this._zone=r,this._closed$=new Qe,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new Fe,this.shown=new Qe,this.hidden=new Qe}get fullscreenClass(){return!0===this.fullscreen?" modal-fullscreen":_d(this.fullscreen)?` modal-fullscreen-${this.fullscreen}-down`:""}dismiss(t){this.dismissEvent.emit(t)}ngOnInit(){this._elWithFocus=this._document.activeElement,this._zone.onStable.asObservable().pipe(nr(1)).subscribe(()=>{this._show()})}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:t}=this._elRef,i={animation:this.animation,runningTransition:"stop"},o=$R(ps(this._zone,t,()=>t.classList.remove("show"),i),ps(this._zone,this._dialogEl.nativeElement,()=>{},i));return o.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),o}_show(){const t={animation:this.animation,runningTransition:"continue"};$R(ps(this._zone,this._elRef.nativeElement,(s,o)=>{o&&mp(s),s.classList.add("show")},t),ps(this._zone,this._dialogEl.nativeElement,()=>{},t)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:t}=this._elRef;this._zone.runOutsideAngular(()=>{br(t,"keydown").pipe(ti(this._closed$),_i(r=>r.which===pn.Escape)).subscribe(r=>{this.keyboard?requestAnimationFrame(()=>{r.defaultPrevented||this._zone.run(()=>this.dismiss(_N.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let i=!1;br(this._dialogEl.nativeElement,"mousedown").pipe(ti(this._closed$),Si(()=>i=!1),Ot(()=>br(t,"mouseup").pipe(ti(this._closed$),nr(1))),_i(({target:r})=>t===r)).subscribe(()=>{i=!0}),br(t,"click").pipe(ti(this._closed$)).subscribe(({target:r})=>{t===r&&("static"===this.backdrop?this._bumpBackdrop():!0===this.backdrop&&!i&&this._zone.run(()=>this.dismiss(_N.BACKDROP_CLICK))),i=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:t}=this._elRef;if(!t.contains(document.activeElement)){const i=t.querySelector("[ngbAutofocus]"),r=i4(t)[0];(i||r||t).focus()}}_restoreFocus(){const t=this._document.body,i=this._elWithFocus;let r;r=i&&i.focus&&t.contains(i)?i:t,this._zone.runOutsideAngular(()=>{setTimeout(()=>r.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&ps(this._zone,this._elRef.nativeElement,({classList:t})=>(t.add("modal-static"),()=>t.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}static#e=this.\u0275fac=function(i){return new(i||n)(O(Di),O(zt),O(rt))};static#t=this.\u0275cmp=gr({type:n,selectors:[["ngb-modal-window"]],viewQuery:function(i,r){if(1&i&&hc(Jde,7),2&i){let s;Kt(s=Zt())&&(r._dialogEl=s.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(i,r){2&i&&(qt("aria-modal",!0)("aria-labelledby",r.ariaLabelledBy)("aria-describedby",r.ariaDescribedBy),qu("modal d-block"+(r.windowClass?" "+r.windowClass:"")),Mt("fade",r.animation))},inputs:{animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",backdrop:"backdrop",centered:"centered",fullscreen:"fullscreen",keyboard:"keyboard",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},standalone:!0,features:[Cs],ngContentSelectors:wde,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(i,r){1&i&&(function FF(n){const e=ee()[Dn][pi];if(!e.projection){const i=e.projection=Bu(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?oK(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}(),ue(0,"div",0,1)(2,"div",2),function LF(n,e=0,t){const i=ee(),r=wt(),s=mf(r,dt+n,16,null,t||null);null===s.projection&&(s.projection=e),Su(),(!i[Gs]||Xl())&&32!=(32&s.flags)&&function c9(n,e,t){VM(e[qe],0,e,t,s1(n,t,e),PM(t.parent||e[pi],t,e))}(r,i,s)}(3),de()()),2&i&&qu("modal-dialog"+(r.size?" modal-"+r.size:"")+(r.centered?" modal-dialog-centered":"")+r.fullscreenClass+(r.scrollable?" modal-dialog-scrollable":"")+(r.modalDialogClass?" "+r.modalDialogClass:""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}\n"],encapsulation:2})}return n})(),Zfe=(()=>{class n{constructor(t){this._document=t}hide(){const t=Math.abs(window.innerWidth-this._document.documentElement.clientWidth),i=this._document.body,r=i.style,{overflow:s,paddingRight:o}=r;if(t>0){const a=parseFloat(window.getComputedStyle(i).paddingRight);r.paddingRight=`${a+t}px`}return r.overflow="hidden",()=>{t>0&&(r.paddingRight=o),r.overflow=s}}static#e=this.\u0275fac=function(i){return new(i||n)(W(Di))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Yfe=(()=>{class n{constructor(t,i,r,s,o,a,l){this._applicationRef=t,this._injector=i,this._environmentInjector=r,this._document=s,this._scrollBar=o,this._rendererFactory=a,this._ngZone=l,this._activeWindowCmptHasChanged=new Qe,this._ariaHiddenValues=new Map,this._scrollBarRestoreFn=null,this._modalRefs=[],this._windowCmpts=[],this._activeInstances=new Fe,this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const u=this._windowCmpts[this._windowCmpts.length-1];((n,e,t,i=!1)=>{n.runOutsideAngular(()=>{const r=br(e,"focusin").pipe(ti(t),Ne(s=>s.target));br(e,"keydown").pipe(ti(t),_i(s=>s.which===pn.Tab),jE(r)).subscribe(([s,o])=>{const[a,l]=i4(e);(o===a||o===e)&&s.shiftKey&&(l.focus(),s.preventDefault()),o===l&&!s.shiftKey&&(a.focus(),s.preventDefault())}),i&&br(e,"click").pipe(ti(t),jE(r),Ne(s=>s[1])).subscribe(s=>s.focus())})})(this._ngZone,u.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(u.location.nativeElement)}})}_restoreScrollBar(){const t=this._scrollBarRestoreFn;t&&(this._scrollBarRestoreFn=null,t())}_hideScrollBar(){this._scrollBarRestoreFn||(this._scrollBarRestoreFn=this._scrollBar.hide())}open(t,i,r){const s=r.container instanceof HTMLElement?r.container:yd(r.container)?this._document.querySelector(r.container):this._document.body,o=this._rendererFactory.createRenderer(null,null);if(!s)throw new Error(`The specified modal container "${r.container||"body"}" was not found in the DOM.`);this._hideScrollBar();const a=new b4,l=(t=r.injector||t).get(ss,null)||this._environmentInjector,u=this._getContentRef(t,l,i,a,r);let h=!1!==r.backdrop?this._attachBackdrop(s):void 0,g=this._attachWindowComponent(s,u.nodes),m=new qfe(g,u,h,r.beforeDismiss);return this._registerModalRef(m),this._registerWindowCmpt(g),m.hidden.pipe(nr(1)).subscribe(()=>Promise.resolve(!0).then(()=>{this._modalRefs.length||(o.removeClass(this._document.body,"modal-open"),this._restoreScrollBar(),this._revertAriaHidden())})),a.close=y=>{m.close(y)},a.dismiss=y=>{m.dismiss(y)},a.update=y=>{m.update(y)},m.update(r),1===this._modalRefs.length&&o.addClass(this._document.body,"modal-open"),h&&h.instance&&h.changeDetectorRef.detectChanges(),g.changeDetectorRef.detectChanges(),m}get activeInstances(){return this._activeInstances}dismissAll(t){this._modalRefs.forEach(i=>i.dismiss(t))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(t){let i=KD(Gfe,{environmentInjector:this._applicationRef.injector,elementInjector:this._injector});return this._applicationRef.attachView(i.hostView),t.appendChild(i.location.nativeElement),i}_attachWindowComponent(t,i){let r=KD(Kfe,{environmentInjector:this._applicationRef.injector,elementInjector:this._injector,projectableNodes:i});return this._applicationRef.attachView(r.hostView),t.appendChild(r.location.nativeElement),r}_getContentRef(t,i,r,s,o){return r?r instanceof Wn?this._createFromTemplateRef(r,s):_d(r)?this._createFromString(r):this._createFromComponent(t,i,r,s,o):new Td([])}_createFromTemplateRef(t,i){const s=t.createEmbeddedView({$implicit:i,close(o){i.close(o)},dismiss(o){i.dismiss(o)}});return this._applicationRef.attachView(s),new Td([s.rootNodes],s)}_createFromString(t){const i=this._document.createTextNode(`${t}`);return new Td([[i]])}_createFromComponent(t,i,r,s,o){const l=KD(r,{environmentInjector:i,elementInjector:er.create({providers:[{provide:b4,useValue:s}],parent:t})}),u=l.location.nativeElement;return o.scrollable&&u.classList.add("component-host-scrollable"),this._applicationRef.attachView(l.hostView),new Td([[u]],l.hostView,l)}_setAriaHidden(t){const i=t.parentElement;i&&t!==this._document.body&&(Array.from(i.children).forEach(r=>{r!==t&&"SCRIPT"!==r.nodeName&&(this._ariaHiddenValues.set(r,r.getAttribute("aria-hidden")),r.setAttribute("aria-hidden","true"))}),this._setAriaHidden(i))}_revertAriaHidden(){this._ariaHiddenValues.forEach((t,i)=>{t?i.setAttribute("aria-hidden",t):i.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(t){const i=()=>{const r=this._modalRefs.indexOf(t);r>-1&&(this._modalRefs.splice(r,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(t),this._activeInstances.emit(this._modalRefs),t.result.then(i,i)}_registerWindowCmpt(t){this._windowCmpts.push(t),this._activeWindowCmptHasChanged.next(),t.onDestroy(()=>{const i=this._windowCmpts.indexOf(t);i>-1&&(this._windowCmpts.splice(i,1),this._activeWindowCmptHasChanged.next())})}static#e=this.\u0275fac=function(i){return new(i||n)(W(pc),W(er),W(ss),W(Di),W(Zfe),W(O1),W(rt))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Qfe=(()=>{class n{constructor(t){this._ngbConfig=t,this.backdrop=!0,this.fullscreen=!1,this.keyboard=!0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(t){this._animation=t}static#e=this.\u0275fac=function(i){return new(i||n)(W($w))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Jfe=(()=>{class n{constructor(t,i,r){this._injector=t,this._modalStack=i,this._config=r}open(t,i={}){const r={...this._config,animation:this._config.animation,...i};return this._modalStack.open(this._injector,t,r)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(t){this._modalStack.dismissAll(t)}hasOpenModals(){return this._modalStack.hasOpenModals()}static#e=this.\u0275fac=function(i){return new(i||n)(W(er),W(Yfe),W(Qfe))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),E4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({providers:[Jfe]})}return n})(),Xfe=(()=>{class n{constructor(t){this._ngbConfig=t,this.destroyOnHide=!0,this.orientation="horizontal",this.roles="tablist",this.keyboard=!1}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(t){this._animation=t}static#e=this.\u0275fac=function(i){return new(i||n)(W($w))};static#t=this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const w4=n=>yd(n)&&""!==n;let epe=0,yN=(()=>{class n{constructor(t){this.templateRef=t}static#e=this.\u0275fac=function(i){return new(i||n)(O(Wn))};static#t=this.\u0275dir=_e({type:n,selectors:[["ng-template","ngbNavContent",""]],standalone:!0})}return n})(),T4=(()=>{class n{constructor(t,i){this.role=t,this.nav=i}static#e=this.\u0275fac=function(i){return new(i||n)(To("role"),O(ge(()=>Id)))};static#t=this.\u0275dir=_e({type:n,selectors:[["","ngbNavItem","",5,"ng-container"]],hostVars:1,hostBindings:function(i,r){2&i&&qt("role",r.role?r.role:r.nav.roles?"presentation":void 0)},standalone:!0})}return n})(),vp=(()=>{class n{constructor(t,i){this._nav=t,this.elementRef=i,this.disabled=!1,this.shown=new Fe,this.hidden=new Fe}ngAfterContentChecked(){this.contentTpl=this.contentTpls.first}ngOnInit(){yd(this.domId)||(this.domId="ngb-nav-"+epe++)}get active(){return this._nav.activeId===this.id}get id(){return w4(this._id)?this._id:this.domId}get panelDomId(){return`${this.domId}-panel`}isPanelInDom(){return(yd(this.destroyOnHide)?!this.destroyOnHide:!this._nav.destroyOnHide)||this.active}static#e=this.\u0275fac=function(i){return new(i||n)(O(ge(()=>Id)),O(zt))};static#t=this.\u0275dir=_e({type:n,selectors:[["","ngbNavItem",""]],contentQueries:function(i,r,s){if(1&i&&qn(s,yN,4),2&i){let o;Kt(o=Zt())&&(r.contentTpls=o)}},hostVars:2,hostBindings:function(i,r){2&i&&Mt("nav-item",!0)},inputs:{destroyOnHide:"destroyOnHide",disabled:"disabled",domId:"domId",_id:["ngbNavItem","_id"]},outputs:{shown:"shown",hidden:"hidden"},exportAs:["ngbNavItem"],standalone:!0})}return n})(),Id=(()=>{class n{constructor(t,i,r,s){this.role=t,this._cd=r,this._document=s,this.activeIdChange=new Fe,this.shown=new Fe,this.hidden=new Fe,this.destroy$=new Qe,this.navItemChange$=new Qe,this.navChange=new Fe,this.animation=i.animation,this.destroyOnHide=i.destroyOnHide,this.orientation=i.orientation,this.roles=i.roles,this.keyboard=i.keyboard}click(t){t.disabled||this._updateActiveId(t.id)}onKeyDown(t){if("tablist"!==this.roles||!this.keyboard)return;const i=t.which,r=this.links.filter(a=>!a.navItem.disabled),{length:s}=r;let o=-1;if(r.forEach((a,l)=>{a.elRef.nativeElement===this._document.activeElement&&(o=l)}),s){switch(i){case pn.ArrowLeft:if("vertical"===this.orientation)return;o=(o-1+s)%s;break;case pn.ArrowRight:if("vertical"===this.orientation)return;o=(o+1)%s;break;case pn.ArrowDown:if("horizontal"===this.orientation)return;o=(o+1)%s;break;case pn.ArrowUp:if("horizontal"===this.orientation)return;o=(o-1+s)%s;break;case pn.Home:o=0;break;case pn.End:o=s-1}"changeWithArrows"===this.keyboard&&this.select(r[o].navItem.id),r[o].elRef.nativeElement.focus(),t.preventDefault()}}select(t){this._updateActiveId(t,!1)}ngAfterContentInit(){if(!yd(this.activeId)){const t=this.items.first?this.items.first.id:null;w4(t)&&(this._updateActiveId(t,!1),this._cd.detectChanges())}this.items.changes.pipe(ti(this.destroy$)).subscribe(()=>this._notifyItemChanged(this.activeId))}ngOnChanges({activeId:t}){t&&!t.firstChange&&this._notifyItemChanged(t.currentValue)}ngOnDestroy(){this.destroy$.next()}_updateActiveId(t,i=!0){if(this.activeId!==t){let r=!1;i&&this.navChange.emit({activeId:this.activeId,nextId:t,preventDefault:()=>{r=!0}}),r||(this.activeId=t,this.activeIdChange.emit(t),this._notifyItemChanged(t))}}_notifyItemChanged(t){this.navItemChange$.next(this._getItemById(t))}_getItemById(t){return this.items&&this.items.find(i=>i.id===t)||null}static#e=this.\u0275fac=function(i){return new(i||n)(To("role"),O(Xfe),O(Js),O(Di))};static#t=this.\u0275dir=_e({type:n,selectors:[["","ngbNav",""]],contentQueries:function(i,r,s){if(1&i&&(qn(s,vp,4),qn(s,eT,5)),2&i){let o;Kt(o=Zt())&&(r.items=o),Kt(o=Zt())&&(r.links=o)}},hostVars:6,hostBindings:function(i,r){1&i&&Ve("keydown.arrowLeft",function(o){return r.onKeyDown(o)})("keydown.arrowRight",function(o){return r.onKeyDown(o)})("keydown.arrowDown",function(o){return r.onKeyDown(o)})("keydown.arrowUp",function(o){return r.onKeyDown(o)})("keydown.Home",function(o){return r.onKeyDown(o)})("keydown.End",function(o){return r.onKeyDown(o)}),2&i&&(qt("aria-orientation","vertical"===r.orientation&&"tablist"===r.roles?"vertical":void 0)("role",r.role?r.role:r.roles?"tablist":void 0),Mt("nav",!0)("flex-column","vertical"===r.orientation))},inputs:{activeId:"activeId",animation:"animation",destroyOnHide:"destroyOnHide",orientation:"orientation",roles:"roles",keyboard:"keyboard"},outputs:{activeIdChange:"activeIdChange",shown:"shown",hidden:"hidden",navChange:"navChange"},exportAs:["ngbNav"],standalone:!0,features:[dn]})}return n})(),eT=(()=>{class n{constructor(t,i,r,s){this.role=t,this.navItem=i,this.nav=r,this.elRef=s}hasNavItemClass(){return this.navItem.elementRef.nativeElement.nodeType===Node.COMMENT_NODE}static#e=this.\u0275fac=function(i){return new(i||n)(To("role"),O(vp),O(Id),O(zt))};static#t=this.\u0275dir=_e({type:n,selectors:[["","ngbNavLink",""]],hostVars:14,hostBindings:function(i,r){2&i&&(Ys("id",r.navItem.domId),qt("role",r.role?r.role:r.nav.roles?"tab":void 0)("tabindex",r.navItem.disabled?-1:void 0)("aria-controls",r.navItem.isPanelInDom()?r.navItem.panelDomId:null)("aria-selected",r.navItem.active)("aria-disabled",r.navItem.disabled),Mt("nav-link",!0)("nav-item",r.hasNavItemClass())("active",r.navItem.active)("disabled",r.navItem.disabled))},standalone:!0})}return n})();const ipe=({classList:n})=>(n.remove("show"),()=>n.remove("active")),rpe=(n,e)=>{e&&mp(n),n.classList.add("show")};let vN=(()=>{class n{constructor(t){this.elRef=t}static#e=this.\u0275fac=function(i){return new(i||n)(O(zt))};static#t=this.\u0275dir=_e({type:n,selectors:[["","ngbNavPane",""]],hostAttrs:[1,"tab-pane"],hostVars:5,hostBindings:function(i,r){2&i&&(Ys("id",r.item.panelDomId),qt("role",r.role?r.role:r.nav.roles?"tabpanel":void 0)("aria-labelledby",r.item.domId),Mt("fade",r.nav.animation))},inputs:{item:"item",nav:"nav",role:"role"},standalone:!0})}return n})(),I4=(()=>{class n{constructor(t,i){this._cd=t,this._ngZone=i,this._activePane=null}isPanelTransitioning(t){return this._activePane?.item===t}ngAfterViewInit(){this._updateActivePane(),this.nav.navItemChange$.pipe(ti(this.nav.destroy$),Xm(this._activePane?.item||null),po(),function qce(n){return e=>e.lift(new Kce(n))}(1)).subscribe(t=>{const i={animation:this.nav.animation,runningTransition:"stop"};this._cd.detectChanges(),this._activePane?ps(this._ngZone,this._activePane.elRef.nativeElement,ipe,i).subscribe(()=>{const r=this._activePane?.item;this._activePane=this._getPaneForItem(t),this._cd.markForCheck(),this._activePane&&(this._activePane.elRef.nativeElement.classList.add("active"),ps(this._ngZone,this._activePane.elRef.nativeElement,rpe,i).subscribe(()=>{t&&(t.shown.emit(),this.nav.shown.emit(t.id))})),r&&(r.hidden.emit(),this.nav.hidden.emit(r.id))}):this._updateActivePane()})}_updateActivePane(){this._activePane=this._getActivePane(),this._activePane?.elRef.nativeElement.classList.add("show"),this._activePane?.elRef.nativeElement.classList.add("active")}_getPaneForItem(t){return this._panes&&this._panes.find(i=>i.item===t)||null}_getActivePane(){return this._panes&&this._panes.find(t=>t.item.active)||null}static#e=this.\u0275fac=function(i){return new(i||n)(O(Js),O(rt))};static#t=this.\u0275cmp=gr({type:n,selectors:[["","ngbNavOutlet",""]],viewQuery:function(i,r){if(1&i&&hc(vN,5),2&i){let s;Kt(s=Zt())&&(r._panes=s)}},hostVars:2,hostBindings:function(i,r){2&i&&Mt("tab-content",!0)},inputs:{paneRole:"paneRole",nav:["ngbNavOutlet","nav"]},standalone:!0,features:[Cs],attrs:Xde,decls:1,vars:1,consts:[["ngFor","",3,"ngForOf"],["ngbNavPane","",3,"item","nav","role",4,"ngIf"],["ngbNavPane","",3,"item","nav","role"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(i,r){1&i&&De(0,nhe,1,1,"ng-template",0),2&i&&ce("ngForOf",r.nav.items)},dependencies:[vN,_l,yl,Ju],encapsulation:2,changeDetection:0})}return n})(),C4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})(),O4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})(),M4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})(),k4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})(),F4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})(),L4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})(),V4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})(),B4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})(),U4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})();new me("live announcer delay",{providedIn:"root",factory:function hpe(){return 100}});let j4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})(),$4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({})}return n})();const ppe=[G3,z3,K3,Z3,m4,v4,E4,C4,$4,O4,M4,k4,F4,L4,V4,B4,U4,j4];let H4=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({imports:[ppe,G3,z3,K3,Z3,m4,v4,E4,C4,$4,O4,M4,k4,F4,L4,V4,B4,U4,j4]})}return n})();const gpe=["playerTurnCountdown"];function mpe(n,e){if(1&n){const t=Fi();ue(0,"div",7)(1,"button",8),Ve("click",function(){return Rt(t),Nt(be().newGame())}),It(2,"New Game"),de(),ue(3,"button",9),Ve("click",function(){return Rt(t),Nt(be().joinGame())}),It(4,"Join Game"),de()()}}function _pe(n,e){if(1&n){const t=Fi();ue(0,"div",10)(1,"h2"),It(2),de(),ue(3,"div")(4,"div",11)(5,"span",12),It(6,"# of Players:"),de(),ue(7,"input",13),Ve("ngModelChange",function(r){return Rt(t),Nt(be(2).game.playerCount=r)}),de()(),ue(8,"div",11)(9,"span",12),It(10,"Total Game Time (m):"),de(),ue(11,"input",13),Ve("ngModelChange",function(r){return Rt(t),Nt(be(2).game.minutesForGame=r)}),de()(),ue(12,"div",11)(13,"span",12),It(14,"Time per Turn (s):"),de(),ue(15,"input",13),Ve("ngModelChange",function(r){return Rt(t),Nt(be(2).game.secondsPerTurn=r)}),de()()(),ue(16,"div")(17,"button",14),Ve("click",function(){return Rt(t),Nt(be(2).back())}),It(18,"Back"),de(),ue(19,"button",15),Ve("click",function(){return Rt(t),Nt(be(2).next())}),It(20,"Next"),de()()()}if(2&n){const t=be(2);le(2),Ro("Code: ",t.game.code,""),le(5),ce("ngModel",t.game.playerCount),le(4),ce("ngModel",t.game.minutesForGame),le(4),ce("ngModel",t.game.secondsPerTurn)}}function ype(n,e){1&n&&(ue(0,"li",3),De(1,_pe,21,4,"ng-template",4),de()),2&n&&ce("ngbNavItem",be().views.newGame)}function vpe(n,e){1&n&&(ue(0,"div"),It(1," Game not found. "),de()),2&n&&Wu("color","red")}function bpe(n,e){if(1&n){const t=Fi();ue(0,"div",10)(1,"div")(2,"div",11)(3,"span",12),It(4,"Code:"),de(),ue(5,"input",16),Ve("ngModelChange",function(r){return Rt(t),Nt(be().gameCode=r)})("change",function(){return Rt(t),Nt(be().invalidGameCode=!1)}),de()(),De(6,vpe,2,2,"div",17),de(),ue(7,"div")(8,"button",14),Ve("click",function(){return Rt(t),Nt(be().back())}),It(9,"Back"),de(),ue(10,"button",15),Ve("click",function(){return Rt(t),Nt(be().next())}),It(11,"Next"),de()()()}if(2&n){const t=be();le(5),ce("ngModel",t.gameCode),le(1),ce("ngIf",t.invalidGameCode)}}function Epe(n,e){if(1&n){const t=Fi();ue(0,"div",21)(1,"input",22),Ve("ngModelChange",function(r){return Rt(t),Nt(be(3).player=r)}),de(),ue(2,"label",23),It(3),de()()}if(2&n){const t=e.$implicit,i=be(3);le(1),ce("ngModel",i.player)("value",t)("id",t.number),le(1),ce("for",t.number),le(1),Ro("Player ",t.number,"")}}function wpe(n,e){if(1&n){const t=Fi();ue(0,"div",10)(1,"h2"),It(2,"Who are you?"),de(),ue(3,"div")(4,"div",7),De(5,Epe,4,5,"div",18),de()(),ue(6,"div")(7,"button",19),Ve("click",function(){return Rt(t),Nt(be(2).back())}),It(8,"Back"),de(),ue(9,"button",20),Ve("click",function(){return Rt(t),Nt(be(2).next())}),It(10,"Next"),de()()()}if(2&n){const t=be(2);le(5),ce("ngForOf",t.game.players)}}function Tpe(n,e){1&n&&(ue(0,"li",3),De(1,wpe,11,1,"ng-template",4),de()),2&n&&ce("ngbNavItem",be().views.selectPlayer)}function Ipe(n,e){if(1&n){const t=Fi();ue(0,"div",10)(1,"h2"),It(2),de(),ue(3,"div")(4,"div",7)(5,"div",24)(6,"span",12),It(7,"Name:"),de(),ue(8,"input",13),Ve("ngModelChange",function(r){return Rt(t),Nt(be(2).player.name=r)}),de()(),ue(9,"div",11)(10,"span",12),It(11,"Color:"),de(),ue(12,"input",25),Ve("ngModelChange",function(r){return Rt(t),Nt(be(2).player.color=r)}),de()()()(),ue(13,"div")(14,"button",19),Ve("click",function(){return Rt(t),Nt(be(2).back())}),It(15,"Back"),de(),ue(16,"button",20),Ve("click",function(){return Rt(t),Nt(be(2).next())}),It(17,"Play"),de()()()}if(2&n){const t=be(2);le(2),Ro("Player ",t.player.number,""),le(6),ce("ngModel",t.player.name),le(4),ce("ngModel",t.player.color)}}function Cpe(n,e){1&n&&(ue(0,"li",3),De(1,Ipe,18,3,"ng-template",4),de()),2&n&&ce("ngbNavItem",be().views.newPlayer)}function Dpe(n,e){if(1&n&&tr(0,"span",27),2&n){const t=e.$implicit;Wu("color",t.myTurn?t.color:"grey"),Mt("fs-1",t.myTurn)}}function Spe(n,e){if(1&n&&(ue(0,"span"),It(1),de()),2&n){const t=be(3);le(1),Ro("",t.currentPlayerName,"'s Turn")}}function Ape(n,e){1&n&&(ue(0,"span"),It(1,"Your Turn"),de())}function Rpe(n,e){if(1&n&&(ue(0,"div")(1,"div",39)(2,"div"),De(3,Dpe,1,4,"span",40),de()(),ue(4,"div",39)(5,"div",29)(6,"div",41),De(7,Spe,2,1,"span",26),De(8,Ape,2,0,"span",26),de()()()()),2&n){const t=be(2);let i;le(3),ce("ngForOf",t.game.players),le(3),Wu("color",null!==(i=null==t.currentPlayer?null:t.currentPlayer.color)&&void 0!==i?i:"grey"),le(1),ce("ngIf",!t.isMyTurn),le(1),ce("ngIf",t.isMyTurn)}}function Npe(n,e){if(1&n){const t=Fi();ue(0,"div")(1,"button",42),Ve("click",function(){return Rt(t),Nt(be(2).startGame())}),It(2,"Start"),de()()}}function xpe(n,e){if(1&n){const t=Fi();ue(0,"div",10)(1,"h2"),De(2,Rpe,9,5,"div",26),ue(3,"div"),It(4),tr(5,"span",27),de()(),ue(6,"div"),De(7,Npe,3,0,"div",26),ue(8,"div",28)(9,"div",28)(10,"div",29)(11,"button",30)(12,"countdown",31,32),Ve("event",function(r){return Rt(t),Nt(be().countdownAction(r))}),de()()(),ue(14,"div",29)(15,"button",33),Ve("click",function(){return Rt(t),Nt(be().pauseTurn())}),tr(16,"span",34),de(),ue(17,"button",35),Ve("click",function(){return Rt(t),Nt(be().resumeTurn())}),tr(18,"span",36),de(),ue(19,"button",37),Ve("click",function(){return Rt(t),Nt(be().endTurn())}),tr(20,"span",38),de()()()()(),tr(21,"div"),de()}if(2&n){const t=be();le(2),ce("ngIf",t.game),le(1),Wu("color",null==t.player?null:t.player.color),le(1),Ro("Player ",null==t.player?null:t.player.number," "),le(1),Wu("color",null==t.player?null:t.player.color),le(2),ce("ngIf",t.showStartGameBtn),le(1),ce("hidden",t.showStartGameBtn),le(1),ce("hidden",!t.isMyTurn),le(2),ce("ngClass",t.countdownBtnClass),le(1),ce("config",t.playerTurnCountdownConfig)}}let Ppe=(()=>{class n{constructor(t,i){this.gameStore=t,this.playerStore=i,this.countdownBtnClass="btn-outline-success",this.gameCode="",this.invalidGameCode=!1,this.game=null,this.player=null,this.views={landing:"landing",newGame:"new-game",joinGame:"join-game",selectPlayer:"select-player",newPlayer:"new-player",playGame:"play-game"},this.view=this.views.landing,this.games$=this.gameStore.games$,this.playerTurnCountdownConfig={demand:!0,leftTime:60,format:"mm:ss",notify:5},this.playerStore.player$.subscribe(r=>{this.player&&(Object.assign(this.player,r),this.player.myTurn&&(this.playerTurnCountdown?.restart(),this.playerTurnCountdown?.begin()))}),this.gameStore.game$.subscribe(r=>{r&&this.game?.secondsPerTurn!==r.secondsPerTurn&&(this.playerTurnCountdownConfig.leftTime=r.secondsPerTurn),this.game=r,!this.game&&this.gameCode&&(this.view=this.views.joinGame,this.invalidGameCode=!0)})}get turnInProgress(){return this.player?.myTurn??!1}get isPlayer1(){return this.playerStore.isPlayer1}newGame(){this.game=new bU,this.view=this.views.newGame}joinGame(){this.view=this.views.joinGame}back(){switch(this.view){case this.views.newGame:this.game=null,this.view=this.views.landing;break;case this.views.selectPlayer:this.view=this.views.newGame;break;case this.views.newPlayer:this.player=null,this.view=this.views.selectPlayer}}next(){switch(this.view){case this.views.newGame:if(this.game){for(let t=0;t<this.game.playerCount;t++)this.game.addPlayer();this.game.players[0].myTurn=!0,this.playerTurnCountdownConfig.leftTime=this.game.secondsPerTurn}this.gameStore.createGame(this.game),this.view=this.views.selectPlayer;break;case this.views.joinGame:this.gameStore.findGame(this.gameCode),this.view=this.views.selectPlayer,this.invalidGameCode=!1;break;case this.views.selectPlayer:this.view=this.views.newPlayer;break;case this.views.newPlayer:this.playerStore.updatePlayer(this.player),this.view=this.views.playGame}}get showStartGameBtn(){return this.isPlayer1&&!this.game?.inProgress}startGame(){this.gameStore.startGame(),this.playerStore.startGame()}endTurn(){this.gameStore.nextPlayer(),this.playerTurnCountdown?.stop()}pauseTurn(){this.playerTurnCountdown?.pause()}resumeTurn(){this.playerTurnCountdown?.resume()}countdownAction(t){console.log(t),"notify"===t.action?this.countdownBtnClass="btn-outline-warning":"done"===t.action&&(this.countdownBtnClass="btn-outline-danger",this.endTurn(),this.countdownBtnClass="btn-outline-success")}get currentPlayer(){return this.gameStore.getCurrentPlayer()}get isMyTurn(){return this.currentPlayer?this.currentPlayer?.number===this.player?.number:this.isPlayer1}get currentPlayerName(){return this.currentPlayer?.name||"Player "+this.currentPlayer?.number}static#e=this.\u0275fac=function(i){return new(i||n)(O(bR),O(Z$))};static#t=this.\u0275cmp=gr({type:n,selectors:[["app-root"]],viewQuery:function(i,r){if(1&i&&hc(gpe,5),2&i){let s;Kt(s=Zt())&&(r.playerTurnCountdown=s.first)}},decls:13,vars:8,consts:[[1,"container-sm","vh-100"],["ngbNav","",1,"nav-tabs",3,"activeId","activeIdChange"],["nav","ngbNav"],[3,"ngbNavItem"],["ngbNavContent",""],[3,"ngbNavItem",4,"ngIf"],[1,"h-100",3,"ngbNavOutlet"],[1,"d-flex","flex-column","justify-content-center","h-100"],["type","button",1,"btn","btn-primary","btn-xl",3,"click"],["type","button",1,"btn","btn-secondary","btn-xl","mt-5",3,"click"],[1,"d-flex","flex-column","justify-content-evenly","h-100"],[1,"input-group","input-group-lg","mt-2"],["id","inputGroup-sizing-lg",1,"input-group-text"],["type","text","aria-label","Sizing example input","aria-describedby","inputGroup-sizing-lg",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-link",3,"click"],["type","button",1,"btn","btn-success",3,"click"],["type","text","aria-label","Sizing example input","aria-describedby","inputGroup-sizing-lg",1,"form-control",3,"ngModel","ngModelChange","change"],[3,"color",4,"ngIf"],["class","mb-2",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-link","btn-lg",3,"click"],["type","button",1,"btn","btn-success","btn-lg",3,"click"],[1,"mb-2"],["type","radio","name","btnradio","autocomplete","off",1,"btn-check",3,"ngModel","value","id","ngModelChange"],[1,"btn","btn-outline-primary","btn-lg",3,"for"],[1,"input-group","input-group-lg"],["type","color","aria-label","Sizing example input","aria-describedby","inputGroup-sizing-lg",1,"form-control","h-100",3,"ngModel","ngModelChange"],[4,"ngIf"],[1,"bi","bi-person-arms-up"],[3,"hidden"],[1,"row"],["type","button",1,"btn","btn-xl",3,"ngClass"],[3,"config","event"],["playerTurnCountdown",""],[1,"btn","btn-outline-warning","btn-xl","col",3,"click"],[1,"bi","bi-pause-circle-fill"],[1,"btn","btn-outline-primary","btn-xl","col",3,"click"],[1,"bi","bi-play-circle-fill"],[1,"btn","btn-outline-success","btn-xl","col",3,"click"],[1,"bi","bi-fast-forward-fill"],[1,"d-flex","justify-content-center"],["class","bi bi-person-arms-up",3,"fs-1","color",4,"ngFor","ngForOf"],[1,"col","h4","text-center"],["type","button",1,"btn","btn-success","btn-xl",3,"click"]],template:function(i,r){if(1&i&&(ue(0,"div",0)(1,"ul",1,2),Ve("activeIdChange",function(o){return r.view=o}),ue(3,"li",3),De(4,mpe,5,0,"ng-template",4),de(),De(5,ype,2,1,"li",5),ue(6,"li",3),De(7,bpe,12,2,"ng-template",4),de(),De(8,Tpe,2,1,"li",5),De(9,Cpe,2,1,"li",5),ue(10,"li",3),De(11,xpe,22,11,"ng-template",4),de()(),tr(12,"div",6),de()),2&i){const s=function Do(n){return function Jl(n,e){return n[e]}(function vC(){return We.lFrame.contextLView}(),dt+n)}(2);le(1),ce("activeId",r.view),le(2),ce("ngbNavItem",r.views.landing),le(2),ce("ngIf",r.game),le(1),ce("ngbNavItem",r.views.joinGame),le(2),ce("ngIf",r.game),le(1),ce("ngIf",r.player),le(1),ce("ngbNavItem",r.views.playGame),le(2),ce("ngbNavOutlet",s)}},dependencies:[BV,_l,yl,Iw,kR,EH,MR,t3,yN,Id,vp,T4,I4]})}return n})();function bN(){return n=>n.lift(new Ope)}class Ope{call(e,t){return t.subscribe(new Mpe(e))}}class Mpe extends xe{constructor(e){super(e),this.hasPrev=!1}_next(e){let t;this.hasPrev?t=[this.prev,e]:this.hasPrev=!0,this.prev=e,t&&this.destination.next(t)}}var Ce,kpe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ho={},EN=EN||{},Xe=kpe||self;function tT(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function ly(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var wN="closure_uid_"+(1e9*Math.random()>>>0),Lpe=0;function Vpe(n,e,t){return n.call.apply(n.bind,arguments)}function Bpe(n,e,t){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),n.apply(e,r)}}return function(){return n.apply(e,arguments)}}function Er(n,e,t){return(Er=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Vpe:Bpe).apply(null,arguments)}function nT(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var i=t.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function Ui(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(i,r,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(i,o)}}function Vc(){this.s=this.s,this.o=this.o}Vc.prototype.s=!1,Vc.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function Fpe(n){Object.prototype.hasOwnProperty.call(n,wN)&&n[wN]||(n[wN]=++Lpe)}(this)},Vc.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const G4=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function TN(n){const e=n.length;if(0<e){const t=Array(e);for(let i=0;i<e;i++)t[i]=n[i];return t}return[]}function z4(n,e){for(let t=1;t<arguments.length;t++){const i=arguments[t];if(tT(i)){const r=n.length||0,s=i.length||0;n.length=r+s;for(let o=0;o<s;o++)n[r+o]=i[o]}else n.push(i)}}function wr(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}wr.prototype.h=function(){this.defaultPrevented=!0};var jpe=function(){if(!Xe.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{const t=()=>{};Xe.addEventListener("test",t,e),Xe.removeEventListener("test",t,e)}catch{}return n}();function cy(n){return/^[\s\xa0]*$/.test(n)}function iT(){var n=Xe.navigator;return n&&(n=n.userAgent)?n:""}function Ta(n){return-1!=iT().indexOf(n)}function IN(n){return IN[" "](n),n}IN[" "]=function(){};var DN,Hpe=Ta("Opera"),bp=Ta("Trident")||Ta("MSIE"),W4=Ta("Edge"),CN=W4||bp,q4=Ta("Gecko")&&!(-1!=iT().toLowerCase().indexOf("webkit")&&!Ta("Edge"))&&!(Ta("Trident")||Ta("MSIE"))&&!Ta("Edge"),Gpe=-1!=iT().toLowerCase().indexOf("webkit")&&!Ta("Edge");function K4(){var n=Xe.document;return n?n.documentMode:void 0}e:{var SN="",AN=function(){var n=iT();return q4?/rv:([^\);]+)(\)|;)/.exec(n):W4?/Edge\/([\d\.]+)/.exec(n):bp?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Gpe?/WebKit\/(\S+)/.exec(n):Hpe?/(?:Version)[ \/]?(\S+)/.exec(n):void 0}();if(AN&&(SN=AN?AN[1]:""),bp){var RN=K4();if(null!=RN&&RN>parseFloat(SN)){DN=String(RN);break e}}DN=SN}var zpe=Xe.document&&bp&&(K4()||parseInt(DN,10))||void 0;function uy(n,e){if(wr.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(q4){e:{try{IN(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:Wpe[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&uy.$.h.call(this)}}Ui(uy,wr);var Wpe={2:"touch",3:"pen",4:"mouse"};uy.prototype.h=function(){uy.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var dy="closure_listenable_"+(1e6*Math.random()|0),qpe=0;function Kpe(n,e,t,i,r){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!i,this.la=r,this.key=++qpe,this.fa=this.ia=!1}function rT(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function xN(n,e,t){for(const i in n)e.call(t,n[i],i,n)}function Y4(n){const e={};for(const t in n)e[t]=n[t];return e}const Q4="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J4(n,e){let t,i;for(let r=1;r<arguments.length;r++){for(t in i=arguments[r],i)n[t]=i[t];for(let s=0;s<Q4.length;s++)t=Q4[s],Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])}}function sT(n){this.src=n,this.g={},this.h=0}function PN(n,e){var t=e.type;if(t in n.g){var s,i=n.g[t],r=G4(i,e);(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(rT(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function ON(n,e,t,i){for(var r=0;r<n.length;++r){var s=n[r];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==i)return r}return-1}sT.prototype.add=function(n,e,t,i,r){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var o=ON(n,e,i,r);return-1<o?(e=n[o],t||(e.ia=!1)):((e=new Kpe(e,this.src,s,!!i,r)).ia=t,n.push(e)),e};var MN="closure_lm_"+(1e6*Math.random()|0),kN={};function X4(n,e,t,i,r){if(i&&i.once)return tG(n,e,t,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)X4(n,e[s],t,i,r);return null}return t=BN(t),n&&n[dy]?n.O(e,t,ly(i)?!!i.capture:!!i,r):eG(n,e,t,!1,i,r)}function eG(n,e,t,i,r,s){if(!e)throw Error("Invalid event type");var o=ly(r)?!!r.capture:!!r,a=LN(n);if(a||(n[MN]=a=new sT(n)),(t=a.add(e,t,i,o,s)).proxy)return t;if(i=function Ype(){const e=Qpe;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=i,i.src=n,i.listener=t,n.addEventListener)jpe||(r=o),void 0===r&&(r=!1),n.addEventListener(e.toString(),i,r);else if(n.attachEvent)n.attachEvent(iG(e.toString()),i);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(i)}return t}function tG(n,e,t,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)tG(n,e[s],t,i,r);return null}return t=BN(t),n&&n[dy]?n.P(e,t,ly(i)?!!i.capture:!!i,r):eG(n,e,t,!0,i,r)}function nG(n,e,t,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)nG(n,e[s],t,i,r);else i=ly(i)?!!i.capture:!!i,t=BN(t),n&&n[dy]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=ON(s=n.g[e],t,i,r))&&(rT(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=LN(n))&&(e=n.g[e.toString()],n=-1,e&&(n=ON(e,t,i,r)),(t=-1<n?e[n]:null)&&FN(t))}function FN(n){if("number"!=typeof n&&n&&!n.fa){var e=n.src;if(e&&e[dy])PN(e.i,n);else{var t=n.type,i=n.proxy;e.removeEventListener?e.removeEventListener(t,i,n.capture):e.detachEvent?e.detachEvent(iG(t),i):e.addListener&&e.removeListener&&e.removeListener(i),(t=LN(e))?(PN(t,n),0==t.h&&(t.src=null,e[MN]=null)):rT(n)}}}function iG(n){return n in kN?kN[n]:kN[n]="on"+n}function Qpe(n,e){if(n.fa)n=!0;else{e=new uy(e,this);var t=n.listener,i=n.la||n.src;n.ia&&FN(n),n=t.call(i,e)}return n}function LN(n){return(n=n[MN])instanceof sT?n:null}var VN="__closure_events_fn_"+(1e9*Math.random()>>>0);function BN(n){return"function"==typeof n?n:(n[VN]||(n[VN]=function(e){return n.handleEvent(e)}),n[VN])}function ji(){Vc.call(this),this.i=new sT(this),this.S=this,this.J=null}function ar(n,e){var t,i=n.J;if(i)for(t=[];i;i=i.J)t.push(i);if(n=n.S,i=e.type||e,"string"==typeof e)e=new wr(e,n);else if(e instanceof wr)e.target=e.target||n;else{var r=e;J4(e=new wr(i,n),r)}if(r=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];r=oT(o,i,!0,e)&&r}if(r=oT(o=e.g=n,i,!0,e)&&r,r=oT(o,i,!1,e)&&r,t)for(s=0;s<t.length;s++)r=oT(o=e.g=t[s],i,!1,e)&&r}function oT(n,e,t,i){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var a=o.listener,l=o.la||o.src;o.ia&&PN(n.i,o),r=!1!==a.call(l,i)&&r}}return r&&!i.defaultPrevented}Ui(ji,Vc),ji.prototype[dy]=!0,ji.prototype.removeEventListener=function(n,e,t,i){nG(this,n,e,t,i)},ji.prototype.N=function(){if(ji.$.N.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],i=0;i<t.length;i++)rT(t[i]);delete n.g[e],n.h--}}this.J=null},ji.prototype.O=function(n,e,t,i){return this.i.add(String(n),e,!1,t,i)},ji.prototype.P=function(n,e,t,i){return this.i.add(String(n),e,!0,t,i)};var UN=Xe.JSON.stringify;function Xpe(){var n=jN;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var rG=new class Jpe{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new tge,n=>n.reset());class tge{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function nge(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function ige(n){Xe.setTimeout(()=>{throw n},0)}let hy,fy=!1,jN=new class ege{constructor(){this.h=this.g=null}add(e,t){const i=rG.get();i.set(e,t),this.h?this.h.next=i:this.g=i,this.h=i}},sG=()=>{const n=Xe.Promise.resolve(void 0);hy=()=>{n.then(rge)}};var rge=()=>{for(var n;n=Xpe();){try{n.h.call(n.g)}catch(t){ige(t)}var e=rG;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}fy=!1};function aT(n,e){ji.call(this),this.h=n||1,this.g=e||Xe,this.j=Er(this.qb,this),this.l=Date.now()}function $N(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}function HN(n,e,t){if("function"==typeof n)t&&(n=Er(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Er(n.handleEvent,n)}return 2147483647<Number(e)?-1:Xe.setTimeout(n,e||0)}function oG(n){n.g=HN(()=>{n.g=null,n.i&&(n.i=!1,oG(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Ui(aT,ji),(Ce=aT.prototype).ga=!1,Ce.T=null,Ce.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ar(this,"tick"),this.ga&&($N(this),this.start()))}},Ce.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ce.N=function(){aT.$.N.call(this),$N(this),delete this.g};class sge extends Vc{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:oG(this)}N(){super.N(),this.g&&(Xe.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function py(n){Vc.call(this),this.h=n,this.g={}}Ui(py,Vc);var aG=[];function lG(n,e,t,i){Array.isArray(t)||(t&&(aG[0]=t.toString()),t=aG);for(var r=0;r<t.length;r++){var s=X4(e,t[r],i||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function cG(n){xN(n.g,function(e,t){this.g.hasOwnProperty(t)&&FN(e)},n),n.g={}}function lT(){this.g=!0}function Ep(n,e,t,i){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function cge(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var i=t[n];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return UN(t)}catch{return e}}(n,t)+(i?" "+i:"")})}py.prototype.N=function(){py.$.N.call(this),cG(this)},py.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},lT.prototype.Ea=function(){this.g=!1},lT.prototype.info=function(){};var Cd={},uG=null;function cT(){return uG=uG||new ji}function dG(n){wr.call(this,Cd.Ta,n)}function gy(n){const e=cT();ar(e,new dG(e))}function hG(n,e){wr.call(this,Cd.STAT_EVENT,n),this.stat=e}function Vr(n){const e=cT();ar(e,new hG(e,n))}function fG(n,e){wr.call(this,Cd.Ua,n),this.size=e}function my(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return Xe.setTimeout(function(){n()},e)}Cd.Ta="serverreachability",Ui(dG,wr),Cd.STAT_EVENT="statevent",Ui(hG,wr),Cd.Ua="timingevent",Ui(fG,wr);var uT={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},pG={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function GN(){}function mG(){}GN.prototype.h=null;var qN,_y={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function zN(){wr.call(this,"d")}function WN(){wr.call(this,"c")}function dT(){}function yy(n,e,t,i){this.l=n,this.j=e,this.m=t,this.W=i||1,this.U=new py(this),this.P=uge,this.V=new aT(n=CN?125:void 0),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new _G}function _G(){this.i=null,this.g="",this.h=!1}Ui(zN,wr),Ui(WN,wr),Ui(dT,GN),dT.prototype.g=function(){return new XMLHttpRequest},dT.prototype.i=function(){return{}},qN=new dT;var uge=45e3,yG={},KN={};function ZN(n,e,t){n.L=1,n.A=gT(Il(e)),n.u=t,n.S=!0,vG(n,null)}function vG(n,e){n.G=Date.now(),vy(n),n.B=Il(n.A);var t=n.B,i=n.W;Array.isArray(i)||(i=[String(i)]),RG(t.i,"t",i),n.o=0,t=n.l.J,n.h=new _G,n.g=XG(n.l,t?e:null,!n.u),0<n.O&&(n.M=new sge(Er(n.Pa,n,n.g),n.O)),lG(n.U,n.g,"readystatechange",n.nb),e=n.I?Y4(n.I):{},n.u?(n.v||(n.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.B,n.v,n.u,e)):(n.v="GET",n.g.ha(n.B,n.v,null,e)),gy(),function oge(n,e,t,i,r,s){n.info(function(){if(n.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var u=a[l].split("=");if(1<u.length){var h=u[0];u=u[1];var g=h.split("_");o=2<=g.length&&"type"==g[1]?o+(h+"=")+u+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+t+"\n"+o})}(n.j,n.v,n.B,n.m,n.W,n.u)}function bG(n){return!!n.g&&"GET"==n.v&&2!=n.L&&n.l.Ha}function EG(n,e,t){let r,i=!0;for(;!n.J&&n.o<t.length;){if(r=dge(n,t),r==KN){4==e&&(n.s=4,Vr(14),i=!1),Ep(n.j,n.m,null,"[Incomplete Response]");break}if(r==yG){n.s=4,Vr(15),Ep(n.j,n.m,t,"[Invalid Chunk]"),i=!1;break}Ep(n.j,n.m,r,null),YN(n,r)}bG(n)&&0!=n.o&&(n.h.g=n.h.g.slice(n.o),n.o=0),4!=e||0!=t.length||n.h.h||(n.s=1,Vr(16),i=!1),n.i=n.i&&i,i?0<t.length&&!n.ba&&(n.ba=!0,(e=n.l).g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),ix(e),e.M=!0,Vr(11))):(Ep(n.j,n.m,t,"[Invalid Chunked Response]"),Dd(n),by(n))}function dge(n,e){var t=n.o,i=e.indexOf("\n",t);return-1==i?KN:(t=Number(e.substring(t,i)),isNaN(t)?yG:(i+=1)+t>e.length?KN:(e=e.slice(i,i+t),n.o=i+t,e))}function vy(n){n.Y=Date.now()+n.P,wG(n,n.P)}function wG(n,e){if(null!=n.C)throw Error("WatchDog timer not null");n.C=my(Er(n.lb,n),e)}function hT(n){n.C&&(Xe.clearTimeout(n.C),n.C=null)}function by(n){0==n.l.H||n.J||ZG(n.l,n)}function Dd(n){hT(n);var e=n.M;e&&"function"==typeof e.sa&&e.sa(),n.M=null,$N(n.V),cG(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function YN(n,e){try{var t=n.l;if(0!=t.H&&(t.g==n||QN(t.i,n)))if(!n.K&&QN(t.i,n)&&3==t.H){try{var i=t.Ja.g.parse(e)}catch{i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<n.G))break e;ET(t),vT(t)}nx(t),Vr(18)}}else t.Fa=r[1],0<t.Fa-t.V&&37500>r[2]&&t.G&&0==t.A&&!t.v&&(t.v=my(Er(t.ib,t),6e3));if(1>=PG(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Ad(t,11)}else if((n.K||t.g==n)&&ET(t),!cy(e))for(r=t.Ja.g.parse(e),e=0;e<r.length;e++){let u=r[e];if(t.V=u[0],u=u[1],2==t.H)if("c"==u[0]){t.K=u[1],t.pa=u[2];const h=u[3];null!=h&&(t.ra=h,t.l.info("VER="+t.ra));const g=u[4];null!=g&&(t.Ga=g,t.l.info("SVER="+t.Ga));const m=u[5];null!=m&&"number"==typeof m&&0<m&&(t.L=i=1.5*m,t.l.info("backChannelRequestTimeoutMs_="+i)),i=t;const y=n.g;if(y){const b=y.g?y.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(b){var s=i.i;s.g||-1==b.indexOf("spdy")&&-1==b.indexOf("quic")&&-1==b.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(JN(s,s.h),s.h=null))}if(i.F){const w=y.g?y.g.getResponseHeader("X-HTTP-Session-Id"):null;w&&(i.Da=w,Rn(i.I,i.F,w))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms"));var o=n;if((i=t).wa=JG(i,i.J?i.pa:null,i.Y),o.K){OG(i.i,o);var a=o,l=i.L;l&&a.setTimeout(l),a.C&&(hT(a),vy(a)),i.g=o}else qG(i);0<t.j.length&&bT(t)}else"stop"!=u[0]&&"close"!=u[0]||Ad(t,7);else 3==t.H&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?Ad(t,7):tx(t):"noop"!=u[0]&&t.h&&t.h.Aa(u),t.A=0)}gy()}catch{}}function TG(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(tT(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function fge(n){if(n.ta&&"function"==typeof n.ta)return n.ta();if(!n.Z||"function"!=typeof n.Z){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(tT(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const i in n)e[t++]=i;return e}}}(n),i=function hge(n){if(n.Z&&"function"==typeof n.Z)return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(tT(n)){for(var e=[],t=n.length,i=0;i<t;i++)e.push(n[i]);return e}for(i in e=[],t=0,n)e[t++]=n[i];return e}(n),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],t&&t[s],n)}(Ce=yy.prototype).setTimeout=function(n){this.P=n},Ce.nb=function(n){n=n.target;const e=this.M;e&&3==Ia(n)?e.l():this.Pa(n)},Ce.Pa=function(n){try{if(n==this.g)e:{const h=Ia(this.g);var e=this.g.Ia();if(this.g.da(),!(3>h)&&(3!=h||CN||this.g&&(this.h.h||this.g.ja()||jG(this.g)))){this.J||4!=h||7==e||gy(),hT(this);var t=this.g.da();this.ca=t;t:if(bG(this)){var i=jG(this.g);n="";var r=i.length,s=4==Ia(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Dd(this),by(this);var o="";break t}this.h.i=new Xe.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,n+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.length=0,this.h.g+=n,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==t,function age(n,e,t,i,r,s,o){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+t+"\n"+s+" "+o})}(this.j,this.v,this.B,this.m,this.W,h,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!cy(a)){var u=a;break t}}u=null}if(!(t=u)){this.i=!1,this.s=3,Vr(12),Dd(this),by(this);break e}Ep(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,YN(this,t)}this.S?(EG(this,h,o),CN&&this.i&&3==h&&(lG(this.U,this.V,"tick",this.mb),this.V.start())):(Ep(this.j,this.m,o,null),YN(this,o)),4==h&&Dd(this),this.i&&!this.J&&(4==h?ZG(this.l,this):(this.i=!1,vy(this)))}else(function xge(n){const e={};n=(n.g&&2<=Ia(n)&&n.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<n.length;i++){if(cy(n[i]))continue;var t=nge(n[i]);const r=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[r]||[];e[r]=s,s.push(t)}!function Zpe(n,e){for(const t in n)e.call(void 0,n[t],t,n)}(e,function(i){return i.join(", ")})})(this.g),400==t&&0<o.indexOf("Unknown SID")?(this.s=3,Vr(12)):(this.s=0,Vr(13)),Dd(this),by(this)}}}catch{}},Ce.mb=function(){if(this.g){var n=Ia(this.g),e=this.g.ja();this.o<e.length&&(hT(this),EG(this,n,e),this.i&&4!=n&&vy(this))}},Ce.cancel=function(){this.J=!0,Dd(this)},Ce.lb=function(){this.C=null;const n=Date.now();0<=n-this.Y?(function lge(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.B),2!=this.L&&(gy(),Vr(17)),Dd(this),this.s=2,by(this)):wG(this,this.Y-n)};var IG=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Sd(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Sd){this.h=n.h,fT(this,n.j),this.s=n.s,this.g=n.g,pT(this,n.m),this.l=n.l;var e=n.i,t=new Ty;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),CG(this,t),this.o=n.o}else n&&(e=String(n).match(IG))?(this.h=!1,fT(this,e[1]||"",!0),this.s=Ey(e[2]||""),this.g=Ey(e[3]||"",!0),pT(this,e[4]),this.l=Ey(e[5]||"",!0),CG(this,e[6]||"",!0),this.o=Ey(e[7]||"")):(this.h=!1,this.i=new Ty(null,this.h))}function Il(n){return new Sd(n)}function fT(n,e,t){n.j=t?Ey(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function pT(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function CG(n,e,t){e instanceof Ty?(n.i=e,function bge(n,e){e&&!n.j&&(Bc(n),n.i=null,n.g.forEach(function(t,i){var r=i.toLowerCase();i!=r&&(SG(this,i),RG(this,r,t))},n)),n.j=e}(n.i,n.h)):(t||(e=wy(e,yge)),n.i=new Ty(e,n.h))}function Rn(n,e,t){n.i.set(e,t)}function gT(n){return Rn(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Ey(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function wy(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,gge),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function gge(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Sd.prototype.toString=function(){var n=[],e=this.j;e&&n.push(wy(e,DG,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(wy(e,DG,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(wy(t,"/"==t.charAt(0)?_ge:mge,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",wy(t,vge)),n.join("")};var DG=/[#\/\?@]/g,mge=/[#\?:]/g,_ge=/[#\?]/g,yge=/[#\?@]/g,vge=/#/g;function Ty(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function Bc(n){n.g||(n.g=new Map,n.h=0,n.i&&function pge(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var i=n[t].indexOf("="),r=null;if(0<=i){var s=n[t].substring(0,i);r=n[t].substring(i+1)}else s=n[t];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function SG(n,e){Bc(n),e=wp(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function AG(n,e){return Bc(n),e=wp(n,e),n.g.has(e)}function RG(n,e,t){SG(n,e),0<t.length&&(n.i=null,n.g.set(wp(n,e),TN(t)),n.h+=t.length)}function wp(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function NG(n){this.l=n||wge,n=Xe.PerformanceNavigationTiming?0<(n=Xe.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(Xe.g&&Xe.g.Ka&&Xe.g.Ka()&&Xe.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Ce=Ty.prototype).add=function(n,e){Bc(this),this.i=null,n=wp(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},Ce.forEach=function(n,e){Bc(this),this.g.forEach(function(t,i){t.forEach(function(r){n.call(e,r,i,this)},this)},this)},Ce.ta=function(){Bc(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let i=0;i<e.length;i++){const r=n[i];for(let s=0;s<r.length;s++)t.push(e[i])}return t},Ce.Z=function(n){Bc(this);let e=[];if("string"==typeof n)AG(this,n)&&(e=e.concat(this.g.get(wp(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},Ce.set=function(n,e){return Bc(this),this.i=null,AG(this,n=wp(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},Ce.get=function(n,e){return n&&0<(n=this.Z(n)).length?String(n[0]):e},Ce.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var i=e[t];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),n.push(r)}}return this.i=n.join("&")};var wge=10;function xG(n){return!!n.h||!!n.g&&n.g.size>=n.j}function PG(n){return n.h?1:n.g?n.g.size:0}function QN(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function JN(n,e){n.g?n.g.add(e):n.h=e}function OG(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function MG(n){if(null!=n.h)return n.i.concat(n.h.F);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return TN(n.i)}NG.prototype.cancel=function(){if(this.i=MG(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}};var Tge=class{stringify(n){return Xe.JSON.stringify(n,void 0)}parse(n){return Xe.JSON.parse(n,void 0)}};function Ige(){this.g=new Tge}function Cge(n,e,t){const i=t||"";try{TG(n,function(r,s){let o=r;ly(r)&&(o=UN(r)),e.push(i+s+"="+encodeURIComponent(o))})}catch(r){throw e.push(i+"type="+encodeURIComponent("_badmap")),r}}function mT(n,e,t,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch{}}function Iy(n){this.l=n.ec||null,this.j=n.ob||!1}function _T(n,e){ji.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=XN,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ui(Iy,GN),Iy.prototype.g=function(){return new _T(this.l,this.j)},Iy.prototype.i=function(n){return function(){return n}}({}),Ui(_T,ji);var XN=0;function kG(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}function Cy(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Dy(n)}function Dy(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(Ce=_T.prototype).open=function(n,e){if(this.readyState!=XN)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Dy(this)},Ce.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||Xe).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Ce.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Cy(this)),this.readyState=XN},Ce.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Dy(this)),this.g&&(this.readyState=3,Dy(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Xe.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;kG(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))},Ce.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Cy(this):Dy(this),3==this.readyState&&kG(this)}},Ce.Za=function(n){this.g&&(this.response=this.responseText=n,Cy(this))},Ce.Ya=function(n){this.g&&(this.response=n,Cy(this))},Ce.ka=function(){this.g&&Cy(this)},Ce.setRequestHeader=function(n,e){this.v.append(n,e)},Ce.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},Ce.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(_T.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Sge=Xe.JSON.parse;function ni(n){ji.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=FG,this.L=this.M=!1}Ui(ni,ji);var FG="",Age=/^https?$/i,Rge=["POST","PUT"];function LG(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,VG(n),yT(n)}function VG(n){n.F||(n.F=!0,ar(n,"complete"),ar(n,"error"))}function BG(n){if(n.h&&typeof EN<"u"&&(!n.C[1]||4!=Ia(n)||2!=n.da()))if(n.v&&4==Ia(n))HN(n.La,0,n);else if(ar(n,"readystatechange"),4==Ia(n)){n.h=!1;try{const o=n.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var i;if(i=0===o){var r=String(n.I).match(IG)[1]||null;!r&&Xe.self&&Xe.self.location&&(r=Xe.self.location.protocol.slice(0,-1)),i=!Age.test(r?r.toLowerCase():"")}t=i}if(t)ar(n,"complete"),ar(n,"success");else{n.m=6;try{var s=2<Ia(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",VG(n)}}finally{yT(n)}}}function yT(n,e){if(n.g){UG(n);const t=n.g,i=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||ar(n,"ready");try{t.onreadystatechange=i}catch{}}}function UG(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(Xe.clearTimeout(n.A),n.A=null)}function Ia(n){return n.g?n.g.readyState:0}function jG(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case FG:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function $G(n){let e="";return xN(n,function(t,i){e+=i,e+=":",e+=t,e+="\r\n"}),e}function ex(n,e,t){e:{for(i in t){var i=!1;break e}i=!0}i||(t=$G(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Rn(n,e,t))}function Sy(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function HG(n){this.Ga=0,this.j=[],this.l=new lT,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Sy("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Sy("baseRetryDelayMs",5e3,n),this.hb=Sy("retryDelaySeedMs",1e4,n),this.eb=Sy("forwardChannelMaxRetries",2,n),this.xa=Sy("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new NG(n&&n.concurrentRequestLimit),this.Ja=new Ige,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function tx(n){if(GG(n),3==n.H){var e=n.W++,t=Il(n.I);if(Rn(t,"SID",n.K),Rn(t,"RID",e),Rn(t,"TYPE","terminate"),Ay(n,t),(e=new yy(n,n.l,e)).L=2,e.A=gT(Il(t)),t=!1,Xe.navigator&&Xe.navigator.sendBeacon)try{t=Xe.navigator.sendBeacon(e.A.toString(),"")}catch{}!t&&Xe.Image&&((new Image).src=e.A,t=!0),t||(e.g=XG(e.l,null),e.g.ha(e.A)),e.G=Date.now(),vy(e)}QG(n)}function vT(n){n.g&&(ix(n),n.g.cancel(),n.g=null)}function GG(n){vT(n),n.u&&(Xe.clearTimeout(n.u),n.u=null),ET(n),n.i.cancel(),n.m&&("number"==typeof n.m&&Xe.clearTimeout(n.m),n.m=null)}function bT(n){if(!xG(n.i)&&!n.m){n.m=!0;var e=n.Na;hy||sG(),fy||(hy(),fy=!0),jN.add(e,n),n.C=0}}function zG(n,e){var t;t=e?e.m:n.W++;const i=Il(n.I);Rn(i,"SID",n.K),Rn(i,"RID",t),Rn(i,"AID",n.V),Ay(n,i),n.o&&n.s&&ex(i,n.o,n.s),t=new yy(n,n.l,t,n.C+1),null===n.o&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=WG(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),JN(n.i,t),ZN(t,i,e)}function Ay(n,e){n.na&&xN(n.na,function(t,i){Rn(e,i,t)}),n.h&&TG({},function(t,i){Rn(e,i,t)})}function WG(n,e,t){t=Math.min(n.j.length,t);var i=n.h?Er(n.h.Va,n.h,n):null;e:{var r=n.j;let s=-1;for(;;){const o=["count="+t];-1==s?0<t?(s=r[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<t;l++){let u=r[l].g;const h=r[l].map;if(u-=s,0>u)s=Math.max(0,r[l].g-100),a=!1;else try{Cge(h,o,"req"+u+"_")}catch{i&&i(h)}}if(a){i=o.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,i}function qG(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;hy||sG(),fy||(hy(),fy=!0),jN.add(e,n),n.A=0}}function nx(n){return!(n.g||n.u||3<=n.A||(n.ba++,n.u=my(Er(n.Ma,n),YG(n,n.A)),n.A++,0))}function ix(n){null!=n.B&&(Xe.clearTimeout(n.B),n.B=null)}function KG(n){n.g=new yy(n,n.l,"rpc",n.ba),null===n.o&&(n.g.I=n.s),n.g.O=0;var e=Il(n.wa);Rn(e,"RID","rpc"),Rn(e,"SID",n.K),Rn(e,"AID",n.V),Rn(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&Rn(e,"TO",n.qa),Rn(e,"TYPE","xmlhttp"),Ay(n,e),n.o&&n.s&&ex(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.A=gT(Il(e)),t.u=null,t.S=!0,vG(t,n)}function ET(n){null!=n.v&&(Xe.clearTimeout(n.v),n.v=null)}function ZG(n,e){var t=null;if(n.g==e){ET(n),ix(n),n.g=null;var i=2}else{if(!QN(n.i,e))return;t=e.F,OG(n.i,e),i=1}if(0!=n.H)if(e.i)if(1==i){t=e.u?e.u.length:0,e=Date.now()-e.G;var r=n.C;ar(i=cT(),new fG(i,t)),bT(n)}else qG(n);else if(3==(r=e.s)||0==r&&0<e.ca||!(1==i&&function Pge(n,e){return!(PG(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.j=e.F.concat(n.j),0):1==n.H||2==n.H||n.C>=(n.cb?0:n.eb)||(n.m=my(Er(n.Na,n,e),YG(n,n.C)),n.C++,0)))}(n,e)||2==i&&nx(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),r){case 1:Ad(n,5);break;case 4:Ad(n,10);break;case 3:Ad(n,6);break;default:Ad(n,2)}}function YG(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Ad(n,e){if(n.l.info("Error code "+e),2==e){var t=null;n.h&&(t=null);var i=Er(n.pb,n);t||(t=new Sd("//www.google.com/images/cleardot.gif"),Xe.location&&"http"==Xe.location.protocol||fT(t,"https"),gT(t)),function Dge(n,e){const t=new lT;if(Xe.Image){const i=new Image;i.onload=nT(mT,t,i,"TestLoadImage: loaded",!0,e),i.onerror=nT(mT,t,i,"TestLoadImage: error",!1,e),i.onabort=nT(mT,t,i,"TestLoadImage: abort",!1,e),i.ontimeout=nT(mT,t,i,"TestLoadImage: timeout",!1,e),Xe.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else e(!1)}(t.toString(),i)}else Vr(2);n.H=0,n.h&&n.h.za(e),QG(n),GG(n)}function QG(n){if(n.H=0,n.ma=[],n.h){const e=MG(n.i);(0!=e.length||0!=n.j.length)&&(z4(n.ma,e),z4(n.ma,n.j),n.i.i.length=0,TN(n.j),n.j.length=0),n.h.ya()}}function JG(n,e,t){var i=t instanceof Sd?Il(t):new Sd(t);if(""!=i.g)e&&(i.g=e+"."+i.g),pT(i,i.m);else{var r=Xe.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new Sd(null);i&&fT(s,i),e&&(s.g=e),r&&pT(s,r),t&&(s.l=t),i=s}return e=n.Da,(t=n.F)&&e&&Rn(i,t,e),Rn(i,"VER",n.ra),Ay(n,i),i}function XG(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new ni(n.Ha&&!n.va?new Iy({ob:t}):n.va)).Oa(n.J),e}function e8(){}function wT(){if(bp&&!(10<=Number(zpe)))throw Error("Environmental error: no available transport.")}function Ms(n,e){ji.call(this),this.g=new HG(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!cy(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!cy(e)&&(this.g.F=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Tp(this)}function t8(n){zN.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function n8(){WN.call(this),this.status=1}function Tp(n){this.g=n}function Go(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function rx(n,e,t){t||(t=0);var i=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)i[r]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(r=0;16>r;++r)i[r]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=n.g[3],o=(e=n.g[0])+(s^(t=n.g[1])&((r=n.g[2])^s))+i[0]+3614090360&4294967295;o=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=t+(o<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(t^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(t^s&(e^t))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^r&(s^e))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^s&(t^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(t^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(t^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(t^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^r&(e^t))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^t&(s^e))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(t^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^t)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=t+(r^s^e)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(r^(t|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~t))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(r|~e))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(t|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~t))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(r|~e))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(t|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~t))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(r|~e))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=t+((o=e+(r^(t|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(e^(s|~t))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+i[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,n.g[2]=n.g[2]+r&4294967295,n.g[3]=n.g[3]+s&4294967295}function tn(n,e){this.h=e;for(var t=[],i=!0,r=n.length-1;0<=r;r--){var s=0|n[r];i&&s==e||(t[r]=s,i=!1)}this.g=t}(Ce=ni.prototype).Oa=function(n){this.M=n},Ce.ha=function(n,e,t,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():qN.g(),this.C=function gG(n){return n.h||(n.h=n.i())}(this.u?this.u:qN),this.g.onreadystatechange=Er(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){return void LG(this,s)}if(n=t||"",t=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)t.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const s of i.keys())t.set(s,i.get(s))}i=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),r=Xe.FormData&&n instanceof Xe.FormData,!(0<=G4(Rge,e))||i||r||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{UG(this),0<this.B&&((this.L=function Nge(n){return bp&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Er(this.ua,this)):this.A=HN(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){LG(this,s)}},Ce.ua=function(){typeof EN<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ar(this,"timeout"),this.abort(8))},Ce.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,ar(this,"complete"),ar(this,"abort"),yT(this))},Ce.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),yT(this,!0)),ni.$.N.call(this)},Ce.La=function(){this.s||(this.G||this.v||this.l?BG(this):this.kb())},Ce.kb=function(){BG(this)},Ce.isActive=function(){return!!this.g},Ce.da=function(){try{return 2<Ia(this)?this.g.status:-1}catch{return-1}},Ce.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},Ce.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),Sge(e)}},Ce.Ia=function(){return this.m},Ce.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ce=HG.prototype).ra=8,Ce.H=1,Ce.Na=function(n){if(this.m)if(this.m=null,1==this.H){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const r=new yy(this,this.l,n);let s=this.s;if(this.U&&(s?(s=Y4(s),J4(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var i=this.j[t];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=WG(this,r,e),Rn(t=Il(this.I),"RID",n),Rn(t,"CVER",22),this.F&&Rn(t,"X-HTTP-Session-Id",this.F),Ay(this,t),s&&(this.O?e="headers="+encodeURIComponent(String($G(s)))+"&"+e:this.o&&ex(t,this.o,s)),JN(this.i,r),this.bb&&Rn(t,"TYPE","init"),this.P?(Rn(t,"$req",e),Rn(t,"SID","null"),r.aa=!0,ZN(r,t,null)):ZN(r,t,e),this.H=2}}else 3==this.H&&(n?zG(this,n):0==this.j.length||xG(this.i)||zG(this))},Ce.Ma=function(){if(this.u=null,KG(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=my(Er(this.jb,this),n)}},Ce.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Vr(10),vT(this),KG(this))},Ce.ib=function(){null!=this.v&&(this.v=null,vT(this),nx(this),Vr(19))},Ce.pb=function(n){n?(this.l.info("Successfully pinged google.com"),Vr(2)):(this.l.info("Failed to ping google.com"),Vr(1))},Ce.isActive=function(){return!!this.h&&this.h.isActive(this)},(Ce=e8.prototype).Ba=function(){},Ce.Aa=function(){},Ce.za=function(){},Ce.ya=function(){},Ce.isActive=function(){return!0},Ce.Va=function(){},wT.prototype.g=function(n,e){return new Ms(n,e)},Ui(Ms,ji),Ms.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;Vr(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=JG(n,null,n.Y),bT(n)},Ms.prototype.close=function(){tx(this.g)},Ms.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=UN(n),n=t);e.j.push(new class{constructor(n,e){this.g=n,this.map=e}}(e.fb++,n)),3==e.H&&bT(e)},Ms.prototype.N=function(){this.g.h=null,delete this.j,tx(this.g),delete this.g,Ms.$.N.call(this)},Ui(t8,zN),Ui(n8,WN),Ui(Tp,e8),Tp.prototype.Ba=function(){ar(this.g,"a")},Tp.prototype.Aa=function(n){ar(this.g,new t8(n))},Tp.prototype.za=function(n){ar(this.g,new n8)},Tp.prototype.ya=function(){ar(this.g,"b")},Ui(Go,function Oge(){this.blockSize=-1}),Go.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Go.prototype.j=function(n,e){void 0===e&&(e=n.length);for(var t=e-this.blockSize,i=this.m,r=this.h,s=0;s<e;){if(0==r)for(;s<=t;)rx(this,n,s),s+=this.blockSize;if("string"==typeof n){for(;s<e;)if(i[r++]=n.charCodeAt(s++),r==this.blockSize){rx(this,i),r=0;break}}else for(;s<e;)if(i[r++]=n[s++],r==this.blockSize){rx(this,i),r=0;break}}this.h=r,this.i+=e},Go.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=255&t,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var i=0;32>i;i+=8)n[t++]=this.g[e]>>>i&255;return n};var Mge={};function sx(n){return-128<=n&&128>n?function $pe(n,e){var t=Mge;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}(n,function(e){return new tn([0|e],0>e?-1:0)}):new tn([0|n],0>n?-1:0)}function Ca(n){if(isNaN(n)||!isFinite(n))return Ip;if(0>n)return lr(Ca(-n));for(var e=[],t=1,i=0;n>=t;i++)e[i]=n/t|0,t*=ox;return new tn(e,0)}var ox=4294967296,Ip=sx(0),ax=sx(1),r8=sx(16777216);function Cl(n){if(0!=n.h)return!1;for(var e=0;e<n.g.length;e++)if(0!=n.g[e])return!1;return!0}function lo(n){return-1==n.h}function lr(n){for(var e=n.g.length,t=[],i=0;i<e;i++)t[i]=~n.g[i];return new tn(t,~n.h).add(ax)}function TT(n,e){return n.add(lr(e))}function IT(n,e){for(;(65535&n[e])!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function Ry(n,e){this.g=n,this.h=e}function CT(n,e){if(Cl(e))throw Error("division by zero");if(Cl(n))return new Ry(Ip,Ip);if(lo(n))return e=CT(lr(n),e),new Ry(lr(e.g),lr(e.h));if(lo(e))return e=CT(n,lr(e)),new Ry(lr(e.g),e.h);if(30<n.g.length){if(lo(n)||lo(e))throw Error("slowDivide_ only works with positive integers.");for(var t=ax,i=e;0>=i.X(n);)t=s8(t),i=s8(i);var r=Cp(t,1),s=Cp(i,1);for(i=Cp(i,2),t=Cp(t,2);!Cl(i);){var o=s.add(i);0>=o.X(n)&&(r=r.add(t),s=o),i=Cp(i,1),t=Cp(t,1)}return e=TT(n,r.R(e)),new Ry(r,e)}for(r=Ip;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),i=48>=(i=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,i-48),o=(s=Ca(t)).R(e);lo(o)||0<o.X(n);)o=(s=Ca(t-=i)).R(e);Cl(s)&&(s=ax),r=r.add(s),n=TT(n,o)}return new Ry(r,n)}function s8(n){for(var e=n.g.length+1,t=[],i=0;i<e;i++)t[i]=n.D(i)<<1|n.D(i-1)>>>31;return new tn(t,n.h)}function Cp(n,e){var t=e>>5;e%=32;for(var i=n.g.length-t,r=[],s=0;s<i;s++)r[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new tn(r,n.h)}(Ce=tn.prototype).ea=function(){if(lo(this))return-lr(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var i=this.D(t);n+=(0<=i?i:ox+i)*e,e*=ox}return n},Ce.toString=function(n){if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if(Cl(this))return"0";if(lo(this))return"-"+lr(this).toString(n);for(var e=Ca(Math.pow(n,6)),t=this,i="";;){var r=CT(t,e).g,s=((0<(t=TT(t,r.R(e))).g.length?t.g[0]:t.h)>>>0).toString(n);if(Cl(t=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},Ce.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h},Ce.X=function(n){return lo(n=TT(this,n))?-1:Cl(n)?0:1},Ce.abs=function(){return lo(this)?lr(this):this},Ce.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0,r=0;r<=e;r++){var s=i+(65535&this.D(r))+(65535&n.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(n.D(r)>>>16);i=o>>>16,t[r]=(o&=65535)<<16|(s&=65535)}return new tn(t,-2147483648&t[t.length-1]?-1:0)},Ce.R=function(n){if(Cl(this)||Cl(n))return Ip;if(lo(this))return lo(n)?lr(this).R(lr(n)):lr(lr(this).R(n));if(lo(n))return lr(this.R(lr(n)));if(0>this.X(r8)&&0>n.X(r8))return Ca(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],i=0;i<2*e;i++)t[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<n.g.length;r++){var s=this.D(i)>>>16,o=65535&this.D(i),a=n.D(r)>>>16,l=65535&n.D(r);t[2*i+2*r]+=o*l,IT(t,2*i+2*r),t[2*i+2*r+1]+=s*l,IT(t,2*i+2*r+1),t[2*i+2*r+1]+=o*a,IT(t,2*i+2*r+1),t[2*i+2*r+2]+=s*a,IT(t,2*i+2*r+2)}for(i=0;i<e;i++)t[i]=t[2*i+1]<<16|t[2*i];for(i=e;i<2*e;i++)t[i]=0;return new tn(t,0)},Ce.gb=function(n){return CT(this,n).h},Ce.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)&n.D(i);return new tn(t,this.h&n.h)},Ce.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)|n.D(i);return new tn(t,this.h|n.h)},Ce.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)^n.D(i);return new tn(t,this.h^n.h)},wT.prototype.createWebChannel=wT.prototype.g,Ms.prototype.send=Ms.prototype.u,Ms.prototype.open=Ms.prototype.m,Ms.prototype.close=Ms.prototype.close,uT.NO_ERROR=0,uT.TIMEOUT=8,uT.HTTP_ERROR=6,pG.COMPLETE="complete",mG.EventType=_y,_y.OPEN="a",_y.CLOSE="b",_y.ERROR="c",_y.MESSAGE="d",ji.prototype.listen=ji.prototype.O,ni.prototype.listenOnce=ni.prototype.P,ni.prototype.getLastError=ni.prototype.Sa,ni.prototype.getLastErrorCode=ni.prototype.Ia,ni.prototype.getStatus=ni.prototype.da,ni.prototype.getResponseJson=ni.prototype.Wa,ni.prototype.getResponseText=ni.prototype.ja,ni.prototype.send=ni.prototype.ha,ni.prototype.setWithCredentials=ni.prototype.Oa,Go.prototype.digest=Go.prototype.l,Go.prototype.reset=Go.prototype.reset,Go.prototype.update=Go.prototype.j,tn.prototype.add=tn.prototype.add,tn.prototype.multiply=tn.prototype.R,tn.prototype.modulo=tn.prototype.gb,tn.prototype.compare=tn.prototype.X,tn.prototype.toNumber=tn.prototype.ea,tn.prototype.toString=tn.prototype.toString,tn.prototype.getBits=tn.prototype.D,tn.fromNumber=Ca,tn.fromString=function i8(n,e){if(0==n.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==n.charAt(0))return lr(i8(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Ca(Math.pow(e,8)),i=Ip,r=0;r<n.length;r+=8){var s=Math.min(8,n.length-r),o=parseInt(n.substring(r,r+s),e);8>s?(s=Ca(Math.pow(e,s)),i=i.R(s).add(Ca(o))):i=(i=i.R(t)).add(Ca(o))}return i};var kge=Ho.createWebChannelTransport=function(){return new wT},Fge=Ho.getStatEventTarget=function(){return cT()},lx=Ho.ErrorCode=uT,Lge=Ho.EventType=pG,Vge=Ho.Event=Cd,o8=Ho.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},DT=(Ho.FetchXmlHttpFactory=Iy,Ho.WebChannel=mG),Bge=Ho.XhrIo=ni,Uge=Ho.Md5=Go,Dp=Ho.Integer=tn;const a8="@firebase/firestore";class $i{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}$i.UNAUTHENTICATED=new $i(null),$i.GOOGLE_CREDENTIALS=new $i("google-credentials-uid"),$i.FIRST_PARTY=new $i("first-party-uid"),$i.MOCK_USER=new $i("mock-user");let Sp="10.7.0";const Uc=new As.Yd("@firebase/firestore");function Ap(){return Uc.logLevel}function ie(n,...e){if(Uc.logLevel<=As.in.DEBUG){const t=e.map(cx);Uc.debug(`Firestore (${Sp}): ${n}`,...t)}}function di(n,...e){if(Uc.logLevel<=As.in.ERROR){const t=e.map(cx);Uc.error(`Firestore (${Sp}): ${n}`,...t)}}function gs(n,...e){if(Uc.logLevel<=As.in.WARN){const t=e.map(cx);Uc.warn(`Firestore (${Sp}): ${n}`,...t)}}function cx(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function Ae(n="Unexpected state"){const e=`FIRESTORE (${Sp}) INTERNAL ASSERTION FAILED: `+n;throw di(e),new Error(e)}function Pe(n,e){n||Ae()}function Ee(n,e){return n}const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class te extends E.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ri{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class l8{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Hge{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t($i.UNAUTHENTICATED))}shutdown(){}}class Gge{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class zge{constructor(e){this.t=e,this.currentUser=$i.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var i=this;let r=this.i;const s=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let o=new Ri;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ri,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=o;e.enqueueRetryable((0,K.Z)(function*(){yield u.promise,yield s(i.currentUser)}))},l=u=>{ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ri)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Pe("string"==typeof i.accessToken),new l8(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Pe(null===e||"string"==typeof e),new $i(e)}}class Wge{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=$i.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class qge{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new Wge(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t($i.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class c8{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Kge{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const i=s=>{null!=s.error&&ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,ie("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?r(s):ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Pe("string"==typeof t.token),this.R=t.token,new c8(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Zge(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class u8{static newId(){const t=62*Math.floor(256/62);let i="";for(;i.length<20;){const r=Zge(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r[s]%62))}return i}}function Ze(n,e){return n<e?-1:n>e?1:0}function Rp(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}function d8(n){return n+"\0"}class Vn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new te(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new te(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new te(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Vn.fromMillis(Date.now())}static fromDate(e){return Vn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Vn(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ze(this.nanoseconds,e.nanoseconds):Ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ke{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ke(e)}static min(){return new ke(new Vn(0,0))}static max(){return new ke(new Vn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Ny{constructor(e,t,i){void 0===t?t=0:t>e.length&&Ae(),void 0===i?i=e.length-t:i>e.length-t&&Ae(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return 0===Ny.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ny?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class kt extends Ny{construct(e,t,i){return new kt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new te(U.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new kt(t)}static emptyPath(){return new kt([])}}const Yge=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Nn extends Ny{construct(e,t,i){return new Nn(e,t,i)}static isValidIdentifier(e){return Yge.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Nn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Nn(["__name__"])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(0===i.length)throw new te(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if("\\"===a){if(r+1===e.length)throw new te(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if("\\"!==l&&"."!==l&&"`"!==l)throw new te(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else"`"===a?(o=!o,r++):"."!==a||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new te(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Nn(t)}static emptyPath(){return new Nn([])}}class we{constructor(e){this.path=e}static fromPath(e){return new we(kt.fromString(e))}static fromName(e){return new we(kt.fromString(e).popFirst(5))}static empty(){return new we(kt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===kt.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return kt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new kt(e.slice()))}}class Np{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function ux(n){return n.fields.find(e=>2===e.kind)}function Rd(n){return n.fields.filter(e=>2!==e.kind)}Np.UNKNOWN_ID=-1;class Nd{constructor(e,t){this.fieldPath=e,this.kind=t}}class xp{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new xp(0,ks.min())}}function h8(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=ke.fromTimestamp(1e9===i?new Vn(t+1,0):new Vn(t,i));return new ks(r,we.empty(),e)}function f8(n){return new ks(n.readTime,n.key,-1)}class ks{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ks(ke.min(),we.empty(),-1)}static max(){return new ks(ke.max(),we.empty(),-1)}}function dx(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=we.comparator(n.documentKey,e.documentKey),0!==t?t:Ze(n.largestBatchId,e.largestBatchId))}const p8="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class g8{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function jc(n){return hx.apply(this,arguments)}function hx(){return hx=(0,K.Z)(function*(n){if(n.code!==U.FAILED_PRECONDITION||n.message!==p8)throw n;ie("LocalStore","Unexpectedly lost primary lease")}),hx.apply(this,arguments)}class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new F((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof F?t:F.resolve(t)}catch(t){return F.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):F.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):F.reject(t)}static resolve(e){return new F((t,i)=>{t(e)})}static reject(e){return new F((t,i)=>{i(e)})}static waitFor(e){return new F((t,i)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&t()},l=>i(l))}),o=!0,s===r&&t()})}static or(e){let t=F.resolve(!1);for(const i of e)t=t.next(r=>r?F.resolve(r):i());return t}static forEach(e,t){const i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new F((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;t(e[u]).next(h=>{o[u]=h,++a,a===s&&i(o)},h=>r(h))}})}static doWhile(e,t){return new F((i,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):i()};s()})}}class ST{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Ri,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new xy(e,t.error)):this.V.resolve()},this.transaction.onerror=i=>{const r=fx(i.target.error);this.V.reject(new xy(e,r))}}static open(e,t,i,r){try{return new ST(t,e.transaction(r,i))}catch(s){throw new xy(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(ie("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new eme(t)}}class zo{constructor(e,t,i){this.name=e,this.version=t,this.p=i,12.2===zo.S((0,E.z$)())&&di("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return ie("SimpleDb","Removing database:",e),xd(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,E.hl)())return!1;if(zo.C())return!0;const e=(0,E.z$)(),t=zo.S(e),i=0<t&&t<10,r=zo.v(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}static v(e){const t=e.match(/Android ([\d.]+)/i),i=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(i)}O(e){var t=this;return(0,K.Z)(function*(){return t.db||(ie("SimpleDb","Opening database:",t.name),t.db=yield new Promise((i,r)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=o=>{i(o.target.result)},s.onblocked=()=>{r(new xy(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;r("VersionError"===a.name?new te(U.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new te(U.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new xy(e,a))},s.onupgradeneeded=o=>{ie("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',o.oldVersion),t.p.N(o.target.result,s.transaction,o.oldVersion,t.version).next(()=>{ie("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=i=>t.B(i)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,i,r){var s=this;return(0,K.Z)(function*(){const o="readonly"===t;let a=0;for(;;){++a;try{s.db=yield s.O(e);const l=ST.open(s.db,e,o?"readonly":"readwrite",i),u=r(l).next(h=>(l.g(),h)).catch(h=>(l.abort(h),F.reject(h))).toPromise();return u.catch(()=>{}),yield l.m,u}catch(l){const u=l,h="FirebaseError"!==u.name&&a<3;if(ie("SimpleDb","Transaction failed with error:",u.message,"Retrying:",h),s.close(),!h)return Promise.reject(u)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Xge{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return xd(this.k.delete())}}class xy extends te{constructor(e,t){super(U.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function $c(n){return"IndexedDbTransactionError"===n.name}class eme{constructor(e){this.store=e}put(e,t){let i;return void 0!==t?(ie("SimpleDb","PUT",this.store.name,e,t),i=this.store.put(t,e)):(ie("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),xd(i)}add(e){return ie("SimpleDb","ADD",this.store.name,e,e),xd(this.store.add(e))}get(e){return xd(this.store.get(e)).next(t=>(void 0===t&&(t=null),ie("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return ie("SimpleDb","DELETE",this.store.name,e),xd(this.store.delete(e))}count(){return ie("SimpleDb","COUNT",this.store.name),xd(this.store.count())}W(e,t){const i=this.options(e,t);if(i.index||"function"!=typeof this.store.getAll){const r=this.cursor(i),s=[];return this.G(r,(o,a)=>{s.push(a)}).next(()=>s)}{const r=this.store.getAll(i.range);return new F((s,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{s(a.target.result)}})}}j(e,t){const i=this.store.getAll(e,null===t?void 0:t);return new F((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}})}H(e,t){ie("SimpleDb","DELETE ALL",this.store.name);const i=this.options(e,t);i.J=!1;const r=this.cursor(i);return this.G(r,(s,o,a)=>a.delete())}Y(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.G(r,t)}Z(e){const t=this.cursor({});return new F((i,r)=>{t.onerror=s=>{const o=fx(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():i()}):i()}})}G(e,t){const i=[];return new F((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const l=new Xge(a),u=t(a.primaryKey,a.value,l);if(u instanceof F){const h=u.catch(g=>(l.done(),F.reject(g)));i.push(h)}l.isDone?r():null===l.$?a.continue():a.continue(l.$)}}).next(()=>F.waitFor(i))}options(e,t){let i;return void 0!==e&&("string"==typeof e?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.J?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function xd(n){return new F((e,t)=>{n.onsuccess=i=>{e(i.target.result)},n.onerror=i=>{const r=fx(i.target.error);t(r)}})}let m8=!1;function fx(n){const e=zo.S((0,E.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new te("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return m8||(m8=!0,setTimeout(()=>{throw i},0)),i}}return n}class tme{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){var t=this;ie("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,K.Z)(function*(){t.task=null;try{ie("IndexBackiller",`Documents written: ${yield t.X.te()}`)}catch(i){$c(i)?ie("IndexBackiller","Ignoring IndexedDB error during index backfill: ",i):yield jc(i)}yield t.ee(6e4)}))}}class nme{constructor(e,t){this.localStore=e,this.persistence=t}te(e=50){var t=this;return(0,K.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",i=>t.ne(i,e))})()}ne(e,t){const i=new Set;let r=t,s=!0;return F.doWhile(()=>!0===s&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!i.has(o))return ie("IndexBackiller",`Processing collection: ${o}`),this.re(e,o,r).next(a=>{r-=a,i.add(o)});s=!1})).next(()=>t-r)}re(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(r,s)).next(a=>(ie("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}ie(e,t){let i=e;return t.changes.forEach((r,s)=>{const o=f8(s);dx(o,i)>0&&(i=o)}),new ks(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}let Fs=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.se(r),this.oe=r=>i.writeSequenceNumber(r))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}return n._e=-1,n})();function Py(n){return null==n}function Oy(n){return 0===n&&1/n==-1/0}function _8(n){return"number"==typeof n&&Number.isInteger(n)&&!Oy(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Tr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=y8(e)),e=ime(n.get(t),e);return y8(e)}function ime(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function y8(n){return n+"\x01\x01"}function Da(n){const e=n.length;if(Pe(e>=2),2===e)return Pe("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),kt.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf("\x01",s);switch((o<0||o>t)&&Ae(),n.charAt(o+1)){case"\x01":const a=n.substring(s,o);let l;0===r.length?l=a:(r+=a,l=r,r=""),i.push(l);break;case"\x10":r+=n.substring(s,o),r+="\0";break;case"\x11":r+=n.substring(s,o+1);break;default:Ae()}s=o+2}return new kt(i)}const v8=["userId","batchId"];function AT(n,e){return[n,Tr(e)]}function b8(n,e,t){return[n,Tr(e),t]}const rme={},sme=["prefixPath","collectionGroup","readTime","documentId"],ome=["prefixPath","collectionGroup","documentId"],ame=["collectionGroup","readTime","prefixPath","documentId"],lme=["canonicalId","targetId"],cme=["targetId","path"],ume=["path","targetId"],dme=["collectionId","parent"],hme=["indexId","uid"],fme=["uid","sequenceNumber"],pme=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],gme=["indexId","uid","orderedDocumentKey"],mme=["userId","collectionPath","documentId"],_me=["userId","collectionPath","largestBatchId"],yme=["userId","collectionGroup","largestBatchId"],E8=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],vme=[...E8,"documentOverlays"],w8=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],T8=w8,bme=[...T8,"indexConfiguration","indexState","indexEntries"];class px extends g8{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function Hi(n,e){const t=Ee(n);return zo.M(t.ae,e)}function I8(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Hc(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function C8(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class En{constructor(e,t){this.comparator=e,this.root=t||cr.EMPTY}insert(e,t){return new En(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,cr.BLACK,null,null))}remove(e){return new En(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(0===i)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(0===r)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new RT(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new RT(this.root,e,this.comparator,!1)}getReverseIterator(){return new RT(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new RT(this.root,e,this.comparator,!0)}}class RT{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class cr{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??cr.RED,this.left=r??cr.EMPTY,this.right=s??cr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new cr(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return cr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return cr.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,cr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,cr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ae();const e=this.left.check();if(e!==this.right.check())throw Ae();return e+(this.isRed()?0:1)}}cr.EMPTY=null,cr.RED=!0,cr.BLACK=!1,cr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ae()}get value(){throw Ae()}get color(){throw Ae()}get left(){throw Ae()}get right(){throw Ae()}copy(e,t,i,r,s){return this}insert(e,t,i){return new cr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class an{constructor(e){this.comparator=e,this.data=new En(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new D8(this.data.getIterator())}getIteratorFrom(e){return new D8(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof an)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(0!==this.comparator(r,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new an(this.comparator);return t.data=e,t}}class D8{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Pp(n){return n.hasNext()?n.getNext():void 0}class ms{constructor(e){this.fields=e,e.sort(Nn.comparator)}static empty(){return new ms([])}unionWith(e){let t=new an(Nn.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new ms(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Rp(this.fields,e.fields,(t,i)=>t.isEqual(i))}}class S8 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ni{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new S8("Invalid base64 string: "+s):s}}(e);return new Ni(t)}static fromUint8Array(e){const t=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new Ni(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ni.EMPTY_BYTE_STRING=new Ni("");const wme=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gc(n){if(Pe(!!n),"string"==typeof n){let e=0;const t=wme.exec(n);if(Pe(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ii(n.seconds),nanos:ii(n.nanos)}}function ii(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Dl(n){return"string"==typeof n?Ni.fromBase64String(n):Ni.fromUint8Array(n)}function NT(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function xT(n){const e=n.mapValue.fields.__previous_value__;return NT(e)?xT(e):e}function My(n){const e=Gc(n.mapValue.fields.__local_write_time__.timestampValue);return new Vn(e.seconds,e.nanos)}class Tme{constructor(e,t,i,r,s,o,a,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class zc{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new zc("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof zc&&e.projectId===this.projectId&&e.database===this.database}}const Wc={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},PT={nullValue:"NULL_VALUE"};function qc(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?NT(n)?4:x8(n)?9007199254740991:10:Ae()}function Sa(n,e){if(n===e)return!0;const t=qc(n);if(t!==qc(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return My(n).isEqual(My(e));case 3:return function(r,s){if("string"==typeof r.timestampValue&&"string"==typeof s.timestampValue&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=Gc(r.timestampValue),a=Gc(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return s=e,Dl(n.bytesValue).isEqual(Dl(s.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return ii(r.geoPointValue.latitude)===ii(s.geoPointValue.latitude)&&ii(r.geoPointValue.longitude)===ii(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return ii(r.integerValue)===ii(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=ii(r.doubleValue),a=ii(s.doubleValue);return o===a?Oy(o)===Oy(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Rp(n.arrayValue.values||[],e.arrayValue.values||[],Sa);case 10:return function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(I8(o)!==I8(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(void 0===a[l]||!Sa(o[l],a[l])))return!1;return!0}(n,e);default:return Ae()}var s}function ky(n,e){return void 0!==(n.values||[]).find(t=>Sa(t,e))}function Kc(n,e){if(n===e)return 0;const t=qc(n),i=qc(e);if(t!==i)return Ze(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ze(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=ii(s.integerValue||s.doubleValue),l=ii(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return A8(n.timestampValue,e.timestampValue);case 4:return A8(My(n),My(e));case 5:return Ze(n.stringValue,e.stringValue);case 6:return function(s,o){const a=Dl(s),l=Dl(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const h=Ze(a[u],l[u]);if(0!==h)return h}return Ze(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ze(ii(s.latitude),ii(o.latitude));return 0!==a?a:Ze(ii(s.longitude),ii(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],l=o.values||[];for(let u=0;u<a.length&&u<l.length;++u){const h=Kc(a[u],l[u]);if(h)return h}return Ze(a.length,l.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Wc.mapValue&&o===Wc.mapValue)return 0;if(s===Wc.mapValue)return 1;if(o===Wc.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let g=0;g<l.length&&g<h.length;++g){const m=Ze(l[g],h[g]);if(0!==m)return m;const y=Kc(a[l[g]],u[h[g]]);if(0!==y)return y}return Ze(l.length,h.length)}(n.mapValue,e.mapValue);default:throw Ae()}}function A8(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Ze(n,e);const t=Gc(n),i=Gc(e),r=Ze(t.seconds,i.seconds);return 0!==r?r:Ze(t.nanos,i.nanos)}function Op(n){return gx(n)}function gx(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const i=Gc(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Dl(n.bytesValue).toBase64():"referenceValue"in n?we.fromName(n.referenceValue).toString():"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=gx(s);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${gx(t.fields[o])}`;return r+"}"}(n.mapValue):Ae()}function Pd(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function mx(n){return!!n&&"integerValue"in n}function Fy(n){return!!n&&"arrayValue"in n}function R8(n){return!!n&&"nullValue"in n}function N8(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function MT(n){return!!n&&"mapValue"in n}function Ly(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Hc(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Ly(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ly(n.arrayValue.values[t]);return e}return Object.assign({},n)}function x8(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function Ime(n){return"nullValue"in n?PT:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Pd(zc.empty(),we.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Ae()}function Cme(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Pd(zc.empty(),we.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Wc:Ae()}function P8(n,e){const t=Kc(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function O8(n,e){const t=Kc(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class ur{constructor(e){this.value=e}static empty(){return new ur({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!MT(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ly(t)}setAll(e){let t=Nn.emptyPath(),i={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=Ly(o):r.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());MT(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Sa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];MT(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Hc(t,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new ur(Ly(this.value))}}function M8(n){const e=[];return Hc(n.fields,(t,i)=>{const r=new Nn([t]);if(MT(i)){const s=M8(i.mapValue).fields;if(0===s.length)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)}),new ms(e)}class xn{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new xn(e,0,ke.min(),ke.min(),ke.min(),ur.empty(),0)}static newFoundDocument(e,t,i,r){return new xn(e,1,t,ke.min(),i,r,0)}static newNoDocument(e,t){return new xn(e,2,t,ke.min(),ke.min(),ur.empty(),0)}static newUnknownDocument(e,t){return new xn(e,3,t,ke.min(),ke.min(),ur.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ke.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ur.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ur.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ke.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof xn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Zc{constructor(e,t){this.position=e,this.inclusive=t}}function k8(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(i=s.field.isKeyField()?we.comparator(we.fromName(o.referenceValue),t.key):Kc(o,t.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function F8(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Sa(n.position[t],e.position[t]))return!1;return!0}class Vy{constructor(e,t="asc"){this.field=e,this.dir=t}}function Dme(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class L8{}class xt extends L8{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,i):new Sme(e,t,i):"array-contains"===t?new Nme(e,i):"in"===t?new H8(e,i):"not-in"===t?new xme(e,i):"array-contains-any"===t?new Pme(e,i):new xt(e,t,i)}static createKeyFieldInFilter(e,t,i){return"in"===t?new Ame(e,i):new Rme(e,i)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Kc(t,this.value)):null!==t&&qc(this.value)===qc(t)&&this.matchesComparison(Kc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class nn extends L8{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new nn(e,t)}matches(e){return Mp(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Mp(n){return"and"===n.op}function _x(n){return"or"===n.op}function yx(n){return V8(n)&&Mp(n)}function V8(n){for(const e of n.filters)if(e instanceof nn)return!1;return!0}function vx(n){if(n instanceof xt)return n.field.canonicalString()+n.op.toString()+Op(n.value);if(yx(n))return n.filters.map(e=>vx(e)).join(",");{const e=n.filters.map(t=>vx(t)).join(",");return`${n.op}(${e})`}}function B8(n,e){return n instanceof xt?(i=n,(r=e)instanceof xt&&i.op===r.op&&i.field.isEqual(r.field)&&Sa(i.value,r.value)):n instanceof nn?function(i,r){return r instanceof nn&&i.op===r.op&&i.filters.length===r.filters.length&&i.filters.reduce((s,o,a)=>s&&B8(o,r.filters[a]),!0)}(n,e):void Ae();var i,r}function U8(n,e){const t=n.filters.concat(e);return nn.create(t,n.op)}function j8(n){return n instanceof xt?`${(t=n).field.canonicalString()} ${t.op} ${Op(t.value)}`:n instanceof nn?function(t){return t.op.toString()+" {"+t.getFilters().map(j8).join(" ,")+"}"}(n):"Filter";var t}class Sme extends xt{constructor(e,t,i){super(e,t,i),this.key=we.fromName(i.referenceValue)}matches(e){const t=we.comparator(e.key,this.key);return this.matchesComparison(t)}}class Ame extends xt{constructor(e,t){super(e,"in",t),this.keys=$8(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Rme extends xt{constructor(e,t){super(e,"not-in",t),this.keys=$8(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function $8(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(i=>we.fromName(i.referenceValue))}class Nme extends xt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Fy(t)&&ky(t.arrayValue,this.value)}}class H8 extends xt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&ky(this.value.arrayValue,t)}}class xme extends xt{constructor(e,t){super(e,"not-in",t)}matches(e){if(ky(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!ky(this.value.arrayValue,t)}}class Pme extends xt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Fy(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>ky(this.value.arrayValue,i))}}class Ome{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}}function bx(n,e=null,t=[],i=[],r=null,s=null,o=null){return new Ome(n,e,t,i,r,s,o)}function Od(n){const e=Ee(n);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>vx(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>{return(s=i).field.canonicalString()+s.dir;var s}).join(","),Py(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Op(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Op(i)).join(",")),e.ce=t}return e.ce}function By(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Dme(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!B8(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!F8(n.startAt,e.startAt)&&F8(n.endAt,e.endAt)}function kT(n){return we.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function FT(n,e){return n.filters.filter(t=>t instanceof xt&&t.field.isEqual(e))}function G8(n,e,t){let i=PT,r=!0;for(const s of FT(n,e)){let o=PT,a=!0;switch(s.op){case"<":case"<=":o=Ime(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=PT}P8({value:i,inclusive:r},{value:o,inclusive:a})<0&&(i=o,r=a)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];P8({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}return{value:i,inclusive:r}}function z8(n,e,t){let i=Wc,r=!0;for(const s of FT(n,e)){let o=Wc,a=!0;switch(s.op){case">=":case">":o=Cme(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Wc}O8({value:i,inclusive:r},{value:o,inclusive:a})>0&&(i=o,r=a)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];O8({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}return{value:i,inclusive:r}}class Sl{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.le=null,this.he=null,this.Pe=null}}function W8(n,e,t,i,r,s,o,a){return new Sl(n,e,t,i,r,s,o,a)}function kp(n){return new Sl(n)}function q8(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function Ex(n){return null!==n.collectionGroup}function Fp(n){const e=Ee(n);if(null===e.le){e.le=[];const t=new Set;for(const s of e.explicitOrderBy)e.le.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new an(Nn.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.le.push(new Vy(s,i))}),t.has(Nn.keyField().canonicalString())||e.le.push(new Vy(Nn.keyField(),i))}return e.le}function Br(n){const e=Ee(n);return e.he||(e.he=function K8(n,e){if("F"===n.limitType)return bx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>new Vy(r.field,"desc"===r.dir?"asc":"desc"));const t=n.endAt?new Zc(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Zc(n.startAt.position,n.startAt.inclusive):null;return bx(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}(e,Fp(n))),e.he}function wx(n,e){const t=n.filters.concat([e]);return new Sl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function LT(n,e,t){return new Sl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Uy(n,e){return By(Br(n),Br(e))&&n.limitType===e.limitType}function Z8(n){return`${Od(Br(n))}|lt:${n.limitType}`}function Lp(n){return`Query(target=${function(t){let i=t.path.canonicalString();return null!==t.collectionGroup&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>j8(r)).join(", ")}]`),Py(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>{return`${(o=r).field.canonicalString()} (${o.dir})`;var o}).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>Op(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>Op(r)).join(",")),`Target(${i})`}(Br(n))}; limitType=${n.limitType})`}function jy(n,e){return e.isFoundDocument()&&function(i,r){const s=r.key.path;return null!==i.collectionGroup?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):we.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(n,e)&&function(i,r){for(const s of Fp(i))if(!s.field.isKeyField()&&null===r.data.field(s.field))return!1;return!0}(n,e)&&function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0}(n,e)&&(r=e,!((i=n).startAt&&!function(o,a,l){const u=k8(o,a,l);return o.inclusive?u<=0:u<0}(i.startAt,Fp(i),r)||i.endAt&&!function(o,a,l){const u=k8(o,a,l);return o.inclusive?u>=0:u>0}(i.endAt,Fp(i),r)));var i,r}function Y8(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Q8(n){return(e,t)=>{let i=!1;for(const r of Fp(n)){const s=Mme(r,e,t);if(0!==s)return s;i=i||r.field.isKeyField()}return 0}}function Mme(n,e,t){const i=n.field.isKeyField()?we.comparator(e.key,t.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return null!==l&&null!==u?Kc(l,u):Ae()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ae()}}class Al{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0!==i)for(const[r,s]of i)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(void 0===r)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0===i)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return 1===i.length?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Hc(this.inner,(t,i)=>{for(const[r,s]of i)e(r,s)})}isEmpty(){return C8(this.inner)}size(){return this.innerSize}}const kme=new En(we.comparator);function _s(){return kme}const J8=new En(we.comparator);function $y(...n){let e=J8;for(const t of n)e=e.insert(t.key,t);return e}function X8(n){let e=J8;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Aa(){return Hy()}function e5(){return Hy()}function Hy(){return new Al(n=>n.toString(),(n,e)=>n.isEqual(e))}const Fme=new En(we.comparator),Lme=new an(we.comparator);function ct(...n){let e=Lme;for(const t of n)e=e.add(t);return e}const Vme=new an(Ze);function Tx(){return Vme}function t5(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Oy(e)?"-0":e}}function n5(n){return{integerValue:""+n}}function i5(n,e){return _8(e)?n5(e):t5(n,e)}class VT{constructor(){this._=void 0}}function Bme(n,e,t){return n instanceof Vp?function(r,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&NT(s)&&(s=xT(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Md?s5(n,e):n instanceof kd?o5(n,e):function(r,s){const o=r5(r,s),a=a5(o)+a5(r.Ie);return mx(o)&&mx(r.Ie)?n5(a):t5(r.serializer,a)}(n,e)}function Ume(n,e,t){return n instanceof Md?s5(n,e):n instanceof kd?o5(n,e):t}function r5(n,e){return n instanceof Bp?mx(i=e)||(s=i)&&"doubleValue"in s?e:{integerValue:0}:null;var i,s}class Vp extends VT{}class Md extends VT{constructor(e){super(),this.elements=e}}function s5(n,e){const t=l5(e);for(const i of n.elements)t.some(r=>Sa(r,i))||t.push(i);return{arrayValue:{values:t}}}class kd extends VT{constructor(e){super(),this.elements=e}}function o5(n,e){let t=l5(e);for(const i of n.elements)t=t.filter(r=>!Sa(r,i));return{arrayValue:{values:t}}}class Bp extends VT{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function a5(n){return ii(n.integerValue||n.doubleValue)}function l5(n){return Fy(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Gy{constructor(e,t){this.field=e,this.transform=t}}class $me{constructor(e,t){this.version=e,this.transformResults=t}}class Bn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Bn}static exists(e){return new Bn(void 0,e)}static updateTime(e){return new Bn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function BT(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class UT{}function c5(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new jp(n.key,Bn.none()):new Up(n.key,n.data,Bn.none());{const t=n.data,i=ur.empty();let r=new an(Nn.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);null===o&&s.length>1&&(s=s.popLast(),o=t.field(s)),null===o?i.delete(s):i.set(s,o),r=r.add(s)}return new Rl(n.key,i,new ms(r.toArray()),Bn.none())}}function Hme(n,e,t){n instanceof Up?function(r,s,o){const a=r.value.clone(),l=h5(r.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Rl?function(r,s,o){if(!BT(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=h5(r.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(d5(r)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function zy(n,e,t,i){return n instanceof Up?function(s,o,a,l){if(!BT(s.precondition,o))return a;const u=s.value.clone(),h=f5(s.fieldTransforms,l,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,i):n instanceof Rl?function(s,o,a,l){if(!BT(s.precondition,o))return a;const u=f5(s.fieldTransforms,l,o),h=o.data;return h.setAll(d5(s)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null===a?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(n,e,t,i):(a=t,BT(n.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a);var o,a}function Gme(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=r5(i.transform,r||null);null!=s&&(null===t&&(t=ur.empty()),t.set(i.field,s))}return t||null}function u5(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(i=n.fieldTransforms)&&void 0===r||i&&r&&Rp(i,r,(s,o)=>function jme(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(i=n.transform)instanceof Md&&r instanceof Md||i instanceof kd&&r instanceof kd?Rp(i.elements,r.elements,Sa):i instanceof Bp&&r instanceof Bp?Sa(i.Ie,r.Ie):i instanceof Vp&&r instanceof Vp);var i,r}(s,o))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var i,r}class Up extends UT{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Rl extends UT{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function d5(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function h5(n,e,t){const i=new Map;Pe(n.length===t.length);for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Ume(o,a,t[r]))}return i}function f5(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,Bme(s,o,e))}return i}class jp extends UT{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ix extends UT{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Cx{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&Hme(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=zy(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=zy(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=e5();return this.mutations.forEach(r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const l=c5(o,a);null!==l&&i.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(ke.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ct())}isEqual(e){return this.batchId===e.batchId&&Rp(this.mutations,e.mutations,(t,i)=>u5(t,i))&&Rp(this.baseMutations,e.baseMutations,(t,i)=>u5(t,i))}}class Dx{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Pe(e.mutations.length===i.length);let r=Fme;const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new Dx(e,t,i,r)}}class Sx{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Wme{constructor(e,t){this.count=e,this.unchangedNames=t}}var yi,Ft;function p5(n){switch(n){default:return Ae();case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0}}function g5(n){if(void 0===n)return di("GRPC error has no .code"),U.UNKNOWN;switch(n){case yi.OK:return U.OK;case yi.CANCELLED:return U.CANCELLED;case yi.UNKNOWN:return U.UNKNOWN;case yi.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case yi.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case yi.INTERNAL:return U.INTERNAL;case yi.UNAVAILABLE:return U.UNAVAILABLE;case yi.UNAUTHENTICATED:return U.UNAUTHENTICATED;case yi.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case yi.NOT_FOUND:return U.NOT_FOUND;case yi.ALREADY_EXISTS:return U.ALREADY_EXISTS;case yi.PERMISSION_DENIED:return U.PERMISSION_DENIED;case yi.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case yi.ABORTED:return U.ABORTED;case yi.OUT_OF_RANGE:return U.OUT_OF_RANGE;case yi.UNIMPLEMENTED:return U.UNIMPLEMENTED;case yi.DATA_LOSS:return U.DATA_LOSS;default:return Ae()}}(Ft=yi||(yi={}))[Ft.OK=0]="OK",Ft[Ft.CANCELLED=1]="CANCELLED",Ft[Ft.UNKNOWN=2]="UNKNOWN",Ft[Ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ft[Ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ft[Ft.NOT_FOUND=5]="NOT_FOUND",Ft[Ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ft[Ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ft[Ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ft[Ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ft[Ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ft[Ft.ABORTED=10]="ABORTED",Ft[Ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ft[Ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ft[Ft.INTERNAL=13]="INTERNAL",Ft[Ft.UNAVAILABLE=14]="UNAVAILABLE",Ft[Ft.DATA_LOSS=15]="DATA_LOSS";function m5(){return new TextEncoder}const qme=new Dp([4294967295,4294967295],0);function _5(n){const e=m5().encode(n),t=new Uge;return t.update(e),new Uint8Array(t.digest())}function y5(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Dp([t,i],0),new Dp([r,s],0)]}class Ax{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Wy(`Invalid padding: ${t}`);if(i<0)throw new Wy(`Invalid hash count: ${i}`);if(e.length>0&&0===this.hashCount)throw new Wy(`Invalid hash count: ${i}`);if(0===e.length&&0!==t)throw new Wy(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=Dp.fromNumber(this.Te)}de(e,t,i){let r=e.add(t.multiply(Dp.fromNumber(i)));return 1===r.compare(qme)&&(r=new Dp([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=_5(e),[i,r]=y5(t);for(let s=0;s<this.hashCount;s++){const o=this.de(i,r,s);if(!this.Ae(o))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Ax(s,r,t);return i.forEach(a=>o.insert(a)),o}insert(e){if(0===this.Te)return;const t=_5(e),[i,r]=y5(t);for(let s=0;s<this.hashCount;s++){const o=this.de(i,r,s);this.Re(o)}}Re(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class Wy extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class qy{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,Ky.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new qy(ke.min(),r,new En(Ze),_s(),ct())}}class Ky{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Ky(i,t,ct(),ct(),ct())}}class $T{constructor(e,t,i,r){this.Ve=e,this.removedTargetIds=t,this.key=i,this.me=r}}class v5{constructor(e,t){this.targetId=e,this.fe=t}}class b5{constructor(e,t,i=Ni.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class E5{constructor(){this.ge=0,this.pe=T5(),this.ye=Ni.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=ct(),t=ct(),i=ct();return this.pe.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Ae()}}),new Ky(this.ye,this.we,e,t,i)}Fe(){this.Se=!1,this.pe=T5()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,Pe(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class Kme{constructor(e){this.Le=e,this.ke=new Map,this.qe=_s(),this.Qe=w5(),this.Ke=new En(Ze)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,t=>{const i=this.ze(t);switch(e.state){case 0:this.je(t)&&i.Ce(e.resumeToken);break;case 1:i.Ne(),i.be||i.Fe(),i.Ce(e.resumeToken);break;case 2:i.Ne(),i.be||this.removeTarget(t);break;case 3:this.je(t)&&(i.Be(),i.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),i.Ce(e.resumeToken));break;default:Ae()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((i,r)=>{this.je(r)&&t(r)})}Je(e){const t=e.targetId,i=e.fe.count,r=this.Ye(t);if(r){const s=r.target;if(kT(s))if(0===i){const o=new we(s.path);this.We(t,o,xn.newNoDocument(o,ke.min()))}else Pe(1===i);else{const o=this.Ze(t);if(o!==i){const a=this.Xe(e),l=a?this.et(a,e,o):1;0!==l&&(this.He(t),this.Ke=this.Ke.insert(t,2===l?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t;let o,a;try{o=Dl(i).toUint8Array()}catch(l){if(l instanceof S8)return gs("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Ax(o,r,s)}catch(l){return gs(l instanceof Wy?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return 0===a.Te?null:a}et(e,t,i){return t.fe.count===i-this.rt(e,t.targetId)?0:2}rt(e,t){const i=this.Le.getRemoteKeysForTarget(t);let r=0;return i.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(t,s,null),r++)}),r}it(e){const t=new Map;this.ke.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&kT(a.target)){const l=new we(a.target.path);null!==this.qe.get(l)||this.st(o,l)||this.We(o,l,xn.newNoDocument(l,e))}s.De&&(t.set(o,s.ve()),s.Fe())}});let i=ct();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Ye(l);return!u||"TargetPurposeLimboResolution"===u.purpose||(a=!1,!1)}),a&&(i=i.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));const r=new qy(e,t,this.Ke,this.qe,i);return this.qe=_s(),this.Qe=w5(),this.Ke=new En(Ze),r}Ue(e,t){if(!this.je(e))return;const i=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,i),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,i){if(!this.je(e))return;const r=this.ze(e);this.st(e,t)?r.Me(t,1):r.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),i&&(this.qe=this.qe.insert(t,i))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new E5,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new an(Ze),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=null!==this.Ye(e);return t||ie("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new E5),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function w5(){return new En(we.comparator)}function T5(){return new En(we.comparator)}const Zme={asc:"ASCENDING",desc:"DESCENDING"},Yme={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Qme={and:"AND",or:"OR"};class Jme{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Rx(n,e){return n.useProto3Json||Py(e)?e:{value:e}}function $p(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function I5(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Xme(n,e){return $p(n,e.toTimestamp())}function hi(n){return Pe(!!n),ke.fromTimestamp(function(t){const i=Gc(t);return new Vn(i.seconds,i.nanos)}(n))}function Nx(n,e){return(i=n,new kt(["projects",i.projectId,"databases",i.database])).child("documents").child(e).canonicalString();var i}function C5(n){const e=kt.fromString(n);return Pe(M5(e)),e}function Zy(n,e){return Nx(n.databaseId,e.path)}function Ra(n,e){const t=C5(e);if(t.get(1)!==n.databaseId.projectId)throw new te(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new te(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new we(S5(t))}function xx(n,e){return Nx(n.databaseId,e)}function D5(n){const e=C5(n);return 4===e.length?kt.emptyPath():S5(e)}function Yy(n){return new kt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function S5(n){return Pe(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function A5(n,e,t){return{name:Zy(n,e),fields:t.value.mapValue.fields}}function R5(n,e,t){const i=Ra(n,e.name),r=hi(e.updateTime),s=e.createTime?hi(e.createTime):ke.min(),o=new ur({mapValue:{fields:e.fields}}),a=xn.newFoundDocument(i,r,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function Qy(n,e){let t;if(e instanceof Up)t={update:A5(n,e.key,e.value)};else if(e instanceof jp)t={delete:Zy(n,e.key)};else if(e instanceof Rl)t={update:A5(n,e.key,e.data),updateMask:a_e(e.fieldMask)};else{if(!(e instanceof Ix))return Ae();t={verify:Zy(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,o){const a=o.transform;if(a instanceof Vp)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Md)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof kd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Bp)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw Ae()}(0,i))),e.precondition.isNone||(t.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:Xme(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:Ae()),t;var s}function Px(n,e){const t=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?Bn.updateTime(hi(s.updateTime)):void 0!==s.exists?Bn.exists(s.exists):Bn.none():Bn.none(),i=e.updateTransforms?e.updateTransforms.map(r=>function(o,a){let l=null;"setToServerValue"in a?(Pe("REQUEST_TIME"===a.setToServerValue),l=new Vp):"appendMissingElements"in a?l=new Md(a.appendMissingElements.values||[]):"removeAllFromArray"in a?l=new kd(a.removeAllFromArray.values||[]):"increment"in a?l=new Bp(o,a.increment):Ae();const u=Nn.fromServerFormat(a.fieldPath);return new Gy(u,l)}(n,r)):[];var s;if(e.update){const r=Ra(n,e.update.name),s=new ur({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new ms((e.updateMask.fieldPaths||[]).map(h=>Nn.fromServerFormat(h)));return new Rl(r,s,o,t,i)}return new Up(r,s,t,i)}if(e.delete){const r=Ra(n,e.delete);return new jp(r,t)}if(e.verify){const r=Ra(n,e.verify);return new Ix(r,t)}return Ae()}function N5(n,e){return{documents:[xx(n,e.path)]}}function Ox(n,e){const t={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(t.parent=xx(n,i),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=xx(n,i.popLast()),t.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(l){if(0!==l.length)return O5(nn.create(l,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const s=function(l){if(0!==l.length)return l.map(u=>{return{field:Yc((g=u).field),direction:r_e(g.dir)};var g})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const o=Rx(n,e.limit);return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(l=e.startAt).inclusive,values:l.position}),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),t;var l}function x5(n){let e=D5(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Pe(1===i);const h=t.from[0];h.allDescendants?r=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=function(g){const m=P5(g);return m instanceof nn&&yx(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(m=>{return new Vy(Hp((b=m).field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction));var b}));let a=null;t.limit&&(a=function(g){let m;return m="object"==typeof g?g.value:g,Py(m)?null:m}(t.limit));let l=null;var g;t.startAt&&(l=new Zc((g=t.startAt).values||[],!!g.before));let u=null;return t.endAt&&(u=function(g){return new Zc(g.values||[],!g.before)}(t.endAt)),W8(e,r,o,s,a,"F",l,u)}function P5(n){return void 0!==n.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Hp(t.unaryFilter.field);return xt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Hp(t.unaryFilter.field);return xt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Hp(t.unaryFilter.field);return xt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Hp(t.unaryFilter.field);return xt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Ae()}}(n):void 0!==n.fieldFilter?xt.create(Hp((t=n).fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ae()}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==n.compositeFilter?function(t){return nn.create(t.compositeFilter.filters.map(i=>P5(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Ae()}}(t.compositeFilter.op))}(n):Ae();var t}function r_e(n){return Zme[n]}function s_e(n){return Yme[n]}function o_e(n){return Qme[n]}function Yc(n){return{fieldPath:n.canonicalString()}}function Hp(n){return Nn.fromServerFormat(n.fieldPath)}function O5(n){return n instanceof xt?function(t){if("=="===t.op){if(N8(t.value))return{unaryFilter:{field:Yc(t.field),op:"IS_NAN"}};if(R8(t.value))return{unaryFilter:{field:Yc(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(N8(t.value))return{unaryFilter:{field:Yc(t.field),op:"IS_NOT_NAN"}};if(R8(t.value))return{unaryFilter:{field:Yc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yc(t.field),op:s_e(t.op),value:t.value}}}(n):n instanceof nn?function(t){const i=t.getFilters().map(r=>O5(r));return 1===i.length?i[0]:{compositeFilter:{op:o_e(t.op),filters:i}}}(n):Ae()}function a_e(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function M5(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class Nl{constructor(e,t,i,r,s=ke.min(),o=ke.min(),a=Ni.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Nl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Nl(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Nl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Nl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class k5{constructor(e){this.ut=e}}function F5(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:HT(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document={name:Zy(s=n.ut,(o=e).key),fields:o.data.value.mapValue.fields,updateTime:$p(s,o.version.toTimestamp()),createTime:$p(s,o.createTime.toTimestamp())};else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Fd(e.version)};else{if(!e.isUnknownDocument())return Ae();i.unknownDocument={path:t.path.toArray(),version:Fd(e.version)}}var s,o;return i}function HT(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Fd(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ld(n){const e=new Vn(n.seconds,n.nanoseconds);return ke.fromTimestamp(e)}function Vd(n,e){const t=(e.baseMutations||[]).map(s=>Px(n.ut,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const i=e.mutations.map(s=>Px(n.ut,s)),r=Vn.fromMillis(e.localWriteTimeMs);return new Cx(e.batchId,r,t,i)}function Jy(n){const e=Ld(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Ld(n.lastLimboFreeSnapshotVersion):ke.min();let i;return i=void 0!==n.query.documents?(Pe(1===(s=n.query).documents.length),Br(kp(D5(s.documents[0])))):function(s){return Br(x5(s))}(n.query),new Nl(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ni.fromBase64String(n.resumeToken));var s}function L5(n,e){const t=Fd(e.snapshotVersion),i=Fd(e.lastLimboFreeSnapshotVersion);let r;r=kT(e.target)?N5(n.ut,e.target):Ox(n.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Od(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function Mx(n){const e=x5({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?LT(e,e.limit,"L"):e}function kx(n,e){return new Sx(e.largestBatchId,Px(n.ut,e.overlayMutation))}function V5(n,e){const t=e.path.lastSegment();return[n,Tr(e.path.popLast()),t]}function B5(n,e,t,i){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Fd(i.readTime),documentKey:Tr(i.documentKey.path),largestBatchId:i.largestBatchId}}class c_e{getBundleMetadata(e,t){return U5(e).get(t).next(i=>{if(i)return{id:(s=i).bundleId,createTime:Ld(s.createTime),version:s.version};var s})}saveBundleMetadata(e,t){return U5(e).put({bundleId:(r=t).id,createTime:Fd(hi(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return j5(e).get(t).next(i=>{if(i)return{name:(s=i).name,query:Mx(s.bundledQuery),readTime:Ld(s.readTime)};var s})}saveNamedQuery(e,t){return j5(e).put({name:(r=t).name,readTime:Fd(hi(r.readTime)),bundledQuery:r.bundledQuery});var r}}function U5(n){return Hi(n,"bundles")}function j5(n){return Hi(n,"namedQueries")}class GT{constructor(e,t){this.serializer=e,this.userId=t}static ct(e,t){return new GT(e,t.uid||"")}getOverlay(e,t){return Xy(e).get(V5(this.userId,t)).next(i=>i?kx(this.serializer,i):null)}getOverlays(e,t){const i=Aa();return F.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){const r=[];return i.forEach((s,o)=>{const a=new Sx(t,o);r.push(this.lt(e,a))}),F.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach(o=>r.add(Tr(o.getCollectionPath())));const s=[];return r.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Xy(e).H("collectionPathOverlayIndex",a))}),F.waitFor(s)}getOverlaysForCollection(e,t,i){const r=Aa(),s=Tr(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Xy(e).W("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const u=kx(this.serializer,l);r.set(u.getKey(),u)}return r})}getOverlaysForCollectionGroup(e,t,i,r){const s=Aa();let o;const a=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Xy(e).Y({index:"collectionGroupOverlayIndex",range:a},(l,u,h)=>{const g=kx(this.serializer,u);s.size()<r||g.largestBatchId===o?(s.set(g.getKey(),g),o=g.largestBatchId):h.done()}).next(()=>s)}lt(e,t){return Xy(e).put(function(r,s,o){const[a,l,u]=V5(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Qy(r.ut,o.mutation)}}(this.serializer,this.userId,t))}}function Xy(n){return Hi(n,"documentOverlays")}class Bd{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(ii(e.integerValue));else if("doubleValue"in e){const i=ii(e.doubleValue);isNaN(i)?this.Tt(t,13):(this.Tt(t,15),Oy(i)?t.Et(0):t.Et(i))}else if("timestampValue"in e){const i=e.timestampValue;this.Tt(t,20),"string"==typeof i?t.dt(i):(t.dt(`${i.seconds||""}`),t.Et(i.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(Dl(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Tt(t,45),t.Et(i.latitude||0),t.Et(i.longitude||0)}else"mapValue"in e?x8(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):Ae()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const i=e.fields||{};this.Tt(t,55);for(const r of Object.keys(i))this.At(r,t),this.Pt(i[r],t)}yt(e,t){const i=e.values||[];this.Tt(t,50);for(const r of i)this.Pt(r,t)}ft(e,t){this.Tt(t,37),we.fromName(e).path.forEach(i=>{this.Tt(t,60),this.wt(i,t)})}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}function u_e(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function $5(n){const e=64-function(i){let r=0;for(let s=0;s<8;++s){const o=u_e(255&i[s]);if(r+=o,8!==o)break}return r}(n);return Math.ceil(e/8)}Bd.St=new Bd;class d_e{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Dt(i.value),i=t.next();this.Ct()}vt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ft(i.value),i=t.next();this.Mt()}xt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Dt(i);else if(i<2048)this.Dt(960|i>>>6),this.Dt(128|63&i);else if(t<"\ud800"||"\udbff"<t)this.Dt(480|i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i);else{const r=t.codePointAt(0);this.Dt(240|r>>>18),this.Dt(128|63&r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r)}}this.Ct()}Ot(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ft(i);else if(i<2048)this.Ft(960|i>>>6),this.Ft(128|63&i);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i);else{const r=t.codePointAt(0);this.Ft(240|r>>>18),this.Ft(128|63&r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r)}}this.Mt()}Nt(e){const t=this.Bt(e),i=$5(t);this.Lt(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}kt(e){const t=this.Bt(e),i=$5(t);this.Lt(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),i=0!=(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Dt(e){const t=255&e;0===t?(this.Qt(0),this.Qt(255)):255===t?(this.Qt(255),this.Qt(0)):this.Qt(t)}Ft(e){const t=255&e;0===t?(this.$t(0),this.$t(255)):255===t?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class h_e{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class f_e{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class ev{constructor(){this.Wt=new d_e,this.Gt=new h_e(this.Wt),this.zt=new f_e(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return 0===e?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class Ud{constructor(e,t,i,r){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=r}Ht(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new Ud(this.indexId,this.documentKey,this.arrayValue,i)}}function Qc(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=H5(n.arrayValue,e.arrayValue),0!==t?t:(t=H5(n.directionalValue,e.directionalValue),0!==t?t:we.comparator(n.documentKey,e.documentKey)))}function H5(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(0!==i)return i}return n.length-e.length}class G5{constructor(e){this.Jt=new an((t,i)=>Nn.comparator(t.field,i.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const i=t;i.isInequality()?this.Jt=this.Jt.add(i):this.Zt.push(i)}}get Xt(){return this.Jt.size>1}en(e){if(Pe(e.collectionGroup===this.collectionId),this.Xt)return!1;const t=ux(e);if(void 0!==t&&!this.tn(t))return!1;const i=Rd(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.tn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.Jt.size>0){const a=this.Jt.getIterator().getNext();if(!r.has(a.field.canonicalString())){const l=i[s];if(!this.nn(a,l)||!this.rn(this.Yt[o++],l))return!1}++s}for(;s<i.length;++s)if(o>=this.Yt.length||!this.rn(this.Yt[o++],i[s]))return!1;return!0}sn(){if(this.Xt)return null;let e=new an(Nn.comparator);const t=[];for(const i of this.Zt)if(!i.field.isKeyField())if("array-contains"===i.op||"array-contains-any"===i.op)t.push(new Nd(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Nd(i.field,0))}for(const i of this.Yt)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Nd(i.field,"asc"===i.dir?0:1)));return new Np(Np.UNKNOWN_ID,this.collectionId,t,xp.empty())}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function z5(n){var e,t;if(Pe(n instanceof xt||n instanceof nn),n instanceof xt){if(n instanceof H8){const r=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>xt.create(n.field,"==",s)))||[];return nn.create(r,"or")}return n}const i=n.filters.map(r=>z5(r));return nn.create(i,n.op)}function p_e(n){if(0===n.getFilters().length)return[];const e=Vx(z5(n));return Pe(W5(e)),Fx(e)||Lx(e)?[e]:e.getFilters()}function Fx(n){return n instanceof xt}function Lx(n){return n instanceof nn&&yx(n)}function W5(n){return Fx(n)||Lx(n)||function(t){if(t instanceof nn&&_x(t)){for(const i of t.getFilters())if(!Fx(i)&&!Lx(i))return!1;return!0}return!1}(n)}function Vx(n){if(Pe(n instanceof xt||n instanceof nn),n instanceof xt)return n;if(1===n.filters.length)return Vx(n.filters[0]);const e=n.filters.map(i=>Vx(i));let t=nn.create(e,n.op);return t=zT(t),W5(t)?t:(Pe(t instanceof nn),Pe(Mp(t)),Pe(t.filters.length>1),t.filters.reduce((i,r)=>Bx(i,r)))}function Bx(n,e){let t;return Pe(n instanceof xt||n instanceof nn),Pe(e instanceof xt||e instanceof nn),t=n instanceof xt?e instanceof xt?nn.create([n,e],"and"):q5(n,e):e instanceof xt?q5(e,n):function(r,s){if(Pe(r.filters.length>0&&s.filters.length>0),Mp(r)&&Mp(s))return U8(r,s.getFilters());const o=_x(r)?r:s,a=_x(r)?s:r,l=o.filters.map(u=>Bx(u,a));return nn.create(l,"or")}(n,e),zT(t)}function q5(n,e){if(Mp(e))return U8(e,n.getFilters());{const t=e.filters.map(i=>Bx(n,i));return nn.create(t,"or")}}function zT(n){if(Pe(n instanceof xt||n instanceof nn),n instanceof xt)return n;const e=n.getFilters();if(1===e.length)return zT(e[0]);if(V8(n))return n;const t=e.map(r=>zT(r)),i=[];return t.forEach(r=>{r instanceof xt?i.push(r):r instanceof nn&&(r.op===n.op?i.push(...r.filters):i.push(r))}),1===i.length?i[0]:nn.create(i,n.op)}class g_e{constructor(){this.on=new Ux}addToCollectionParentIndex(e,t){return this.on.add(t),F.resolve()}getCollectionParents(e,t){return F.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return F.resolve()}deleteFieldIndex(e,t){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,t){return F.resolve()}getDocumentsMatchingTarget(e,t){return F.resolve(null)}getIndexType(e,t){return F.resolve(0)}getFieldIndexes(e,t){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,t){return F.resolve(ks.min())}getMinOffsetFromCollectionGroup(e,t){return F.resolve(ks.min())}updateCollectionGroup(e,t,i){return F.resolve()}updateIndexEntries(e,t){return F.resolve()}}class Ux{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new an(kt.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new an(kt.comparator)).toArray()}}const WT=new Uint8Array(0);class m_e{constructor(e,t){this.user=e,this.databaseId=t,this._n=new Ux,this.an=new Al(i=>Od(i),(i,r)=>By(i,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this._n.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this._n.add(t)});const s={collectionId:i,parent:Tr(r)};return K5(e).put(s)}return F.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[d8(t),""],!1,!0);return K5(e).W(r).next(s=>{for(const o of s){if(o.collectionId!==t)break;i.push(Da(o.parent))}return i})}addFieldIndex(e,t){const i=tv(e),r={indexId:(a=t).indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])};var a;delete r.indexId;const s=i.add(r);if(t.indexState){const o=zp(e);return s.next(a=>{o.put(B5(a,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const i=tv(e),r=zp(e),s=Gp(e);return i.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=tv(e),i=Gp(e),r=zp(e);return t.H().next(()=>i.H()).next(()=>r.H())}createTargetIndexes(e,t){return F.forEach(this.un(t),i=>this.getIndexType(e,i).next(r=>{if(0===r||1===r){const s=new G5(i).sn();if(null!=s)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const i=Gp(e);let r=!0;const s=new Map;return F.forEach(this.un(t),o=>this.cn(e,o).next(a=>{r&&(r=!!a),s.set(o,a)})).next(()=>{if(r){let o=ct();const a=[];return F.forEach(s,(l,u)=>{var M;ie("IndexedDbIndexManager",`Using index ${M=l,`id=${M.indexId}|cg=${M.collectionGroup}|f=${M.fields.map(L=>`${L.fieldPath}:${L.kind}`).join(",")}`} to execute ${Od(t)}`);const h=function(M,L){const Y=ux(L);if(void 0===Y)return null;for(const pe of FT(M,Y.fieldPath))switch(pe.op){case"array-contains-any":return pe.value.arrayValue.values||[];case"array-contains":return[pe.value]}return null}(u,l),g=function(M,L){const Y=new Map;for(const pe of Rd(L))for(const Oe of FT(M,pe.fieldPath))switch(Oe.op){case"==":case"in":Y.set(pe.fieldPath.canonicalString(),Oe.value);break;case"not-in":case"!=":return Y.set(pe.fieldPath.canonicalString(),Oe.value),Array.from(Y.values())}return null}(u,l),m=function(M,L){const Y=[];let pe=!0;for(const Oe of Rd(L)){const Ge=0===Oe.kind?G8(M,Oe.fieldPath,M.startAt):z8(M,Oe.fieldPath,M.startAt);Y.push(Ge.value),pe&&(pe=Ge.inclusive)}return new Zc(Y,pe)}(u,l),y=function(M,L){const Y=[];let pe=!0;for(const Oe of Rd(L)){const Ge=0===Oe.kind?z8(M,Oe.fieldPath,M.endAt):G8(M,Oe.fieldPath,M.endAt);Y.push(Ge.value),pe&&(pe=Ge.inclusive)}return new Zc(Y,pe)}(u,l),b=this.ln(l,u,m),w=this.ln(l,u,y),T=this.hn(l,u,g),P=this.Pn(l.indexId,h,b,m.inclusive,w,y.inclusive,T);return F.forEach(P,S=>i.j(S,t.limit).next(M=>{M.forEach(L=>{const Y=we.fromSegments(L.documentKey);o.has(Y)||(o=o.add(Y),a.push(Y))})}))}).next(()=>a)}return F.resolve(null)})}un(e){let t=this.an.get(e);return t||(t=0===e.filters.length?[e]:p_e(nn.create(e.filters,"and")).map(i=>bx(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,t),t)}Pn(e,t,i,r,s,o,a){const l=(null!=t?t.length:1)*Math.max(i.length,s.length),u=l/(null!=t?t.length:1),h=[];for(let g=0;g<l;++g){const m=t?this.In(t[g/u]):WT,y=this.Tn(e,m,i[g%u],r),b=this.En(e,m,s[g%u],o),w=a.map(T=>this.Tn(e,m,T,!0));h.push(...this.createRange(y,b,w))}return h}Tn(e,t,i,r){const s=new Ud(e,we.empty(),t,i);return r?s:s.Ht()}En(e,t,i,r){const s=new Ud(e,we.empty(),t,i);return r?s.Ht():s}cn(e,t){const i=new G5(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let o=null;for(const a of s)i.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let i=2;const r=this.un(t);return F.forEach(r,s=>this.cn(e,s).next(o=>{o?0!==i&&o.fields.length<function(l){let u=new an(Nn.comparator),h=!1;for(const g of l.filters)for(const m of g.getFlattenedFilters())m.field.isKeyField()||("array-contains"===m.op||"array-contains-any"===m.op?h=!0:u=u.add(m.field));for(const g of l.orderBy)g.field.isKeyField()||(u=u.add(g.field));return u.size+(h?1:0)}(s)&&(i=1):i=0})).next(()=>null!==t.limit&&r.length>1&&2===i?1:i)}dn(e,t){const i=new ev;for(const r of Rd(e)){const s=t.data.field(r.fieldPath);if(null==s)return null;const o=i.jt(r.kind);Bd.St.ht(s,o)}return i.Ut()}In(e){const t=new ev;return Bd.St.ht(e,t.jt(0)),t.Ut()}An(e,t){const i=new ev;return Bd.St.ht(Pd(this.databaseId,t),i.jt(function(s){const o=Rd(s);return 0===o.length?0:o[o.length-1].kind}(e))),i.Ut()}hn(e,t,i){if(null===i)return[];let r=[];r.push(new ev);let s=0;for(const o of Rd(e)){const a=i[s++];for(const l of r)if(this.Rn(t,o.fieldPath)&&Fy(a))r=this.Vn(r,o,a);else{const u=l.jt(o.kind);Bd.St.ht(a,u)}}return this.mn(r)}ln(e,t,i){return this.hn(e,t,i.position)}mn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].Ut();return t}Vn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const a of r){const l=new ev;l.seed(a.Ut()),Bd.St.ht(o,l.jt(t.kind)),s.push(l)}return s}Rn(e,t){return!!e.filters.find(i=>i instanceof xt&&i.field.isEqual(t)&&("in"===i.op||"not-in"===i.op))}getFieldIndexes(e,t){const i=tv(e),r=zp(e);return(t?i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):i.W()).next(s=>{const o=[];return F.forEach(s,a=>r.get([a.indexId,this.uid]).next(l=>{o.push(function(h,g){const m=g?new xp(g.sequenceNumber,new ks(Ld(g.readTime),new we(Da(g.documentKey)),g.largestBatchId)):xp.empty(),y=h.fields.map(([b,w])=>new Nd(Nn.fromServerFormat(b),w));return new Np(h.indexId,h.collectionGroup,y,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return 0!==s?s:Ze(i.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){const r=tv(e),s=zp(e);return this.fn(e).next(o=>r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>F.forEach(a,l=>s.put(B5(l.indexId,this.user,o,i)))))}updateIndexEntries(e,t){const i=new Map;return F.forEach(t,(r,s)=>{const o=i.get(r.collectionGroup);return(o?F.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(a=>(i.set(r.collectionGroup,a),F.forEach(a,l=>this.gn(e,r,l).next(u=>{const h=this.pn(s,l);return u.isEqual(h)?F.resolve():this.yn(e,s,l,u,h)}))))})}wn(e,t,i,r){return Gp(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.An(i,t.key),documentKey:t.key.path.toArray()})}Sn(e,t,i,r){return Gp(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.An(i,t.key),t.key.path.toArray()])}gn(e,t,i){const r=Gp(e);let s=new an(Qc);return r.Y({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.An(i,t)])},(o,a)=>{s=s.add(new Ud(i.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}pn(e,t){let i=new an(Qc);const r=this.dn(t,e);if(null==r)return i;const s=ux(t);if(null!=s){const o=e.data.field(s.fieldPath);if(Fy(o))for(const a of o.arrayValue.values||[])i=i.add(new Ud(t.indexId,e.key,this.In(a),r))}else i=i.add(new Ud(t.indexId,e.key,WT,r));return i}yn(e,t,i,r,s){ie("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(l,u,h,g,m){const y=l.getIterator(),b=u.getIterator();let w=Pp(y),T=Pp(b);for(;w||T;){let P=!1,S=!1;if(w&&T){const M=h(w,T);M<0?S=!0:M>0&&(P=!0)}else null!=w?S=!0:P=!0;P?(g(T),T=Pp(b)):S?(m(w),w=Pp(y)):(w=Pp(y),T=Pp(b))}}(r,s,Qc,a=>{o.push(this.wn(e,t,i,a))},a=>{o.push(this.Sn(e,t,i,a))}),F.waitFor(o)}fn(e){let t=1;return zp(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,s)=>{s.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((o,a)=>Qc(o,a)).filter((o,a,l)=>!a||0!==Qc(o,l[a-1]));const r=[];r.push(e);for(const o of i){const a=Qc(o,e),l=Qc(o,t);if(0===a)r[0]=e.Ht();else if(a>0&&l<0)r.push(o),r.push(o.Ht());else if(l>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.bn(r[o],r[o+1]))return[];s.push(IDBKeyRange.bound([r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,WT,[]],[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,WT,[]]))}return s}bn(e,t){return Qc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Z5)}getMinOffset(e,t){return F.mapArray(this.un(t),i=>this.cn(e,i).next(r=>r||Ae())).next(Z5)}}function K5(n){return Hi(n,"collectionParents")}function Gp(n){return Hi(n,"indexEntries")}function tv(n){return Hi(n,"indexConfiguration")}function zp(n){return Hi(n,"indexState")}function Z5(n){Pe(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;dx(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new ks(e.readTime,e.documentKey,t)}const Y5={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ir{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new Ir(e,Ir.DEFAULT_COLLECTION_PERCENTILE,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Q5(n,e,t){const i=n.store("mutations"),r=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=i.Y({range:o},(h,g,m)=>(a++,m.delete()));s.push(l.next(()=>{Pe(1===a)}));const u=[];for(const h of t.mutations){const g=b8(e,h.key.path,t.batchId);s.push(r.delete(g)),u.push(h.key)}return F.waitFor(s).next(()=>u)}function qT(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ae();e=n.noDocument}return JSON.stringify(e).length}Ir.DEFAULT_COLLECTION_PERCENTILE=10,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ir.DEFAULT=new Ir(41943040,Ir.DEFAULT_COLLECTION_PERCENTILE,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ir.DISABLED=new Ir(-1,0,0);class KT{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Dn={}}static ct(e,t,i,r){Pe(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new KT(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Jc(e).Y({index:"userMutationsIndex",range:i},(r,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,i,r){const s=Wp(e),o=Jc(e);return o.add({}).next(a=>{Pe("number"==typeof a);const l=new Cx(a,t,i,r),u=function(y,b,w){const T=w.baseMutations.map(S=>Qy(y.ut,S)),P=w.mutations.map(S=>Qy(y.ut,S));return{userId:b,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:T,mutations:P}}(this.serializer,this.userId,l),h=[];let g=new an((m,y)=>Ze(m.canonicalString(),y.canonicalString()));for(const m of r){const y=b8(this.userId,m.key.path,a);g=g.add(m.key.path.popLast()),h.push(o.put(u)),h.push(s.put(y,rme))}return g.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Dn[a]=l.keys()}),F.waitFor(h).next(()=>l)})}lookupMutationBatch(e,t){return Jc(e).get(t).next(i=>i?(Pe(i.userId===this.userId),Vd(this.serializer,i)):null)}Cn(e,t){return this.Dn[t]?F.resolve(this.Dn[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){const r=i.keys();return this.Dn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return Jc(e).Y({index:"userMutationsIndex",range:r},(o,a,l)=>{a.userId===this.userId&&(Pe(a.batchId>=i),s=Vd(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return Jc(e).Y({index:"userMutationsIndex",range:t,reverse:!0},(r,s,o)=>{i=s.batchId,o.done()}).next(()=>i)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Jc(e).W("userMutationsIndex",t).next(i=>i.map(r=>Vd(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=AT(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Wp(e).Y({range:r},(o,a,l)=>{const[u,h,g]=o,m=Da(h);if(u===this.userId&&t.path.isEqual(m))return Jc(e).get(g).next(y=>{if(!y)throw Ae();Pe(y.userId===this.userId),s.push(Vd(this.serializer,y))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new an(Ze);const r=[];return t.forEach(s=>{const o=AT(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Wp(e).Y({range:a},(u,h,g)=>{const[m,y,b]=u,w=Da(y);m===this.userId&&s.path.isEqual(w)?i=i.add(b):g.done()});r.push(l)}),F.waitFor(r).next(()=>this.vn(e,i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=AT(this.userId,i),o=IDBKeyRange.lowerBound(s);let a=new an(Ze);return Wp(e).Y({range:o},(l,u,h)=>{const[g,m,y]=l,b=Da(m);g===this.userId&&i.isPrefixOf(b)?b.length===r&&(a=a.add(y)):h.done()}).next(()=>this.vn(e,a))}vn(e,t){const i=[],r=[];return t.forEach(s=>{r.push(Jc(e).get(s).next(o=>{if(null===o)throw Ae();Pe(o.userId===this.userId),i.push(Vd(this.serializer,o))}))}),F.waitFor(r).next(()=>i)}removeMutationBatch(e,t){return Q5(e.ae,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.Fn(t.batchId)}),F.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return F.resolve();const i=IDBKeyRange.lowerBound([this.userId]),r=[];return Wp(e).Y({range:i},(s,o,a)=>{if(s[0]===this.userId){const l=Da(s[1]);r.push(l)}else a.done()}).next(()=>{Pe(0===r.length)})})}containsKey(e,t){return J5(e,this.userId,t)}Mn(e){return X5(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function J5(n,e,t){const i=AT(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return Wp(n).Y({range:s,J:!0},(a,l,u)=>{const[h,g,m]=a;h===e&&g===r&&(o=!0),u.done()}).next(()=>o)}function Jc(n){return Hi(n,"mutations")}function Wp(n){return Hi(n,"documentMutations")}function X5(n){return Hi(n,"mutationQueues")}class jd{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new jd(0)}static Nn(){return new jd(-1)}}class __e{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{const i=new jd(t.highestTargetId);return t.highestTargetId=i.next(),this.Ln(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>ke.fromTimestamp(new Vn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.Bn(e).next(r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Ln(e,r)))}addTargetData(e,t){return this.kn(e,t).next(()=>this.Bn(e).next(i=>(i.targetCount+=1,this.qn(t,i),this.Ln(e,i))))}updateTargetData(e,t){return this.kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>qp(e).delete(t.targetId)).next(()=>this.Bn(e)).next(i=>(Pe(i.targetCount>0),i.targetCount-=1,this.Ln(e,i)))}removeTargets(e,t,i){let r=0;const s=[];return qp(e).Y((o,a)=>{const l=Jy(a);l.sequenceNumber<=t&&null===i.get(l.targetId)&&(r++,s.push(this.removeTargetData(e,l)))}).next(()=>F.waitFor(s)).next(()=>r)}forEachTarget(e,t){return qp(e).Y((i,r)=>{const s=Jy(r);t(s)})}Bn(e){return ez(e).get("targetGlobalKey").next(t=>(Pe(null!==t),t))}Ln(e,t){return ez(e).put("targetGlobalKey",t)}kn(e,t){return qp(e).put(L5(this.serializer,t))}qn(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){const i=Od(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return qp(e).Y({range:r,index:"queryTargetsIndex"},(o,a,l)=>{const u=Jy(a);By(t,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,t,i){const r=[],s=Xc(e);return t.forEach(o=>{const a=Tr(o.path);r.push(s.put({targetId:i,path:a})),r.push(this.referenceDelegate.addReference(e,i,o))}),F.waitFor(r)}removeMatchingKeys(e,t,i){const r=Xc(e);return F.forEach(t,s=>{const o=Tr(s.path);return F.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])})}removeMatchingKeysForTargetId(e,t){const i=Xc(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Xc(e);let s=ct();return r.Y({range:i,J:!0},(o,a,l)=>{const u=Da(o[1]),h=new we(u);s=s.add(h)}).next(()=>s)}containsKey(e,t){const i=Tr(t.path),r=IDBKeyRange.bound([i],[d8(i)],!1,!0);let s=0;return Xc(e).Y({index:"documentTargetsIndex",J:!0,range:r},([o,a],l,u)=>{0!==o&&(s++,u.done())}).next(()=>s>0)}_t(e,t){return qp(e).get(t).next(i=>i?Jy(i):null)}}function qp(n){return Hi(n,"targets")}function ez(n){return Hi(n,"targetGlobal")}function Xc(n){return Hi(n,"targetDocuments")}function tz([n,e],[t,i]){const r=Ze(n,t);return 0===r?Ze(e,i):r}class y_e{constructor(e){this.Qn=e,this.buffer=new an(tz),this.Kn=0}$n(){return++this.Kn}Un(e){const t=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();tz(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class nz{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Wn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return null!==this.Wn}Gn(e){var t=this;ie("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,K.Z)(function*(){t.Wn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(i){$c(i)?ie("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",i):yield jc(i)}yield t.Gn(3e5)}))}}class v_e{constructor(e,t){this.zn=e,this.params=t}calculateTargetCount(e,t){return this.zn.jn(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(0===t)return F.resolve(Fs._e);const i=new y_e(t);return this.zn.forEachTarget(e,r=>i.Un(r.sequenceNumber)).next(()=>this.zn.Hn(e,r=>i.Un(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.zn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.zn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(ie("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(Y5)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(ie("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Y5):this.Jn(e,t))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,t){let i,r,s,o,a,l,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(ie("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),r=this.params.maximumSequenceNumbersToCollect):r=g,o=Date.now(),this.nthSequenceNumber(e,r))).next(g=>(i=g,a=Date.now(),this.removeTargets(e,i,t))).next(g=>(s=g,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(g=>(u=Date.now(),Ap()<=As.in.DEBUG&&ie("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-h}ms\n\tDetermined least recently used ${r} in `+(a-o)+`ms\n\tRemoved ${s} targets in `+(l-a)+`ms\n\tRemoved ${g} documents in `+(u-l)+`ms\nTotal Duration: ${u-h}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:g})))}}class b_e{constructor(e,t){this.db=e,this.garbageCollector=function iz(n,e){return new v_e(n,e)}(this,t)}jn(e){const t=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}Yn(e){let t=0;return this.Hn(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Hn(e,t){return this.Zn(e,(i,r)=>t(r))}addReference(e,t,i){return ZT(e,i)}removeReference(e,t,i){return ZT(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return ZT(e,t)}Xn(e,t){return function(r,s){let o=!1;return X5(r).Z(a=>J5(r,a,s).next(l=>(l&&(o=!0),F.resolve(!l)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Zn(e,(o,a)=>{if(a<=t){const l=this.Xn(e,o).next(u=>{if(!u)return s++,i.getEntry(e,o).next(()=>(i.removeEntry(o,ke.min()),Xc(e).delete([0,Tr(o.path)])))});r.push(l)}}).next(()=>F.waitFor(r)).next(()=>i.apply(e)).next(()=>s)}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return ZT(e,t)}Zn(e,t){const i=Xc(e);let r,s=Fs._e;return i.Y({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:u})=>{0===o?(s!==Fs._e&&t(new we(Da(r)),s),s=u,r=l):s=Fs._e}).next(()=>{s!==Fs._e&&t(new we(Da(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ZT(n,e){return Xc(n).put((r=n.currentSequenceNumber,{targetId:0,path:Tr(e.path),sequenceNumber:r}));var r}class rz{constructor(){this.changes=new Al(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,xn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return void 0!==i?F.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class E_e{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return $d(e).put(i)}removeEntry(e,t,i){return $d(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],HT(o),a[a.length-1]]}(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.er(e,i)))}getEntry(e,t){let i=xn.newInvalidDocument(t);return $d(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(nv(t))},(r,s)=>{i=this.tr(t,s)}).next(()=>i)}nr(e,t){let i={size:0,document:xn.newInvalidDocument(t)};return $d(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(nv(t))},(r,s)=>{i={document:this.tr(t,s),size:qT(s)}}).next(()=>i)}getEntries(e,t){let i=_s();return this.rr(e,t,(r,s)=>{const o=this.tr(r,s);i=i.insert(r,o)}).next(()=>i)}ir(e,t){let i=_s(),r=new En(we.comparator);return this.rr(e,t,(s,o)=>{const a=this.tr(s,o);i=i.insert(s,a),r=r.insert(s,qT(o))}).next(()=>({documents:i,sr:r}))}rr(e,t,i){if(t.isEmpty())return F.resolve();let r=new an(lz);t.forEach(l=>r=r.add(l));const s=IDBKeyRange.bound(nv(r.first()),nv(r.last())),o=r.getIterator();let a=o.getNext();return $d(e).Y({index:"documentKeyIndex",range:s},(l,u,h)=>{const g=we.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&lz(a,g)<0;)i(a,null),a=o.getNext();a&&a.isEqual(g)&&(i(a,u),a=o.hasNext()?o.getNext():null),a?h.U(nv(a)):h.done()}).next(()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),HT(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return $d(e).W(IDBKeyRange.bound(a,l,!0)).next(u=>{s?.incrementDocumentReadCount(u.length);let h=_s();for(const g of u){const m=this.tr(we.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);m.isFoundDocument()&&(jy(t,m)||r.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,t,i,r){let s=_s();const o=az(t,i),a=az(t,ks.max());return $d(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,u,h)=>{const g=this.tr(we.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(g.key,g),s.size===r&&h.done()}).next(()=>s)}newChangeBuffer(e){return new w_e(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return oz(e).get("remoteDocumentGlobalKey").next(t=>(Pe(!!t),t))}er(e,t){return oz(e).put("remoteDocumentGlobalKey",t)}tr(e,t){if(t){const i=function l_e(n,e){let t;if(e.document)t=R5(n.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=we.fromSegments(e.noDocument.path),r=Ld(e.noDocument.readTime);t=xn.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ae();{const i=we.fromSegments(e.unknownDocument.path),r=Ld(e.unknownDocument.version);t=xn.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime(function(r){const s=new Vn(r[0],r[1]);return ke.fromTimestamp(s)}(e.readTime)),t}(this.serializer,t);if(!i.isNoDocument()||!i.version.isEqual(ke.min()))return i}return xn.newInvalidDocument(e)}}function sz(n){return new E_e(n)}class w_e extends rz{constructor(e,t){super(),this._r=e,this.trackRemovals=t,this.ar=new Al(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(e){const t=[];let i=0,r=new an((s,o)=>Ze(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.ar.get(s);if(t.push(this._r.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=F5(this._r.serializer,o);r=r.add(s.path.popLast());const u=qT(l);i+=u-a.size,t.push(this._r.addEntry(e,s,l))}else if(i-=a.size,this.trackRemovals){const l=F5(this._r.serializer,o.convertToNoDocument(ke.min()));t.push(this._r.addEntry(e,s,l))}}),r.forEach(s=>{t.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),t.push(this._r.updateMetadata(e,i)),F.waitFor(t)}getFromCache(e,t){return this._r.nr(e,t).next(i=>(this.ar.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this._r.ir(e,t).next(({documents:i,sr:r})=>(r.forEach((s,o)=>{this.ar.set(s,{size:o,readTime:i.get(s).readTime})}),i))}}function oz(n){return Hi(n,"remoteDocumentGlobal")}function $d(n){return Hi(n,"remoteDocumentsV14")}function nv(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function az(n,e){const t=e.documentKey.path.toArray();return[n,HT(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function lz(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=Ze(t[s],i[s]),r)return r;return r=Ze(t.length,i.length),r||(r=Ze(t[t.length-2],i[i.length-2]),r||Ze(t[t.length-1],i[i.length-1]))}class T_e{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class cz{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(null!==i&&zy(i.mutation,r,ms.empty(),Vn.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,ct()).next(()=>i))}getLocalViewOfDocuments(e,t,i=ct()){const r=Aa();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let o=$y();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const i=Aa();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,ct()))}populateOverlays(e,t,i){const r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,i,r){let s=_s();const o=Hy(),a=Hy();return t.forEach((l,u)=>{const h=i.get(u.key);r.has(u.key)&&(void 0===h||h.mutation instanceof Rl)?s=s.insert(u.key,u):void 0!==h?(o.set(u.key,h.mutation.getFieldMask()),zy(h.mutation,u,h.mutation.getFieldMask(),Vn.now())):o.set(u.key,ms.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,h)=>o.set(u,h)),t.forEach((u,h)=>{var g;return a.set(u,new T_e(h,null!==(g=o.get(u))&&void 0!==g?g:null))}),a))}recalculateAndSaveOverlays(e,t){const i=Hy();let r=new En((o,a)=>o-a),s=ct();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=t.get(l);if(null===u)return;let h=i.get(l)||ms.empty();h=a.applyToLocalView(u,h),i.set(l,h);const g=(r.get(a.batchId)||ct()).add(l);r=r.insert(a.batchId,g)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,h=l.value,g=e5();h.forEach(m=>{if(!s.has(m)){const y=c5(t.get(m),i.get(m));null!==y&&g.set(m,y),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,g))}return F.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return we.isDocumentKey((o=t).path)&&null===o.collectionGroup&&0===o.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Ex(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r);var o}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):F.resolve(Aa());let a=-1,l=s;return o.next(u=>F.forEach(u,(h,g)=>(a<g.largestBatchId&&(a=g.largestBatchId),s.get(h)?F.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,ct())).next(h=>({batchId:a,changes:X8(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new we(t)).next(i=>{let r=$y();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=$y();return this.indexManager.getCollectionParents(e,s).next(a=>F.forEach(a,l=>{const u=(g=t,m=l.child(s),new Sl(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt));var g,m;return this.getDocumentsMatchingCollectionQuery(e,u,i,r).next(h=>{h.forEach((g,m)=>{o=o.insert(g,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(o=>{s.forEach((l,u)=>{const h=u.getKey();null===o.get(h)&&(o=o.insert(h,xn.newInvalidDocument(h)))});let a=$y();return o.forEach((l,u)=>{const h=s.get(l);void 0!==h&&zy(h.mutation,u,ms.empty(),Vn.now()),jy(t,u)&&(a=a.insert(l,u))}),a})}}class I_e{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return F.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,{id:(r=t).id,version:r.version,createTime:hi(r.createTime)}),F.resolve();var r}getNamedQuery(e,t){return F.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,{name:(r=t).name,query:Mx(r.bundledQuery),readTime:hi(r.readTime)}),F.resolve();var r}}class C_e{constructor(){this.overlays=new En(we.comparator),this.lr=new Map}getOverlay(e,t){return F.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Aa();return F.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.lt(e,t,s)}),F.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.lr.get(i);return void 0!==r&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(i)),F.resolve()}getOverlaysForCollection(e,t,i){const r=Aa(),s=t.length+1,o=new we(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return F.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new En((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>i){let h=s.get(u.largestBatchId);null===h&&(h=Aa(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=Aa(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>a.set(u,h)),!(a.size()>=r)););return F.resolve(a)}lt(e,t,i){const r=this.overlays.get(i.key);if(null!==r){const o=this.lr.get(r.largestBatchId).delete(i.key);this.lr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new Sx(t,i));let s=this.lr.get(t);void 0===s&&(s=ct(),this.lr.set(t,s)),this.lr.set(t,s.add(i.key))}}class jx{constructor(){this.hr=new an(Gi.Pr),this.Ir=new an(Gi.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const i=new Gi(e,t);this.hr=this.hr.add(i),this.Ir=this.Ir.add(i)}Er(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.dr(new Gi(e,t))}Ar(e,t){e.forEach(i=>this.removeReference(i,t))}Rr(e){const t=new we(new kt([])),i=new Gi(t,e),r=new Gi(t,e+1),s=[];return this.Ir.forEachInRange([i,r],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new we(new kt([])),i=new Gi(t,e),r=new Gi(t,e+1);let s=ct();return this.Ir.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new Gi(e,0),i=this.hr.firstAfterOrEqual(t);return null!==i&&e.isEqual(i.key)}}class Gi{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return we.comparator(e.key,t.key)||Ze(e.gr,t.gr)}static Tr(e,t){return Ze(e.gr,t.gr)||we.comparator(e.key,t.key)}}class D_e{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new an(Gi.Pr)}checkEmpty(e){return F.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,i,r){const s=this.pr;this.pr++;const o=new Cx(s,t,i,r);this.mutationQueue.push(o);for(const a of r)this.yr=this.yr.add(new Gi(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return F.resolve(o)}lookupMutationBatch(e,t){return F.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const r=this.Sr(t+1),s=r<0?0:r;return F.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Gi(t,0),r=new Gi(t,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([i,r],o=>{const a=this.wr(o.gr);s.push(a)}),F.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new an(Ze);return t.forEach(r=>{const s=new Gi(r,0),o=new Gi(r,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{i=i.add(a.gr)})}),F.resolve(this.br(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;we.isDocumentKey(s)||(s=s.child(""));const o=new Gi(new we(s),0);let a=new an(Ze);return this.yr.forEachWhile(l=>{const u=l.key.path;return!!i.isPrefixOf(u)&&(u.length===r&&(a=a.add(l.gr)),!0)},o),F.resolve(this.br(a))}br(e){const t=[];return e.forEach(i=>{const r=this.wr(i);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){Pe(0===this.Dr(t.batchId,"removed")),this.mutationQueue.shift();let i=this.yr;return F.forEach(t.mutations,r=>{const s=new Gi(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.yr=i})}Fn(e){}containsKey(e,t){const i=new Gi(t,0),r=this.yr.firstAfterOrEqual(i);return F.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return F.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class S_e{constructor(e){this.Cr=e,this.docs=new En(we.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.Cr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return F.resolve(i?i.document.mutableCopy():xn.newInvalidDocument(t))}getEntries(e,t){let i=_s();return t.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():xn.newInvalidDocument(r))}),F.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=_s();const o=t.path,a=new we(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||dx(f8(h),i)<=0||(r.has(h.key)||jy(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return F.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Ae()}vr(e,t){return F.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new A_e(this)}getSize(e){return F.resolve(this.size)}}class A_e extends rz{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this._r.addEntry(e,r)):this._r.removeEntry(i)}),F.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class R_e{constructor(e){this.persistence=e,this.Fr=new Al(t=>Od(t),By),this.lastRemoteSnapshotVersion=ke.min(),this.highestTargetId=0,this.Mr=0,this.Or=new jx,this.targetCount=0,this.Nr=jd.On()}forEachTarget(e,t){return this.Fr.forEach((i,r)=>t(r)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Mr&&(this.Mr=t),F.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new jd(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,F.resolve()}updateTargetData(e,t){return this.kn(t),F.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=t&&null===i.get(a.targetId)&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),F.waitFor(s).next(()=>r)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,t){const i=this.Fr.get(t)||null;return F.resolve(i)}addMatchingKeys(e,t,i){return this.Or.Er(t,i),F.resolve()}removeMatchingKeys(e,t,i){this.Or.Ar(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),F.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),F.resolve()}getMatchingKeysForTargetId(e,t){const i=this.Or.mr(t);return F.resolve(i)}containsKey(e,t){return F.resolve(this.Or.containsKey(t))}}class $x{constructor(e,t){this.Br={},this.overlays={},this.Lr=new Fs(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new R_e(this),this.indexManager=new g_e,this.remoteDocumentCache=new S_e(i=>this.referenceDelegate.Qr(i)),this.serializer=new k5(t),this.Kr=new I_e(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new C_e,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Br[e.toKey()];return i||(i=new D_e(t,this.referenceDelegate),this.Br[e.toKey()]=i),i}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,i){ie("MemoryPersistence","Starting transaction:",e);const r=new N_e(this.Lr.next());return this.referenceDelegate.$r(),i(r).next(s=>this.referenceDelegate.Ur(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Wr(e,t){return F.or(Object.values(this.Br).map(i=>()=>i.containsKey(e,t)))}}class N_e extends g8{constructor(e){super(),this.currentSequenceNumber=e}}class YT{constructor(e){this.persistence=e,this.Gr=new jx,this.zr=null}static jr(e){return new YT(e)}get Hr(){if(this.zr)return this.zr;throw Ae()}addReference(e,t,i){return this.Gr.addReference(i,t),this.Hr.delete(i.toString()),F.resolve()}removeReference(e,t,i){return this.Gr.removeReference(i,t),this.Hr.add(i.toString()),F.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),F.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach(r=>this.Hr.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Hr.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.Hr,i=>{const r=we.fromPath(i);return this.Jr(e,r).next(s=>{s||t.removeEntry(r,ke.min())})}).next(()=>(this.zr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Jr(e,t).next(i=>{i?this.Hr.delete(t.toString()):this.Hr.add(t.toString())})}Qr(e){return 0}Jr(e,t){return F.or([()=>F.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class x_e{constructor(e){this.serializer=e}N(e,t,i,r){const s=new ST("createOrUpgrade",t);var l;i<1&&r>=1&&(e.createObjectStore("owner"),(l=e).createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",v8,{unique:!0}),l.createObjectStore("documentMutations"),uz(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=F.resolve();return i<3&&r>=3&&(0!==i&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),uz(e)),o=o.next(()=>function(l){const u=l.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ke.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",h)}(s))),i<4&&r>=4&&(0!==i&&(o=o.next(()=>function(l,u){return u.store("mutations").W().next(h=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",v8,{unique:!0});const g=u.store("mutations"),m=h.map(y=>g.put(y));return F.waitFor(m)})}(e,s))),o=o.next(()=>{!function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),i<5&&r>=5&&(o=o.next(()=>this.Zr(s))),i<6&&r>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),i<7&&r>=7&&(o=o.next(()=>this.ei(s))),i<8&&r>=8&&(o=o.next(()=>this.ti(e,s))),i<9&&r>=9&&(o=o.next(()=>{!function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")}(e)})),i<10&&r>=10&&(o=o.next(()=>this.ni(s))),i<11&&r>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),i<12&&r>=12&&(o=o.next(()=>{!function(l){const u=l.createObjectStore("documentOverlays",{keyPath:mme});u.createIndex("collectionPathOverlayIndex",_me,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",yme,{unique:!1})}(e)})),i<13&&r>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore("remoteDocumentsV14",{keyPath:sme});u.createIndex("documentKeyIndex",ome),u.createIndex("collectionGroupIndex",ame)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(o=o.next(()=>this.ii(e,s))),i<15&&r>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:hme}).createIndex("sequenceNumberIndex",fme,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:pme}).createIndex("documentKeyIndex",gme,{unique:!1})}(e))),o}Xr(e){let t=0;return e.store("remoteDocuments").Y((i,r)=>{t+=qT(r)}).next(()=>{const i={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}Zr(e){const t=e.store("mutationQueues"),i=e.store("mutations");return t.W().next(r=>F.forEach(r,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return i.W("userMutationsIndex",o).next(a=>F.forEach(a,l=>{Pe(l.userId===s.userId);const u=Vd(this.serializer,l);return Q5(e,s.userId,u).next(()=>{})}))}))}ei(e){const t=e.store("targetDocuments"),i=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const s=[];return i.Y((o,a)=>{const l=new kt(o),u=[0,Tr(l)];s.push(t.get(u).next(h=>h?F.resolve():t.put({targetId:0,path:Tr(l),sequenceNumber:r.highestListenSequenceNumber})))}).next(()=>F.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:dme});const i=t.store("collectionParents"),r=new Ux,s=o=>{if(r.add(o)){const a=o.lastSegment(),l=o.popLast();return i.put({collectionId:a,parent:Tr(l)})}};return t.store("remoteDocuments").Y({J:!0},(o,a)=>{const l=new kt(o);return s(l.popLast())}).next(()=>t.store("documentMutations").Y({J:!0},([o,a,l],u)=>{const h=Da(a);return s(h.popLast())}))}ni(e){const t=e.store("targets");return t.Y((i,r)=>{const s=Jy(r),o=L5(this.serializer,s);return t.put(o)})}ri(e,t){const i=t.store("remoteDocuments"),r=[];return i.Y((s,o)=>{const a=t.store("remoteDocumentsV14"),l=(g=o,g.document?new we(kt.fromString(g.document.name).popFirst(5)):g.noDocument?we.fromSegments(g.noDocument.path):g.unknownDocument?we.fromSegments(g.unknownDocument.path):Ae()).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};var g;r.push(a.put(u))}).next(()=>F.waitFor(r))}ii(e,t){const i=t.store("mutations"),r=sz(this.serializer),s=new $x(YT.jr,this.serializer.ut);return i.W().next(o=>{const a=new Map;return o.forEach(l=>{var u;let h=null!==(u=a.get(l.userId))&&void 0!==u?u:ct();Vd(this.serializer,l).keys().forEach(g=>h=h.add(g)),a.set(l.userId,h)}),F.forEach(a,(l,u)=>{const h=new $i(u),g=GT.ct(this.serializer,h),m=s.getIndexManager(h),y=KT.ct(h,this.serializer,m,s.referenceDelegate);return new cz(r,y,g,m).recalculateAndSaveOverlaysForDocumentKeys(new px(t,Fs._e),l).next()})})}}function uz(n){n.createObjectStore("targetDocuments",{keyPath:cme}).createIndex("documentTargetsIndex",ume,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",lme,{unique:!0}),n.createObjectStore("targetGlobal")}const Hx="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Gx{constructor(e,t,i,r,s,o,a,l,u,h,g=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.si=s,this.window=o,this.document=a,this.oi=u,this._i=h,this.ai=g,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=m=>Promise.resolve(),!Gx.D())throw new te(U.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new b_e(this,r),this.Ii=t+"main",this.serializer=new k5(l),this.Ti=new zo(this.Ii,this.ai,new x_e(this.serializer)),this.qr=new __e(this.referenceDelegate,this.serializer),this.remoteDocumentCache=sz(this.serializer),this.Kr=new c_e,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,!1===h&&di("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new te(U.FAILED_PRECONDITION,Hx);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new Fs(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){var t=this;return this.Pi=function(){var i=(0,K.Z)(function*(r){if(t.started)return e(r)});return function(r){return i.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(function(){var t=(0,K.Z)(function*(i){null===i.newVersion&&(yield e())});return function(i){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget((0,K.Z)(function*(){t.started&&(yield t.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>JT(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(t=>this.isPrimary&&!t?this.pi(e).next(()=>!1):!!t&&this.yi(e).next(()=>!0))).catch(e=>{if($c(e))return ie("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ie("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return iv(e).get("owner").next(t=>F.resolve(this.wi(t)))}Si(e){return JT(e).delete(this.clientId)}bi(){var e=this;return(0,K.Z)(function*(){if(e.isPrimary&&!e.Di(e.hi,18e5)){e.hi=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",i=>{const r=Hi(i,"clientMetadata");return r.W().next(s=>{const o=e.Ci(s,18e5),a=s.filter(l=>-1===o.indexOf(l));return F.forEach(a,l=>r.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(e.Ei)for(const i of t)e.Ei.removeItem(e.vi(i.clientId))}})()}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?F.resolve(!0):iv(e).get("owner").next(t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)){if(this.wi(t)&&this.networkEnabled)return!0;if(!this.wi(t)){if(!t.allowTabSynchronization)throw new te(U.FAILED_PRECONDITION,Hx);return!1}}return!(!this.networkEnabled||!this.inForeground)||JT(e).W().next(i=>void 0===this.Ci(i,5e3).find(r=>!(this.clientId===r.clientId||!(!this.networkEnabled&&r.networkEnabled||!this.inForeground&&r.inForeground&&this.networkEnabled===r.networkEnabled))))}).next(t=>(this.isPrimary!==t&&ie("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,K.Z)(function*(){e.kr=!1,e.Mi(),e.li&&(e.li.cancel(),e.li=null),e.xi(),e.Oi(),yield e.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const i=new px(t,Fs._e);return e.pi(i).next(()=>e.Si(i))}),e.Ti.close(),e.Ni()})()}Ci(e,t){return e.filter(i=>this.Di(i.updateTimeMs,t)&&!this.Fi(i.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>JT(e).W().next(t=>this.Ci(t,18e5).map(i=>i.clientId)))}get started(){return this.kr}getMutationQueue(e,t){return KT.ct(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new m_e(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return GT.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,t,i){ie("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",s=15===(l=this.ai)?bme:14===l?T8:13===l?w8:12===l?vme:11===l?E8:void Ae();var l;let o;return this.Ti.runTransaction(e,r,s,a=>(o=new px(a,this.Lr?this.Lr.next():Fs._e),"readwrite-primary"===t?this.fi(o).next(l=>!!l||this.gi(o)).next(l=>{if(!l)throw di(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new te(U.FAILED_PRECONDITION,p8);return i(o)}).next(l=>this.yi(o).next(()=>l)):this.Li(o).next(()=>i(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Li(e){return iv(e).get("owner").next(t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)&&!this.wi(t)&&!(this._i||this.allowTabSynchronization&&t.allowTabSynchronization))throw new te(U.FAILED_PRECONDITION,Hx)})}yi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return iv(e).put("owner",t)}static D(){return zo.D()}pi(e){const t=iv(e);return t.get("owner").next(i=>this.wi(i)?(ie("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):F.resolve())}Di(e,t){const i=Date.now();return!(e<i-t||e>i&&(di(`Detected an update time that is in the future: ${e} > ${i}`),1))}Ai(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Mi();const t=/(?:Version|Mobile)\/1[456]/;(0,E.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var t;try{const i=null!==(null===(t=this.Ei)||void 0===t?void 0:t.getItem(this.vi(e)));return ie("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return di("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){di("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function iv(n){return Hi(n,"owner")}function JT(n){return Hi(n,"clientMetadata")}function zx(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Wx{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.ki=i,this.qi=r}static Qi(e,t){let i=ct(),r=ct();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Wx(e,t.fromCache,i,r)}}class P_e{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class dz{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.zi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,t,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new P_e;return this.Hi(e,t,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,t,o,a.size)})}).next(()=>s.result)}Ji(e,t,i,r){return i.documentReadCount<this.Ui?(Ap()<=As.in.DEBUG&&ie("QueryEngine","SDK will not create cache indexes for query:",Lp(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),F.resolve()):(Ap()<=As.in.DEBUG&&ie("QueryEngine","Query:",Lp(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Wi*r?(Ap()<=As.in.DEBUG&&ie("QueryEngine","The SDK decides to create cache indexes for query:",Lp(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Br(t))):F.resolve())}zi(e,t){if(q8(t))return F.resolve(null);let i=Br(t);return this.indexManager.getIndexType(e,i).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=LT(t,null,"F"),i=Br(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{const o=ct(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{const u=this.Yi(t,a);return this.Zi(t,u,o,l.readTime)?this.zi(e,LT(t,null,"F")):this.Xi(e,u,t,l)}))})))}ji(e,t,i,r){return q8(t)||r.isEqual(ke.min())?F.resolve(null):this.Gi.getDocuments(e,i).next(s=>{const o=this.Yi(t,s);return this.Zi(t,o,i,r)?F.resolve(null):(Ap()<=As.in.DEBUG&&ie("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Lp(t)),this.Xi(e,o,t,h8(r,-1)).next(a=>a))})}Yi(e,t){let i=new an(Q8(e));return t.forEach((r,s)=>{jy(e,s)&&(i=i.add(s))}),i}Zi(e,t,i,r){if(null===e.limit)return!1;if(i.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Hi(e,t,i){return Ap()<=As.in.DEBUG&&ie("QueryEngine","Using full collection scan to execute query:",Lp(t)),this.Gi.getDocumentsMatchingQuery(e,t,ks.min(),i)}Xi(e,t,i,r){return this.Gi.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}class O_e{constructor(e,t,i,r){this.persistence=e,this.es=t,this.serializer=r,this.ts=new En(Ze),this.ns=new Al(s=>Od(s),By),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(i)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cz(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ts))}}function hz(n,e,t,i){return new O_e(n,e,t,i)}function fz(n,e){return qx.apply(this,arguments)}function qx(){return qx=(0,K.Z)(function*(n,e){const t=Ee(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.os(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{const o=[],a=[];let l=ct();for(const u of r){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of s){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(i,l).next(u=>({_s:u,removedBatchIds:o,addedBatchIds:a}))})})}),qx.apply(this,arguments)}function pz(n){const e=Ee(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function gz(n,e,t){let i=ct(),r=ct();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let o=_s();return t.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(ke.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||0===l.version.compareTo(u.version)&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ie("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{us:o,cs:r}})}function F_e(n,e){const t=Ee(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Kp(n,e){const t=Ee(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.qr.getTargetData(i,e).next(s=>s?(r=s,F.resolve(r)):t.qr.allocateTargetId(i).next(o=>(r=new Nl(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.qr.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=t.ts.get(i.targetId);return(null===r||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.ts=t.ts.insert(i.targetId,i),t.ns.set(e,i.targetId)),i})}function Zp(n,e,t){return Kx.apply(this,arguments)}function Kx(){return Kx=(0,K.Z)(function*(n,e,t){const i=Ee(n),r=i.ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!$c(o))throw o;ie("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}i.ts=i.ts.remove(e),i.ns.delete(r.target)}),Kx.apply(this,arguments)}function XT(n,e,t){const i=Ee(n);let r=ke.min(),s=ct();return i.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,h){const g=Ee(l),m=g.ns.get(h);return void 0!==m?F.resolve(g.ts.get(m)):g.qr.getTargetData(u,h)}(i,o,Br(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.qr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>i.es.getDocumentsMatchingQuery(o,e,t?r:ke.min(),t?s:ct())).next(a=>(yz(i,Y8(e),a),{documents:a,ls:s})))}function mz(n,e){const t=Ee(n),i=Ee(t.qr),r=t.ts.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>i._t(s,e).next(o=>o?o.target:null))}function _z(n,e){const t=Ee(n),i=t.rs.get(e)||ke.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.ss.getAllFromCollectionGroup(r,e,h8(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(yz(t,e,r),r))}function yz(n,e,t){let i=n.rs.get(e)||ke.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.rs.set(e,i)}function Zx(){return Zx=(0,K.Z)(function*(n,e,t,i){const r=Ee(n);let s=ct(),o=_s();for(const u of t){const h=e.hs(u.metadata.name);u.document&&(s=s.add(h));const g=e.Ps(u);g.setReadTime(e.Is(u.metadata.readTime)),o=o.insert(h,g)}const a=r.ss.newChangeBuffer({trackRemovals:!0}),l=yield Kp(r,(h=i,Br(kp(kt.fromString(`__bundle__/docs/${h}`)))));var h;return r.persistence.runTransaction("Apply bundle documents","readwrite",u=>gz(u,a,o).next(h=>(a.apply(u),h)).next(h=>r.qr.removeMatchingKeysForTargetId(u,l.targetId).next(()=>r.qr.addMatchingKeys(u,s,l.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(u,h.us,h.cs)).next(()=>h.us)))}),Zx.apply(this,arguments)}function V_e(n,e){return Yx.apply(this,arguments)}function Yx(){return Yx=(0,K.Z)(function*(n,e,t=ct()){const i=yield Kp(n,Br(Mx(e.bundledQuery))),r=Ee(n);return r.persistence.runTransaction("Save named query","readwrite",s=>{const o=hi(e.readTime);if(i.snapshotVersion.compareTo(o)>=0)return r.Kr.saveNamedQuery(s,e);const a=i.withResumeToken(Ni.EMPTY_BYTE_STRING,o);return r.ts=r.ts.insert(a.targetId,a),r.qr.updateTargetData(s,a).next(()=>r.qr.removeMatchingKeysForTargetId(s,i.targetId)).next(()=>r.qr.addMatchingKeys(s,t,i.targetId)).next(()=>r.Kr.saveNamedQuery(s,e))})}),Yx.apply(this,arguments)}function vz(n,e){return`firestore_clients_${n}_${e}`}function bz(n,e,t){let i=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function Qx(n,e){return`firestore_targets_${n}_${e}`}class eI{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static Ts(e,t,i){const r=JSON.parse(i);let s,o="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return o&&r.error&&(o="string"==typeof r.error.message&&"string"==typeof r.error.code,o&&(s=new te(r.error.code,r.error.message))),o?new eI(e,t,r.state,s):(di("SharedClientState",`Failed to parse mutation state for ID '${t}': ${i}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class rv{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Ts(e,t){const i=JSON.parse(t);let r,s="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return s&&i.error&&(s="string"==typeof i.error.message&&"string"==typeof i.error.code,s&&(r=new te(i.error.code,i.error.message))),s?new rv(e,i.state,r):(di("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class tI{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ts(e,t){const i=JSON.parse(t);let r="object"==typeof i&&i.activeTargetIds instanceof Array,s=Tx();for(let o=0;r&&o<i.activeTargetIds.length;++o)r=_8(i.activeTargetIds[o]),s=s.add(i.activeTargetIds[o]);return r?new tI(e,s):(di("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Jx{constructor(e,t){this.clientId=e,this.onlineState=t}static Ts(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Jx(t.clientId,t.onlineState):(di("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Xx{constructor(){this.activeTargetIds=Tx()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class eP{constructor(e,t,i,r,s){this.window=e,this.si=t,this.persistenceKey=i,this.Rs=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new En(Ze),this.started=!1,this.ps=[];const o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=vz(this.persistenceKey,this.Rs),this.ws=`firestore_sequence_number_${this.persistenceKey}`,this.gs=this.gs.insert(this.Rs,new Xx),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=`firestore_online_state_${this.persistenceKey}`,this.vs=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,K.Z)(function*(){const t=yield e.syncEngine.Bi();for(const r of t){if(r===e.Rs)continue;const s=e.getItem(vz(e.persistenceKey,r));if(s){const o=tI.Ts(r,s);o&&(e.gs=e.gs.insert(o.clientId,o))}}e.Fs();const i=e.storage.getItem(e.Cs);if(i){const r=e.Ms(i);r&&e.xs(r)}for(const r of e.ps)e.fs(r);e.ps=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let t=!1;return this.gs.forEach((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,t,i){this.Ns(e,t,i),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Qx(this.persistenceKey,e));if(i){const r=rv.Ts(e,i);r&&(t=r.state)}}return this.Ls.ds(e),this.Fs(),t}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Qx(this.persistenceKey,e))}updateQueryState(e,t,i){this.ks(e,t,i)}handleUserChange(e,t,i){t.forEach(r=>{this.Bs(r)}),this.currentUser=e,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ie("SharedClientState","READ",e,t),t}setItem(e,t){ie("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){ie("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){var t=this;const i=e;if(i.storageArea===this.storage){if(ie("SharedClientState","EVENT",i.key,i.newValue),i.key===this.ys)return void di("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable((0,K.Z)(function*(){if(t.started){if(null!==i.key)if(t.Ss.test(i.key)){if(null==i.newValue){const r=t.Ks(i.key);return t.$s(r,null)}{const r=t.Us(i.key,i.newValue);if(r)return t.$s(r.clientId,r)}}else if(t.bs.test(i.key)){if(null!==i.newValue){const r=t.Ws(i.key,i.newValue);if(r)return t.Gs(r)}}else if(t.Ds.test(i.key)){if(null!==i.newValue){const r=t.zs(i.key,i.newValue);if(r)return t.js(r)}}else if(i.key===t.Cs){if(null!==i.newValue){const r=t.Ms(i.newValue);if(r)return t.xs(r)}}else if(i.key===t.ws){const r=function(o){let a=Fs._e;if(null!=o)try{const l=JSON.parse(o);Pe("number"==typeof l),a=l}catch(l){di("SharedClientState","Failed to read sequence number from WebStorage",l)}return a}(i.newValue);r!==Fs._e&&t.sequenceNumberHandler(r)}else if(i.key===t.vs){const r=t.Hs(i.newValue);yield Promise.all(r.map(s=>t.syncEngine.Js(s)))}}else t.ps.push(i)}))}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,t,i){const r=new eI(this.currentUser,e,t,i),s=bz(this.persistenceKey,this.currentUser,e);this.setItem(s,r.Es())}Bs(e){const t=bz(this.persistenceKey,this.currentUser,e);this.removeItem(t)}qs(e){this.storage.setItem(this.Cs,JSON.stringify({clientId:this.Rs,onlineState:e}))}ks(e,t,i){const r=Qx(this.persistenceKey,e),s=new rv(e,t,i);this.setItem(r,s.Es())}Qs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.vs,t)}Ks(e){const t=this.Ss.exec(e);return t?t[1]:null}Us(e,t){const i=this.Ks(e);return tI.Ts(i,t)}Ws(e,t){const i=this.bs.exec(e),r=Number(i[1]);return eI.Ts(new $i(void 0!==i[2]?i[2]:null),r,t)}zs(e,t){const i=this.Ds.exec(e),r=Number(i[1]);return rv.Ts(r,t)}Ms(e){return Jx.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){var t=this;return(0,K.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Ys(e.batchId,e.state,e.error);ie("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,t){const i=t?this.gs.insert(e,t):this.gs.remove(e),r=this.Os(this.gs),s=this.Os(i),o=[],a=[];return s.forEach(l=>{r.has(l)||o.push(l)}),r.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=i})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let t=Tx();return e.forEach((i,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class Ez{constructor(){this.eo=new Xx,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,i){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new Xx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class B_e{ro(e){}shutdown(){}}class wz{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){ie("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){ie("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let nI=null;function tP(){return null===nI?nI=268435456+Math.round(2147483648*Math.random()):nI++,"0x"+nI.toString(16)}const U_e={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class j_e{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const Cr="WebChannelConnection";class $_e extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=i+"://"+t.host,this.fo=`projects/${r}/databases/${s}`,this.po="(default)"===this.databaseId.database?`project_id=${r}`:`project_id=${r}&database_id=${s}`}get yo(){return!1}wo(t,i,r,s,o){const a=tP(),l=this.So(t,i);ie("RestConnection",`Sending RPC '${t}' ${a}:`,l,r);const u={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(u,s,o),this.Do(t,l,u,r).then(h=>(ie("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw gs("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",l,"request:",r),h})}Co(t,i,r,s,o,a){return this.wo(t,i,r,s,o)}bo(t,i,r){t["X-Goog-Api-Client"]="gl-js/ fire/"+Sp,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,o)=>t[o]=s),r&&r.headers.forEach((s,o)=>t[o]=s)}So(t,i){return`${this.mo}/v1/${i}:${U_e[t]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,t,i,r){const s=tP();return new Promise((o,a)=>{const l=new Bge;l.setWithCredentials(!0),l.listenOnce(Lge.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case lx.NO_ERROR:const h=l.getResponseJson();ie(Cr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case lx.TIMEOUT:ie(Cr,`RPC '${e}' ${s} timed out`),a(new te(U.DEADLINE_EXCEEDED,"Request time out"));break;case lx.HTTP_ERROR:const g=l.getStatus();if(ie(Cr,`RPC '${e}' ${s} failed with status:`,g,"response text:",l.getResponseText()),g>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const y=m?.error;if(y&&y.status&&y.message){const b=function(T){const P=T.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(P)>=0?P:U.UNKNOWN}(y.status);a(new te(b,y.message))}else a(new te(U.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new te(U.UNAVAILABLE,"Connection failed."));break;default:Ae()}}finally{ie(Cr,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(r);ie(Cr,`RPC '${e}' ${s} sending request:`,r),l.send(t,"POST",u,i,15)})}vo(e,t,i){const r=tP(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=kge(),a=Fge(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.bo(l.initMessageHeaders,t,i),l.encodeInitMessageHeaders=!0;const h=s.join("");ie(Cr,`Creating RPC '${e}' stream ${r}: ${h}`,l);const g=o.createWebChannel(h,l);let m=!1,y=!1;const b=new j_e({co:T=>{y?ie(Cr,`Not sending because RPC '${e}' stream ${r} is closed:`,T):(m||(ie(Cr,`Opening RPC '${e}' stream ${r} transport.`),g.open(),m=!0),ie(Cr,`RPC '${e}' stream ${r} sending:`,T),g.send(T))},lo:()=>g.close()}),w=(T,P,S)=>{T.listen(P,M=>{try{S(M)}catch(L){setTimeout(()=>{throw L},0)}})};return w(g,DT.EventType.OPEN,()=>{y||ie(Cr,`RPC '${e}' stream ${r} transport opened.`)}),w(g,DT.EventType.CLOSE,()=>{y||(y=!0,ie(Cr,`RPC '${e}' stream ${r} transport closed`),b.Ro())}),w(g,DT.EventType.ERROR,T=>{y||(y=!0,gs(Cr,`RPC '${e}' stream ${r} transport errored:`,T),b.Ro(new te(U.UNAVAILABLE,"The operation could not be completed")))}),w(g,DT.EventType.MESSAGE,T=>{var P;if(!y){const S=T.data[0];Pe(!!S);const L=S.error||(null===(P=S[0])||void 0===P?void 0:P.error);if(L){ie(Cr,`RPC '${e}' stream ${r} received error:`,L);const Y=L.status;let pe=function(ln){const jn=yi[ln];if(void 0!==jn)return g5(jn)}(Y),Oe=L.message;void 0===pe&&(pe=U.INTERNAL,Oe="Unknown error status: "+Y+" with message "+L.message),y=!0,b.Ro(new te(pe,Oe)),g.close()}else ie(Cr,`RPC '${e}' stream ${r} received:`,S),b.Vo(S)}}),w(a,Vge.STAT_EVENT,T=>{T.stat===o8.PROXY?ie(Cr,`RPC '${e}' stream ${r} detected buffering proxy`):T.stat===o8.NOPROXY&&ie(Cr,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{b.Ao()},0),b}}function Tz(){return typeof window<"u"?window:null}function iI(){return typeof document<"u"?document:null}function sv(n){return new Jme(n,!0)}class nP{constructor(e,t,i=1e3,r=1.5,s=6e4){this.si=e,this.timerId=t,this.Fo=i,this.Mo=r,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const t=Math.floor(this.Oo+this.qo()),i=Math.max(0,Date.now()-this.Bo),r=Math.max(0,t-i);r>0&&ie("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Oo} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,r,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class Iz{constructor(e,t,i,r,s,o,a,l){this.si=e,this.Ko=i,this.$o=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new nP(e,t)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}stop(){var e=this;return(0,K.Z)(function*(){e.jo()&&(yield e.close(0))})()}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}Xo(){var e=this;return(0,K.Z)(function*(){if(e.Ho())return e.close(0)})()}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(e,t){var i=this;return(0,K.Z)(function*(){i.t_(),i.n_(),i.zo.cancel(),i.Uo++,4!==e?i.zo.reset():t&&t.code===U.RESOURCE_EXHAUSTED?(di(t.toString()),di("Using maximum backoff delay to prevent overloading the backend."),i.zo.Lo()):t&&t.code===U.UNAUTHENTICATED&&3!==i.state&&(i.authCredentialsProvider.invalidateToken(),i.appCheckCredentialsProvider.invalidateToken()),null!==i.stream&&(i.r_(),i.stream.close(),i.stream=null),i.state=e,yield i.listener.Io(t)})()}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),t=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Uo===t&&this.s_(i,r)},i=>{e(()=>{const r=new te(U.UNKNOWN,"Fetching auth token failed: "+i.message);return this.o_(r)})})}s_(e,t){const i=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho(()=>{i(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(r=>{i(()=>this.o_(r))}),this.stream.onMessage(r=>{i(()=>this.onMessage(r))})}Jo(){var e=this;this.state=5,this.zo.ko((0,K.Z)(function*(){e.state=0,e.start()}))}o_(e){return ie("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return t=>{this.si.enqueueAndForget(()=>this.Uo===e?t():(ie("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class H_e extends Iz{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}__(e,t){return this.connection.vo("Listen",e,t)}onMessage(e){this.zo.reset();const t=function t_e(n,e){let t;if("targetChange"in e){const i="NO_CHANGE"===(u=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:Ae(),r=e.targetChange.targetIds||[],s=function(u,h){return u.useProto3Json?(Pe(void 0===h||"string"==typeof h),Ni.fromBase64String(h||"")):(Pe(void 0===h||h instanceof Uint8Array),Ni.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const h=void 0===u.code?U.UNKNOWN:g5(u.code);return new te(h,u.message||"")}(o);t=new b5(i,r,s,a||null)}else if("documentChange"in e){const i=e.documentChange,r=Ra(n,i.document.name),s=hi(i.document.updateTime),o=i.document.createTime?hi(i.document.createTime):ke.min(),a=new ur({mapValue:{fields:i.document.fields}}),l=xn.newFoundDocument(r,s,o,a);t=new $T(i.targetIds||[],i.removedTargetIds||[],l.key,l)}else if("documentDelete"in e){const i=e.documentDelete,r=Ra(n,i.document),s=i.readTime?hi(i.readTime):ke.min(),o=xn.newNoDocument(r,s);t=new $T([],i.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const i=e.documentRemove,r=Ra(n,i.document);t=new $T([],i.removedTargetIds||[],r,null)}else{if(!("filter"in e))return Ae();{const i=e.filter,{count:r=0,unchangedNames:s}=i,o=new Wme(r,s);t=new v5(i.targetId,o)}}var u;return t}(this.serializer,e),i=function(s){if(!("targetChange"in s))return ke.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ke.min():o.readTime?hi(o.readTime):ke.min()}(e);return this.listener.a_(t,i)}u_(e){const t={};t.database=Yy(this.serializer),t.addTarget=function(s,o){let a;const l=o.target;if(a=kT(l)?{documents:N5(s,l)}:{query:Ox(s,l)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=I5(s,o.resumeToken);const u=Rx(s,o.expectedCount);null!==u&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ke.min())>0){a.readTime=$p(s,o.snapshotVersion.toTimestamp());const u=Rx(s,o.expectedCount);null!==u&&(a.expectedCount=u)}return a}(this.serializer,e);const i=function i_e(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ae()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);i&&(t.labels=i),this.e_(t)}c_(e){const t={};t.database=Yy(this.serializer),t.removeTarget=e,this.e_(t)}}class G_e extends Iz{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,t){return this.connection.vo("Write",e,t)}onMessage(e){if(Pe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const t=function n_e(n,e){return n&&n.length>0?(Pe(void 0!==e),n.map(t=>function(r,s){let o=hi(r.updateTime?r.updateTime:s);return o.isEqual(ke.min())&&(o=hi(s)),new $me(o,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),i=hi(e.commitTime);return this.listener.I_(i,t)}return Pe(!e.writeResults||0===e.writeResults.length),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=Yy(this.serializer),this.e_(e)}P_(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>Qy(this.serializer,i))};this.e_(t)}}class z_e extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.d_=!1}A_(){if(this.d_)throw new te(U.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,t,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection.wo(e,t,i,r,s)).catch(r=>{throw"FirebaseError"===r.name?(r.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new te(U.UNKNOWN,r.toString())})}Co(e,t,i,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,t,i,s,o,r)).catch(s=>{throw"FirebaseError"===s.name?(s.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new te(U.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class q_e{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,"Online"===e&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(di(t),this.f_=!1):ie("OnlineStateTracker",t)}S_(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}class K_e{constructor(e,t,i,r,s){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{i.enqueueAndForget((0,K.Z)(function*(){var l;eu(o)&&(ie("RemoteStore","Restarting streams for network reachability change."),yield(l=(0,K.Z)(function*(h){const g=Ee(h);g.C_.add(4),yield Yp(g),g.M_.set("Unknown"),g.C_.delete(4),yield ov(g)}),function u(h){return l.apply(this,arguments)})(o))}))}),this.M_=new q_e(i,r)}}function ov(n){return rP.apply(this,arguments)}function rP(){return rP=(0,K.Z)(function*(n){if(eu(n))for(const e of n.v_)yield e(!0)}),rP.apply(this,arguments)}function Yp(n){return sP.apply(this,arguments)}function sP(){return sP=(0,K.Z)(function*(n){for(const e of n.v_)yield e(!1)}),sP.apply(this,arguments)}function rI(n,e){const t=Ee(n);t.D_.has(e.targetId)||(t.D_.set(e.targetId,e),lP(t)?aP(t):Jp(t).Ho()&&oP(t,e))}function av(n,e){const t=Ee(n),i=Jp(t);t.D_.delete(e),i.Ho()&&Cz(t,e),0===t.D_.size&&(i.Ho()?i.Zo():eu(t)&&t.M_.set("Unknown"))}function oP(n,e){if(n.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ke.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Jp(n).u_(e)}function Cz(n,e){n.x_.Oe(e),Jp(n).c_(e)}function aP(n){n.x_=new Kme({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>n.D_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),Jp(n).start(),n.M_.g_()}function lP(n){return eu(n)&&!Jp(n).jo()&&n.D_.size>0}function eu(n){return 0===Ee(n).C_.size}function Dz(n){n.x_=void 0}function Z_e(n){return cP.apply(this,arguments)}function cP(){return cP=(0,K.Z)(function*(n){n.D_.forEach((e,t)=>{oP(n,e)})}),cP.apply(this,arguments)}function Y_e(n,e){return uP.apply(this,arguments)}function uP(){return uP=(0,K.Z)(function*(n,e){Dz(n),lP(n)?(n.M_.w_(e),aP(n)):n.M_.set("Unknown")}),uP.apply(this,arguments)}function Q_e(n,e,t){return dP.apply(this,arguments)}function dP(){return dP=(0,K.Z)(function*(n,e,t){if(n.M_.set("Online"),e instanceof b5&&2===e.state&&e.cause)try{yield(i=(0,K.Z)(function*(s,o){const a=o.cause;for(const l of o.targetIds)s.D_.has(l)&&(yield s.remoteSyncer.rejectListen(l,a),s.D_.delete(l),s.x_.removeTarget(l))}),function r(s,o){return i.apply(this,arguments)})(n,e)}catch(i){ie("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield sI(n,i)}else if(e instanceof $T?n.x_.$e(e):e instanceof v5?n.x_.Je(e):n.x_.Ge(e),!t.isEqual(ke.min()))try{const i=yield pz(n.localStore);t.compareTo(i)>=0&&(yield function(s,o){const a=s.x_.it(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.D_.get(u);h&&s.D_.set(u,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const h=s.D_.get(l);if(!h)return;s.D_.set(l,h.withResumeToken(Ni.EMPTY_BYTE_STRING,h.snapshotVersion)),Cz(s,l);const g=new Nl(h.target,l,u,h.sequenceNumber);oP(s,g)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(i){ie("RemoteStore","Failed to raise snapshot:",i),yield sI(n,i)}var i}),dP.apply(this,arguments)}function sI(n,e,t){return hP.apply(this,arguments)}function hP(){return hP=(0,K.Z)(function*(n,e,t){if(!$c(e))throw e;n.C_.add(1),yield Yp(n),n.M_.set("Offline"),t||(t=()=>pz(n.localStore)),n.asyncQueue.enqueueRetryable((0,K.Z)(function*(){ie("RemoteStore","Retrying IndexedDB access"),yield t(),n.C_.delete(1),yield ov(n)}))}),hP.apply(this,arguments)}function Sz(n,e){return e().catch(t=>sI(n,t,e))}function Qp(n){return fP.apply(this,arguments)}function fP(){return fP=(0,K.Z)(function*(n){const e=Ee(n),t=tu(e);let i=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;J_e(e);)try{const r=yield F_e(e.localStore,i);if(null===r){0===e.b_.length&&t.Zo();break}i=r.batchId,X_e(e,r)}catch(r){yield sI(e,r)}Az(e)&&Rz(e)}),fP.apply(this,arguments)}function J_e(n){return eu(n)&&n.b_.length<10}function X_e(n,e){n.b_.push(e);const t=tu(n);t.Ho()&&t.h_&&t.P_(e.mutations)}function Az(n){return eu(n)&&!tu(n).jo()&&n.b_.length>0}function Rz(n){tu(n).start()}function eye(n){return pP.apply(this,arguments)}function pP(){return pP=(0,K.Z)(function*(n){tu(n).E_()}),pP.apply(this,arguments)}function tye(n){return gP.apply(this,arguments)}function gP(){return gP=(0,K.Z)(function*(n){const e=tu(n);for(const t of n.b_)e.P_(t.mutations)}),gP.apply(this,arguments)}function nye(n,e,t){return mP.apply(this,arguments)}function mP(){return mP=(0,K.Z)(function*(n,e,t){const i=n.b_.shift(),r=Dx.from(i,e,t);yield Sz(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield Qp(n)}),mP.apply(this,arguments)}function iye(n,e){return _P.apply(this,arguments)}function _P(){return _P=(0,K.Z)(function*(n,e){var t;e&&tu(n).h_&&(yield(t=(0,K.Z)(function*(r,s){if(p5(a=s.code)&&a!==U.ABORTED){const o=r.b_.shift();tu(r).Yo(),yield Sz(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield Qp(r)}var a}),function i(r,s){return t.apply(this,arguments)})(n,e)),Az(n)&&Rz(n)}),_P.apply(this,arguments)}function Nz(n,e){return yP.apply(this,arguments)}function yP(){return yP=(0,K.Z)(function*(n,e){const t=Ee(n);t.asyncQueue.verifyOperationInProgress(),ie("RemoteStore","RemoteStore received new credentials");const i=eu(t);t.C_.add(3),yield Yp(t),i&&t.M_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.C_.delete(3),yield ov(t)}),yP.apply(this,arguments)}function vP(n,e){return bP.apply(this,arguments)}function bP(){return bP=(0,K.Z)(function*(n,e){const t=Ee(n);e?(t.C_.delete(2),yield ov(t)):e||(t.C_.add(2),yield Yp(t),t.M_.set("Unknown"))}),bP.apply(this,arguments)}function Jp(n){return n.O_||(n.O_=function(t,i,r){const s=Ee(t);return s.A_(),new H_e(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{ho:Z_e.bind(null,n),Io:Y_e.bind(null,n),a_:Q_e.bind(null,n)}),n.v_.push(function(){var e=(0,K.Z)(function*(t){t?(n.O_.Yo(),lP(n)?aP(n):n.M_.set("Unknown")):(yield n.O_.stop(),Dz(n))});return function(t){return e.apply(this,arguments)}}())),n.O_}function tu(n){return n.N_||(n.N_=function(t,i,r){const s=Ee(t);return s.A_(),new G_e(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{ho:eye.bind(null,n),Io:iye.bind(null,n),T_:tye.bind(null,n),I_:nye.bind(null,n)}),n.v_.push(function(){var e=(0,K.Z)(function*(t){t?(n.N_.Yo(),yield Qp(n)):(yield n.N_.stop(),n.b_.length>0&&(ie("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))});return function(t){return e.apply(this,arguments)}}())),n.N_}class EP{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new Ri,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,a=new EP(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new te(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xp(n,e){if(di("AsyncQueue",`${e}: ${n}`),$c(n))return new te(U.UNAVAILABLE,`${e}: ${n}`);throw n}class eg{constructor(e){this.comparator=e?(t,i)=>e(t,i)||we.comparator(t.key,i.key):(t,i)=>we.comparator(t.key,i.key),this.keyedMap=$y(),this.sortedSet=new En(this.comparator)}static emptySet(e){return new eg(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof eg)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const i=new eg;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class xz{constructor(){this.B_=new En(we.comparator)}track(e){const t=e.doc.key,i=this.B_.get(t);i?0!==e.type&&3===i.type?this.B_=this.B_.insert(t,e):3===e.type&&1!==i.type?this.B_=this.B_.insert(t,{type:i.type,doc:e.doc}):2===e.type&&2===i.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===i.type?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===i.type?this.B_=this.B_.remove(t):1===e.type&&2===i.type?this.B_=this.B_.insert(t,{type:1,doc:i.doc}):0===e.type&&1===i.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):Ae():this.B_=this.B_.insert(t,e)}L_(){const e=[];return this.B_.inorderTraversal((t,i)=>{e.push(i)}),e}}class tg{constructor(e,t,i,r,s,o,a,l,u){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,i,r,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new tg(e,t,eg.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uy(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}class rye{constructor(){this.k_=void 0,this.listeners=[]}}class sye{constructor(){this.queries=new Al(e=>Z8(e),Uy),this.onlineState="Unknown",this.q_=new Set}}function wP(n,e){return TP.apply(this,arguments)}function TP(){return TP=(0,K.Z)(function*(n,e){const t=Ee(n),i=e.query;let r=!1,s=t.queries.get(i);if(s||(r=!0,s=new rye),r)try{s.k_=yield t.onListen(i)}catch(o){const a=Xp(o,`Initialization of query '${Lp(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.listeners.push(e),e.Q_(t.onlineState),s.k_&&e.K_(s.k_)&&DP(t)}),TP.apply(this,arguments)}function IP(n,e){return CP.apply(this,arguments)}function CP(){return CP=(0,K.Z)(function*(n,e){const t=Ee(n),i=e.query;let r=!1;const s=t.queries.get(i);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),r=0===s.listeners.length)}if(r)return t.queries.delete(i),t.onUnlisten(i)}),CP.apply(this,arguments)}function oye(n,e){const t=Ee(n);let i=!1;for(const r of e){const o=t.queries.get(r.query);if(o){for(const a of o.listeners)a.K_(r)&&(i=!0);o.k_=r}}i&&DP(t)}function aye(n,e,t){const i=Ee(n),r=i.queries.get(e);if(r)for(const s of r.listeners)s.onError(t);i.queries.delete(e)}function DP(n){n.q_.forEach(e=>{e.next()})}class SP{constructor(e,t,i){this.query=e,this.U_=t,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=i||{}}K_(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)3!==r.type&&i.push(r);e=new tg(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.W_?this.z_(e)&&(this.U_.next(e),t=!0):this.j_(e,this.onlineState)&&(this.H_(e),t=!0),this.G_=e,t}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}j_(e,t){return!e.fromCache||(!this.options.J_||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}z_(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}H_(e){e=tg.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class lye{constructor(e,t){this.Y_=e,this.byteLength=t}Z_(){return"metadata"in this.Y_}}class Pz{constructor(e){this.serializer=e}hs(e){return Ra(this.serializer,e)}Ps(e){return e.metadata.exists?R5(this.serializer,e.document,!1):xn.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return hi(e)}}class cye{constructor(e,t,i){this.X_=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Oz(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++t;const i=kt.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ta(e){const t=new Map,i=new Pz(this.serializer);for(const r of e)if(r.metadata.queries){const s=i.hs(r.metadata.name);for(const o of r.metadata.queries){const a=(t.get(o)||ct()).add(s);t.set(o,a)}}return t}complete(){var e=this;return(0,K.Z)(function*(){const t=yield function L_e(n,e,t,i){return Zx.apply(this,arguments)}(e.localStore,new Pz(e.serializer),e.documents,e.X_.id),i=e.ta(e.documents);for(const r of e.queries)yield V_e(e.localStore,r,i.get(r.name));return e.progress.taskState="Success",{progress:e.progress,na:e.collectionGroups,ra:t}})()}}function Oz(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class Mz{constructor(e){this.key=e}}class kz{constructor(e){this.key=e}}class Fz{constructor(e,t){this.query=e,this.ia=t,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=ct(),this.mutatedKeys=ct(),this._a=Q8(e),this.aa=new eg(this._a)}get ua(){return this.ia}ca(e,t){const i=t?t.la:new xz,r=t?t.aa:this.aa;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,u="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((h,g)=>{const m=r.get(h),y=jy(this.query,g)?g:null,b=!!m&&this.mutatedKeys.has(m.key),w=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let T=!1;m&&y?m.data.isEqual(y.data)?b!==w&&(i.track({type:3,doc:y}),T=!0):this.ha(m,y)||(i.track({type:2,doc:y}),T=!0,(l&&this._a(y,l)>0||u&&this._a(y,u)<0)&&(a=!0)):!m&&y?(i.track({type:0,doc:y}),T=!0):m&&!y&&(i.track({type:1,doc:m}),T=!0,(l||u)&&(a=!0)),T&&(y?(o=o.add(y),s=w?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const h="F"===this.query.limitType?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),i.track({type:1,doc:h})}return{aa:o,la:i,Zi:a,mutatedKeys:s}}ha(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const o=e.la.L_();o.sort((h,g)=>function(y,b){const w=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ae()}};return w(y)-w(b)}(h.type,g.type)||this._a(h.doc,g.doc)),this.Pa(i),r=null!=r&&r;const a=t&&!r?this.Ia():[],l=0===this.oa.size&&this.current&&!r?1:0,u=l!==this.sa;return this.sa=l,0!==o.length||u?{snapshot:new tg(this.query,e.aa,s,o,e.mutatedKeys,0===l,u,!1,!!i&&i.resumeToken.approximateByteSize()>0),Ta:a}:{Ta:a}}Q_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({aa:this.aa,la:new xz,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(t=>this.ia=this.ia.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.ia=this.ia.delete(t)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=ct(),this.aa.forEach(i=>{this.Ea(i.key)&&(this.oa=this.oa.add(i.key))});const t=[];return e.forEach(i=>{this.oa.has(i)||t.push(new kz(i))}),this.oa.forEach(i=>{e.has(i)||t.push(new Mz(i))}),t}da(e){this.ia=e.ls,this.oa=ct();const t=this.ca(e.documents);return this.applyChanges(t,!0)}Aa(){return tg.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}class uye{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class dye{constructor(e){this.key=e,this.Ra=!1}}class hye{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new Al(a=>Z8(a),Uy),this.fa=new Map,this.ga=new Set,this.pa=new En(we.comparator),this.ya=new Map,this.wa=new jx,this.Sa={},this.ba=new Map,this.Da=jd.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}function fye(n,e){return AP.apply(this,arguments)}function AP(){return AP=(0,K.Z)(function*(n,e){const t=QP(n);let i,r;const s=t.ma.get(e);if(s)i=s.targetId,t.sharedClientState.addLocalQueryTarget(i),r=s.view.Aa();else{const o=yield Kp(t.localStore,Br(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);i=o.targetId,r=yield RP(t,e,i,"current"===a,o.resumeToken),t.isPrimaryClient&&rI(t.remoteStore,o)}return r}),AP.apply(this,arguments)}function RP(n,e,t,i,r){return NP.apply(this,arguments)}function NP(){return NP=(0,K.Z)(function*(n,e,t,i,r){n.va=(g,m,y)=>{return(b=(0,K.Z)(function*(T,P,S,M){let L=P.view.ca(S);L.Zi&&(L=yield XT(T.localStore,P.query,!1).then(({documents:Ge})=>P.view.ca(Ge,L)));const Y=M&&M.targetChanges.get(P.targetId),pe=M&&null!=M.targetMismatches.get(P.targetId),Oe=P.view.applyChanges(L,T.isPrimaryClient,Y,pe);return UP(T,P.targetId,Oe.Ta),Oe.snapshot}),function w(T,P,S,M){return b.apply(this,arguments)})(n,g,m,y);var b};const s=yield XT(n.localStore,e,!0),o=new Fz(e,s.ls),a=o.ca(s.documents),l=Ky.createSynthesizedTargetChangeForCurrentChange(t,i&&"Offline"!==n.onlineState,r),u=o.applyChanges(a,n.isPrimaryClient,l);UP(n,t,u.Ta);const h=new uye(e,t,o);return n.ma.set(e,h),n.fa.has(t)?n.fa.get(t).push(e):n.fa.set(t,[e]),u.snapshot}),NP.apply(this,arguments)}function pye(n,e){return xP.apply(this,arguments)}function xP(){return xP=(0,K.Z)(function*(n,e){const t=Ee(n),i=t.ma.get(e),r=t.fa.get(i.targetId);if(r.length>1)return t.fa.set(i.targetId,r.filter(s=>!Uy(s,e))),void t.ma.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(i.targetId),t.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Zp(t.localStore,i.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(i.targetId),av(t.remoteStore,i.targetId),ng(t,i.targetId)}).catch(jc))):(ng(t,i.targetId),yield Zp(t.localStore,i.targetId,!0))}),xP.apply(this,arguments)}function PP(){return PP=(0,K.Z)(function*(n,e,t){const i=JP(n);try{const r=yield function(o,a){const l=Ee(o),u=Vn.now(),h=a.reduce((y,b)=>y.add(b.key),ct());let g,m;return l.persistence.runTransaction("Locally write mutations","readwrite",y=>{let b=_s(),w=ct();return l.ss.getEntries(y,h).next(T=>{b=T,b.forEach((P,S)=>{S.isValidDocument()||(w=w.add(P))})}).next(()=>l.localDocuments.getOverlayedDocuments(y,b)).next(T=>{g=T;const P=[];for(const S of a){const M=Gme(S,g.get(S.key).overlayedDocument);null!=M&&P.push(new Rl(S.key,M,M8(M.value.mapValue),Bn.exists(!0)))}return l.mutationQueue.addMutationBatch(y,u,P,a)}).next(T=>{m=T;const P=T.applyToLocalDocumentSet(g,w);return l.documentOverlayCache.saveOverlays(y,T.batchId,P)})}).then(()=>({batchId:m.batchId,changes:X8(g)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(o,a,l){let u=o.Sa[o.currentUser.toKey()];u||(u=new En(Ze)),u=u.insert(a,l),o.Sa[o.currentUser.toKey()]=u}(i,r.batchId,t),yield xl(i,r.changes),yield Qp(i.remoteStore)}catch(r){const s=Xp(r,"Failed to persist write");t.reject(s)}}),PP.apply(this,arguments)}function Lz(n,e){return OP.apply(this,arguments)}function OP(){return OP=(0,K.Z)(function*(n,e){const t=Ee(n);try{const i=yield function k_e(n,e){const t=Ee(n),i=e.snapshotVersion;let r=t.ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.ss.newChangeBuffer({trackRemovals:!0});r=t.ts;const a=[];e.targetChanges.forEach((h,g)=>{const m=r.get(g);if(!m)return;a.push(t.qr.removeMatchingKeys(s,h.removedDocuments,g).next(()=>t.qr.addMatchingKeys(s,h.addedDocuments,g)));let y=m.withSequenceNumber(s.currentSequenceNumber);var w,T,P;null!==e.targetMismatches.get(g)?y=y.withResumeToken(Ni.EMPTY_BYTE_STRING,ke.min()).withLastLimboFreeSnapshotVersion(ke.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,i)),r=r.insert(g,y),T=y,P=h,(0===(w=m).resumeToken.approximateByteSize()||T.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8||P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0)&&a.push(t.qr.updateTargetData(s,y))});let l=_s(),u=ct();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(gz(s,o,e.documentUpdates).next(h=>{l=h.us,u=h.cs})),!i.isEqual(ke.min())){const h=t.qr.getLastRemoteSnapshotVersion(s).next(g=>t.qr.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(h)}return F.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(t.ts=r,s))}(t.localStore,e);e.targetChanges.forEach((r,s)=>{const o=t.ya.get(s);o&&(Pe(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.Ra=!0:r.modifiedDocuments.size>0?Pe(o.Ra):r.removedDocuments.size>0&&(Pe(o.Ra),o.Ra=!1))}),yield xl(t,i,e)}catch(i){yield jc(i)}}),OP.apply(this,arguments)}function Vz(n,e,t){const i=Ee(n);if(i.isPrimaryClient&&0===t||!i.isPrimaryClient&&1===t){const r=[];i.ma.forEach((s,o)=>{const a=o.view.Q_(e);a.snapshot&&r.push(a.snapshot)}),function(o,a){const l=Ee(o);l.onlineState=a;let u=!1;l.queries.forEach((h,g)=>{for(const m of g.listeners)m.Q_(a)&&(u=!0)}),u&&DP(l)}(i.eventManager,e),r.length&&i.Va.a_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function mye(n,e,t){return MP.apply(this,arguments)}function MP(){return MP=(0,K.Z)(function*(n,e,t){const i=Ee(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.ya.get(e),s=r&&r.key;if(s){let o=new En(we.comparator);o=o.insert(s,xn.newNoDocument(s,ke.min()));const a=ct().add(s),l=new qy(ke.min(),new Map,new En(Ze),o,a);yield Lz(i,l),i.pa=i.pa.remove(s),i.ya.delete(e),jP(i)}else yield Zp(i.localStore,e,!1).then(()=>ng(i,e,t)).catch(jc)}),MP.apply(this,arguments)}function _ye(n,e){return kP.apply(this,arguments)}function kP(){return kP=(0,K.Z)(function*(n,e){const t=Ee(n),i=e.batch.batchId;try{const r=yield function M_e(n,e){const t=Ee(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=e.batch.keys(),s=t.ss.newChangeBuffer({trackRemovals:!0});return function(a,l,u,h){const g=u.batch,m=g.keys();let y=F.resolve();return m.forEach(b=>{y=y.next(()=>h.getEntry(l,b)).next(w=>{const T=u.docVersions.get(b);Pe(null!==T),w.version.compareTo(T)<0&&(g.applyToRemoteDocument(w,u),w.isValidDocument()&&(w.setReadTime(u.commitVersion),h.addEntry(w)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(l,g))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(a){let l=ct();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}(t.localStore,e);BP(t,i,null),VP(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield xl(t,r)}catch(r){yield jc(r)}}),kP.apply(this,arguments)}function yye(n,e,t){return FP.apply(this,arguments)}function FP(){return FP=(0,K.Z)(function*(n,e,t){const i=Ee(n);try{const r=yield function(o,a){const l=Ee(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return l.mutationQueue.lookupMutationBatch(u,a).next(g=>(Pe(null!==g),h=g.keys(),l.mutationQueue.removeMutationBatch(u,g))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>l.localDocuments.getDocuments(u,h))})}(i.localStore,e);BP(i,e,t),VP(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield xl(i,r)}catch(r){yield jc(r)}}),FP.apply(this,arguments)}function LP(){return LP=(0,K.Z)(function*(n,e){const t=Ee(n);eu(t.remoteStore)||ie("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=yield function(o){const a=Ee(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(-1===i)return void e.resolve();const r=t.ba.get(i)||[];r.push(e),t.ba.set(i,r)}catch(i){const r=Xp(i,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}),LP.apply(this,arguments)}function VP(n,e){(n.ba.get(e)||[]).forEach(t=>{t.resolve()}),n.ba.delete(e)}function BP(n,e,t){const i=Ee(n);let r=i.Sa[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Sa[i.currentUser.toKey()]=r}}function ng(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.fa.get(e))n.ma.delete(i),t&&n.Va.Fa(i,t);n.fa.delete(e),n.isPrimaryClient&&n.wa.Rr(e).forEach(i=>{n.wa.containsKey(i)||Bz(n,i)})}function Bz(n,e){n.ga.delete(e.path.canonicalString());const t=n.pa.get(e);null!==t&&(av(n.remoteStore,t),n.pa=n.pa.remove(e),n.ya.delete(t),jP(n))}function UP(n,e,t){for(const i of t)i instanceof Mz?(n.wa.addReference(i.key,e),bye(n,i)):i instanceof kz?(ie("SyncEngine","Document no longer in limbo: "+i.key),n.wa.removeReference(i.key,e),n.wa.containsKey(i.key)||Bz(n,i.key)):Ae()}function bye(n,e){const t=e.key,i=t.path.canonicalString();n.pa.get(t)||n.ga.has(i)||(ie("SyncEngine","New document in limbo: "+t),n.ga.add(i),jP(n))}function jP(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const e=n.ga.values().next().value;n.ga.delete(e);const t=new we(kt.fromString(e)),i=n.Da.next();n.ya.set(i,new dye(t)),n.pa=n.pa.insert(t,i),rI(n.remoteStore,new Nl(Br(kp(t.path)),i,"TargetPurposeLimboResolution",Fs._e))}}function xl(n,e,t){return $P.apply(this,arguments)}function $P(){return $P=(0,K.Z)(function*(n,e,t){const i=Ee(n),r=[],s=[],o=[];var a;i.ma.isEmpty()||(i.ma.forEach((a,l)=>{o.push(i.va(l,e,t).then(u=>{if((u||t)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(l.targetId,u?.fromCache?"not-current":"current"),u){r.push(u);const h=Wx.Qi(l.targetId,u);s.push(h)}}))}),yield Promise.all(o),i.Va.a_(r),yield(a=(0,K.Z)(function*(u,h){const g=Ee(u);try{yield g.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>F.forEach(h,y=>F.forEach(y.ki,b=>g.persistence.referenceDelegate.addReference(m,y.targetId,b)).next(()=>F.forEach(y.qi,b=>g.persistence.referenceDelegate.removeReference(m,y.targetId,b)))))}catch(m){if(!$c(m))throw m;ie("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const y=m.targetId;if(!m.fromCache){const b=g.ts.get(y),T=b.withLastLimboFreeSnapshotVersion(b.snapshotVersion);g.ts=g.ts.insert(y,T)}}}),function l(u,h){return a.apply(this,arguments)})(i.localStore,s))}),$P.apply(this,arguments)}function Eye(n,e){return HP.apply(this,arguments)}function HP(){return HP=(0,K.Z)(function*(n,e){const t=Ee(n);if(!t.currentUser.isEqual(e)){ie("SyncEngine","User change. New user:",e.toKey());const i=yield fz(t.localStore,e);t.currentUser=e,(s=t).ba.forEach(a=>{a.forEach(l=>{l.reject(new te(U.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.ba.clear(),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield xl(t,i._s)}var s}),HP.apply(this,arguments)}function wye(n,e){const t=Ee(n),i=t.ya.get(e);if(i&&i.Ra)return ct().add(i.key);{let r=ct();const s=t.fa.get(e);if(!s)return r;for(const o of s){const a=t.ma.get(o);r=r.unionWith(a.view.ua)}return r}}function Tye(n,e){return GP.apply(this,arguments)}function GP(){return GP=(0,K.Z)(function*(n,e){const t=Ee(n),i=yield XT(t.localStore,e.query,!0),r=e.view.da(i);return t.isPrimaryClient&&UP(t,e.targetId,r.Ta),r}),GP.apply(this,arguments)}function Iye(n,e){return zP.apply(this,arguments)}function zP(){return zP=(0,K.Z)(function*(n,e){const t=Ee(n);return _z(t.localStore,e).then(i=>xl(t,i))}),zP.apply(this,arguments)}function Cye(n,e,t,i){return WP.apply(this,arguments)}function WP(){return WP=(0,K.Z)(function*(n,e,t,i){const r=Ee(n),s=yield function(a,l){const u=Ee(a),h=Ee(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",g=>h.Cn(g,l).next(m=>m?u.localDocuments.getDocuments(g,m):F.resolve(null)))}(r.localStore,e);var l;null!==s?("pending"===t?yield Qp(r.remoteStore):"acknowledged"===t||"rejected"===t?(BP(r,e,i||null),VP(r,e),l=e,Ee(Ee(r.localStore).mutationQueue).Fn(l)):Ae(),yield xl(r,s)):ie("SyncEngine","Cannot apply mutation batch with id: "+e)}),WP.apply(this,arguments)}function qP(){return qP=(0,K.Z)(function*(n,e){const t=Ee(n);if(QP(t),JP(t),!0===e&&!0!==t.Ca){const i=t.sharedClientState.getAllActiveQueryTargets(),r=yield Uz(t,i.toArray());t.Ca=!0,yield vP(t.remoteStore,!0);for(const s of r)rI(t.remoteStore,s)}else if(!1===e&&!1!==t.Ca){const i=[];let r=Promise.resolve();t.fa.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?i.push(o):r=r.then(()=>(ng(t,o),Zp(t.localStore,o,!0))),av(t.remoteStore,o)}),yield r,yield Uz(t,i),function(o){const a=Ee(o);a.ya.forEach((l,u)=>{av(a.remoteStore,u)}),a.wa.Vr(),a.ya=new Map,a.pa=new En(we.comparator)}(t),t.Ca=!1,yield vP(t.remoteStore,!1)}}),qP.apply(this,arguments)}function Uz(n,e,t){return KP.apply(this,arguments)}function KP(){return KP=(0,K.Z)(function*(n,e,t){const i=Ee(n),r=[],s=[];for(const o of e){let a;const l=i.fa.get(o);if(l&&0!==l.length){a=yield Kp(i.localStore,Br(l[0]));for(const u of l){const h=i.ma.get(u),g=yield Tye(i,h);g.snapshot&&s.push(g.snapshot)}}else{const u=yield mz(i.localStore,o);a=yield Kp(i.localStore,u),yield RP(i,jz(u),o,!1,a.resumeToken)}r.push(a)}return i.Va.a_(s),r}),KP.apply(this,arguments)}function jz(n){return W8(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Sye(n){return t=Ee(n).localStore,Ee(Ee(t).persistence).Bi();var t}function Aye(n,e,t,i){return ZP.apply(this,arguments)}function ZP(){return ZP=(0,K.Z)(function*(n,e,t,i){const r=Ee(n);if(r.Ca)return void ie("SyncEngine","Ignoring unexpected query state notification.");const s=r.fa.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=yield _z(r.localStore,Y8(s[0])),a=qy.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,Ni.EMPTY_BYTE_STRING);yield xl(r,o,a);break}case"rejected":yield Zp(r.localStore,e,!0),ng(r,e,i);break;default:Ae()}}),ZP.apply(this,arguments)}function Rye(n,e,t){return YP.apply(this,arguments)}function YP(){return YP=(0,K.Z)(function*(n,e,t){const i=QP(n);if(i.Ca){for(const r of e){if(i.fa.has(r)){ie("SyncEngine","Adding an already active target "+r);continue}const s=yield mz(i.localStore,r),o=yield Kp(i.localStore,s);yield RP(i,jz(s),o.targetId,!1,o.resumeToken),rI(i.remoteStore,o)}for(const r of t)i.fa.has(r)&&(yield Zp(i.localStore,r,!1).then(()=>{av(i.remoteStore,r),ng(i,r)}).catch(jc))}}),YP.apply(this,arguments)}function QP(n){const e=Ee(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Lz.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=wye.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=mye.bind(null,e),e.Va.a_=oye.bind(null,e.eventManager),e.Va.Fa=aye.bind(null,e.eventManager),e}function JP(n){const e=Ee(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_ye.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=yye.bind(null,e),e}class lv{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,K.Z)(function*(){t.serializer=sv(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return hz(this.persistence,new dz,e.initialUser,this.serializer)}createPersistence(e){return new $x(YT.jr,this.serializer)}createSharedClientState(e){return new Ez}terminate(){var e=this;return(0,K.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class XP extends lv{constructor(e,t,i){super(),this.xa=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,i=this;return(0,K.Z)(function*(){yield t().call(i,e),yield i.xa.initialize(i,e),yield JP(i.xa.syncEngine),yield Qp(i.xa.remoteStore),yield i.persistence.mi(()=>(i.gcScheduler&&!i.gcScheduler.started&&i.gcScheduler.start(),i.indexBackfillerScheduler&&!i.indexBackfillerScheduler.started&&i.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return hz(this.persistence,new dz,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new nz(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const i=new nme(t,this.persistence);return new tme(e.asyncQueue,i)}createPersistence(e){const t=zx(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=void 0!==this.cacheSizeBytes?Ir.withCacheSize(this.cacheSizeBytes):Ir.DEFAULT;return new Gx(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,Tz(),iI(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Ez}}class $z extends XP{constructor(e,t){super(e,t,!1),this.xa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,i=this;return(0,K.Z)(function*(){yield t().call(i,e);const r=i.xa.syncEngine;i.sharedClientState instanceof eP&&(i.sharedClientState.syncEngine={Ys:Cye.bind(null,r),Zs:Aye.bind(null,r),Xs:Rye.bind(null,r),Bi:Sye.bind(null,r),Js:Iye.bind(null,r)},yield i.sharedClientState.start()),yield i.persistence.mi(function(){var s=(0,K.Z)(function*(o){yield function Dye(n,e){return qP.apply(this,arguments)}(i.xa.syncEngine,o),i.gcScheduler&&(o&&!i.gcScheduler.started?i.gcScheduler.start():o||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(o&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():o||i.indexBackfillerScheduler.stop())});return function(o){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const t=Tz();if(!eP.D(t))throw new te(U.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=zx(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new eP(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class ig{initialize(e,t){var i=this;return(0,K.Z)(function*(){i.localStore||(i.localStore=e.localStore,i.sharedClientState=e.sharedClientState,i.datastore=i.createDatastore(t),i.remoteStore=i.createRemoteStore(t),i.eventManager=i.createEventManager(t),i.syncEngine=i.createSyncEngine(t,!e.synchronizeTabs),i.sharedClientState.onlineStateHandler=r=>Vz(i.syncEngine,r,1),i.remoteStore.remoteSyncer.handleCredentialChange=Eye.bind(null,i.syncEngine),yield vP(i.remoteStore,i.syncEngine.isPrimaryClient))})()}createEventManager(e){return new sye}createDatastore(e){const t=sv(e.databaseInfo.databaseId),i=new $_e(e.databaseInfo);return new z_e(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return i=this.localStore,r=this.datastore,s=e.asyncQueue,o=t=>Vz(this.syncEngine,t,0),a=wz.D()?new wz:new B_e,new K_e(i,r,s,o,a);var i,r,s,o,a}createSyncEngine(e,t){return function(r,s,o,a,l,u,h){const g=new hye(r,s,o,a,l,u);return h&&(g.Ca=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,K.Z)(function*(i){const r=Ee(i);ie("RemoteStore","RemoteStore shutting down."),r.C_.add(5),yield Yp(r),r.F_.shutdown(),r.M_.set("Unknown")}),function t(i){return e.apply(this,arguments)})(this.remoteStore);var e}}function Hz(n,e=10240){let t=0;return{read:()=>(0,K.Z)(function*(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})(),cancel:()=>(0,K.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class oI{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):di("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Pye{constructor(e,t){this.Ba=e,this.serializer=t,this.metadata=new Ri,this.buffer=new Uint8Array,this.La=new TextDecoder("utf-8"),this.ka().then(i=>{i&&i.Z_()?this.metadata.resolve(i.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(i?.Y_)}`))},i=>this.metadata.reject(i))}close(){return this.Ba.cancel()}getMetadata(){var e=this;return(0,K.Z)(function*(){return e.metadata.promise})()}Ma(){var e=this;return(0,K.Z)(function*(){return yield e.getMetadata(),e.ka()})()}ka(){var e=this;return(0,K.Z)(function*(){const t=yield e.qa();if(null===t)return null;const i=e.La.decode(t),r=Number(i);isNaN(r)&&e.Qa(`length string (${i}) is not valid number`);const s=yield e.Ka(r);return new lye(JSON.parse(s),t.length+r)})()}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}qa(){var e=this;return(0,K.Z)(function*(){for(;e.$a()<0&&!(yield e.Ua()););if(0===e.buffer.length)return null;const t=e.$a();t<0&&e.Qa("Reached the end of bundle when a length string is expected.");const i=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),i})()}Ka(e){var t=this;return(0,K.Z)(function*(){for(;t.buffer.length<e;)(yield t.Ua())&&t.Qa("Reached the end of bundle when more is expected.");const i=t.La.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),i})()}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}Ua(){var e=this;return(0,K.Z)(function*(){const t=yield e.Ba.read();if(!t.done){const i=new Uint8Array(e.buffer.length+t.value.length);i.set(e.buffer),i.set(t.value,e.buffer.length),e.buffer=i}return t.done})()}}class Oye{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,K.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new te(U.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const i=yield(r=(0,K.Z)(function*(o,a){const l=Ee(o),u=Yy(l.serializer)+"/documents",h={documents:a.map(b=>Zy(l.serializer,b))},g=yield l.Co("BatchGetDocuments",u,h,a.length),m=new Map;g.forEach(b=>{const w=function e_e(n,e){return"found"in e?function(i,r){Pe(!!r.found);const s=Ra(i,r.found.name),o=hi(r.found.updateTime),a=r.found.createTime?hi(r.found.createTime):ke.min(),l=new ur({mapValue:{fields:r.found.fields}});return xn.newFoundDocument(s,o,a,l)}(n,e):"missing"in e?function(i,r){Pe(!!r.missing),Pe(!!r.readTime);const s=Ra(i,r.missing),o=hi(r.readTime);return xn.newNoDocument(s,o)}(n,e):Ae()}(l.serializer,b);m.set(w.key.toString(),w)});const y=[];return a.forEach(b=>{const w=m.get(b.toString());Pe(!!w),y.push(w)}),y}),function s(o,a){return r.apply(this,arguments)})(t.datastore,e);var r;return i.forEach(r=>t.recordVersion(r)),i})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastWriteError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new jp(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,K.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var i;e.mutations.forEach(i=>{t.delete(i.key.toString())}),t.forEach((i,r)=>{const s=we.fromPath(r);e.mutations.push(new Ix(s,e.precondition(s)))}),yield(i=(0,K.Z)(function*(s,o){const a=Ee(s),l=Yy(a.serializer)+"/documents",u={writes:o.map(h=>Qy(a.serializer,h))};yield a.wo("Commit",l,u)}),function r(s,o){return i.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ae();t=ke.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new te(U.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ke.min())?Bn.exists(!1):Bn.updateTime(t):Bn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ke.min()))throw new te(U.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Bn.updateTime(t)}return Bn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Mye{constructor(e,t,i,r,s){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=s,this.Wa=i.maxAttempts,this.zo=new nP(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){var e=this;this.zo.ko((0,K.Z)(function*(){const t=new Oye(e.datastore),i=e.za(t);i&&i.then(r=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(r)}).catch(s=>{e.ja(s)}))}).catch(r=>{e.ja(r)})}))}za(e){try{const t=this.updateFunction(e);return!Py(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!p5(t)}return!1}}class kye{constructor(e,t,i,r){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=$i.UNAUTHENTICATED,this.clientId=u8.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,function(){var o=(0,K.Z)(function*(a){ie("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(i,o=>(ie("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return(0,K.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new te(U.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Ri;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,K.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(i){const r=Xp(i,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}function aI(n,e){return eO.apply(this,arguments)}function eO(){return eO=(0,K.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),ie("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(function(){var r=(0,K.Z)(function*(s){i.isEqual(s)||(yield fz(e.localStore,s),i=s)});return function(s){return r.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}),eO.apply(this,arguments)}function tO(n,e){return nO.apply(this,arguments)}function nO(){return nO=(0,K.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield iO(n);ie("FirestoreClient","Initializing OnlineComponentProvider");const i=yield n.getConfiguration();yield e.initialize(t,i),n.setCredentialChangeListener(r=>Nz(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>Nz(e.remoteStore,s)),n._onlineComponents=e}),nO.apply(this,arguments)}function Gz(n){return"FirebaseError"===n.name?n.code===U.FAILED_PRECONDITION||n.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function iO(n){return rO.apply(this,arguments)}function rO(){return rO=(0,K.Z)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ie("FirestoreClient","Using user provided OfflineComponentProvider");try{yield aI(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!Gz(t))throw t;gs("Error using user provided cache. Falling back to memory cache: "+t),yield aI(n,new lv)}}else ie("FirestoreClient","Using default OfflineComponentProvider"),yield aI(n,new lv);return n._offlineComponents}),rO.apply(this,arguments)}function lI(n){return sO.apply(this,arguments)}function sO(){return sO=(0,K.Z)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ie("FirestoreClient","Using user provided OnlineComponentProvider"),yield tO(n,n._uninitializedComponentsProvider._online)):(ie("FirestoreClient","Using default OnlineComponentProvider"),yield tO(n,new ig))),n._onlineComponents}),sO.apply(this,arguments)}function zz(n){return iO(n).then(e=>e.persistence)}function rg(n){return iO(n).then(e=>e.localStore)}function Wz(n){return lI(n).then(e=>e.remoteStore)}function oO(n){return lI(n).then(e=>e.syncEngine)}function sg(n){return aO.apply(this,arguments)}function aO(){return aO=(0,K.Z)(function*(n){const e=yield lI(n),t=e.eventManager;return t.onListen=fye.bind(null,e.syncEngine),t.onUnlisten=pye.bind(null,e.syncEngine),t}),aO.apply(this,arguments)}function Kz(n,e,t={}){const i=new Ri;return n.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return function(s,o,a,l,u){const h=new oI({next:m=>{o.enqueueAndForget(()=>IP(s,g));const y=m.docs.has(a);!y&&m.fromCache?u.reject(new te(U.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&l&&"server"===l.source?u.reject(new te(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),g=new SP(kp(a.path),h,{includeMetadataChanges:!0,J_:!0});return wP(s,g)}(yield sg(n),n.asyncQueue,e,t,i)})),i.promise}function Zz(n,e,t={}){const i=new Ri;return n.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return function(s,o,a,l,u){const h=new oI({next:m=>{o.enqueueAndForget(()=>IP(s,g)),m.fromCache&&"server"===l.source?u.reject(new te(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),g=new SP(a,h,{includeMetadataChanges:!0,J_:!0});return wP(s,g)}(yield sg(n),n.asyncQueue,e,t,i)})),i.promise}function Yz(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}const Qz=new Map;function lO(n,e,t){if(!t)throw new te(U.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Jz(n,e,t,i){if(!0===e&&!0===i)throw new te(U.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Xz(n){if(!we.isDocumentKey(n))throw new te(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function eW(n){if(we.isDocumentKey(n))throw new te(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function cI(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(i=n).constructor?i.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var i;return"function"==typeof n?"a function":Ae()}function Ct(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new te(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=cI(n);throw new te(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function tW(n,e){if(e<=0)throw new te(U.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class nW{constructor(e){var t,i;if(void 0===e.host){if(void 0!==e.ssl)throw new te(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new te(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Jz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=Yz(null!==(i=e.experimentalLongPollingOptions)&&void 0!==i?i:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new te(U.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new te(U.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new te(U.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class cv{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new nW({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new te(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new te(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new nW(e),void 0!==e.credentials&&(this._authCredentials=function(i){if(!i)return new Hge;switch(i.type){case"firstParty":return new qge(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new te(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=Qz.get(t);i&&(ie("ComponentProvider","Removing Datastore"),Qz.delete(t),i.terminate())}(this),Promise.resolve()}}class dr{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new dr(this.firestore,e,this._query)}}class Pn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Na(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pn(this.firestore,e,this._key)}}class Na extends dr{constructor(e,t,i){super(e,t,kp(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pn(this.firestore,null,new we(e))}withConverter(e){return new Na(this.firestore,e,this._path)}}function rW(n,e,...t){if(n=(0,E.m9)(n),lO("collection","path",e),n instanceof cv){const i=kt.fromString(e,...t);return eW(i),new Na(n,null,i)}{if(!(n instanceof Pn||n instanceof Na))throw new te(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(kt.fromString(e,...t));return eW(i),new Na(n.firestore,null,i)}}function uI(n,e,...t){if(n=(0,E.m9)(n),1===arguments.length&&(e=u8.newId()),lO("doc","path",e),n instanceof cv){const i=kt.fromString(e,...t);return Xz(i),new Pn(n,null,new we(i))}{if(!(n instanceof Pn||n instanceof Na))throw new te(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(kt.fromString(e,...t));return Xz(i),new Pn(n.firestore,n instanceof Na?n.converter:null,new we(i))}}function sW(n,e){return n=(0,E.m9)(n),e=(0,E.m9)(e),(n instanceof Pn||n instanceof Na)&&(e instanceof Pn||e instanceof Na)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function cO(n,e){return n=(0,E.m9)(n),e=(0,E.m9)(e),n instanceof dr&&e instanceof dr&&n.firestore===e.firestore&&Uy(n._query,e._query)&&n.converter===e.converter}class qye{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new nP(this,"async_queue_retry"),this.iu=()=>{const t=iI();t&&ie("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const e=iI();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const t=iI();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const t=new Ri;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}_u(){var e=this;return(0,K.Z)(function*(){if(0!==e.Ya.length){try{yield e.Ya[0](),e.Ya.shift(),e.zo.reset()}catch(t){if(!$c(t))throw t;ie("AsyncQueue","Operation failed with retryable error: "+t)}e.Ya.length>0&&e.zo.ko(()=>e._u())}})()}ou(e){const t=this.Ja.then(()=>(this.tu=!0,e().catch(i=>{throw this.eu=i,this.tu=!1,di("INTERNAL UNHANDLED ERROR: ",function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+"\n"+o.stack),a}(i)),i}).then(i=>(this.tu=!1,i))));return this.Ja=t,t}enqueueAfterDelay(e,t,i){this.su(),this.ru.indexOf(e)>-1&&(t=0);const r=EP.createAndSchedule(this,e,t,i,s=>this.au(s));return this.Xa.push(r),r}su(){this.eu&&Ae()}verifyOperationInProgress(){}uu(){var e=this;return(0,K.Z)(function*(){let t;do{t=e.Ja,yield t}while(t!==e.Ja)})()}cu(e){for(const t of this.Xa)if(t.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.Xa)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}function uO(n){return function(t,i){if("object"!=typeof t||null===t)return!1;const r=t;for(const s of["next","error","complete"])if(s in r&&"function"==typeof r[s])return!0;return!1}(n)}class Kye{constructor(){this._progressObserver={},this._taskCompletionResolver=new Ri,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class wn extends cv{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new qye,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||oW(this),this._firestoreClient.terminate()}}function ri(n){return n._firestoreClient||oW(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function oW(n){var e,t,i;const r=n._freezeSettings(),s=(l=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new Tme(n._databaseId,l,n._persistenceKey,(h=r).host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,Yz(h.experimentalLongPollingOptions),h.useFetchStreams));var l,h;n._firestoreClient=new kye(n._authCredentials,n._appCheckCredentials,n._queue,s),null!==(t=r.localCache)&&void 0!==t&&t._offlineComponentProvider&&null!==(i=r.localCache)&&void 0!==i&&i._onlineComponentProvider&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}function aW(n,e,t){const i=new Ri;return n.asyncQueue.enqueue((0,K.Z)(function*(){try{yield aI(n,t),yield tO(n,e),i.resolve()}catch(r){const s=r;if(!Gz(s))throw s;gs("Error enabling indexeddb cache. Falling back to memory cache: "+s),i.reject(s)}})).then(()=>i.promise)}function lW(n){if(n._initialized||n._terminated)throw new te(U.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class xa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xa(Ni.fromBase64String(e))}catch(t){throw new te(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new xa(Ni.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Pl{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new te(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Nn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Hd{constructor(e){this._methodName=e}}class dI{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new te(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new te(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ze(this._lat,e._lat)||Ze(this._long,e._long)}}const sve=/^__.*__$/;class ove{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return null!==this.fieldMask?new Rl(e,this.data,this.fieldMask,t,this.fieldTransforms):new Up(e,this.data,t,this.fieldTransforms)}}class cW{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Rl(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function uW(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ae()}}class hI{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,void 0===s&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new hI(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Tu({path:i,du:!1});return r.Au(e),r}Ru(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Tu({path:i,du:!1});return r.Pu(),r}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return gI(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(0===e.length)throw this.mu("Document fields must not be empty");if(uW(this.Iu)&&sve.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class ave{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||sv(e)}pu(e,t,i,r=!1){return new hI({Iu:e,methodName:t,gu:i,path:Nn.emptyPath(),du:!1,fu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Gd(n){const e=n._freezeSettings(),t=sv(n._databaseId);return new ave(n._databaseId,!!e.ignoreUndefinedProperties,t)}function fI(n,e,t,i,r,s={}){const o=n.pu(s.merge||s.mergeFields?2:0,e,t,r);pO("Data must be an object, but it was:",o,i);const a=fW(i,o);let l,u;if(s.merge)l=new ms(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const g of s.mergeFields){const m=hv(e,g,t);if(!o.contains(m))throw new te(U.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);gW(h,m)||h.push(m)}l=new ms(h),u=o.fieldTransforms.filter(g=>l.covers(g.field))}else l=null,u=o.fieldTransforms;return new ove(new ur(a),l,u)}class dv extends Hd{_toFieldTransform(e){if(2!==e.Iu)throw e.mu(1===e.Iu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof dv}}function dW(n,e,t){return new hI({Iu:3,gu:e.settings.gu,methodName:n._methodName,du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class dO extends Hd{_toFieldTransform(e){return new Gy(e.path,new Vp)}isEqual(e){return e instanceof dO}}class lve extends Hd{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=dW(this,e,!0),i=this.yu.map(s=>zd(s,t)),r=new Md(i);return new Gy(e.path,r)}isEqual(e){return this===e}}class cve extends Hd{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=dW(this,e,!0),i=this.yu.map(s=>zd(s,t)),r=new kd(i);return new Gy(e.path,r)}isEqual(e){return this===e}}class uve extends Hd{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=new Bp(e.serializer,i5(e.serializer,this.wu));return new Gy(e.path,t)}isEqual(e){return this===e}}function hO(n,e,t,i){const r=n.pu(1,e,t);pO("Data must be an object, but it was:",r,i);const s=[],o=ur.empty();Hc(i,(l,u)=>{const h=pI(e,l,t);u=(0,E.m9)(u);const g=r.Ru(h);if(u instanceof dv)s.push(h);else{const m=zd(u,g);null!=m&&(s.push(h),o.set(h,m))}});const a=new ms(s);return new cW(o,a,r.fieldTransforms)}function fO(n,e,t,i,r,s){const o=n.pu(1,e,t),a=[hv(e,i,t)],l=[r];if(s.length%2!=0)throw new te(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(hv(e,s[m])),l.push(s[m+1]);const u=[],h=ur.empty();for(let m=a.length-1;m>=0;--m)if(!gW(u,a[m])){const y=a[m];let b=l[m];b=(0,E.m9)(b);const w=o.Ru(y);if(b instanceof dv)u.push(y);else{const T=zd(b,w);null!=T&&(u.push(y),h.set(y,T))}}const g=new ms(u);return new cW(h,g,o.fieldTransforms)}function hW(n,e,t,i=!1){return zd(t,n.pu(i?4:3,e))}function zd(n,e){if(pW(n=(0,E.m9)(n)))return pO("Unsupported field value:",e,n),fW(n,e);if(n instanceof Hd)return function(i,r){if(!uW(r.Iu))throw r.mu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.mu(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.du&&4!==e.Iu)throw e.mu("Nested arrays are not supported");return function(i,r){const s=[];let o=0;for(const a of i){let l=zd(a,r.Vu(o));null==l&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(i,r){if(null===(i=(0,E.m9)(i)))return{nullValue:"NULL_VALUE"};if("number"==typeof i)return i5(r.serializer,i);if("boolean"==typeof i)return{booleanValue:i};if("string"==typeof i)return{stringValue:i};if(i instanceof Date){const s=Vn.fromDate(i);return{timestampValue:$p(r.serializer,s)}}if(i instanceof Vn){const s=new Vn(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:$p(r.serializer,s)}}if(i instanceof dI)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof xa)return{bytesValue:I5(r.serializer,i._byteString)};if(i instanceof Pn){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Nx(i.firestore._databaseId||r.databaseId,i._key.path)}}throw r.mu(`Unsupported field value: ${cI(i)}`)}(n,e)}function fW(n,e){const t={};return C8(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Hc(n,(i,r)=>{const s=zd(r,e.Eu(i));null!=s&&(t[i]=s)}),{mapValue:{fields:t}}}function pW(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Vn||n instanceof dI||n instanceof xa||n instanceof Pn||n instanceof Hd)}function pO(n,e,t){if(!pW(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const i=cI(t);throw e.mu("an object"===i?n+" a custom object":n+" "+i)}var r}function hv(n,e,t){if((e=(0,E.m9)(e))instanceof Pl)return e._internalPath;if("string"==typeof e)return pI(n,e);throw gI("Field path arguments must be of type string or ",n,!1,void 0,t)}const dve=new RegExp("[~\\*/\\[\\]]");function pI(n,e,t){if(e.search(dve)>=0)throw gI(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Pl(...e.split("."))._internalPath}catch{throw gI(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function gI(n,e,t,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new te(U.INVALID_ARGUMENT,a+n+l)}function gW(n,e){return n.some(t=>t.isEqual(e))}class fv{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Pn(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new hve(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(mI("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class hve extends fv{data(){return super.data()}}function mI(n,e){return"string"==typeof e?pI(n,e):e instanceof Pl?e._internalPath:e._delegate._internalPath}function mW(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new te(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class gO{}class pv extends gO{}function nu(n,e,...t){let i=[];e instanceof gO&&i.push(e),i=i.concat(t),function(s){const o=s.filter(l=>l instanceof og).length,a=s.filter(l=>l instanceof gv).length;if(o>1||o>0&&a>0)throw new te(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)n=r._apply(n);return n}class gv extends pv{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new gv(e,t,i)}_apply(e){const t=this._parse(e);return bW(e._query,t),new dr(e.firestore,e.converter,wx(e._query,t))}_parse(e){const t=Gd(e.firestore);return function(s,o,a,l,u,h,g){let m;if(u.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new te(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){vW(g,h);const y=[];for(const b of g)y.push(yW(l,s,b));m={arrayValue:{values:y}}}else m=yW(l,s,g)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||vW(g,h),m=hW(a,"where",g,"in"===h||"not-in"===h);return xt.create(u,h,m)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class og extends gO{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new og(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return 1===t.length?t[0]:nn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(r,s){let o=r;const a=s.getFlattenedFilters();for(const l of a)bW(o,l),o=wx(o,l)}(e._query,t),new dr(e.firestore,e.converter,wx(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class mO extends pv{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new mO(e,t)}_apply(e){const t=function(r,s,o){if(null!==r.startAt)throw new te(U.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new te(U.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Vy(s,o)}(e._query,this._field,this._direction);return new dr(e.firestore,e.converter,function(r,s){const o=r.explicitOrderBy.concat([s]);return new Sl(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class _I extends pv{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new _I(e,t,i)}_apply(e){return new dr(e.firestore,e.converter,LT(e._query,this._limit,this._limitType))}}class yI extends pv{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new yI(e,t,i)}_apply(e){const t=_W(e,this.type,this._docOrFields,this._inclusive);return new dr(e.firestore,e.converter,(s=t,new Sl((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,s,r.endAt)));var r,s}}class vI extends pv{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new vI(e,t,i)}_apply(e){const t=_W(e,this.type,this._docOrFields,this._inclusive);return new dr(e.firestore,e.converter,(s=t,new Sl((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,s)));var r,s}}function _W(n,e,t,i){if(t[0]=(0,E.m9)(t[0]),t[0]instanceof fv)return function(s,o,a,l,u){if(!l)throw new te(U.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const g of Fp(s))if(g.field.isKeyField())h.push(Pd(o,l.key));else{const m=l.data.field(g.field);if(NT(m))throw new te(U.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+g.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===m){const y=g.field.canonicalString();throw new te(U.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}h.push(m)}return new Zc(h,u)}(n._query,n.firestore._databaseId,e,t[0]._document,i);{const r=Gd(n.firestore);return function(o,a,l,u,h,g){const m=o.explicitOrderBy;if(h.length>m.length)throw new te(U.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const y=[];for(let b=0;b<h.length;b++){const w=h[b];if(m[b].field.isKeyField()){if("string"!=typeof w)throw new te(U.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof w}`);if(!Ex(o)&&-1!==w.indexOf("/"))throw new te(U.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${w}' contains a slash.`);const T=o.path.child(kt.fromString(w));if(!we.isDocumentKey(T))throw new te(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${T}' is not because it contains an odd number of segments.`);const P=new we(T);y.push(Pd(a,P))}else{const T=hW(l,u,w);y.push(T)}}return new Zc(y,g)}(n._query,n.firestore._databaseId,r,e,t,i)}}function yW(n,e,t){if("string"==typeof(t=(0,E.m9)(t))){if(""===t)throw new te(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ex(e)&&-1!==t.indexOf("/"))throw new te(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(kt.fromString(t));if(!we.isDocumentKey(i))throw new te(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Pd(n,new we(i))}if(t instanceof Pn)return Pd(n,t._key);throw new te(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cI(t)}.`)}function vW(n,e){if(!Array.isArray(n)||0===n.length)throw new te(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bW(n,e){const t=function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new te(U.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class _O{convertValue(e,t="none"){switch(qc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ii(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Dl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Ae()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Hc(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertGeoPoint(e){return new dI(ii(e.latitude),ii(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=xT(e);return null==i?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(My(e));default:return null}}convertTimestamp(e){const t=Gc(e);return new Vn(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=kt.fromString(e);Pe(M5(i));const r=new zc(i.get(1),i.get(3)),s=new we(i.popFirst(5));return r.isEqual(t)||di(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function bI(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Eve extends _O{constructor(e){super(),this.firestore=e}convertBytes(e){return new xa(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Pn(this.firestore,null,t)}}class Wd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ol extends fv{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new mv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(mI("DocumentSnapshot.get",e));if(null!==i)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class mv extends Ol{data(e={}){return super.data(e)}}class iu{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Wd(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new mv(this._firestore,this._userDataWriter,i.key,i,new Wd(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new te(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>({type:"added",doc:new mv(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Wd(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:o++}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>s||3!==a.type).map(a=>{const l=new mv(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Wd(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,h=-1;return 0!==a.type&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),1!==a.type&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:Tve(a.type),doc:l,oldIndex:u,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Tve(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ae()}}function wW(n,e){return n instanceof Ol&&e instanceof Ol?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof iu&&e instanceof iu&&n._firestore===e._firestore&&cO(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class ru extends _O{constructor(e){super(),this.firestore=e}convertBytes(e){return new xa(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Pn(this.firestore,null,t)}}function TW(n,e,t){n=Ct(n,Pn);const i=Ct(n.firestore,wn),r=bI(n.converter,e,t);return ag(i,[fI(Gd(i),"setDoc",n._key,r,null!==n.converter,t).toMutation(n._key,Bn.none())])}function IW(n,e,t,...i){n=Ct(n,Pn);const r=Ct(n.firestore,wn),s=Gd(r);let o;return o="string"==typeof(e=(0,E.m9)(e))||e instanceof Pl?fO(s,"updateDoc",n._key,e,t,i):hO(s,"updateDoc",n._key,e),ag(r,[o.toMutation(n._key,Bn.exists(!0))])}function CW(n,...e){var t,i,r;n=(0,E.m9)(n);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||uO(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(uO(e[o])){const g=e[o];e[o]=null===(t=g.next)||void 0===t?void 0:t.bind(g),e[o+1]=null===(i=g.error)||void 0===i?void 0:i.bind(g),e[o+2]=null===(r=g.complete)||void 0===r?void 0:r.bind(g)}let l,u,h;if(n instanceof Pn)u=Ct(n.firestore,wn),h=kp(n._key.path),l={next:g=>{e[o]&&e[o](yO(u,n,g))},error:e[o+1],complete:e[o+2]};else{const g=Ct(n,dr);u=Ct(g.firestore,wn),h=g._query;const m=new ru(u);l={next:y=>{e[o]&&e[o](new iu(u,m,g,y))},error:e[o+1],complete:e[o+2]},mW(n._query)}return function(m,y,b,w){const T=new oI(w),P=new SP(y,T,b);return m.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return wP(yield sg(m),P)})),()=>{T.Na(),m.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return IP(yield sg(m),P)}))}}(ri(u),h,a,l)}function ag(n,e){return function(i,r){const s=new Ri;return i.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return function gye(n,e,t){return PP.apply(this,arguments)}(yield oO(i),r,s)})),s.promise}(ri(n),e)}function yO(n,e,t){const i=t.docs.get(e._key),r=new ru(n);return new Ol(n,r,e._key,i,new Wd(t.hasPendingWrites,t.fromCache),e.converter)}const jve={maxAttempts:5};class DW{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Gd(e)}set(e,t,i){this._verifyNotCommitted();const r=su(e,this._firestore),s=bI(r.converter,t,i),o=fI(this._dataReader,"WriteBatch.set",r._key,s,null!==r.converter,i);return this._mutations.push(o.toMutation(r._key,Bn.none())),this}update(e,t,i,...r){this._verifyNotCommitted();const s=su(e,this._firestore);let o;return o="string"==typeof(t=(0,E.m9)(t))||t instanceof Pl?fO(this._dataReader,"WriteBatch.update",s._key,t,i,r):hO(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Bn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=su(e,this._firestore);return this._mutations=this._mutations.concat(new jp(t._key,Bn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new te(U.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function su(n,e){if((n=(0,E.m9)(n)).firestore!==e)throw new te(U.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class $ve extends class{constructor(t,i){this._firestore=t,this._transaction=i,this._dataReader=Gd(t)}get(t){const i=su(t,this._firestore),r=new Eve(this._firestore);return this._transaction.lookup([i._key]).then(s=>{if(!s||1!==s.length)return Ae();const o=s[0];if(o.isFoundDocument())return new fv(this._firestore,r,o.key,o,i.converter);if(o.isNoDocument())return new fv(this._firestore,r,i._key,null,i.converter);throw Ae()})}set(t,i,r){const s=su(t,this._firestore),o=bI(s.converter,i,r),a=fI(this._dataReader,"Transaction.set",s._key,o,null!==s.converter,r);return this._transaction.set(s._key,a),this}update(t,i,r,...s){const o=su(t,this._firestore);let a;return a="string"==typeof(i=(0,E.m9)(i))||i instanceof Pl?fO(this._dataReader,"Transaction.update",o._key,i,r,s):hO(this._dataReader,"Transaction.update",o._key,i),this._transaction.update(o._key,a),this}delete(t){const i=su(t,this._firestore);return this._transaction.delete(i._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=su(e,this._firestore),i=new ru(this._firestore);return super.get(e).then(r=>new Ol(this._firestore,i,t._key,r._document,new Wd(!1,!1),t.converter))}}function bO(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new te("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function NW(){if(typeof Uint8Array>"u")throw new te("unimplemented","Uint8Arrays are not available in this environment.")}function xW(){if(!function Eme(){return typeof atob<"u"}())throw new te("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(e,t=!0){Sp=ls.SDK_VERSION,(0,ls._registerComponent)(new ko.wA("firestore",(i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new wn(new zge(i.getProvider("auth-internal")),new Kge(i.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new te(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zc(u.options.projectId,h)}(o,r),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),(0,ls.registerVersion)(a8,"4.4.0",e),(0,ls.registerVersion)(a8,"4.4.0","esm2017")}();class _v{constructor(e){this._delegate=e}static fromBase64String(e){return xW(),new _v(xa.fromBase64String(e))}static fromUint8Array(e){return NW(),new _v(xa.fromUint8Array(e))}toBase64(){return xW(),this._delegate.toBase64()}toUint8Array(){return NW(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function EO(n){return function Jve(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const i of e)if(i in t&&"function"==typeof t[i])return!0;return!1}(n,["next","error","complete"])}class Xve{enableIndexedDbPersistence(e,t){return function Yye(n,e){lW(n=Ct(n,wn));const t=ri(n);if(t._uninitializedComponentsProvider)throw new te(U.FAILED_PRECONDITION,"SDK cache is already specified.");gs("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const i=n._freezeSettings(),r=new ig;return aW(t,r,new XP(r,i.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function Qye(n){lW(n=Ct(n,wn));const e=ri(n);if(e._uninitializedComponentsProvider)throw new te(U.FAILED_PRECONDITION,"SDK cache is already specified.");gs("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),i=new ig;return aW(e,i,new $z(i,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function Jye(n){if(n._initialized&&!n._terminated)throw new te(U.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Ri;return n._queue.enqueueAndForgetEvenWhileRestricted((0,K.Z)(function*(){try{yield(t=(0,K.Z)(function*(r){if(!zo.D())return Promise.resolve();const s=r+"main";yield zo.delete(s)}),function i(r){return t.apply(this,arguments)})(zx(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class PW{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof zc||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&gs("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,i={}){!function iW(n,e,t,i={}){var r;const s=(n=Ct(n,cv))._getSettings(),o=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&gs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let a,l;if("string"==typeof i.mockUserToken)a=i.mockUserToken,l=$i.MOCK_USER;else{a=(0,E.Sg)(i.mockUserToken,null===(r=n._app)||void 0===r?void 0:r.options.projectId);const u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new te(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new $i(u)}n._authCredentials=new Gge(new l8(a,l))}}(this._delegate,e,t,i)}enableNetwork(){return function eve(n){return function Fye(n){return n.asyncQueue.enqueue((0,K.Z)(function*(){const e=yield zz(n),t=yield Wz(n);return e.setNetworkEnabled(!0),function(r){const s=Ee(r);return s.C_.delete(0),ov(s)}(t)}))}(ri(n=Ct(n,wn)))}(this._delegate)}disableNetwork(){return function tve(n){return function Lye(n){return n.asyncQueue.enqueue((0,K.Z)(function*(){const e=yield zz(n),t=yield Wz(n);return e.setNetworkEnabled(!1),(i=(0,K.Z)(function*(s){const o=Ee(s);o.C_.add(0),yield Yp(o),o.M_.set("Offline")}),function r(s){return i.apply(this,arguments)})(t);var i}))}(ri(n=Ct(n,wn)))}(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,Jz("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function Xye(n){return function(t){const i=new Ri;return t.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return function vye(n,e){return LP.apply(this,arguments)}(yield oO(t),i)})),i.promise}(ri(n=Ct(n,wn)))}(this._delegate)}onSnapshotsInSync(e){return function Pve(n,e){return function Uye(n,e){const t=new oI(e);return n.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return r=yield sg(n),s=t,Ee(r).q_.add(s),void s.next();var r,s})),()=>{t.Na(),n.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return r=yield sg(n),s=t,void Ee(r).q_.delete(s);var r,s}))}}(ri(n=Ct(n,wn)),uO(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new te("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new lg(this,rW(this._delegate,e))}catch(t){throw Ur(t,"collection()","Firestore.collection()")}}doc(e){try{return new co(this,uI(this._delegate,e))}catch(t){throw Ur(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new jr(this,function Wye(n,e){if(n=Ct(n,cv),lO("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new te(U.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new dr(n,null,(i=e,new Sl(kt.emptyPath(),i)));var i}(this._delegate,e))}catch(t){throw Ur(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function Hve(n,e,t){n=Ct(n,wn);const i=Object.assign(Object.assign({},jve),t);return function(s){if(s.maxAttempts<1)throw new te(U.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(s,o,a){const l=new Ri;return s.asyncQueue.enqueueAndForget((0,K.Z)(function*(){const u=yield function qz(n){return lI(n).then(e=>e.datastore)}(s);new Mye(s.asyncQueue,u,a,o,l).run()})),l.promise}(ri(n),r=>e(new $ve(n,r)),i)}(this._delegate,t=>e(new OW(this,t)))}batch(){return ri(this._delegate),new MW(new DW(this._delegate,e=>ag(this._delegate,e)))}loadBundle(e){return function nve(n,e){const t=ri(n=Ct(n,wn)),i=new Kye;return function jye(n,e,t,i){const r=function(o,a){let l;return l="string"==typeof o?m5().encode(o):o,h=function(h,g){if(h instanceof Uint8Array)return Hz(h,g);if(h instanceof ArrayBuffer)return Hz(new Uint8Array(h),g);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),new Pye(h,a);var h}(t,sv(e));n.asyncQueue.enqueueAndForget((0,K.Z)(function*(){!function Nye(n,e,t){const i=Ee(n);var r;(r=(0,K.Z)(function*(o,a,l){try{const u=yield a.getMetadata();if(yield function(b,w){const T=Ee(b),P=hi(w.createTime);return T.persistence.runTransaction("hasNewerBundle","readonly",S=>T.Kr.getBundleMetadata(S,w.id)).then(S=>!!S&&S.createTime.compareTo(P)>=0)}(o.localStore,u))return yield a.close(),l._completeWith({taskState:"Success",documentsLoaded:(b=u).totalDocuments,bytesLoaded:b.totalBytes,totalDocuments:b.totalDocuments,totalBytes:b.totalBytes}),Promise.resolve(new Set);l._updateProgress(Oz(u));const h=new cye(u,o.localStore,a.serializer);let g=yield a.Ma();for(;g;){const y=yield h.ea(g);y&&l._updateProgress(y),g=yield a.Ma()}const m=yield h.complete();return yield xl(o,m.ra,void 0),yield function(b,w){const T=Ee(b);return T.persistence.runTransaction("Save bundle","readwrite",P=>T.Kr.saveBundleMetadata(P,w))}(o.localStore,u),l._completeWith(m.progress),Promise.resolve(m.na)}catch(u){return gs("SyncEngine",`Loading bundle failed with ${u}`),l._failWith(u),Promise.resolve(new Set)}var b}),function s(o,a,l){return r.apply(this,arguments)})(i,e,t).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}(yield oO(n),r,i)}))}(t,n._databaseId,e,i),i}(this._delegate,e)}namedQuery(e){return function ive(n,e){return function $ye(n,e){return n.asyncQueue.enqueue((0,K.Z)(function*(){return function(i,r){const s=Ee(i);return s.persistence.runTransaction("Get named query","readonly",o=>s.Kr.getNamedQuery(o,r))}(yield rg(n),e)}))}(ri(n=Ct(n,wn)),e).then(t=>t?new dr(n,null,t.query):null)}(this._delegate,e).then(t=>t?new jr(this,t):null)}}class wI extends _O{constructor(e){super(),this.firestore=e}convertBytes(e){return new _v(new xa(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return co.forKey(t,this.firestore,null)}}class OW{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new wI(e)}get(e){const t=Kd(e);return this._delegate.get(t).then(i=>new yv(this._firestore,new Ol(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){const r=Kd(e);return i?(bO("Transaction.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=Kd(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=Kd(e);return this._delegate.delete(t),this}}class MW{constructor(e){this._delegate=e}set(e,t,i){const r=Kd(e);return i?(bO("WriteBatch.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=Kd(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=Kd(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class qd{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){const i=new mv(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new vv(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const i=qd.INSTANCES;let r=i.get(e);r||(r=new WeakMap,i.set(e,r));let s=r.get(t);return s||(s=new qd(e,new wI(e),t),r.set(t,s)),s}}qd.INSTANCES=new WeakMap;class co{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new wI(e)}static forPath(e,t,i){if(e.length%2!=0)throw new te("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new co(t,new Pn(t._delegate,i,new we(e)))}static forKey(e,t,i){return new co(t,new Pn(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new lg(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new lg(this.firestore,rW(this._delegate,e))}catch(t){throw Ur(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,E.m9)(e))instanceof Pn&&sW(this._delegate,e)}set(e,t){t=bO("DocumentReference.set",t);try{return t?TW(this._delegate,e,t):TW(this._delegate,e)}catch(i){throw Ur(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return 1===arguments.length?IW(this._delegate,e):IW(this._delegate,e,t,...i)}catch(r){throw Ur(r,"updateDoc()","DocumentReference.update()")}}delete(){return function Nve(n){return ag(Ct(n.firestore,wn),[new jp(n._key,Bn.none())])}(this._delegate)}onSnapshot(...e){const t=kW(e),i=FW(e,r=>new yv(this.firestore,new Ol(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return CW(this._delegate,t,i)}get(e){let t;return t="cache"===e?.source?function Cve(n){n=Ct(n,Pn);const e=Ct(n.firestore,wn),t=ri(e),i=new ru(e);return function Vye(n,e){const t=new Ri;return n.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return(i=(0,K.Z)(function*(s,o,a){try{const l=yield function(h,g){const m=Ee(h);return m.persistence.runTransaction("read document","readonly",y=>m.localDocuments.getDocument(y,g))}(s,o);l.isFoundDocument()?a.resolve(l):l.isNoDocument()?a.resolve(null):a.reject(new te(U.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const u=Xp(l,`Failed to get document '${o} from cache`);a.reject(u)}}),function r(s,o,a){return i.apply(this,arguments)})(yield rg(n),e,t);var i})),t.promise}(t,n._key).then(r=>new Ol(e,i,n._key,r,new Wd(null!==r&&r.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function Dve(n){n=Ct(n,Pn);const e=Ct(n.firestore,wn);return Kz(ri(e),n._key,{source:"server"}).then(t=>yO(e,n,t))}(this._delegate):function Ive(n){n=Ct(n,Pn);const e=Ct(n.firestore,wn);return Kz(ri(e),n._key).then(t=>yO(e,n,t))}(this._delegate),t.then(i=>new yv(this.firestore,new Ol(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new co(this.firestore,this._delegate.withConverter(e?qd.getInstance(this.firestore,e):null))}}function Ur(n,e,t){return n.message=n.message.replace(e,t),n}function kW(n){for(const e of n)if("object"==typeof e&&!EO(e))return e;return{}}function FW(n,e){var t,i;let r;return r=EO(n[0])?n[0]:EO(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{r.next&&r.next(e(s))},error:null===(t=r.error)||void 0===t?void 0:t.bind(r),complete:null===(i=r.complete)||void 0===i?void 0:i.bind(r)}}class yv{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new co(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return wW(this._delegate,e._delegate)}}class vv extends yv{data(e){const t=this._delegate.data(e);return this._delegate._converter||function $ge(n,e){n||Ae()}(void 0!==t),t}}class jr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new wI(e)}where(e,t,i){try{return new jr(this.firestore,nu(this._delegate,function fve(n,e,t){const i=e,r=mI("where",n);return gv._create(r,i,t)}(e,t,i)))}catch(r){throw Ur(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new jr(this.firestore,nu(this._delegate,function pve(n,e="asc"){const t=e,i=mI("orderBy",n);return mO._create(i,t)}(e,t)))}catch(i){throw Ur(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new jr(this.firestore,nu(this._delegate,function gve(n){return tW("limit",n),_I._create("limit",n,"F")}(e)))}catch(t){throw Ur(t,"limit()","Query.limit()")}}limitToLast(e){try{return new jr(this.firestore,nu(this._delegate,function mve(n){return tW("limitToLast",n),_I._create("limitToLast",n,"L")}(e)))}catch(t){throw Ur(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new jr(this.firestore,nu(this._delegate,function _ve(...n){return yI._create("startAt",n,!0)}(...e)))}catch(t){throw Ur(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new jr(this.firestore,nu(this._delegate,function yve(...n){return yI._create("startAfter",n,!1)}(...e)))}catch(t){throw Ur(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new jr(this.firestore,nu(this._delegate,function vve(...n){return vI._create("endBefore",n,!1)}(...e)))}catch(t){throw Ur(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new jr(this.firestore,nu(this._delegate,function bve(...n){return vI._create("endAt",n,!0)}(...e)))}catch(t){throw Ur(t,"endAt()","Query.endAt()")}}isEqual(e){return cO(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function Ave(n){n=Ct(n,dr);const e=Ct(n.firestore,wn),t=ri(e),i=new ru(e);return function Bye(n,e){const t=new Ri;return n.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return(i=(0,K.Z)(function*(s,o,a){try{const l=yield XT(s,o,!0),u=new Fz(o,l.ls),h=u.ca(l.documents),g=u.applyChanges(h,!1);a.resolve(g.snapshot)}catch(l){const u=Xp(l,`Failed to execute query '${o} against cache`);a.reject(u)}}),function r(s,o,a){return i.apply(this,arguments)})(yield rg(n),e,t);var i})),t.promise}(t,n._query).then(r=>new iu(e,i,n,r))}(this._delegate):"server"===e?.source?function Rve(n){n=Ct(n,dr);const e=Ct(n.firestore,wn),t=ri(e),i=new ru(e);return Zz(t,n._query,{source:"server"}).then(r=>new iu(e,i,n,r))}(this._delegate):function Sve(n){n=Ct(n,dr);const e=Ct(n.firestore,wn),t=ri(e),i=new ru(e);return mW(n._query),Zz(t,n._query).then(r=>new iu(e,i,n,r))}(this._delegate),t.then(i=>new wO(this.firestore,new iu(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const t=kW(e),i=FW(e,r=>new wO(this.firestore,new iu(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return CW(this._delegate,t,i)}withConverter(e){return new jr(this.firestore,this._delegate.withConverter(e?qd.getInstance(this.firestore,e):null))}}class t0e{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new vv(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class wO{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new jr(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new vv(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new t0e(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new vv(this._firestore,i))})}isEqual(e){return wW(this._delegate,e._delegate)}}class lg extends jr{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new co(this.firestore,e):null}doc(e){try{return new co(this.firestore,void 0===e?uI(this._delegate):uI(this._delegate,e))}catch(t){throw Ur(t,"doc()","CollectionReference.doc()")}}add(e){return function xve(n,e){const t=Ct(n.firestore,wn),i=uI(n),r=bI(n.converter,e);return ag(t,[fI(Gd(n.firestore),"addDoc",i._key,r,null!==n.converter,{}).toMutation(i._key,Bn.exists(!1))]).then(()=>i)}(this._delegate,e).then(t=>new co(this.firestore,t))}isEqual(e){return sW(this._delegate,e._delegate)}withConverter(e){return new lg(this.firestore,this._delegate.withConverter(e?qd.getInstance(this.firestore,e):null))}}function Kd(n){return Ct(n,Pn)}class TO{constructor(...e){this._delegate=new Pl(...e)}static documentId(){return new TO(Nn.keyField().canonicalString())}isEqual(e){return(e=(0,E.m9)(e))instanceof Pl&&this._delegate._internalPath.isEqual(e._internalPath)}}class Zd{constructor(e){this._delegate=e}static serverTimestamp(){const e=function zve(){return new dO("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Zd(e)}static delete(){const e=function Gve(){return new dv("deleteField")}();return e._methodName="FieldValue.delete",new Zd(e)}static arrayUnion(...e){const t=function Wve(...n){return new lve("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new Zd(t)}static arrayRemove(...e){const t=function qve(...n){return new cve("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new Zd(t)}static increment(e){const t=function Kve(n){return new uve("increment",n)}(e);return t._methodName="FieldValue.increment",new Zd(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const n0e={Firestore:PW,GeoPoint:dI,Timestamp:Vn,Blob:_v,Transaction:OW,WriteBatch:MW,DocumentReference:co,DocumentSnapshot:yv,Query:jr,QueryDocumentSnapshot:vv,QuerySnapshot:wO,CollectionReference:lg,FieldPath:TO,FieldValue:Zd,setLogLevel:function e0e(n){!function jge(n){Uc.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function LW(n,e){return function s0e(n,e=OE){return new $e(t=>{let i;return null!=e?e.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},t)}):i=n.onSnapshot({includeMetadataChanges:!0},t),()=>{i?.()}})}(n,e)}function IO(n,e){return LW(n,e).pipe(Ne(t=>({payload:t,type:"query"})))}!function r0e(n){(function i0e(n,e){n.INTERNAL.registerComponent(new ko.wA("firestore-compat",t=>{const i=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},n0e)))})(n,(e,t)=>new PW(e,t,new Xve)),n.registerVersion("@firebase/firestore-compat","0.3.23")}(no.Z);class VW{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const i=this.ref.collection(e),{ref:r,query:s}=GW(i,t);return new jW(r,s,this.afs)}snapshotChanges(){return function o0e(n,e){return LW(n,e).pipe(Xm(void 0),bN(),Ne(t=>{const[i,r]=t;return r.exists?i?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(ui)}valueChanges(e={}){return this.snapshotChanges().pipe(Ne(({payload:t})=>e.idField?{...t.data(),[e.idField]:t.id}:t.data()))}get(e){return N(this.ref.get(e)).pipe(ui)}}function TI(n,e){return IO(n,e).pipe(Xm(void 0),bN(),Ne(t=>{const[i,r]=t,s=r.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return i&&JSON.stringify(i.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((a,l)=>{const u=s.find(g=>g.doc.ref.isEqual(a.ref)),h=i?.payload.docs.find(g=>g.ref.isEqual(a.ref));u&&JSON.stringify(u.doc.metadata)===JSON.stringify(a.metadata)||!u&&h&&JSON.stringify(h.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:l,newIndex:l,type:"modified",doc:a}})}),o}))}function BW(n,e,t){return TI(n,t).pipe(Ff((i,r)=>function a0e(n,e,t){return e.forEach(i=>{t.indexOf(i.type)>-1&&(n=function l0e(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return CO(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return CO(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return CO(n,e.oldIndex,1)}return n}(n,i))}),n}(i,r.map(s=>s.payload),e),[]),po(),Ne(i=>i.map(r=>({type:r.type,payload:r}))))}function CO(n,e,t,...i){const r=n.slice();return r.splice(e,t,...i),r}function UW(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class jW{ref;query;afs;constructor(e,t,i){this.ref=e,this.query=t,this.afs=i}stateChanges(e){let t=TI(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(Ne(i=>i.filter(r=>e.indexOf(r.type)>-1)))),t.pipe(Xm(void 0),bN(),_i(([i,r])=>r.length>0||!i),Ne(([,i])=>i),ui)}auditTrail(e){return this.stateChanges(e).pipe(Ff((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=UW(e);return BW(this.query,t,this.afs.schedulers.outsideAngular).pipe(ui)}valueChanges(e={}){return IO(this.query,this.afs.schedulers.outsideAngular).pipe(Ne(t=>t.payload.docs.map(i=>e.idField?{...i.data(),[e.idField]:i.id}:i.data())),ui)}get(e){return N(this.query.get(e)).pipe(ui)}add(e){return this.ref.add(e)}doc(e){return new VW(this.ref.doc(e),this.afs)}}class c0e{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?TI(this.query,this.afs.schedulers.outsideAngular).pipe(Ne(t=>t.filter(i=>e.indexOf(i.type)>-1)),_i(t=>t.length>0),ui):TI(this.query,this.afs.schedulers.outsideAngular).pipe(ui)}auditTrail(e){return this.stateChanges(e).pipe(Ff((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=UW(e);return BW(this.query,t,this.afs.schedulers.outsideAngular).pipe(ui)}valueChanges(e={}){return IO(this.query,this.afs.schedulers.outsideAngular).pipe(Ne(i=>i.payload.docs.map(r=>e.idField?{[e.idField]:r.id,...r.data()}:r.data())),ui)}get(e){return N(this.query.get(e)).pipe(ui)}}const $W=new me("angularfire2.enableFirestorePersistence"),HW=new me("angularfire2.firestore.persistenceSettings"),u0e=new me("angularfire2.firestore.settings"),d0e=new me("angularfire2.firestore.use-emulator");function GW(n,e=(t=>t)){return{query:e(n),ref:n}}let h0e=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,i,r,s,o,a,l,u,h,g,m,y,b,w,T,P,S){this.schedulers=l;const M=__(t,a,i),L=h;g&&aA(M,a,m,b,w,T,y,P),[this.firestore,this.persistenceEnabled$]=UE(`${M.name}.firestore`,"AngularFirestore",M.name,()=>{const Y=a.runOutsideAngular(()=>M.firestore());if(s&&Y.settings(s),L&&Y.useEmulator(...L),r&&!lE(o)){const pe=()=>{try{return N(Y.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(Oe){return typeof console<"u"&&console.warn(Oe),ye(!1)}};return[Y,a.runOutsideAngular(pe)]}return[Y,ye(!1)]},[s,L,r])}collection(t,i){let r;r="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:o}=GW(r,i),a=this.schedulers.ngZone.run(()=>s);return new jW(a,o,this)}collectionGroup(t,i){const r=i||(o=>o),s=this.firestore.collectionGroup(t);return new c0e(r(s),this)}doc(t){let i;i="string"==typeof t?this.firestore.doc(t):t;const r=this.schedulers.ngZone.run(()=>i);return new VW(r,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(i){return new(i||n)(W(Zf),W(Yf,8),W($W,8),W(u0e,8),W(Co),W(rt),W(BE),W(HW,8),W(d0e,8),W(lA,8),W(tA,8),W(nA,8),W(iA,8),W(rA,8),W(sA,8),W(oA,8),W(VE,8))};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),f0e=(()=>{class n{constructor(){no.Z.registerVersion("angularfire",m_.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:$W,useValue:!0},{provide:HW,useValue:t}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=yt({type:n});static \u0275inj=ht({providers:[h0e]})}return n})();class g0e{constructor(e,t){this.dueTime=e,this.scheduler=t}call(e,t){return t.subscribe(new m0e(e,this.dueTime,this.scheduler))}}class m0e extends xe{constructor(e,t,i){super(e),this.dueTime=t,this.scheduler=i,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(_0e,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:e}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}clearDebounce(){const e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}function _0e(n){n.debouncedNext()}const zW="firebasestorage.googleapis.com",WW="storageBucket";class Zn extends E.ZR{constructor(e,t,i=0){super(DO(e),`Firebase Storage: ${t} (${DO(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Zn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return DO(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var Un=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Un||{});function DO(n){return"storage/"+n}function SO(){return new Zn(Un.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function qW(){return new Zn(Un.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function KW(){return new Zn(Un.CANCELED,"User canceled the upload/download.")}function ZW(){return new Zn(Un.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function cg(n){return new Zn(Un.INVALID_ARGUMENT,n)}function YW(){return new Zn(Un.APP_DELETED,"The Firebase app was deleted.")}function QW(n){return new Zn(Un.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function bv(n,e){return new Zn(Un.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Ev(n){throw new Zn(Un.INTERNAL_ERROR,"Internal error: "+n)}class Dr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Dr.makeFromUrl(e,t)}catch{return new Dr(e,"")}if(""===i.path)return i;throw function S0e(n){return new Zn(Un.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)",a=new RegExp("^gs://"+r+"(/(.*))?$","i");function u(L){L.path_=decodeURIComponent(L.path)}const g=t.replace(/[.]/g,"\\."),M=[{regex:a,indices:{bucket:1,path:3},postModify:function s(L){"/"===L.path.charAt(L.path.length-1)&&(L.path_=L.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${g}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:u},{regex:new RegExp(`^https?://${t===zW?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:u}];for(let L=0;L<M.length;L++){const Y=M[L],pe=Y.regex.exec(e);if(pe){let Ge=pe[Y.indices.path];Ge||(Ge=""),i=new Dr(pe[Y.indices.bucket],Ge),Y.postModify(i);break}}if(null==i)throw function D0e(n){return new Zn(Un.INVALID_URL,"Invalid URL '"+n+"'.")}(e);return i}}class P0e{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function II(n){return"string"==typeof n||n instanceof String}function JW(n){return AO()&&n instanceof Blob}function AO(){return typeof Blob<"u"}function RO(n,e,t,i){if(i<e)throw cg(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw cg(`Invalid value for '${n}'. Expected ${t} or less.`)}function Ml(n,e,t){let i=e;return null==t&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function XW(n){const e=encodeURIComponent;let t="?";for(const i in n)n.hasOwnProperty(i)&&(t=t+(e(i)+"=")+e(n[i])+"&");return t=t.slice(0,-1),t}var ug=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(ug||{});function e6(n,e){const t=n>=500&&n<600,r=-1!==[408,429].indexOf(n),s=-1!==e.indexOf(n);return t||r||s}class V0e{constructor(e,t,i,r,s,o,a,l,u,h,g,m=!0){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=g,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,b)=>{this.resolve_=y,this.reject_=b,this.start_()})}start_(){const t=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());!function k0e(n){return void 0!==n}(l)?s():s(l)}catch(l){o(l)}else if(null!==a){const l=SO();l.serverResponse=a.getErrorText(),o(this.errorCallback_?this.errorCallback_(a,l):l)}else o(r.canceled?this.appDelete_?YW():KW():qW())};this.canceled_?t(0,new CI(!1,null,!0)):this.backoffId_=function O0e(n,e,t){let i=1,r=null,s=null,o=!1,a=0;function l(){return 2===a}let u=!1;function h(...T){u||(u=!0,e.apply(null,T))}function g(T){r=setTimeout(()=>{r=null,n(y,l())},T)}function m(){s&&clearTimeout(s)}function y(T,...P){if(u)return void m();if(T)return m(),void h.call(null,T,...P);if(l()||o)return m(),void h.call(null,T,...P);let M;i<64&&(i*=2),1===a?(a=2,M=0):M=1e3*(i+Math.random()),g(M)}let b=!1;function w(T){b||(b=!0,m(),!u&&(null!==r?(T||(a=2),clearTimeout(r),g(0)):T||(a=1)))}return g(0),s=setTimeout(()=>{o=!0,w(!0)},t),w}((i,r)=>{if(r)return void i(!1,new CI(!1,null,!0));const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{null!==this.progressCallback_&&this.progressCallback_(a.loaded,a.lengthComputable?a.total:-1)};null!==this.progressCallback_&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===ug.NO_ERROR,l=s.getStatus();if(!a||e6(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===ug.ABORT;return void i(!1,new CI(!1,null,h))}const u=-1!==this.successCodes_.indexOf(l);i(!0,new CI(u,s))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function M0e(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class CI{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function z0e(...n){const e=function G0e(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}if(AO())return new Blob(n);throw new Zn(Un.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const Ls={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class NO{constructor(e,t){this.data=e,this.contentType=t||null}}function xO(n,e){switch(n){case Ls.RAW:return new NO(t6(e));case Ls.BASE64:case Ls.BASE64URL:return new NO(n6(n,e));case Ls.DATA_URL:return new NO(function Z0e(n){const e=new i6(n);return e.base64?n6(Ls.BASE64,e.rest):function K0e(n){let e;try{e=decodeURIComponent(n)}catch{throw bv(Ls.DATA_URL,"Malformed data URL.")}return t6(e)}(e.rest)}(e),function Y0e(n){return new i6(n).contentType}(e))}throw SO()}function t6(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);i<=127?e.push(i):i<=2047?e.push(192|i>>6,128|63&i):55296==(64512&i)?t<n.length-1&&56320==(64512&n.charCodeAt(t+1))?(i=65536|(1023&i)<<10|1023&n.charCodeAt(++t),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)):e.push(239,191,189):56320==(64512&i)?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|63&i)}return new Uint8Array(e)}function n6(n,e){switch(n){case Ls.BASE64:{const r=-1!==e.indexOf("-"),s=-1!==e.indexOf("_");if(r||s)throw bv(n,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Ls.BASE64URL:{const r=-1!==e.indexOf("+"),s=-1!==e.indexOf("/");if(r||s)throw bv(n,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=function q0e(n){if(typeof atob>"u")throw function x0e(n){return new Zn(Un.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(e)}catch(r){throw r.message.includes("polyfill")?r:bv(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}class i6{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw bv(Ls.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;null!=i&&(this.base64=function Q0e(n,e){return n.length>=e.length&&n.substring(n.length-e.length)===e}(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}class Pa{constructor(e,t){let i=0,r="";JW(e)?(this.data_=e,i=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(JW(this.data_)){const r=function W0e(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}(this.data_,e,t);return null===r?null:new Pa(r)}{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Pa(i,!0)}}static getBlob(...e){if(AO()){const t=e.map(i=>i instanceof Pa?i.data_:i);return new Pa(z0e.apply(null,t))}{const t=e.map(o=>II(o)?xO(Ls.RAW,o).data:o.data_);let i=0;t.forEach(o=>{i+=o.byteLength});const r=new Uint8Array(i);let s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)r[s++]=o[a]}),new Pa(r,!0)}}uploadData(){return this.data_}}function PO(n){let e;try{e=JSON.parse(n)}catch{return null}return function L0e(n){return"object"==typeof n&&!Array.isArray(n)}(e)?e:null}function r6(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}function ebe(n,e){return e}class $r{constructor(e,t,i,r){this.server=e,this.local=t||e,this.writable=!!i,this.xform=r||ebe}}let DI=null;function wv(){if(DI)return DI;const n=[];n.push(new $r("bucket")),n.push(new $r("generation")),n.push(new $r("metageneration")),n.push(new $r("name","fullPath",!0));const t=new $r("name");t.xform=function e(s,o){return function tbe(n){return!II(n)||n.length<2?n:r6(n)}(o)},n.push(t);const r=new $r("size");return r.xform=function i(s,o){return void 0!==o?Number(o):o},n.push(r),n.push(new $r("timeCreated")),n.push(new $r("updated")),n.push(new $r("md5Hash",null,!0)),n.push(new $r("cacheControl",null,!0)),n.push(new $r("contentDisposition",null,!0)),n.push(new $r("contentEncoding",null,!0)),n.push(new $r("contentLanguage",null,!0)),n.push(new $r("contentType",null,!0)),n.push(new $r("metadata","customMetadata",!0)),DI=n,DI}function s6(n,e,t){const i=PO(e);return null===i?null:function ibe(n,e,t){const i={type:"file"},r=t.length;for(let s=0;s<r;s++){const o=t[s];i[o.local]=o.xform(i,e[o.server])}return function nbe(n,e){Object.defineProperty(n,"ref",{get:function t(){const s=new Dr(n.bucket,n.fullPath);return e._makeStorageReference(s)}})}(i,n),i}(n,i,t)}function OO(n,e){const t={},i=e.length;for(let r=0;r<i;r++){const s=e[r];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}const o6="prefixes",a6="items";class Oa{constructor(e,t,i,r){this.url=e,this.method=t,this.handler=i,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Ma(n){if(!n)throw SO()}function SI(n,e){return function t(i,r){const s=s6(n,r,e);return Ma(null!==s),s}}function dg(n){return function e(t,i){let r;return r=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?function I0e(){return new Zn(Un.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function T0e(){return new Zn(Un.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===t.getStatus()?function w0e(n){return new Zn(Un.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===t.getStatus()?function C0e(n){return new Zn(Un.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}(n.path):i,r.status=t.getStatus(),r.serverResponse=i.serverResponse,r}}function Tv(n){const e=dg(n);return function t(i,r){let s=e(i,r);return 404===i.getStatus()&&(s=function E0e(n){return new Zn(Un.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}(n.path)),s.serverResponse=r.serverResponse,s}}function l6(n,e,t){const r=Ml(e.fullServerUrl(),n.host,n._protocol),o=n.maxOperationRetryTime,a=new Oa(r,"GET",SI(n,t),o);return a.errorHandler=Tv(e),a}function cbe(n,e,t,i,r){const s={};s.prefix=e.isRoot?"":e.path+"/",t&&t.length>0&&(s.delimiter=t),i&&(s.pageToken=i),r&&(s.maxResults=r);const a=Ml(e.bucketOnlyServerUrl(),n.host,n._protocol),u=n.maxOperationRetryTime,h=new Oa(a,"GET",function abe(n,e){return function t(i,r){const s=function obe(n,e,t){const i=PO(t);return null===i?null:function sbe(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[o6])for(const r of t[o6]){const s=r.replace(/\/$/,""),o=n._makeStorageReference(new Dr(e,s));i.prefixes.push(o)}if(t[a6])for(const r of t[a6]){const s=n._makeStorageReference(new Dr(e,r.name));i.items.push(s)}return i}(n,e,i)}(n,e,r);return Ma(null!==s),s}}(n,e.bucket),u);return h.urlParams=s,h.errorHandler=dg(e),h}function u6(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=function fbe(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}(null,e)),i}class AI{constructor(e,t,i,r){this.current=e,this.total=t,this.finalized=!!i,this.metadata=r||null}}function MO(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{Ma(!1)}return Ma(!!t&&-1!==(e||["active"]).indexOf(t)),t}const _be={STATE_CHANGED:"state_changed"},Hr={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function kO(n){switch(n){case"running":case"pausing":case"canceling":return Hr.RUNNING;case"paused":return Hr.PAUSED;case"success":return Hr.SUCCESS;case"canceled":return Hr.CANCELED;default:return Hr.ERROR}}class ybe{constructor(e,t,i){if(function F0e(n){return"function"==typeof n}(e)||null!=t||null!=i)this.next=e,this.error=t??void 0,this.complete=i??void 0;else{const s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}}function hg(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}let f6=null;class vbe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ug.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ug.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ug.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,r){if(this.sent_)throw Ev("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const s in r)r.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,r[s].toString());return void 0!==i?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ev("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ev("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Ev("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ev("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class bbe extends vbe{initXhr(){this.xhr_.responseType="text"}}function Wo(){return f6?f6():new bbe}class p6{constructor(e,t,i=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=i,this._mappings=wv(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=r=>{if(this._request=void 0,this._chunkMultiplier=1,r._codeEquals(Un.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const s=this.isExponentialBackoffExpired();if(e6(r.status,[])){if(!s)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();r=qW()}this._error=r,this._transition("error")}},this._metadataErrorHandler=r=>{this._request=void 0,r._codeEquals(Un.CANCELED)?this.completeTransitions_():(this._error=r,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((r,s)=>{this._resolve=r,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,i])=>{switch(this._state){case"running":e(t,i);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const i=function pbe(n,e,t,i,r){const s=e.bucketOnlyServerUrl(),o=u6(e,i,r),a={name:o.fullPath},l=Ml(s,n.host,n._protocol),h={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${i.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},g=OO(o,t),b=new Oa(l,"POST",function y(w){let T;MO(w);try{T=w.getResponseHeader("X-Goog-Upload-URL")}catch{Ma(!1)}return Ma(II(T)),T},n.maxUploadRetryTime);return b.urlParams=a,b.headers=h,b.body=g,b.errorHandler=dg(e),b}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(i,Wo,e,t);this._request=r,r.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,i)=>{const r=function gbe(n,e,t,i){const l=new Oa(t,"POST",function s(u){const h=MO(u,["active","final"]);let g=null;try{g=u.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Ma(!1)}g||Ma(!1);const m=Number(g);return Ma(!isNaN(m)),new AI(m,i.size(),"final"===h)},n.maxUploadRetryTime);return l.headers={"X-Goog-Upload-Command":"query"},l.errorHandler=dg(e),l}(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(r,Wo,t,i);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,t=new AI(this._transferred,this._blob.size()),i=this._uploadUrl;this._resolveToken((r,s)=>{let o;try{o=function mbe(n,e,t,i,r,s,o,a){const l=new AI(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=i.size()),i.size()!==l.total)throw function R0e(){return new Zn(Un.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const u=l.total-l.current;let h=u;r>0&&(h=Math.min(h,r));const g=l.current;let y="";y=0===h?"finalize":u===h?"upload, finalize":"upload";const b={"X-Goog-Upload-Command":y,"X-Goog-Upload-Offset":`${l.current}`},w=i.slice(g,g+h);if(null===w)throw ZW();const M=new Oa(t,"POST",function T(L,Y){const pe=MO(L,["active","final"]),Oe=l.current+h,Ge=i.size();let ln;return ln="final"===pe?SI(e,s)(L,Y):null,new AI(Oe,Ge,"final"===pe,ln)},e.maxUploadRetryTime);return M.headers=b,M.body=w.uploadData(),M.progressCallback=a||null,M.errorHandler=dg(n),M}(this._ref._location,this._ref.storage,i,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(l){return this._error=l,void this._transition("error")}const a=this._ref.storage._makeRequest(o,Wo,r,s,!1);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const i=l6(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(i,Wo,e,t);this._request=r,r.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const i=function d6(n,e,t,i,r){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},l=function a(){let M="";for(let L=0;L<2;L++)M+=Math.random().toString().slice(2);return M}();o["Content-Type"]="multipart/related; boundary="+l;const u=u6(e,i,r),h=OO(u,t),y=Pa.getBlob("--"+l+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+h+"\r\n--"+l+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",i,"\r\n--"+l+"--");if(null===y)throw ZW();const b={name:u.fullPath},w=Ml(s,n.host,n._protocol),P=n.maxUploadRetryTime,S=new Oa(w,"POST",SI(n,t),P);return S.urlParams=b,S.headers=o,S.body=y.uploadData(),S.errorHandler=dg(e),S}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(i,Wo,e,t);this._request=r,r.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=KW(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=kO(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,i,r){const s=new ybe(t||void 0,i||void 0,r||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(kO(this._state)){case Hr.SUCCESS:hg(this._resolve.bind(null,this.snapshot))();break;case Hr.CANCELED:case Hr.ERROR:hg(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(kO(this._state)){case Hr.RUNNING:case Hr.PAUSED:e.next&&hg(e.next.bind(e,this.snapshot))();break;case Hr.SUCCESS:e.complete&&hg(e.complete.bind(e))();break;default:e.error&&hg(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class Yd{constructor(e,t){this._service=e,this._location=t instanceof Dr?t:Dr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Yd(e,t)}get root(){const e=new Dr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return r6(this._location.path)}get storage(){return this._service}get parent(){const e=function J0e(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new Dr(this._location.bucket,e);return new Yd(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw QW(e)}}function m6(n,e,t){return FO.apply(this,arguments)}function FO(){return FO=(0,K.Z)(function*(n,e,t){const r=yield _6(n,{pageToken:t});e.prefixes.push(...r.prefixes),e.items.push(...r.items),null!=r.nextPageToken&&(yield m6(n,e,r.nextPageToken))}),FO.apply(this,arguments)}function _6(n,e){null!=e&&"number"==typeof e.maxResults&&RO("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=cbe(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,Wo)}function Pbe(n){n._throwIfRoot("getDownloadURL");const e=function ube(n,e,t){const r=Ml(e.fullServerUrl(),n.host,n._protocol),o=n.maxOperationRetryTime,a=new Oa(r,"GET",function lbe(n,e){return function t(i,r){const s=s6(n,r,e);return Ma(null!==s),function rbe(n,e,t,i){const r=PO(e);if(null===r||!II(r.downloadTokens))return null;const s=r.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map(u=>{const g=n.fullPath;return Ml("/b/"+o(n.bucket)+"/o/"+o(g),t,i)+XW({alt:"media",token:u})})[0]}(s,r,n.host,n._protocol)}}(n,t),o);return a.errorHandler=Tv(e),a}(n.storage,n._location,wv());return n.storage.makeRequestWithTokens(e,Wo).then(t=>{if(null===t)throw function N0e(){return new Zn(Un.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return t})}function y6(n,e){const t=function X0e(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return 0===n.length?t:n+"/"+t}(n._location.path,e),i=new Dr(n._location.bucket,t);return new Yd(n.storage,i)}function v6(n,e){if(n instanceof LO){const t=n;if(null==t._bucket)throw function A0e(){return new Zn(Un.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+WW+"' property when initializing the app?")}();const i=new Yd(t,t._bucket);return null!=e?v6(i,e):i}return void 0!==e?y6(n,e):n}function Fbe(n,e){if(e&&function Mbe(n){return/^[A-Za-z]+:\/\//.test(n)}(e)){if(n instanceof LO)return function kbe(n,e){return new Yd(n,e)}(n,e);throw cg("To use ref(service, url), the first argument must be a Storage instance.")}return v6(n,e)}function b6(n,e){const t=e?.[WW];return null==t?null:Dr.makeFromBucketSpec(t,n)}class LO{constructor(e,t,i,r,s){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=zW,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?Dr.makeFromBucketSpec(r,this._host):b6(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?Dr.makeFromBucketSpec(this._url,e):b6(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){RO("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){RO("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,K.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const i=yield t.getToken();if(null!==i)return i.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,K.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Yd(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new P0e(YW());{const o=function H0e(n,e,t,i,r,s,o=!0){const a=XW(n.urlParams),l=n.url+a,u=Object.assign({},n.headers);return function j0e(n,e){e&&(n["X-Firebase-GMPID"]=e)}(u,e),function B0e(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(u,t),function U0e(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(u,s),function $0e(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(u,i),new V0e(l,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o)}(e,this._appId,i,r,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){var i=this;return(0,K.Z)(function*(){const[r,s]=yield Promise.all([i._getAuthToken(),i._getAppCheckToken()]);return i._makeRequest(e,t,r,s).getPromise()})()}}const E6="@firebase/storage";function I6(n,e){return Fbe(n=(0,E.m9)(n),e)}function Wbe(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new LO(t,i,r,e,ls.SDK_VERSION)}!function qbe(){(0,ls._registerComponent)(new ko.wA("storage",Wbe,"PUBLIC").setMultipleInstances(!0)),(0,ls.registerVersion)(E6,"0.12.0",""),(0,ls.registerVersion)(E6,"0.12.0","esm2017")}();class RI{constructor(e,t,i){this._delegate=e,this.task=t,this.ref=i}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class D6{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new RI(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(i=>{if(e)return e(new RI(i,this,this._ref))},t)}on(e,t,i,r){let s;return t&&(s="function"==typeof t?o=>t(new RI(o,this,this._ref)):{next:t.next?o=>t.next(new RI(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,i||void 0,r||void 0)}}class S6{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new kl(e,this._service))}get items(){return this._delegate.items.map(e=>new kl(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class kl{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function zbe(n,e){return y6(n,e)}(this._delegate,e);return new kl(t,this.storage)}get root(){return new kl(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new kl(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new D6(function Vbe(n,e,t){return function Sbe(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new p6(n,new Pa(e),t)}(n=(0,E.m9)(n),e,t)}(this._delegate,e,t),this)}putString(e,t=Ls.RAW,i){this._throwIfRoot("putString");const r=xO(t,e),s=Object.assign({},i);return null==s.contentType&&null!=r.contentType&&(s.contentType=r.contentType),new D6(new p6(this._delegate,new Pa(r.data,!0),s),this)}listAll(){return function $be(n){return function Rbe(n){const e={prefixes:[],items:[]};return m6(n,e).then(()=>e)}(n=(0,E.m9)(n))}(this._delegate).then(e=>new S6(e,this.storage))}list(e){return function jbe(n,e){return _6(n=(0,E.m9)(n),e)}(this._delegate,e||void 0).then(t=>new S6(t,this.storage))}getMetadata(){return function Bbe(n){return function Nbe(n){n._throwIfRoot("getMetadata");const e=l6(n.storage,n._location,wv());return n.storage.makeRequestWithTokens(e,Wo)}(n=(0,E.m9)(n))}(this._delegate)}updateMetadata(e){return function Ube(n,e){return function xbe(n,e){n._throwIfRoot("updateMetadata");const t=function dbe(n,e,t,i){const s=Ml(e.fullServerUrl(),n.host,n._protocol),a=OO(t,i),u=n.maxOperationRetryTime,h=new Oa(s,"PATCH",SI(n,i),u);return h.headers={"Content-Type":"application/json; charset=utf-8"},h.body=a,h.errorHandler=Tv(e),h}(n.storage,n._location,e,wv());return n.storage.makeRequestWithTokens(t,Wo)}(n=(0,E.m9)(n),e)}(this._delegate,e)}getDownloadURL(){return function Hbe(n){return Pbe(n=(0,E.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function Gbe(n){return function Obe(n){n._throwIfRoot("deleteObject");const e=function hbe(n,e){const i=Ml(e.fullServerUrl(),n.host,n._protocol),a=new Oa(i,"DELETE",function o(l,u){},n.maxOperationRetryTime);return a.successCodes=[200,204],a.errorHandler=Tv(e),a}(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Wo)}(n=(0,E.m9)(n))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw QW(e)}}class A6{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(R6(e))throw cg("ref() expected a child path but got a URL, use refFromURL instead.");return new kl(I6(this._delegate,e),this)}refFromURL(e){if(!R6(e))throw cg("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Dr.makeFromUrl(e,this._delegate.host)}catch{throw cg("refFromUrl() expected a valid full URL but got an invalid one.")}return new kl(I6(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,i={}){!function C6(n,e,t,i={}){!function Lbe(n,e,t,i={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:r}=i;r&&(n._overrideAuthToken="string"==typeof r?r:(0,E.Sg)(r,n.app.options.projectId))}(n,e,t,i)}(this._delegate,e,t,i)}}function R6(n){return/^[A-Za-z]+:\/\//.test(n)}function Qbe(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),i=n.getProvider("storage").getImmediate({identifier:e});return new A6(t,i)}function N6(n){const e=function Xbe(n){return new $e(e=>{const t=o=>e.next(o);t(n.snapshot);const s=n.on("state_changed",t);return n.then(o=>{t(o),e.complete()},o=>{t(n.snapshot),(o=>{e.error(o)})(o)}),function(){s()}}).pipe(function p0e(n,e=JS){return t=>t.lift(new g0e(n,e))}(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(Ne(t=>t.bytesTransferred/t.totalBytes*100))}}function NI(n){return{getDownloadURL:()=>ye(void 0).pipe(SU,Ot(()=>n.getDownloadURL()),ui),getMetadata:()=>ye(void 0).pipe(SU,Ot(()=>n.getMetadata()),ui),delete:()=>N(n.delete()),child:e=>NI(n.child(e)),updateMetadata:e=>N(n.updateMetadata(e)),put:(e,t)=>N6(n.put(e,t)),putString:(e,t,i)=>N6(n.putString(e,t,i)),list:e=>N(n.list(e)),listAll:()=>N(n.listAll())}}!function Jbe(n){const e={TaskState:Hr,TaskEvent:_be,StringFormat:Ls,Storage:A6,Reference:kl};n.INTERNAL.registerComponent(new ko.wA("storage-compat",Qbe,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.3.3")}(no.Z);const eEe=new me("angularfire2.storageBucket"),tEe=new me("angularfire2.storage.maxUploadRetryTime"),nEe=new me("angularfire2.storage.maxOperationRetryTime"),iEe=new me("angularfire2.storage.use-emulator");let rEe=(()=>{class n{storage;constructor(t,i,r,s,o,a,l,u,h,g){const m=__(t,o,i);this.storage=UE(`${m.name}.storage.${r}`,"AngularFireStorage",m.name,()=>{const y=o.runOutsideAngular(()=>m.storage(r||void 0)),b=h;return b&&y.useEmulator(...b),l&&y.setMaxUploadRetryTime(l),u&&y.setMaxOperationRetryTime(u),y},[l,u])}ref(t){return NI(this.storage.ref(t))}refFromURL(t){return NI(this.storage.refFromURL(t))}upload(t,i,r){return NI(this.storage.ref(t)).put(i,r)}static \u0275fac=function(i){return new(i||n)(W(Zf),W(Yf,8),W(eEe,8),W(Co),W(rt),W(BE),W(tEe,8),W(nEe,8),W(iEe,8),W(VE,8))};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),sEe=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=yt({type:n});static \u0275inj=ht({})}return n})(),oEe=(()=>{class n{constructor(){no.Z.registerVersion("angularfire",m_.full,"gcs-compat")}static \u0275fac=function(i){return new(i||n)};static \u0275mod=yt({type:n});static \u0275inj=ht({providers:[rEe],imports:[sEe]})}return n})();const x6_firebase={apiKey:"AIzaSyAKD3R8dMk-YpNi78GsHXvU_Tkhqp9u3XM",authDomain:"please-take-your-turn.firebaseapp.com",projectId:"please-take-your-turn",storageBucket:"please-take-your-turn.appspot.com",messagingSenderId:"386803685699",appId:"1:386803685699:web:63cff6e4163b36a971f7f6",measurementId:"G-9FT9L70K5D"};new class lEe extends Mo{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class aEe extends PE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(()=>e.flush(null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(cancelAnimationFrame(t),e.scheduled=void 0)}});RegExp(/[&<>"']/g.source);const BEe=new me("ng-select-selection-model");function UEe(){return new jEe}class jEe{constructor(){this._selected=[]}get value(){return this._selected}select(e,t,i){if(e.selected=!0,(!e.children||!t&&i)&&this._selected.push(e),t)if(e.parent){const r=e.parent.children.length,s=e.parent.children.filter(o=>o.selected).length;e.parent.selected=r===s}else e.children&&(this._setChildrenSelectedState(e.children,!0),this._removeChildren(e),this._selected=i&&this._activeChildren(e)?[...this._selected.filter(r=>r.parent!==e),e]:[...this._selected,...e.children.filter(r=>!r.disabled)])}unselect(e,t){if(this._selected=this._selected.filter(i=>i!==e),e.selected=!1,t)if(e.parent&&e.parent.selected){const i=e.parent.children;this._removeParent(e.parent),this._removeChildren(e.parent),this._selected.push(...i.filter(r=>r!==e&&!r.disabled)),e.parent.selected=!1}else e.children&&(this._setChildrenSelectedState(e.children,!1),this._removeChildren(e))}clear(e){this._selected=e?this._selected.filter(t=>t.disabled):[]}_setChildrenSelectedState(e,t){for(const i of e)i.disabled||(i.selected=t)}_removeChildren(e){this._selected=[...this._selected.filter(t=>t.parent!==e),...e.children.filter(t=>t.parent===e&&t.disabled&&t.selected)]}_removeParent(e){this._selected=this._selected.filter(t=>t!==e)}_activeChildren(e){return e.children.every(t=>!t.disabled||t.selected)}}let $Ee=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n});static#n=this.\u0275inj=ht({providers:[{provide:BEe,useValue:UEe}],imports:[gS]})}return n})(),HEe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=yt({type:n,bootstrap:[Ppe]});static#n=this.\u0275inj=ht({providers:[vR,bR,Z$],imports:[xee,Cce,Rce,are.initializeApp(x6_firebase),Dle,f0e,oEe,H4,$Ee,Pie,H4]})}return n})();Ree().bootstrapModule(HEe).catch(n=>console.error(n))},614:()=>{const zr=":";const fo=function(N,...k){if(fo.translate){const X=fo.translate(N,k);N=X[0],k=X[1]}let H=Jo(N[0],N.raw[0]);for(let X=1;X<N.length;X++)H+=k[X-1]+Jo(N[X],N.raw[X]);return H},La=":";function Jo(N,k){return k.charAt(0)===La?N.substring(function Wi(N,k){for(let H=1,X=1;H<N.length;H++,X++)if("\\"===k[X])X++;else if(N[H]===zr)return H;throw new Error(`Unterminated $localize metadata block in "${k}".`)}(N,k)+1):N}globalThis.$localize=fo},106:(zr,fi,et)=>{et.d(fi,{Z:()=>$n});var D=et(58),Be=et(537),j=et(534),ze=et(879);class rn{constructor(ut,Ye){this._delegate=ut,this.firebase=Ye,(0,j._addComponent)(ut,new Be.wA("app-compat",()=>this,"PUBLIC")),this.container=ut.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(ut){this._delegate.automaticDataCollectionEnabled=ut}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(ut=>{this._delegate.checkDestroyed(),ut()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,j.deleteApp)(this._delegate)))}_getService(ut,Ye=j._DEFAULT_ENTRY_NAME){var Yn;this._delegate.checkDestroyed();const xi=this._delegate.container.getProvider(ut);return!xi.isInitialized()&&"EXPLICIT"===(null===(Yn=xi.getComponent())||void 0===Yn?void 0:Yn.instantiationMode)&&xi.initialize(),xi.getImmediate({identifier:Ye})}_removeServiceInstance(ut,Ye=j._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(ut).clearInstance(Ye)}_addComponent(ut){(0,j._addComponent)(this._delegate,ut)}_addOrOverwriteComponent(ut){(0,j._addOrOverwriteComponent)(this._delegate,ut)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const On=new D.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),$=function Dt(){const Qt=function si(Qt){const ut={},Ye={__esModule:!0,initializeApp:function Hn(ot,Gn={}){const Tn=j.initializeApp(ot,Gn);if((0,D.r3)(ut,Tn.name))return ut[Tn.name];const Qe=new Qt(Tn,Ye);return ut[Tn.name]=Qe,Qe},app:xi,registerVersion:j.registerVersion,setLogLevel:j.setLogLevel,onLog:j.onLog,apps:null,SDK_VERSION:j.SDK_VERSION,INTERNAL:{registerComponent:function Wr(ot){const Gn=ot.name,Tn=Gn.replace("-compat","");if(j._registerComponent(ot)&&"PUBLIC"===ot.type){const Qe=(Sr=xi())=>{if("function"!=typeof Sr[Tn])throw On.create("invalid-app-argument",{appName:Gn});return Sr[Tn]()};void 0!==ot.serviceProps&&(0,D.ZB)(Qe,ot.serviceProps),Ye[Tn]=Qe,Qt.prototype[Tn]=function(...Sr){return this._getService.bind(this,Gn).apply(this,ot.multipleInstances?Sr:[])}}return"PUBLIC"===ot.type?Ye[Tn]:null},removeApp:function Yn(ot){delete ut[ot]},useAsService:function ka(ot,Gn){return"serverAuth"===Gn?null:Gn},modularAPIs:j}};function xi(ot){if(!(0,D.r3)(ut,ot=ot||j._DEFAULT_ENTRY_NAME))throw On.create("no-app",{appName:ot});return ut[ot]}return Ye.default=Ye,Object.defineProperty(Ye,"apps",{get:function $e(){return Object.keys(ut).map(ot=>ut[ot])}}),xi.App=Qt,Ye}(rn);return Qt.INTERNAL=Object.assign(Object.assign({},Qt.INTERNAL),{createFirebaseNamespace:Dt,extendNamespace:function ut(Ye){(0,D.ZB)(Qt,Ye)},createSubscribe:D.ne,ErrorFactory:D.LL,deepExtend:D.ZB}),Qt}(),re=new ze.Yd("@firebase/app-compat");if((0,D.jU)()&&void 0!==self.firebase){re.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Qt=self.firebase.SDK_VERSION;Qt&&Qt.indexOf("LITE")>=0&&re.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const $n=$;!function xe(Qt){(0,j.registerVersion)("@firebase/app-compat","0.2.25",Qt)}()},534:(zr,fi,et)=>{et.r(fi),et.d(fi,{FirebaseError:()=>ze.ZR,SDK_VERSION:()=>ih,_DEFAULT_ENTRY_NAME:()=>tt,_addComponent:()=>cn,_addOrOverwriteComponent:()=>un,_apps:()=>Q,_clearComponents:()=>pr,_components:()=>Ht,_getProvider:()=>vi,_registerComponent:()=>ye,_removeServiceInstance:()=>gn,deleteApp:()=>Va,getApp:()=>Gt,getApps:()=>Ut,initializeApp:()=>Bl,onLog:()=>Zr,registerVersion:()=>Ot,setLogLevel:()=>Ul});var D=et(861),Be=et(537),j=et(879),ze=et(58);const rn=(q,B)=>B.some(ne=>q instanceof ne);let Bt,On;const $=new WeakMap,re=new WeakMap,Me=new WeakMap,mt=new WeakMap,xe=new WeakMap;let ut={get(q,B,ne){if(q instanceof IDBTransaction){if("done"===B)return re.get(q);if("objectStoreNames"===B)return q.objectStoreNames||Me.get(q);if("store"===B)return ne.objectStoreNames[1]?void 0:ne.objectStore(ne.objectStoreNames[0])}return Hn(q[B])},set:(q,B,ne)=>(q[B]=ne,!0),has:(q,B)=>q instanceof IDBTransaction&&("done"===B||"store"===B)||B in q};function xi(q){return"function"==typeof q?function Yn(q){return q!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Dt(){return On||(On=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(q)?function(...B){return q.apply($e(this),B),Hn($.get(this))}:function(...B){return Hn(q.apply($e(this),B))}:function(B,...ne){const Se=q.call($e(this),B,...ne);return Me.set(Se,B.sort?B.sort():[B]),Hn(Se)}}(q):(q instanceof IDBTransaction&&function Qt(q){if(re.has(q))return;const B=new Promise((ne,Se)=>{const Le=()=>{q.removeEventListener("complete",bt),q.removeEventListener("error",at),q.removeEventListener("abort",at)},bt=()=>{ne(),Le()},at=()=>{Se(q.error||new DOMException("AbortError","AbortError")),Le()};q.addEventListener("complete",bt),q.addEventListener("error",at),q.addEventListener("abort",at)});re.set(q,B)}(q),rn(q,function si(){return Bt||(Bt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(q,ut):q)}function Hn(q){if(q instanceof IDBRequest)return function $n(q){const B=new Promise((ne,Se)=>{const Le=()=>{q.removeEventListener("success",bt),q.removeEventListener("error",at)},bt=()=>{ne(Hn(q.result)),Le()},at=()=>{Se(q.error),Le()};q.addEventListener("success",bt),q.addEventListener("error",at)});return B.then(ne=>{ne instanceof IDBCursor&&$.set(ne,q)}).catch(()=>{}),xe.set(B,q),B}(q);if(mt.has(q))return mt.get(q);const B=xi(q);return B!==q&&(mt.set(q,B),xe.set(B,q)),B}const $e=q=>xe.get(q),ot=["get","getKey","getAll","getAllKeys","count"],Gn=["put","add","delete","clear"],Tn=new Map;function Qe(q,B){if(!(q instanceof IDBDatabase)||B in q||"string"!=typeof B)return;if(Tn.get(B))return Tn.get(B);const ne=B.replace(/FromIndex$/,""),Se=B!==ne,Le=Gn.includes(ne);if(!(ne in(Se?IDBIndex:IDBObjectStore).prototype)||!Le&&!ot.includes(ne))return;const bt=function(){var at=(0,D.Z)(function*(Qn,...Jt){const ea=this.transaction(Qn,Le?"readwrite":"readonly");let uu=ea.store;return Se&&(uu=uu.index(Jt.shift())),(yield Promise.all([uu[ne](...Jt),Le&&ea.done]))[0]});return function(Jt){return at.apply(this,arguments)}}();return Tn.set(B,bt),bt}!function Ye(q){ut=q(ut)}(q=>({...q,get:(B,ne,Se)=>Qe(B,ne)||q.get(B,ne,Se),has:(B,ne)=>!!Qe(B,ne)||q.has(B,ne)}));class Sr{constructor(B){this.container=B}getPlatformInfoString(){return this.container.getProviders().map(ne=>{if(function hr(q){const B=q.getComponent();return"VERSION"===B?.type}(ne)){const Se=ne.getImmediate();return`${Se.library}/${Se.version}`}return null}).filter(ne=>ne).join(" ")}}const Ne="@firebase/app",qr=new j.Yd("@firebase/app"),tt="[DEFAULT]",In={[Ne]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Q=new Map,Ht=new Map;function cn(q,B){try{q.container.addComponent(B)}catch(ne){qr.debug(`Component ${B.name} failed to register with FirebaseApp ${q.name}`,ne)}}function un(q,B){q.container.addOrOverwriteComponent(B)}function ye(q){const B=q.name;if(Ht.has(B))return qr.debug(`There were multiple attempts to register component ${B}.`),!1;Ht.set(B,q);for(const ne of Q.values())cn(ne,q);return!0}function vi(q,B){const ne=q.container.getProvider("heartbeat").getImmediate({optional:!0});return ne&&ne.triggerHeartbeat(),q.container.getProvider(B)}function gn(q,B,ne=tt){vi(q,B).clearInstance(ne)}function pr(){Ht.clear()}const bi=new ze.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Xo{constructor(B,ne,Se){this._isDeleted=!1,this._options=Object.assign({},B),this._config=Object.assign({},ne),this._name=ne.name,this._automaticDataCollectionEnabled=ne.automaticDataCollectionEnabled,this._container=Se,this.container.addComponent(new Be.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(B){this.checkDestroyed(),this._automaticDataCollectionEnabled=B}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(B){this._isDeleted=B}checkDestroyed(){if(this.isDeleted)throw bi.create("app-deleted",{appName:this._name})}}const ih="10.7.1";function Bl(q,B={}){let ne=q;"object"!=typeof B&&(B={name:B});const Se=Object.assign({name:tt,automaticDataCollectionEnabled:!1},B),Le=Se.name;if("string"!=typeof Le||!Le)throw bi.create("bad-app-name",{appName:String(Le)});if(ne||(ne=(0,ze.aH)()),!ne)throw bi.create("no-options");const bt=Q.get(Le);if(bt){if((0,ze.vZ)(ne,bt.options)&&(0,ze.vZ)(Se,bt.config))return bt;throw bi.create("duplicate-app",{appName:Le})}const at=new Be.H0(Le);for(const Jt of Ht.values())at.addComponent(Jt);const Qn=new Xo(ne,Se,at);return Q.set(Le,Qn),Qn}function Gt(q=tt){const B=Q.get(q);if(!B&&q===tt&&(0,ze.aH)())return Bl();if(!B)throw bi.create("no-app",{appName:q});return B}function Ut(){return Array.from(Q.values())}function Va(q){return Bs.apply(this,arguments)}function Bs(){return(Bs=(0,D.Z)(function*(q){const B=q.name;Q.has(B)&&(Q.delete(B),yield Promise.all(q.container.getProviders().map(ne=>ne.delete())),q.isDeleted=!0)})).apply(this,arguments)}function Ot(q,B,ne){var Se;let Le=null!==(Se=In[q])&&void 0!==Se?Se:q;ne&&(Le+=`-${ne}`);const bt=Le.match(/\s|\//),at=B.match(/\s|\//);if(bt||at){const Qn=[`Unable to register library "${Le}" with version "${B}":`];return bt&&Qn.push(`library name "${Le}" contains illegal characters (whitespace or "/")`),bt&&at&&Qn.push("and"),at&&Qn.push(`version name "${B}" contains illegal characters (whitespace or "/")`),void qr.warn(Qn.join(" "))}ye(new Be.wA(`${Le}-version`,()=>({library:Le,version:B}),"VERSION"))}function Zr(q,B){if(null!==q&&"function"!=typeof q)throw bi.create("invalid-log-argument");(0,j.Am)(q,B)}function Ul(q){(0,j.Ub)(q)}const po="firebase-heartbeat-database",cu=1,A="firebase-heartbeat-store";let C=null;function x(){return C||(C=function Wr(q,B,{blocked:ne,upgrade:Se,blocking:Le,terminated:bt}={}){const at=indexedDB.open(q,B),Qn=Hn(at);return Se&&at.addEventListener("upgradeneeded",Jt=>{Se(Hn(at.result),Jt.oldVersion,Jt.newVersion,Hn(at.transaction),Jt)}),ne&&at.addEventListener("blocked",Jt=>ne(Jt.oldVersion,Jt.newVersion,Jt)),Qn.then(Jt=>{bt&&Jt.addEventListener("close",()=>bt()),Le&&Jt.addEventListener("versionchange",ea=>Le(ea.oldVersion,ea.newVersion,ea))}).catch(()=>{}),Qn}(po,cu,{upgrade:(q,B)=>{0===B&&q.createObjectStore(A)}}).catch(q=>{throw bi.create("idb-open",{originalErrorMessage:q.message})})),C}function V(){return(V=(0,D.Z)(function*(q){try{return yield(yield x()).transaction(A).objectStore(A).get(Ie(q))}catch(B){if(B instanceof ze.ZR)qr.warn(B.message);else{const ne=bi.create("idb-get",{originalErrorMessage:B?.message});qr.warn(ne.message)}}})).apply(this,arguments)}function Re(q,B){return ge.apply(this,arguments)}function ge(){return(ge=(0,D.Z)(function*(q,B){try{const Se=(yield x()).transaction(A,"readwrite");yield Se.objectStore(A).put(B,Ie(q)),yield Se.done}catch(ne){if(ne instanceof ze.ZR)qr.warn(ne.message);else{const Se=bi.create("idb-set",{originalErrorMessage:ne?.message});qr.warn(Se.message)}}})).apply(this,arguments)}function Ie(q){return`${q.name}!${q.options.appId}`}class Ar{constructor(B){this.container=B,this._heartbeatsCache=null;const ne=this.container.getProvider("app").getImmediate();this._storage=new vs(ne),this._heartbeatsCachePromise=this._storage.read().then(Se=>(this._heartbeatsCache=Se,Se))}triggerHeartbeat(){var B=this;return(0,D.Z)(function*(){var ne,Se;const bt=B.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),at=St();if((null!=(null===(ne=B._heartbeatsCache)||void 0===ne?void 0:ne.heartbeats)||(B._heartbeatsCache=yield B._heartbeatsCachePromise,null!=(null===(Se=B._heartbeatsCache)||void 0===Se?void 0:Se.heartbeats)))&&B._heartbeatsCache.lastSentHeartbeatDate!==at&&!B._heartbeatsCache.heartbeats.some(Qn=>Qn.date===at))return B._heartbeatsCache.heartbeats.push({date:at,agent:bt}),B._heartbeatsCache.heartbeats=B._heartbeatsCache.heartbeats.filter(Qn=>{const Jt=new Date(Qn.date).valueOf();return Date.now()-Jt<=2592e6}),B._storage.overwrite(B._heartbeatsCache)})()}getHeartbeatsHeader(){var B=this;return(0,D.Z)(function*(){var ne;if(null===B._heartbeatsCache&&(yield B._heartbeatsCachePromise),null==(null===(ne=B._heartbeatsCache)||void 0===ne?void 0:ne.heartbeats)||0===B._heartbeatsCache.heartbeats.length)return"";const Se=St(),{heartbeatsToSend:Le,unsentEntries:bt}=function J(q,B=1024){const ne=[];let Se=q.slice();for(const Le of q){const bt=ne.find(at=>at.agent===Le.agent);if(bt){if(bt.dates.push(Le.date),je(ne)>B){bt.dates.pop();break}}else if(ne.push({agent:Le.agent,dates:[Le.date]}),je(ne)>B){ne.pop();break}Se=Se.slice(1)}return{heartbeatsToSend:ne,unsentEntries:Se}}(B._heartbeatsCache.heartbeats),at=(0,ze.L)(JSON.stringify({version:2,heartbeats:Le}));return B._heartbeatsCache.lastSentHeartbeatDate=Se,bt.length>0?(B._heartbeatsCache.heartbeats=bt,yield B._storage.overwrite(B._heartbeatsCache)):(B._heartbeatsCache.heartbeats=[],B._storage.overwrite(B._heartbeatsCache)),at})()}}function St(){return(new Date).toISOString().substring(0,10)}class vs{constructor(B){this.app=B,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,D.Z)(function*(){return!!(0,ze.hl)()&&(0,ze.eu)().then(()=>!0).catch(()=>!1)})()}read(){var B=this;return(0,D.Z)(function*(){if(yield B._canUseIndexedDBPromise){const Se=yield function G(q){return V.apply(this,arguments)}(B.app);return Se?.heartbeats?Se:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(B){var ne=this;return(0,D.Z)(function*(){var Se;if(yield ne._canUseIndexedDBPromise){const bt=yield ne.read();return Re(ne.app,{lastSentHeartbeatDate:null!==(Se=B.lastSentHeartbeatDate)&&void 0!==Se?Se:bt.lastSentHeartbeatDate,heartbeats:B.heartbeats})}})()}add(B){var ne=this;return(0,D.Z)(function*(){var Se;if(yield ne._canUseIndexedDBPromise){const bt=yield ne.read();return Re(ne.app,{lastSentHeartbeatDate:null!==(Se=B.lastSentHeartbeatDate)&&void 0!==Se?Se:bt.lastSentHeartbeatDate,heartbeats:[...bt.heartbeats,...B.heartbeats]})}})()}}function je(q){return(0,ze.L)(JSON.stringify({version:2,heartbeats:q})).length}!function _t(q){ye(new Be.wA("platform-logger",B=>new Sr(B),"PRIVATE")),ye(new Be.wA("heartbeat",B=>new Ar(B),"PRIVATE")),Ot(Ne,"0.9.25",q),Ot(Ne,"0.9.25","esm2017"),Ot("fire-js","")}("")},537:(zr,fi,et)=>{et.d(fi,{H0:()=>si,wA:()=>j,zt:()=>rn});var D=et(861),Be=et(58);class j{constructor($,re,Me){this.name=$,this.instanceFactory=re,this.type=Me,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode($){return this.instantiationMode=$,this}setMultipleInstances($){return this.multipleInstances=$,this}setServiceProps($){return this.serviceProps=$,this}setInstanceCreatedCallback($){return this.onInstanceCreated=$,this}}const ze="[DEFAULT]";class rn{constructor($,re){this.name=$,this.container=re,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get($){const re=this.normalizeInstanceIdentifier($);if(!this.instancesDeferred.has(re)){const Me=new Be.BH;if(this.instancesDeferred.set(re,Me),this.isInitialized(re)||this.shouldAutoInitialize())try{const mt=this.getOrInitializeService({instanceIdentifier:re});mt&&Me.resolve(mt)}catch{}}return this.instancesDeferred.get(re).promise}getImmediate($){var re;const Me=this.normalizeInstanceIdentifier($?.identifier),mt=null!==(re=$?.optional)&&void 0!==re&&re;if(!this.isInitialized(Me)&&!this.shouldAutoInitialize()){if(mt)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Me})}catch(xe){if(mt)return null;throw xe}}getComponent(){return this.component}setComponent($){if($.name!==this.name)throw Error(`Mismatching Component ${$.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=$,this.shouldAutoInitialize()){if(function On(Dt){return"EAGER"===Dt.instantiationMode}($))try{this.getOrInitializeService({instanceIdentifier:ze})}catch{}for(const[re,Me]of this.instancesDeferred.entries()){const mt=this.normalizeInstanceIdentifier(re);try{const xe=this.getOrInitializeService({instanceIdentifier:mt});Me.resolve(xe)}catch{}}}}clearInstance($=ze){this.instancesDeferred.delete($),this.instancesOptions.delete($),this.instances.delete($)}delete(){var $=this;return(0,D.Z)(function*(){const re=Array.from($.instances.values());yield Promise.all([...re.filter(Me=>"INTERNAL"in Me).map(Me=>Me.INTERNAL.delete()),...re.filter(Me=>"_delete"in Me).map(Me=>Me._delete())])})()}isComponentSet(){return null!=this.component}isInitialized($=ze){return this.instances.has($)}getOptions($=ze){return this.instancesOptions.get($)||{}}initialize($={}){const{options:re={}}=$,Me=this.normalizeInstanceIdentifier($.instanceIdentifier);if(this.isInitialized(Me))throw Error(`${this.name}(${Me}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const mt=this.getOrInitializeService({instanceIdentifier:Me,options:re});for(const[xe,$n]of this.instancesDeferred.entries())Me===this.normalizeInstanceIdentifier(xe)&&$n.resolve(mt);return mt}onInit($,re){var Me;const mt=this.normalizeInstanceIdentifier(re),xe=null!==(Me=this.onInitCallbacks.get(mt))&&void 0!==Me?Me:new Set;xe.add($),this.onInitCallbacks.set(mt,xe);const $n=this.instances.get(mt);return $n&&$($n,mt),()=>{xe.delete($)}}invokeOnInitCallbacks($,re){const Me=this.onInitCallbacks.get(re);if(Me)for(const mt of Me)try{mt($,re)}catch{}}getOrInitializeService({instanceIdentifier:$,options:re={}}){let Me=this.instances.get($);if(!Me&&this.component&&(Me=this.component.instanceFactory(this.container,{instanceIdentifier:(Dt=$,Dt===ze?void 0:Dt),options:re}),this.instances.set($,Me),this.instancesOptions.set($,re),this.invokeOnInitCallbacks(Me,$),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,$,Me)}catch{}var Dt;return Me||null}normalizeInstanceIdentifier($=ze){return this.component?this.component.multipleInstances?$:ze:$}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class si{constructor($){this.name=$,this.providers=new Map}addComponent($){const re=this.getProvider($.name);if(re.isComponentSet())throw new Error(`Component ${$.name} has already been registered with ${this.name}`);re.setComponent($)}addOrOverwriteComponent($){this.getProvider($.name).isComponentSet()&&this.providers.delete($.name),this.addComponent($)}getProvider($){if(this.providers.has($))return this.providers.get($);const re=new rn($,this);return this.providers.set($,re),re}getProviders(){return Array.from(this.providers.values())}}},879:(zr,fi,et)=>{et.d(fi,{Am:()=>Dt,Ub:()=>si,Yd:()=>On,in:()=>Be});const D=[];var Be=function($){return $[$.DEBUG=0]="DEBUG",$[$.VERBOSE=1]="VERBOSE",$[$.INFO=2]="INFO",$[$.WARN=3]="WARN",$[$.ERROR=4]="ERROR",$[$.SILENT=5]="SILENT",$}(Be||{});const j={debug:Be.DEBUG,verbose:Be.VERBOSE,info:Be.INFO,warn:Be.WARN,error:Be.ERROR,silent:Be.SILENT},ze=Be.INFO,rn={[Be.DEBUG]:"log",[Be.VERBOSE]:"log",[Be.INFO]:"info",[Be.WARN]:"warn",[Be.ERROR]:"error"},Bt=($,re,...Me)=>{if(re<$.logLevel)return;const mt=(new Date).toISOString(),xe=rn[re];if(!xe)throw new Error(`Attempted to log a message with an invalid logType (value: ${re})`);console[xe](`[${mt}]  ${$.name}:`,...Me)};class On{constructor(re){this.name=re,this._logLevel=ze,this._logHandler=Bt,this._userLogHandler=null,D.push(this)}get logLevel(){return this._logLevel}set logLevel(re){if(!(re in Be))throw new TypeError(`Invalid value "${re}" assigned to \`logLevel\``);this._logLevel=re}setLogLevel(re){this._logLevel="string"==typeof re?j[re]:re}get logHandler(){return this._logHandler}set logHandler(re){if("function"!=typeof re)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=re}get userLogHandler(){return this._userLogHandler}set userLogHandler(re){this._userLogHandler=re}debug(...re){this._userLogHandler&&this._userLogHandler(this,Be.DEBUG,...re),this._logHandler(this,Be.DEBUG,...re)}log(...re){this._userLogHandler&&this._userLogHandler(this,Be.VERBOSE,...re),this._logHandler(this,Be.VERBOSE,...re)}info(...re){this._userLogHandler&&this._userLogHandler(this,Be.INFO,...re),this._logHandler(this,Be.INFO,...re)}warn(...re){this._userLogHandler&&this._userLogHandler(this,Be.WARN,...re),this._logHandler(this,Be.WARN,...re)}error(...re){this._userLogHandler&&this._userLogHandler(this,Be.ERROR,...re),this._logHandler(this,Be.ERROR,...re)}}function si($){D.forEach(re=>{re.setLogLevel($)})}function Dt($,re){for(const Me of D){let mt=null;re&&re.level&&(mt=j[re.level]),Me.userLogHandler=null===$?null:(xe,$n,...Qt)=>{const ut=Qt.map(Ye=>{if(null==Ye)return null;if("string"==typeof Ye)return Ye;if("number"==typeof Ye||"boolean"==typeof Ye)return Ye.toString();if(Ye instanceof Error)return Ye.message;try{return JSON.stringify(Ye)}catch{return null}}).filter(Ye=>Ye).join(" ");$n>=(mt??xe.logLevel)&&$({level:Be[$n].toLowerCase(),message:ut,args:Qt,type:xe.name})}}}},980:(zr,fi,et)=>{et.r(fi);var D=et(861),Be=et(106),j=et(58),ze=et(534),rn=et(879);function Dt(f,c){var d={};for(var p in f)Object.prototype.hasOwnProperty.call(f,p)&&c.indexOf(p)<0&&(d[p]=f[p]);if(null!=f&&"function"==typeof Object.getOwnPropertySymbols){var _=0;for(p=Object.getOwnPropertySymbols(f);_<p.length;_++)c.indexOf(p[_])<0&&Object.prototype.propertyIsEnumerable.call(f,p[_])&&(d[p[_]]=f[p[_]])}return d}"function"==typeof SuppressedError&&SuppressedError;var ys=et(537);const fr={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};const La=function Vl(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},Jo=function fo(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},N=new j.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),H=new rn.Yd("@firebase/auth");function he(f,...c){H.logLevel<=rn.in.ERROR&&H.error(`Auth (${ze.SDK_VERSION}): ${f}`,...c)}function se(f,...c){throw In(f,...c)}function Ue(f,...c){return In(f,...c)}function Pt(f,c,d){const p=Object.assign(Object.assign({},Jo()),{[c]:d});return new j.LL("auth","Firebase",p).create(c,{appName:f.name})}function tt(f,c,d){if(!(c instanceof d))throw d.name!==c.constructor.name&&se(f,"argument-error"),Pt(f,"argument-error",`Type of ${c.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function In(f,...c){if("string"!=typeof f){const d=c[0],p=[...c.slice(1)];return p[0]&&(p[0].appName=f.name),f._errorFactory.create(d,...p)}return N.create(f,...c)}function Q(f,c,...d){if(!f)throw In(c,...d)}function Ht(f){const c="INTERNAL ASSERTION FAILED: "+f;throw he(c),new Error(c)}function cn(f,c){f||Ht(c)}function un(){var f;return typeof self<"u"&&(null===(f=self.location)||void 0===f?void 0:f.href)||""}function ye(){return"http:"===vi()||"https:"===vi()}function vi(){var f;return typeof self<"u"&&(null===(f=self.location)||void 0===f?void 0:f.protocol)||null}class Kr{constructor(c,d){this.shortDelay=c,this.longDelay=d,cn(d>c,"Short delay should be less than long delay!"),this.isMobile=(0,j.uI)()||(0,j.b$)()}get(){return function gn(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(ye()||(0,j.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function bi(f,c){cn(f.emulator,"Emulator should always be set here");const{url:d}=f.emulator;return c?`${d}${c.startsWith("/")?c.slice(1):c}`:d}class Xo{static initialize(c,d,p){this.fetchImpl=c,d&&(this.headersImpl=d),p&&(this.responseImpl=p)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void Ht("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void Ht("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void Ht("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ih={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Bl=new Kr(3e4,6e4);function Gt(f,c){return f.tenantId&&!c.tenantId?Object.assign(Object.assign({},c),{tenantId:f.tenantId}):c}function Ut(f,c,d,p){return Va.apply(this,arguments)}function Va(){return(Va=(0,D.Z)(function*(f,c,d,p,_={}){return Bs(f,_,(0,D.Z)(function*(){let v={},I={};p&&("GET"===c?I=p:v={body:JSON.stringify(p)});const R=(0,j.xO)(Object.assign({key:f.config.apiKey},I)).slice(1),z=yield f._getAdditionalHeaders();return z["Content-Type"]="application/json",f.languageCode&&(z["X-Firebase-Locale"]=f.languageCode),Xo.fetch()(po(f,f.config.apiHost,d,R),Object.assign({method:c,headers:z,referrerPolicy:"no-referrer"},v))}))})).apply(this,arguments)}function Bs(f,c,d){return Ot.apply(this,arguments)}function Ot(){return(Ot=(0,D.Z)(function*(f,c,d){f._canInitEmulator=!1;const p=Object.assign(Object.assign({},ih),c);try{const _=new A(f),v=yield Promise.race([d(),_.promise]);_.clearNetworkTimeout();const I=yield v.json();if("needConfirmation"in I)throw C(f,"account-exists-with-different-credential",I);if(v.ok&&!("errorMessage"in I))return I;{const R=v.ok?I.errorMessage:I.error.message,[z,Z]=R.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===z)throw C(f,"credential-already-in-use",I);if("EMAIL_EXISTS"===z)throw C(f,"email-already-in-use",I);if("USER_DISABLED"===z)throw C(f,"user-disabled",I);const ae=p[z]||z.toLowerCase().replace(/[_\s]+/g,"-");if(Z)throw Pt(f,ae,Z);se(f,ae)}}catch(_){if(_ instanceof j.ZR)throw _;se(f,"network-request-failed",{message:String(_)})}})).apply(this,arguments)}function Zr(f,c,d,p){return Ul.apply(this,arguments)}function Ul(){return(Ul=(0,D.Z)(function*(f,c,d,p,_={}){const v=yield Ut(f,c,d,p,_);return"mfaPendingCredential"in v&&se(f,"multi-factor-auth-required",{_serverResponse:v}),v})).apply(this,arguments)}function po(f,c,d,p){const _=`${c}${d}?${p}`;return f.config.emulator?bi(f.config,_):`${f.config.apiScheme}://${_}`}function cu(f){switch(f){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class A{constructor(c){this.auth=c,this.timer=null,this.promise=new Promise((d,p)=>{this.timer=setTimeout(()=>p(Ue(this.auth,"network-request-failed")),Bl.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function C(f,c,d){const p={appName:f.name};d.email&&(p.email=d.email),d.phoneNumber&&(p.phoneNumber=d.phoneNumber);const _=Ue(f,c,p);return _.customData._tokenResponse=d,_}function x(f){return void 0!==f&&void 0!==f.getResponse}function G(f){return void 0!==f&&void 0!==f.enterprise}class V{constructor(c){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===c.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=c.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=c.recaptchaEnforcementState}getProviderEnforcementState(c){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const d of this.recaptchaEnforcementState)if(d.provider&&d.provider===c)return cu(d.enforcementState);return null}isProviderEnabled(c){return"ENFORCE"===this.getProviderEnforcementState(c)||"AUDIT"===this.getProviderEnforcementState(c)}}function ge(){return(ge=(0,D.Z)(function*(f){return(yield Ut(f,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Ie(f,c){return oi.apply(this,arguments)}function oi(){return(oi=(0,D.Z)(function*(f,c){return Ut(f,"GET","/v2/recaptchaConfig",Gt(f,c))})).apply(this,arguments)}function Ar(){return(Ar=(0,D.Z)(function*(f,c){return Ut(f,"POST","/v1/accounts:delete",c)})).apply(this,arguments)}function J(){return(J=(0,D.Z)(function*(f,c){return Ut(f,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function je(){return(je=(0,D.Z)(function*(f,c){return Ut(f,"POST","/v1/accounts:lookup",c)})).apply(this,arguments)}function _t(f){if(f)try{const c=new Date(Number(f));if(!isNaN(c.getTime()))return c.toUTCString()}catch{}}function ne(){return(ne=(0,D.Z)(function*(f,c=!1){const d=(0,j.m9)(f),p=yield d.getIdToken(c),_=Le(p);Q(_&&_.exp&&_.auth_time&&_.iat,d.auth,"internal-error");const v="object"==typeof _.firebase?_.firebase:void 0,I=v?.sign_in_provider;return{claims:_,token:p,authTime:_t(Se(_.auth_time)),issuedAtTime:_t(Se(_.iat)),expirationTime:_t(Se(_.exp)),signInProvider:I||null,signInSecondFactor:v?.sign_in_second_factor||null}})).apply(this,arguments)}function Se(f){return 1e3*Number(f)}function Le(f){const[c,d,p]=f.split(".");if(void 0===c||void 0===d||void 0===p)return he("JWT malformed, contained fewer than 3 sections"),null;try{const _=(0,j.tV)(d);return _?JSON.parse(_):(he("Failed to decode base64 JWT payload"),null)}catch(_){return he("Caught error parsing JWT payload as JSON",_?.toString()),null}}function at(f,c){return Qn.apply(this,arguments)}function Qn(){return(Qn=(0,D.Z)(function*(f,c,d=!1){if(d)return c;try{return yield c}catch(p){throw p instanceof j.ZR&&function Jt({code:f}){return"auth/user-disabled"===f||"auth/user-token-expired"===f}(p)&&f.auth.currentUser===f&&(yield f.auth.signOut()),p}})).apply(this,arguments)}class ea{constructor(c){this.user=c,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(c){var d;if(c){const p=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),p}{this.errorBackoff=3e4;const _=(null!==(d=this.user.stsTokenManager.expirationTime)&&void 0!==d?d:0)-Date.now()-3e5;return Math.max(0,_)}}schedule(c=!1){var d=this;if(!this.isRunning)return;const p=this.getInterval(c);this.timerId=setTimeout((0,D.Z)(function*(){yield d.iteration()}),p)}iteration(){var c=this;return(0,D.Z)(function*(){try{yield c.user.getIdToken(!0)}catch(d){return void("auth/network-request-failed"===d?.code&&c.schedule(!0))}c.schedule()})()}}class uu{constructor(c,d){this.createdAt=c,this.lastLoginAt=d,this._initializeTime()}_initializeTime(){this.lastSignInTime=_t(this.lastLoginAt),this.creationTime=_t(this.createdAt)}_copy(c){this.createdAt=c.createdAt,this.lastLoginAt=c.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function rh(f){return Sv.apply(this,arguments)}function Sv(){return Sv=(0,D.Z)(function*(f){var c;const d=f.auth,p=yield f.getIdToken(),_=yield at(f,function vs(f,c){return je.apply(this,arguments)}(d,{idToken:p}));Q(_?.users.length,d,"internal-error");const v=_.users[0];f._notifyReloadListener(v);const I=null!==(c=v.providerUserInfo)&&void 0!==c&&c.length?function $O(f){return f.map(c=>{var{providerId:d}=c,p=Dt(c,["providerId"]);return{providerId:d,uid:p.rawId||"",displayName:p.displayName||null,email:p.email||null,phoneNumber:p.phoneNumber||null,photoURL:p.photoUrl||null}})}(v.providerUserInfo):[],R=function VI(f,c){return[...f.filter(p=>!c.some(_=>_.providerId===p.providerId)),...c]}(f.providerData,I),ae=!!f.isAnonymous&&!(f.email&&v.passwordHash||R?.length),fe={uid:v.localId,displayName:v.displayName||null,photoURL:v.photoUrl||null,email:v.email||null,emailVerified:v.emailVerified||!1,phoneNumber:v.phoneNumber||null,tenantId:v.tenantId||null,providerData:R,metadata:new uu(v.createdAt,v.lastLoginAt),isAnonymous:ae};Object.assign(f,fe)}),Sv.apply(this,arguments)}function Av(){return(Av=(0,D.Z)(function*(f){const c=(0,j.m9)(f);yield rh(c),yield c.auth._persistUserIfCurrent(c),c.auth._notifyListenersIfCurrent(c)})).apply(this,arguments)}function He(){return(He=(0,D.Z)(function*(f,c){const d=yield Bs(f,{},(0,D.Z)(function*(){const p=(0,j.xO)({grant_type:"refresh_token",refresh_token:c}).slice(1),{tokenApiHost:_,apiKey:v}=f.config,I=po(f,_,"/v1/token",`key=${v}`),R=yield f._getAdditionalHeaders();return R["Content-Type"]="application/x-www-form-urlencoded",Xo.fetch()(I,{method:"POST",headers:R,body:p})}));return{accessToken:d.access_token,expiresIn:d.expires_in,refreshToken:d.refresh_token}})).apply(this,arguments)}function Rv(){return(Rv=(0,D.Z)(function*(f,c){return Ut(f,"POST","/v2/accounts:revokeToken",Gt(f,c))})).apply(this,arguments)}class sh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(c){Q(c.idToken,"internal-error"),Q(typeof c.idToken<"u","internal-error"),Q(typeof c.refreshToken<"u","internal-error");const d="expiresIn"in c&&typeof c.expiresIn<"u"?Number(c.expiresIn):function bt(f){const c=Le(f);return Q(c,"internal-error"),Q(typeof c.exp<"u","internal-error"),Q(typeof c.iat<"u","internal-error"),Number(c.exp)-Number(c.iat)}(c.idToken);this.updateTokensAndExpiration(c.idToken,c.refreshToken,d)}getToken(c,d=!1){var p=this;return(0,D.Z)(function*(){return Q(!p.accessToken||p.refreshToken,c,"user-token-expired"),d||!p.accessToken||p.isExpired?p.refreshToken?(yield p.refresh(c,p.refreshToken),p.accessToken):null:p.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(c,d){var p=this;return(0,D.Z)(function*(){const{accessToken:_,refreshToken:v,expiresIn:I}=yield function Yr(f,c){return He.apply(this,arguments)}(c,d);p.updateTokensAndExpiration(_,v,Number(I))})()}updateTokensAndExpiration(c,d,p){this.refreshToken=d||null,this.accessToken=c||null,this.expirationTime=Date.now()+1e3*p}static fromJSON(c,d){const{refreshToken:p,accessToken:_,expirationTime:v}=d,I=new sh;return p&&(Q("string"==typeof p,"internal-error",{appName:c}),I.refreshToken=p),_&&(Q("string"==typeof _,"internal-error",{appName:c}),I.accessToken=_),v&&(Q("number"==typeof v,"internal-error",{appName:c}),I.expirationTime=v),I}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(c){this.accessToken=c.accessToken,this.refreshToken=c.refreshToken,this.expirationTime=c.expirationTime}_clone(){return Object.assign(new sh,this.toJSON())}_performRefresh(){return Ht("not implemented")}}function oe(f,c){Q("string"==typeof f||typeof f>"u","internal-error",{appName:c})}class jl{constructor(c){var{uid:d,auth:p,stsTokenManager:_}=c,v=Dt(c,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ea(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=d,this.auth=p,this.stsTokenManager=_,this.accessToken=_.accessToken,this.displayName=v.displayName||null,this.email=v.email||null,this.emailVerified=v.emailVerified||!1,this.phoneNumber=v.phoneNumber||null,this.photoURL=v.photoURL||null,this.isAnonymous=v.isAnonymous||!1,this.tenantId=v.tenantId||null,this.providerData=v.providerData?[...v.providerData]:[],this.metadata=new uu(v.createdAt||void 0,v.lastLoginAt||void 0)}getIdToken(c){var d=this;return(0,D.Z)(function*(){const p=yield at(d,d.stsTokenManager.getToken(d.auth,c));return Q(p,d.auth,"internal-error"),d.accessToken!==p&&(d.accessToken=p,yield d.auth._persistUserIfCurrent(d),d.auth._notifyListenersIfCurrent(d)),p})()}getIdTokenResult(c){return function B(f){return ne.apply(this,arguments)}(this,c)}reload(){return function LI(f){return Av.apply(this,arguments)}(this)}_assign(c){this!==c&&(Q(this.uid===c.uid,this.auth,"internal-error"),this.displayName=c.displayName,this.photoURL=c.photoURL,this.email=c.email,this.emailVerified=c.emailVerified,this.phoneNumber=c.phoneNumber,this.isAnonymous=c.isAnonymous,this.tenantId=c.tenantId,this.providerData=c.providerData.map(d=>Object.assign({},d)),this.metadata._copy(c.metadata),this.stsTokenManager._assign(c.stsTokenManager))}_clone(c){const d=new jl(Object.assign(Object.assign({},this),{auth:c,stsTokenManager:this.stsTokenManager._clone()}));return d.metadata._copy(this.metadata),d}_onReload(c){Q(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=c,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(c){this.reloadListener?this.reloadListener(c):this.reloadUserInfo=c}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(c,d=!1){var p=this;return(0,D.Z)(function*(){let _=!1;c.idToken&&c.idToken!==p.stsTokenManager.accessToken&&(p.stsTokenManager.updateFromServerResponse(c),_=!0),d&&(yield rh(p)),yield p.auth._persistUserIfCurrent(p),_&&p.auth._notifyListenersIfCurrent(p)})()}delete(){var c=this;return(0,D.Z)(function*(){const d=yield c.getIdToken();return yield at(c,function ai(f,c){return Ar.apply(this,arguments)}(c.auth,{idToken:d})),c.stsTokenManager.clearRefreshToken(),c.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(c=>Object.assign({},c)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(c,d){var p,_,v,I,R,z,Z,ae;const fe=null!==(p=d.displayName)&&void 0!==p?p:void 0,Je=null!==(_=d.email)&&void 0!==_?_:void 0,Tt=null!==(v=d.phoneNumber)&&void 0!==v?v:void 0,Xi=null!==(I=d.photoURL)&&void 0!==I?I:void 0,rs=null!==(R=d.tenantId)&&void 0!==R?R:void 0,Or=null!==(z=d._redirectEventId)&&void 0!==z?z:void 0,An=null!==(Z=d.createdAt)&&void 0!==Z?Z:void 0,cc=null!==(ae=d.lastLoginAt)&&void 0!==ae?ae:void 0,{uid:Xh,emailVerified:pm,isAnonymous:Q0,providerData:ef,stsTokenManager:J0}=d;Q(Xh&&J0,c,"internal-error");const X0=sh.fromJSON(this.name,J0);Q("string"==typeof Xh,c,"internal-error"),oe(fe,c.name),oe(Je,c.name),Q("boolean"==typeof pm,c,"internal-error"),Q("boolean"==typeof Q0,c,"internal-error"),oe(Tt,c.name),oe(Xi,c.name),oe(rs,c.name),oe(Or,c.name),oe(An,c.name),oe(cc,c.name);const gm=new jl({uid:Xh,auth:c,email:Je,emailVerified:pm,displayName:fe,isAnonymous:Q0,photoURL:Xi,phoneNumber:Tt,tenantId:rs,stsTokenManager:X0,createdAt:An,lastLoginAt:cc});return ef&&Array.isArray(ef)&&(gm.providerData=ef.map(eb=>Object.assign({},eb))),Or&&(gm._redirectEventId=Or),gm}static _fromIdTokenResponse(c,d,p=!1){return(0,D.Z)(function*(){const _=new sh;_.updateFromServerResponse(d);const v=new jl({uid:d.localId,auth:c,stsTokenManager:_,isAnonymous:p});return yield rh(v),v})()}}const ht=new Map;function Oi(f){cn(f instanceof Function,"Expected a class definition");let c=ht.get(f);return c?(cn(c instanceof f,"Instance stored in cache mismatched with class"),c):(c=new f,ht.set(f,c),c)}const Ba=(()=>{class f{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,D.Z)(function*(){return!0})()}_set(d,p){var _=this;return(0,D.Z)(function*(){_.storage[d]=p})()}_get(d){var p=this;return(0,D.Z)(function*(){const _=p.storage[d];return void 0===_?null:_})()}_remove(d){var p=this;return(0,D.Z)(function*(){delete p.storage[d]})()}_addListener(d,p){}_removeListener(d,p){}}return f.type="NONE",f})();function Ua(f,c,d){return`firebase:${f}:${c}:${d}`}class go{constructor(c,d,p){this.persistence=c,this.auth=d,this.userKey=p;const{config:_,name:v}=this.auth;this.fullUserKey=Ua(this.userKey,_.apiKey,v),this.fullPersistenceKey=Ua("persistence",_.apiKey,v),this.boundEventHandler=d._onStorageEvent.bind(d),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(c){return this.persistence._set(this.fullUserKey,c.toJSON())}getCurrentUser(){var c=this;return(0,D.Z)(function*(){const d=yield c.persistence._get(c.fullUserKey);return d?jl._fromJSON(c.auth,d):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(c){var d=this;return(0,D.Z)(function*(){if(d.persistence===c)return;const p=yield d.getCurrentUser();return yield d.removeCurrentUser(),d.persistence=c,p?d.setCurrentUser(p):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(c,d,p="authUser"){return(0,D.Z)(function*(){if(!d.length)return new go(Oi(Ba),c,p);const _=(yield Promise.all(d.map(function(){var Z=(0,D.Z)(function*(ae){if(yield ae._isAvailable())return ae});return function(ae){return Z.apply(this,arguments)}}()))).filter(Z=>Z);let v=_[0]||Oi(Ba);const I=Ua(p,c.config.apiKey,c.name);let R=null;for(const Z of d)try{const ae=yield Z._get(I);if(ae){const fe=jl._fromJSON(c,ae);Z!==v&&(R=fe),v=Z;break}}catch{}const z=_.filter(Z=>Z._shouldAllowMigration);return v._shouldAllowMigration&&z.length?(v=z[0],R&&(yield v._set(I,R.toJSON())),yield Promise.all(d.map(function(){var Z=(0,D.Z)(function*(ae){if(ae!==v)try{yield ae._remove(I)}catch{}});return function(ae){return Z.apply(this,arguments)}}())),new go(v,c,p)):new go(v,c,p)})()}}function du(f){const c=f.toLowerCase();if(c.includes("opera/")||c.includes("opr/")||c.includes("opios/"))return"Opera";if(ft(c))return"IEMobile";if(c.includes("msie")||c.includes("trident/"))return"IE";if(c.includes("edge/"))return"Edge";if(oh(c))return"Firefox";if(c.includes("silk/"))return"Silk";if(pg(c))return"Blackberry";if(qi(c))return"Webos";if(ah(c))return"Safari";if((c.includes("chrome/")||Nv(c))&&!c.includes("edge/"))return"Chrome";if(ja(c))return"Android";{const p=f.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===p?.length)return p[1]}return"Other"}function oh(f=(0,j.z$)()){return/firefox\//i.test(f)}function ah(f=(0,j.z$)()){const c=f.toLowerCase();return c.includes("safari/")&&!c.includes("chrome/")&&!c.includes("crios/")&&!c.includes("android")}function Nv(f=(0,j.z$)()){return/crios\//i.test(f)}function ft(f=(0,j.z$)()){return/iemobile/i.test(f)}function ja(f=(0,j.z$)()){return/android/i.test(f)}function pg(f=(0,j.z$)()){return/blackberry/i.test(f)}function qi(f=(0,j.z$)()){return/webos/i.test(f)}function $a(f=(0,j.z$)()){return/iphone|ipad|ipod/i.test(f)||/macintosh/i.test(f)&&/mobile/i.test(f)}function BI(f=(0,j.z$)()){return $a(f)||ja(f)||qi(f)||pg(f)||/windows phone/i.test(f)||ft(f)}function lh(f,c=[]){let d;switch(f){case"Browser":d=du((0,j.z$)());break;case"Worker":d=`${du((0,j.z$)())}-${f}`;break;default:d=f}const p=c.length?c.join(","):"FirebaseCore-web";return`${d}/JsCore/${ze.SDK_VERSION}/${p}`}class gg{constructor(c){this.auth=c,this.queue=[]}pushCallback(c,d){const p=v=>new Promise((I,R)=>{try{I(c(v))}catch(z){R(z)}});p.onAbort=d,this.queue.push(p);const _=this.queue.length-1;return()=>{this.queue[_]=()=>Promise.resolve()}}runMiddleware(c){var d=this;return(0,D.Z)(function*(){if(d.auth.currentUser===c)return;const p=[];try{for(const _ of d.queue)yield _(c),_.onAbort&&p.push(_.onAbort)}catch(_){p.reverse();for(const v of p)try{v()}catch{}throw d.auth._errorFactory.create("login-blocked",{originalMessage:_?.message})}})()}}function hu(){return(hu=(0,D.Z)(function*(f,c={}){return Ut(f,"GET","/v2/passwordPolicy",Gt(f,c))})).apply(this,arguments)}class mg{constructor(c){var d,p,_,v;const I=c.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(d=I.minPasswordLength)&&void 0!==d?d:6,I.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=I.maxPasswordLength),void 0!==I.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=I.containsLowercaseCharacter),void 0!==I.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=I.containsUppercaseCharacter),void 0!==I.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=I.containsNumericCharacter),void 0!==I.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=I.containsNonAlphanumericCharacter),this.enforcementState=c.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(_=null===(p=c.allowedNonAlphanumericCharacters)||void 0===p?void 0:p.join(""))&&void 0!==_?_:"",this.forceUpgradeOnSignin=null!==(v=c.forceUpgradeOnSignin)&&void 0!==v&&v,this.schemaVersion=c.schemaVersion}validatePassword(c){var d,p,_,v,I,R;const z={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(c,z),this.validatePasswordCharacterOptions(c,z),z.isValid&&(z.isValid=null===(d=z.meetsMinPasswordLength)||void 0===d||d),z.isValid&&(z.isValid=null===(p=z.meetsMaxPasswordLength)||void 0===p||p),z.isValid&&(z.isValid=null===(_=z.containsLowercaseLetter)||void 0===_||_),z.isValid&&(z.isValid=null===(v=z.containsUppercaseLetter)||void 0===v||v),z.isValid&&(z.isValid=null===(I=z.containsNumericCharacter)||void 0===I||I),z.isValid&&(z.isValid=null===(R=z.containsNonAlphanumericCharacter)||void 0===R||R),z}validatePasswordLengthOptions(c,d){const p=this.customStrengthOptions.minPasswordLength,_=this.customStrengthOptions.maxPasswordLength;p&&(d.meetsMinPasswordLength=c.length>=p),_&&(d.meetsMaxPasswordLength=c.length<=_)}validatePasswordCharacterOptions(c,d){let p;this.updatePasswordCharacterOptionsStatuses(d,!1,!1,!1,!1);for(let _=0;_<c.length;_++)p=c.charAt(_),this.updatePasswordCharacterOptionsStatuses(d,p>="a"&&p<="z",p>="A"&&p<="Z",p>="0"&&p<="9",this.allowedNonAlphanumericCharacters.includes(p))}updatePasswordCharacterOptionsStatuses(c,d,p,_,v){this.customStrengthOptions.containsLowercaseLetter&&(c.containsLowercaseLetter||(c.containsLowercaseLetter=d)),this.customStrengthOptions.containsUppercaseLetter&&(c.containsUppercaseLetter||(c.containsUppercaseLetter=p)),this.customStrengthOptions.containsNumericCharacter&&(c.containsNumericCharacter||(c.containsNumericCharacter=_)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(c.containsNonAlphanumericCharacter||(c.containsNonAlphanumericCharacter=v))}}class qO{constructor(c,d,p,_){this.app=c,this.heartbeatServiceProvider=d,this.appCheckServiceProvider=p,this.config=_,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jI(this),this.idTokenSubscription=new jI(this),this.beforeStateQueue=new gg(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=N,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=c.name,this.clientVersion=_.sdkClientVersion}_initializeWithPersistence(c,d){var p=this;return d&&(this._popupRedirectResolver=Oi(d)),this._initializationPromise=this.queue((0,D.Z)(function*(){var _,v;if(!p._deleted&&(p.persistenceManager=yield go.create(p,c),!p._deleted)){if(null!==(_=p._popupRedirectResolver)&&void 0!==_&&_._shouldInitProactively)try{yield p._popupRedirectResolver._initialize(p)}catch{}yield p.initializeCurrentUser(d),p.lastNotifiedUid=(null===(v=p.currentUser)||void 0===v?void 0:v.uid)||null,!p._deleted&&(p._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var c=this;return(0,D.Z)(function*(){if(c._deleted)return;const d=yield c.assertedPersistence.getCurrentUser();if(c.currentUser||d){if(c.currentUser&&d&&c.currentUser.uid===d.uid)return c._currentUser._assign(d),void(yield c.currentUser.getIdToken());yield c._updateCurrentUser(d,!0)}})()}initializeCurrentUser(c){var d=this;return(0,D.Z)(function*(){var p;const _=yield d.assertedPersistence.getCurrentUser();let v=_,I=!1;if(c&&d.config.authDomain){yield d.getOrInitRedirectPersistenceManager();const R=null===(p=d.redirectUser)||void 0===p?void 0:p._redirectEventId,z=v?._redirectEventId,Z=yield d.tryRedirectSignIn(c);(!R||R===z)&&Z?.user&&(v=Z.user,I=!0)}if(!v)return d.directlySetCurrentUser(null);if(!v._redirectEventId){if(I)try{yield d.beforeStateQueue.runMiddleware(v)}catch(R){v=_,d._popupRedirectResolver._overrideRedirectResult(d,()=>Promise.reject(R))}return v?d.reloadAndSetCurrentUserOrClear(v):d.directlySetCurrentUser(null)}return Q(d._popupRedirectResolver,d,"argument-error"),yield d.getOrInitRedirectPersistenceManager(),d.redirectUser&&d.redirectUser._redirectEventId===v._redirectEventId?d.directlySetCurrentUser(v):d.reloadAndSetCurrentUserOrClear(v)})()}tryRedirectSignIn(c){var d=this;return(0,D.Z)(function*(){let p=null;try{p=yield d._popupRedirectResolver._completeRedirectFn(d,c,!0)}catch{yield d._setRedirectUser(null)}return p})()}reloadAndSetCurrentUserOrClear(c){var d=this;return(0,D.Z)(function*(){try{yield rh(c)}catch(p){if("auth/network-request-failed"!==p?.code)return d.directlySetCurrentUser(null)}return d.directlySetCurrentUser(c)})()}useDeviceLanguage(){this.languageCode=function pr(){if(typeof navigator>"u")return null;const f=navigator;return f.languages&&f.languages[0]||f.language||null}()}_delete(){var c=this;return(0,D.Z)(function*(){c._deleted=!0})()}updateCurrentUser(c){var d=this;return(0,D.Z)(function*(){const p=c?(0,j.m9)(c):null;return p&&Q(p.auth.config.apiKey===d.config.apiKey,d,"invalid-user-token"),d._updateCurrentUser(p&&p._clone(d))})()}_updateCurrentUser(c,d=!1){var p=this;return(0,D.Z)(function*(){if(!p._deleted)return c&&Q(p.tenantId===c.tenantId,p,"tenant-id-mismatch"),d||(yield p.beforeStateQueue.runMiddleware(c)),p.queue((0,D.Z)(function*(){yield p.directlySetCurrentUser(c),p.notifyAuthListeners()}))})()}signOut(){var c=this;return(0,D.Z)(function*(){return yield c.beforeStateQueue.runMiddleware(null),(c.redirectPersistenceManager||c._popupRedirectResolver)&&(yield c._setRedirectUser(null)),c._updateCurrentUser(null,!0)})()}setPersistence(c){var d=this;return this.queue((0,D.Z)(function*(){yield d.assertedPersistence.setPersistence(Oi(c))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(c){var d=this;return(0,D.Z)(function*(){d._getPasswordPolicyInternal()||(yield d._updatePasswordPolicy());const p=d._getPasswordPolicyInternal();return p.schemaVersion!==d.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(d._errorFactory.create("unsupported-password-policy-schema-version",{})):p.validatePassword(c)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var c=this;return(0,D.Z)(function*(){const d=yield function xv(f){return hu.apply(this,arguments)}(c),p=new mg(d);null===c.tenantId?c._projectPasswordPolicy=p:c._tenantPasswordPolicies[c.tenantId]=p})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(c){this._errorFactory=new j.LL("auth","Firebase",c())}onAuthStateChanged(c,d,p){return this.registerStateListener(this.authStateSubscription,c,d,p)}beforeAuthStateChanged(c,d){return this.beforeStateQueue.pushCallback(c,d)}onIdTokenChanged(c,d,p){return this.registerStateListener(this.idTokenSubscription,c,d,p)}authStateReady(){return new Promise((c,d)=>{if(this.currentUser)c();else{const p=this.onAuthStateChanged(()=>{p(),c()},d)}})}revokeAccessToken(c){var d=this;return(0,D.Z)(function*(){if(d.currentUser){const p=yield d.currentUser.getIdToken(),_={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:c,idToken:p};null!=d.tenantId&&(_.tenantId=d.tenantId),yield function HO(f,c){return Rv.apply(this,arguments)}(d,_)}})()}toJSON(){var c;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(c=this._currentUser)||void 0===c?void 0:c.toJSON()}}_setRedirectUser(c,d){var p=this;return(0,D.Z)(function*(){const _=yield p.getOrInitRedirectPersistenceManager(d);return null===c?_.removeCurrentUser():_.setCurrentUser(c)})()}getOrInitRedirectPersistenceManager(c){var d=this;return(0,D.Z)(function*(){if(!d.redirectPersistenceManager){const p=c&&Oi(c)||d._popupRedirectResolver;Q(p,d,"argument-error"),d.redirectPersistenceManager=yield go.create(d,[Oi(p._redirectPersistence)],"redirectUser"),d.redirectUser=yield d.redirectPersistenceManager.getCurrentUser()}return d.redirectPersistenceManager})()}_redirectUserForId(c){var d=this;return(0,D.Z)(function*(){var p,_;return d._isInitialized&&(yield d.queue((0,D.Z)(function*(){}))),(null===(p=d._currentUser)||void 0===p?void 0:p._redirectEventId)===c?d._currentUser:(null===(_=d.redirectUser)||void 0===_?void 0:_._redirectEventId)===c?d.redirectUser:null})()}_persistUserIfCurrent(c){var d=this;return(0,D.Z)(function*(){if(c===d.currentUser)return d.queue((0,D.Z)(function*(){return d.directlySetCurrentUser(c)}))})()}_notifyListenersIfCurrent(c){c===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var c,d;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const p=null!==(d=null===(c=this.currentUser)||void 0===c?void 0:c.uid)&&void 0!==d?d:null;this.lastNotifiedUid!==p&&(this.lastNotifiedUid=p,this.authStateSubscription.next(this.currentUser))}registerStateListener(c,d,p,_){if(this._deleted)return()=>{};const v="function"==typeof d?d:d.next.bind(d);let I=!1;const R=this._isInitialized?Promise.resolve():this._initializationPromise;if(Q(R,this,"internal-error"),R.then(()=>{I||v(this.currentUser)}),"function"==typeof d){const z=c.addObserver(d,p,_);return()=>{I=!0,z()}}{const z=c.addObserver(d);return()=>{I=!0,z()}}}directlySetCurrentUser(c){var d=this;return(0,D.Z)(function*(){d.currentUser&&d.currentUser!==c&&d._currentUser._stopProactiveRefresh(),c&&d.isProactiveRefreshEnabled&&c._startProactiveRefresh(),d.currentUser=c,c?yield d.assertedPersistence.setCurrentUser(c):yield d.assertedPersistence.removeCurrentUser()})()}queue(c){return this.operations=this.operations.then(c,c),this.operations}get assertedPersistence(){return Q(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(c){!c||this.frameworks.includes(c)||(this.frameworks.push(c),this.frameworks.sort(),this.clientVersion=lh(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var c=this;return(0,D.Z)(function*(){var d;const p={"X-Client-Version":c.clientVersion};c.app.options.appId&&(p["X-Firebase-gmpid"]=c.app.options.appId);const _=yield null===(d=c.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===d?void 0:d.getHeartbeatsHeader();_&&(p["X-Firebase-Client"]=_);const v=yield c._getAppCheckToken();return v&&(p["X-Firebase-AppCheck"]=v),p})()}_getAppCheckToken(){var c=this;return(0,D.Z)(function*(){var d;const p=yield null===(d=c.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===d?void 0:d.getToken();return p?.error&&function X(f,...c){H.logLevel<=rn.in.WARN&&H.warn(`Auth (${ze.SDK_VERSION}): ${f}`,...c)}(`Error while retrieving App Check token: ${p.error}`),p?.token})()}}function mn(f){return(0,j.m9)(f)}class jI{constructor(c){this.auth=c,this.observer=null,this.addObserver=(0,j.ne)(d=>this.observer=d)}get next(){return Q(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Pv(f){return new Promise((c,d)=>{const p=document.createElement("script");p.setAttribute("src",f),p.onload=c,p.onerror=_=>{const v=Ue("internal-error");v.customData=_,d(v)},p.type="text/javascript",p.charset="UTF-8",function KO(){var f,c;return null!==(c=null===(f=document.getElementsByTagName("head"))||void 0===f?void 0:f[0])&&void 0!==c?c:document}().appendChild(p)})}function $l(f){return`__${f}${Math.floor(1e6*Math.random())}`}class Ov{constructor(c){this.type="recaptcha-enterprise",this.auth=mn(c)}verify(c="verify",d=!1){var p=this;return(0,D.Z)(function*(){function v(){return v=(0,D.Z)(function*(R){if(!d){if(null==R.tenantId&&null!=R._agentRecaptchaConfig)return R._agentRecaptchaConfig.siteKey;if(null!=R.tenantId&&void 0!==R._tenantRecaptchaConfigs[R.tenantId])return R._tenantRecaptchaConfigs[R.tenantId].siteKey}return new Promise(function(){var z=(0,D.Z)(function*(Z,ae){Ie(R,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(fe=>{if(void 0!==fe.recaptchaKey){const Je=new V(fe);return null==R.tenantId?R._agentRecaptchaConfig=Je:R._tenantRecaptchaConfigs[R.tenantId]=Je,Z(Je.siteKey)}ae(new Error("recaptcha Enterprise site key undefined"))}).catch(fe=>{ae(fe)})});return function(Z,ae){return z.apply(this,arguments)}}())}),v.apply(this,arguments)}function I(R,z,Z){const ae=window.grecaptcha;G(ae)?ae.enterprise.ready(()=>{ae.enterprise.execute(R,{action:c}).then(fe=>{z(fe)}).catch(()=>{z("NO_RECAPTCHA")})}):Z(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((R,z)=>{(function _(R){return v.apply(this,arguments)})(p.auth).then(Z=>{if(!d&&G(window.grecaptcha))I(Z,R,z);else{if(typeof window>"u")return void z(new Error("RecaptchaVerifier is only supported in browser"));Pv("https://www.google.com/recaptcha/enterprise.js?render="+Z).then(()=>{I(Z,R,z)}).catch(ae=>{z(ae)})}}).catch(Z=>{z(Z)})})})()}}function Mv(f,c,d){return uh.apply(this,arguments)}function uh(){return(uh=(0,D.Z)(function*(f,c,d,p=!1){const _=new Ov(f);let v;try{v=yield _.verify(d)}catch{v=yield _.verify(d,!0)}const I=Object.assign({},c);return Object.assign(I,p?{captchaResp:v}:{captchaResponse:v}),Object.assign(I,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(I,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),I})).apply(this,arguments)}function Us(f,c,d,p){return yg.apply(this,arguments)}function yg(){return yg=(0,D.Z)(function*(f,c,d,p){var _;if(null!==(_=f._getRecaptchaConfig())&&void 0!==_&&_.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const v=yield Mv(f,c,d,"getOobCode"===d);return p(f,v)}return p(f,c).catch(function(){var v=(0,D.Z)(function*(I){if("auth/missing-recaptcha-token"===I.code){console.log(`${d} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const R=yield Mv(f,c,d,"getOobCode"===d);return p(f,R)}return Promise.reject(I)});return function(I){return v.apply(this,arguments)}}())}),yg.apply(this,arguments)}function fu(f){const c=f.indexOf(":");return c<0?"":f.substr(0,c+1)}function Hl(f){if(!f)return null;const c=Number(f);return isNaN(c)?null:c}class Gl{constructor(c,d){this.providerId=c,this.signInMethod=d}toJSON(){return Ht("not implemented")}_getIdTokenResponse(c){return Ht("not implemented")}_linkToIdToken(c,d){return Ht("not implemented")}_getReauthenticationResolver(c){return Ht("not implemented")}}function Fv(f,c){return bs.apply(this,arguments)}function bs(){return(bs=(0,D.Z)(function*(f,c){return Ut(f,"POST","/v1/accounts:resetPassword",Gt(f,c))})).apply(this,arguments)}function Rr(){return(Rr=(0,D.Z)(function*(f,c){return Ut(f,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function js(f,c){return At.apply(this,arguments)}function At(){return(At=(0,D.Z)(function*(f,c){return Ut(f,"POST","/v1/accounts:signUp",c)})).apply(this,arguments)}function pu(){return(pu=(0,D.Z)(function*(f,c){return Ut(f,"POST","/v1/accounts:update",Gt(f,c))})).apply(this,arguments)}function Eg(f,c){return fh.apply(this,arguments)}function fh(){return(fh=(0,D.Z)(function*(f,c){return Zr(f,"POST","/v1/accounts:signInWithPassword",Gt(f,c))})).apply(this,arguments)}function Qr(f,c){return Ha.apply(this,arguments)}function Ha(){return(Ha=(0,D.Z)(function*(f,c){return Ut(f,"POST","/v1/accounts:sendOobCode",Gt(f,c))})).apply(this,arguments)}function ph(){return(ph=(0,D.Z)(function*(f,c){return Qr(f,c)})).apply(this,arguments)}function wg(f,c){return gh.apply(this,arguments)}function gh(){return(gh=(0,D.Z)(function*(f,c){return Qr(f,c)})).apply(this,arguments)}function Vv(f,c){return Ga.apply(this,arguments)}function Ga(){return(Ga=(0,D.Z)(function*(f,c){return Qr(f,c)})).apply(this,arguments)}function mh(){return(mh=(0,D.Z)(function*(f,c){return Qr(f,c)})).apply(this,arguments)}function _h(){return(_h=(0,D.Z)(function*(f,c){return Zr(f,"POST","/v1/accounts:signInWithEmailLink",Gt(f,c))})).apply(this,arguments)}function Tg(){return(Tg=(0,D.Z)(function*(f,c){return Zr(f,"POST","/v1/accounts:signInWithEmailLink",Gt(f,c))})).apply(this,arguments)}class Ki extends Gl{constructor(c,d,p,_=null){super("password",p),this._email=c,this._password=d,this._tenantId=_}static _fromEmailAndPassword(c,d){return new Ki(c,d,"password")}static _fromEmailAndCode(c,d,p=null){return new Ki(c,d,"emailLink",p)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(c){const d="string"==typeof c?JSON.parse(c):c;if(d?.email&&d?.password){if("password"===d.signInMethod)return this._fromEmailAndPassword(d.email,d.password);if("emailLink"===d.signInMethod)return this._fromEmailAndCode(d.email,d.password,d.tenantId)}return null}_getIdTokenResponse(c){var d=this;return(0,D.Z)(function*(){switch(d.signInMethod){case"password":return Us(c,{returnSecureToken:!0,email:d._email,password:d._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Eg);case"emailLink":return function GI(f,c){return _h.apply(this,arguments)}(c,{email:d._email,oobCode:d._password});default:se(c,"internal-error")}})()}_linkToIdToken(c,d){var p=this;return(0,D.Z)(function*(){switch(p.signInMethod){case"password":return Us(c,{idToken:d,returnSecureToken:!0,email:p._email,password:p._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",js);case"emailLink":return function zI(f,c){return Tg.apply(this,arguments)}(c,{idToken:d,email:p._email,oobCode:p._password});default:se(c,"internal-error")}})()}_getReauthenticationResolver(c){return this._getIdTokenResponse(c)}}function mo(f,c){return yh.apply(this,arguments)}function yh(){return(yh=(0,D.Z)(function*(f,c){return Zr(f,"POST","/v1/accounts:signInWithIdp",Gt(f,c))})).apply(this,arguments)}class $s extends Gl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(c){const d=new $s(c.providerId,c.signInMethod);return c.idToken||c.accessToken?(c.idToken&&(d.idToken=c.idToken),c.accessToken&&(d.accessToken=c.accessToken),c.nonce&&!c.pendingToken&&(d.nonce=c.nonce),c.pendingToken&&(d.pendingToken=c.pendingToken)):c.oauthToken&&c.oauthTokenSecret?(d.accessToken=c.oauthToken,d.secret=c.oauthTokenSecret):se("argument-error"),d}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(c){const d="string"==typeof c?JSON.parse(c):c,{providerId:p,signInMethod:_}=d,v=Dt(d,["providerId","signInMethod"]);if(!p||!_)return null;const I=new $s(p,_);return I.idToken=v.idToken||void 0,I.accessToken=v.accessToken||void 0,I.secret=v.secret,I.nonce=v.nonce,I.pendingToken=v.pendingToken||null,I}_getIdTokenResponse(c){return mo(c,this.buildRequest())}_linkToIdToken(c,d){const p=this.buildRequest();return p.idToken=d,mo(c,p)}_getReauthenticationResolver(c){const d=this.buildRequest();return d.autoCreate=!1,mo(c,d)}buildRequest(){const c={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)c.pendingToken=this.pendingToken;else{const d={};this.idToken&&(d.id_token=this.idToken),this.accessToken&&(d.access_token=this.accessToken),this.secret&&(d.oauth_token_secret=this.secret),d.providerId=this.providerId,this.nonce&&!this.pendingToken&&(d.nonce=this.nonce),c.postBody=(0,j.xO)(d)}return c}}function Ig(){return(Ig=(0,D.Z)(function*(f,c){return Ut(f,"POST","/v1/accounts:sendVerificationCode",Gt(f,c))})).apply(this,arguments)}function Cg(){return(Cg=(0,D.Z)(function*(f,c){return Zr(f,"POST","/v1/accounts:signInWithPhoneNumber",Gt(f,c))})).apply(this,arguments)}function Dg(){return(Dg=(0,D.Z)(function*(f,c){const d=yield Zr(f,"POST","/v1/accounts:signInWithPhoneNumber",Gt(f,c));if(d.temporaryProof)throw C(f,"account-exists-with-different-credential",d);return d})).apply(this,arguments)}const gr={USER_NOT_FOUND:"user-not-found"};function Sg(){return(Sg=(0,D.Z)(function*(f,c){return Zr(f,"POST","/v1/accounts:signInWithPhoneNumber",Gt(f,Object.assign(Object.assign({},c),{operation:"REAUTH"})),gr)})).apply(this,arguments)}class za extends Gl{constructor(c){super("phone","phone"),this.params=c}static _fromVerification(c,d){return new za({verificationId:c,verificationCode:d})}static _fromTokenResponse(c,d){return new za({phoneNumber:c,temporaryProof:d})}_getIdTokenResponse(c){return function Uv(f,c){return Cg.apply(this,arguments)}(c,this._makeVerificationRequest())}_linkToIdToken(c,d){return function KI(f,c){return Dg.apply(this,arguments)}(c,Object.assign({idToken:d},this._makeVerificationRequest()))}_getReauthenticationResolver(c){return function ZI(f,c){return Sg.apply(this,arguments)}(c,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:c,phoneNumber:d,verificationId:p,verificationCode:_}=this.params;return c&&d?{temporaryProof:c,phoneNumber:d}:{sessionInfo:p,code:_}}toJSON(){const c={providerId:this.providerId};return this.params.phoneNumber&&(c.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(c.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(c.verificationCode=this.params.verificationCode),this.params.verificationId&&(c.verificationId=this.params.verificationId),c}static fromJSON(c){"string"==typeof c&&(c=JSON.parse(c));const{verificationId:d,verificationCode:p,phoneNumber:_,temporaryProof:v}=c;return p||d||_||v?new za({verificationId:d,verificationCode:p,phoneNumber:_,temporaryProof:v}):null}}class zl{constructor(c){var d,p,_,v,I,R;const z=(0,j.zd)((0,j.pd)(c)),Z=null!==(d=z.apiKey)&&void 0!==d?d:null,ae=null!==(p=z.oobCode)&&void 0!==p?p:null,fe=function yt(f){switch(f){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(_=z.mode)&&void 0!==_?_:null);Q(Z&&ae&&fe,"argument-error"),this.apiKey=Z,this.operation=fe,this.code=ae,this.continueUrl=null!==(v=z.continueUrl)&&void 0!==v?v:null,this.languageCode=null!==(I=z.languageCode)&&void 0!==I?I:null,this.tenantId=null!==(R=z.tenantId)&&void 0!==R?R:null}static parseLink(c){const d=function YI(f){const c=(0,j.zd)((0,j.pd)(f)).link,d=c?(0,j.zd)((0,j.pd)(c)).deep_link_id:null,p=(0,j.zd)((0,j.pd)(f)).deep_link_id;return(p?(0,j.zd)((0,j.pd)(p)).link:null)||p||d||c||f}(c);try{return new zl(d)}catch{return null}}}let Mi=(()=>{class f{constructor(){this.providerId=f.PROVIDER_ID}static credential(d,p){return Ki._fromEmailAndPassword(d,p)}static credentialWithLink(d,p){const _=zl.parseLink(p);return Q(_,"argument-error"),Ki._fromEmailAndCode(d,_.code,_.tenantId)}}return f.PROVIDER_ID="password",f.EMAIL_PASSWORD_SIGN_IN_METHOD="password",f.EMAIL_LINK_SIGN_IN_METHOD="emailLink",f})();class nt{constructor(c){this.providerId=c,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(c){this.defaultLanguageCode=c}setCustomParameters(c){return this.customParameters=c,this}getCustomParameters(){return this.customParameters}}class Mn extends nt{constructor(){super(...arguments),this.scopes=[]}addScope(c){return this.scopes.includes(c)||this.scopes.push(c),this}getScopes(){return[...this.scopes]}}class Jn extends Mn{static credentialFromJSON(c){const d="string"==typeof c?JSON.parse(c):c;return Q("providerId"in d&&"signInMethod"in d,"argument-error"),$s._fromParams(d)}credential(c){return this._credential(Object.assign(Object.assign({},c),{nonce:c.rawNonce}))}_credential(c){return Q(c.idToken||c.accessToken,"argument-error"),$s._fromParams(Object.assign(Object.assign({},c),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(c){return Jn.oauthCredentialFromTaggedObject(c)}static credentialFromError(c){return Jn.oauthCredentialFromTaggedObject(c.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{oauthIdToken:d,oauthAccessToken:p,oauthTokenSecret:_,pendingToken:v,nonce:I,providerId:R}=c;if(!p&&!_&&!d&&!v||!R)return null;try{return new Jn(R)._credential({idToken:d,accessToken:p,nonce:I,pendingToken:v})}catch{return null}}}let Wa=(()=>{class f extends Mn{constructor(){super("facebook.com")}static credential(d){return $s._fromParams({providerId:f.PROVIDER_ID,signInMethod:f.FACEBOOK_SIGN_IN_METHOD,accessToken:d})}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d||!("oauthAccessToken"in d)||!d.oauthAccessToken)return null;try{return f.credential(d.oauthAccessToken)}catch{return null}}}return f.FACEBOOK_SIGN_IN_METHOD="facebook.com",f.PROVIDER_ID="facebook.com",f})(),mr=(()=>{class f extends Mn{constructor(){super("google.com"),this.addScope("profile")}static credential(d,p){return $s._fromParams({providerId:f.PROVIDER_ID,signInMethod:f.GOOGLE_SIGN_IN_METHOD,idToken:d,accessToken:p})}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d)return null;const{oauthIdToken:p,oauthAccessToken:_}=d;if(!p&&!_)return null;try{return f.credential(p,_)}catch{return null}}}return f.GOOGLE_SIGN_IN_METHOD="google.com",f.PROVIDER_ID="google.com",f})(),Ag=(()=>{class f extends Mn{constructor(){super("github.com")}static credential(d){return $s._fromParams({providerId:f.PROVIDER_ID,signInMethod:f.GITHUB_SIGN_IN_METHOD,accessToken:d})}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d||!("oauthAccessToken"in d)||!d.oauthAccessToken)return null;try{return f.credential(d.oauthAccessToken)}catch{return null}}}return f.GITHUB_SIGN_IN_METHOD="github.com",f.PROVIDER_ID="github.com",f})();class _o extends Gl{constructor(c,d){super(c,c),this.pendingToken=d}_getIdTokenResponse(c){return mo(c,this.buildRequest())}_linkToIdToken(c,d){const p=this.buildRequest();return p.idToken=d,mo(c,p)}_getReauthenticationResolver(c){const d=this.buildRequest();return d.autoCreate=!1,mo(c,d)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(c){const d="string"==typeof c?JSON.parse(c):c,{providerId:p,signInMethod:_,pendingToken:v}=d;return p&&_&&v&&p===_?new _o(p,v):null}static _create(c,d){return new _o(c,d)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class vh extends nt{constructor(c){Q(c.startsWith("saml."),"argument-error"),super(c)}static credentialFromResult(c){return vh.samlCredentialFromTaggedObject(c)}static credentialFromError(c){return vh.samlCredentialFromTaggedObject(c.customData||{})}static credentialFromJSON(c){const d=_o.fromJSON(c);return Q(d,"argument-error"),d}static samlCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{pendingToken:d,providerId:p}=c;if(!d||!p)return null;try{return _o._create(p,d)}catch{return null}}}let Cn=(()=>{class f extends Mn{constructor(){super("twitter.com")}static credential(d,p){return $s._fromParams({providerId:f.PROVIDER_ID,signInMethod:f.TWITTER_SIGN_IN_METHOD,oauthToken:d,oauthTokenSecret:p})}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d)return null;const{oauthAccessToken:p,oauthTokenSecret:_}=d;if(!p||!_)return null;try{return f.credential(p,_)}catch{return null}}}return f.TWITTER_SIGN_IN_METHOD="twitter.com",f.PROVIDER_ID="twitter.com",f})();function Te(f,c){return Ke.apply(this,arguments)}function Ke(){return(Ke=(0,D.Z)(function*(f,c){return Zr(f,"POST","/v1/accounts:signUp",Gt(f,c))})).apply(this,arguments)}class Et{constructor(c){this.user=c.user,this.providerId=c.providerId,this._tokenResponse=c._tokenResponse,this.operationType=c.operationType}static _fromIdTokenResponse(c,d,p,_=!1){return(0,D.Z)(function*(){const v=yield jl._fromIdTokenResponse(c,p,_),I=Jr(p);return new Et({user:v,providerId:I,_tokenResponse:p,operationType:d})})()}static _forOperation(c,d,p){return(0,D.Z)(function*(){yield c._updateTokensIfNecessary(p,!0);const _=Jr(p);return new Et({user:c,providerId:_,_tokenResponse:p,operationType:d})})()}}function Jr(f){return f.providerId?f.providerId:"phoneNumber"in f?"phone":null}function pi(){return(pi=(0,D.Z)(function*(f){var c;const d=mn(f);if(yield d._initializationPromise,null!==(c=d.currentUser)&&void 0!==c&&c.isAnonymous)return new Et({user:d.currentUser,providerId:null,operationType:"signIn"});const p=yield Te(d,{returnSecureToken:!0}),_=yield Et._fromIdTokenResponse(d,"signIn",p,!0);return yield d._updateCurrentUser(_.user),_})).apply(this,arguments)}class yo extends j.ZR{constructor(c,d,p,_){var v;super(d.code,d.message),this.operationType=p,this.user=_,Object.setPrototypeOf(this,yo.prototype),this.customData={appName:c.name,tenantId:null!==(v=c.tenantId)&&void 0!==v?v:void 0,_serverResponse:d.customData._serverResponse,operationType:p}}static _fromErrorAndOperation(c,d,p,_){return new yo(c,d,p,_)}}function kn(f,c,d,p){return("reauthenticate"===c?d._getReauthenticationResolver(f):d._getIdTokenResponse(f)).catch(v=>{throw"auth/multi-factor-auth-required"===v.code?yo._fromErrorAndOperation(f,v,c,p):v})}function vo(f){return new Set(f.map(({providerId:c})=>c).filter(c=>!!c))}function qe(){return qe=(0,D.Z)(function*(f,c){const d=(0,j.m9)(f);yield bo(!0,d,c);const{providerUserInfo:p}=yield function St(f,c){return J.apply(this,arguments)}(d.auth,{idToken:yield d.getIdToken(),deleteProvider:[c]}),_=vo(p||[]);return d.providerData=d.providerData.filter(v=>_.has(v.providerId)),_.has("phone")||(d.phoneNumber=null),yield d.auth._persistUserIfCurrent(d),d}),qe.apply(this,arguments)}function qa(f,c){return bh.apply(this,arguments)}function bh(){return(bh=(0,D.Z)(function*(f,c,d=!1){const p=yield at(f,c._linkToIdToken(f.auth,yield f.getIdToken()),d);return Et._forOperation(f,"link",p)})).apply(this,arguments)}function bo(f,c,d){return Dn.apply(this,arguments)}function Dn(){return(Dn=(0,D.Z)(function*(f,c,d){yield rh(c);const _=!1===f?"provider-already-linked":"no-such-provider";Q(vo(c.providerData).has(d)===f,c.auth,_)})).apply(this,arguments)}function ql(f,c){return na.apply(this,arguments)}function na(){return(na=(0,D.Z)(function*(f,c,d=!1){const{auth:p}=f,_="reauthenticate";try{const v=yield at(f,kn(p,_,c,f),d);Q(v.idToken,p,"internal-error");const I=Le(v.idToken);Q(I,p,"internal-error");const{sub:R}=I;return Q(f.uid===R,p,"user-mismatch"),Et._forOperation(f,_,v)}catch(v){throw"auth/user-not-found"===v?.code&&se(p,"user-mismatch"),v}})).apply(this,arguments)}function Es(f,c){return Ka.apply(this,arguments)}function Ka(){return(Ka=(0,D.Z)(function*(f,c,d=!1){const p="signIn",_=yield kn(f,p,c),v=yield Et._fromIdTokenResponse(f,p,_);return d||(yield f._updateCurrentUser(v.user)),v})).apply(this,arguments)}function mu(f,c){return Hs.apply(this,arguments)}function Hs(){return(Hs=(0,D.Z)(function*(f,c){return Es(mn(f),c)})).apply(this,arguments)}function Gs(f,c){return Za.apply(this,arguments)}function Za(){return(Za=(0,D.Z)(function*(f,c){const d=(0,j.m9)(f);return yield bo(!1,d,c.providerId),qa(d,c)})).apply(this,arguments)}function Kl(f,c){return dt.apply(this,arguments)}function dt(){return(dt=(0,D.Z)(function*(f,c){return ql((0,j.m9)(f),c)})).apply(this,arguments)}function _u(){return(_u=(0,D.Z)(function*(f,c){return Zr(f,"POST","/v1/accounts:signInWithCustomToken",Gt(f,c))})).apply(this,arguments)}function Xr(){return Xr=(0,D.Z)(function*(f,c){const d=mn(f),p=yield function ZO(f,c){return _u.apply(this,arguments)}(d,{token:c,returnSecureToken:!0}),_=yield Et._fromIdTokenResponse(d,"signIn",p);return yield d._updateCurrentUser(_.user),_}),Xr.apply(this,arguments)}class ia{constructor(c,d){this.factorId=c,this.uid=d.mfaEnrollmentId,this.enrollmentTime=new Date(d.enrolledAt).toUTCString(),this.displayName=d.displayName}static _fromServerResponse(c,d){return"phoneInfo"in d?ra._fromServerResponse(c,d):"totpInfo"in d?Ya._fromServerResponse(c,d):se(c,"internal-error")}}class ra extends ia{constructor(c){super("phone",c),this.phoneNumber=c.phoneInfo}static _fromServerResponse(c,d){return new ra(d)}}class Ya extends ia{constructor(c){super("totp",c)}static _fromServerResponse(c,d){return new Ya(d)}}function Xn(f,c,d){var p;Q((null===(p=d.url)||void 0===p?void 0:p.length)>0,f,"invalid-continue-uri"),Q(typeof d.dynamicLinkDomain>"u"||d.dynamicLinkDomain.length>0,f,"invalid-dynamic-link-domain"),c.continueUrl=d.url,c.dynamicLinkDomain=d.dynamicLinkDomain,c.canHandleCodeInApp=d.handleCodeInApp,d.iOS&&(Q(d.iOS.bundleId.length>0,f,"missing-ios-bundle-id"),c.iOSBundleId=d.iOS.bundleId),d.android&&(Q(d.android.packageName.length>0,f,"missing-android-pkg-name"),c.androidInstallApp=d.android.installApp,c.androidMinimumVersionCode=d.android.minimumVersion,c.androidPackageName=d.android.packageName)}function Hv(f){return ki.apply(this,arguments)}function ki(){return(ki=(0,D.Z)(function*(f){const c=mn(f);c._getPasswordPolicyInternal()&&(yield c._updatePasswordPolicy())})).apply(this,arguments)}function yu(){return(yu=(0,D.Z)(function*(f,c,d){const p=mn(f),_={requestType:"PASSWORD_RESET",email:c,clientType:"CLIENT_TYPE_WEB"};d&&Xn(p,_,d),yield Us(p,_,"getOobCode",wg)})).apply(this,arguments)}function Zl(){return Zl=(0,D.Z)(function*(f,c,d){yield Fv((0,j.m9)(f),{oobCode:c,newPassword:d}).catch(function(){var p=(0,D.Z)(function*(_){throw"auth/password-does-not-meet-requirements"===_.code&&Hv(f),_});return function(_){return p.apply(this,arguments)}}())}),Zl.apply(this,arguments)}function vu(){return vu=(0,D.Z)(function*(f,c){yield function hh(f,c){return pu.apply(this,arguments)}((0,j.m9)(f),{oobCode:c})}),vu.apply(this,arguments)}function Gv(f,c){return Rg.apply(this,arguments)}function Rg(){return(Rg=(0,D.Z)(function*(f,c){const d=(0,j.m9)(f),p=yield Fv(d,{oobCode:c}),_=p.requestType;switch(Q(_,d,"internal-error"),_){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Q(p.newEmail,d,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Q(p.mfaInfo,d,"internal-error");default:Q(p.email,d,"internal-error")}let v=null;return p.mfaInfo&&(v=ia._fromServerResponse(mn(d),p.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===p.requestType?p.newEmail:p.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===p.requestType?p.email:p.newEmail)||null,multiFactorInfo:v},operation:_}})).apply(this,arguments)}function Ng(){return(Ng=(0,D.Z)(function*(f,c){const{data:d}=yield Gv((0,j.m9)(f),c);return d.email})).apply(this,arguments)}function zv(){return(zv=(0,D.Z)(function*(f,c,d){const p=mn(f),I=yield Us(p,{returnSecureToken:!0,email:c,password:d,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Te).catch(z=>{throw"auth/password-does-not-meet-requirements"===z.code&&Hv(f),z}),R=yield Et._fromIdTokenResponse(p,"signIn",I);return yield p._updateCurrentUser(R.user),R})).apply(this,arguments)}function Wv(){return(Wv=(0,D.Z)(function*(f,c,d){const p=mn(f),_={requestType:"EMAIL_SIGNIN",email:c,clientType:"CLIENT_TYPE_WEB"};(function v(I,R){Q(R.handleCodeInApp,p,"argument-error"),R&&Xn(p,I,R)})(_,d),yield Us(p,_,"getOobCode",Vv)})).apply(this,arguments)}function qv(){return(qv=(0,D.Z)(function*(f,c,d){const p=(0,j.m9)(f),_=Mi.credentialWithLink(c,d||un());return Q(_._tenantId===(p.tenantId||null),p,"tenant-id-mismatch"),mu(p,_)})).apply(this,arguments)}function Kv(){return(Kv=(0,D.Z)(function*(f,c){return Ut(f,"POST","/v1/accounts:createAuthUri",Gt(f,c))})).apply(this,arguments)}function Zv(){return Zv=(0,D.Z)(function*(f,c){const p={identifier:c,continueUri:ye()?un():"http://localhost"},{signinMethods:_}=yield function tM(f,c){return Kv.apply(this,arguments)}((0,j.m9)(f),p);return _||[]}),Zv.apply(this,arguments)}function Eh(){return Eh=(0,D.Z)(function*(f,c){const d=(0,j.m9)(f),_={requestType:"VERIFY_EMAIL",idToken:yield f.getIdToken()};c&&Xn(d.auth,_,c);const{email:v}=yield function Lv(f,c){return ph.apply(this,arguments)}(d.auth,_);v!==f.email&&(yield f.reload())}),Eh.apply(this,arguments)}function Qv(){return Qv=(0,D.Z)(function*(f,c,d){const p=(0,j.m9)(f),v={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield f.getIdToken(),newEmail:c};d&&Xn(p.auth,v,d);const{email:I}=yield function Bv(f,c){return mh.apply(this,arguments)}(p.auth,v);I!==f.email&&(yield f.reload())}),Qv.apply(this,arguments)}function Jv(){return(Jv=(0,D.Z)(function*(f,c){return Ut(f,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function zs(){return zs=(0,D.Z)(function*(f,{displayName:c,photoURL:d}){if(void 0===c&&void 0===d)return;const p=(0,j.m9)(f),v={idToken:yield p.getIdToken(),displayName:c,photoUrl:d,returnSecureToken:!0},I=yield at(p,function rM(f,c){return Jv.apply(this,arguments)}(p.auth,v));p.displayName=I.displayName||null,p.photoURL=I.photoUrl||null;const R=p.providerData.find(({providerId:z})=>"password"===z);R&&(R.displayName=p.displayName,R.photoURL=p.photoURL),yield p._updateTokensIfNecessary(I)}),zs.apply(this,arguments)}function gi(f,c,d){return Yl.apply(this,arguments)}function Yl(){return Yl=(0,D.Z)(function*(f,c,d){const{auth:p}=f,v={idToken:yield f.getIdToken(),returnSecureToken:!0};c&&(v.email=c),d&&(v.password=d);const I=yield at(f,function dh(f,c){return Rr.apply(this,arguments)}(p,v));yield f._updateTokensIfNecessary(I,!0)}),Yl.apply(this,arguments)}class Xa{constructor(c,d,p={}){this.isNewUser=c,this.providerId=d,this.profile=p}}class xg extends Xa{constructor(c,d,p,_){super(c,d,p),this.username=_}}class Xv extends Xa{constructor(c,d){super(c,"facebook.com",d)}}class e0 extends xg{constructor(c,d){super(c,"github.com",d,"string"==typeof d?.login?d?.login:null)}}class Pg extends Xa{constructor(c,d){super(c,"google.com",d)}}class t0 extends xg{constructor(c,d,p){super(c,"twitter.com",d,p)}}function Og(f){const{user:c,_tokenResponse:d}=f;return c.isAnonymous&&!d?{providerId:null,isNewUser:!1,profile:null}:function es(f){var c,d;if(!f)return null;const{providerId:p}=f,_=f.rawUserInfo?JSON.parse(f.rawUserInfo):{},v=f.isNewUser||"identitytoolkit#SignupNewUserResponse"===f.kind;if(!p&&f?.idToken){const I=null===(d=null===(c=Le(f.idToken))||void 0===c?void 0:c.firebase)||void 0===d?void 0:d.sign_in_provider;if(I)return new Xa(v,"anonymous"!==I&&"custom"!==I?I:null)}if(!p)return null;switch(p){case"facebook.com":return new Xv(v,_);case"github.com":return new e0(v,_);case"google.com":return new Pg(v,_);case"twitter.com":return new t0(v,_,f.screenName||null);case"custom":case"anonymous":return new Xa(v,null);default:return new Xa(v,p,_)}}(d)}class Ql{constructor(c,d,p){this.type=c,this.credential=d,this.user=p}static _fromIdtoken(c,d){return new Ql("enroll",c,d)}static _fromMfaPendingCredential(c){return new Ql("signin",c)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(c){var d,p;if(c?.multiFactorSession){if(null!==(d=c.multiFactorSession)&&void 0!==d&&d.pendingCredential)return Ql._fromMfaPendingCredential(c.multiFactorSession.pendingCredential);if(null!==(p=c.multiFactorSession)&&void 0!==p&&p.idToken)return Ql._fromIdtoken(c.multiFactorSession.idToken)}return null}}class Ih{constructor(c,d,p){this.session=c,this.hints=d,this.signInResolver=p}static _fromError(c,d){const p=mn(c),_=d.customData._serverResponse,v=(_.mfaInfo||[]).map(R=>ia._fromServerResponse(p,R));Q(_.mfaPendingCredential,p,"internal-error");const I=Ql._fromMfaPendingCredential(_.mfaPendingCredential);return new Ih(I,v,function(){var R=(0,D.Z)(function*(z){const Z=yield z._process(p,I);delete _.mfaInfo,delete _.mfaPendingCredential;const ae=Object.assign(Object.assign({},_),{idToken:Z.idToken,refreshToken:Z.refreshToken});switch(d.operationType){case"signIn":const fe=yield Et._fromIdTokenResponse(p,d.operationType,ae);return yield p._updateCurrentUser(fe.user),fe;case"reauthenticate":return Q(d.user,p,"internal-error"),Et._forOperation(d.user,d.operationType,ae);default:se(p,"internal-error")}});return function(z){return R.apply(this,arguments)}}())}resolveSignIn(c){var d=this;return(0,D.Z)(function*(){return d.signInResolver(c)})()}}class Ch{constructor(c){this.user=c,this.enrolledFactors=[],c._onReload(d=>{d.mfaInfo&&(this.enrolledFactors=d.mfaInfo.map(p=>ia._fromServerResponse(c.auth,p)))})}static _fromUser(c){return new Ch(c)}getSession(){var c=this;return(0,D.Z)(function*(){return Ql._fromIdtoken(yield c.user.getIdToken(),c.user)})()}enroll(c,d){var p=this;return(0,D.Z)(function*(){const _=c,v=yield p.getSession(),I=yield at(p.user,_._process(p.user.auth,v,d));return yield p.user._updateTokensIfNecessary(I),p.user.reload()})()}unenroll(c){var d=this;return(0,D.Z)(function*(){const p="string"==typeof c?c:c.uid,_=yield d.user.getIdToken();try{const v=yield at(d.user,function iC(f,c){return Ut(f,"POST","/v2/accounts/mfaEnrollment:withdraw",Gt(f,c))}(d.user.auth,{idToken:_,mfaEnrollmentId:p}));d.enrolledFactors=d.enrolledFactors.filter(({uid:I})=>I!==p),yield d.user._updateTokensIfNecessary(v),yield d.user.reload()}catch(v){throw v}})()}}const Dh=new WeakMap,Sh="__sak";class r0{constructor(c,d){this.storageRetriever=c,this.type=d}_isAvailable(){try{return this.storage?(this.storage.setItem(Sh,"1"),this.storage.removeItem(Sh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(c,d){return this.storage.setItem(c,JSON.stringify(d)),Promise.resolve()}_get(c){const d=this.storage.getItem(c);return Promise.resolve(d?JSON.parse(d):null)}_remove(c){return this.storage.removeItem(c),Promise.resolve()}get storage(){return this.storageRetriever()}}const Lg=(()=>{class f extends r0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(d,p)=>this.onStorageEvent(d,p),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function s0(){const f=(0,j.z$)();return ah(f)||$a(f)}()&&function me(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=BI(),this._shouldAllowMigration=!0}forAllChangedKeys(d){for(const p of Object.keys(this.listeners)){const _=this.storage.getItem(p),v=this.localCache[p];_!==v&&d(p,v,_)}}onStorageEvent(d,p=!1){if(!d.key)return void this.forAllChangedKeys((R,z,Z)=>{this.notifyListeners(R,Z)});const _=d.key;if(p?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const R=this.storage.getItem(_);if(d.newValue!==R)null!==d.newValue?this.storage.setItem(_,d.newValue):this.storage.removeItem(_);else if(this.localCache[_]===d.newValue&&!p)return}const v=()=>{const R=this.storage.getItem(_);!p&&this.localCache[_]===R||this.notifyListeners(_,R)},I=this.storage.getItem(_);!function WO(){return(0,j.w1)()&&10===document.documentMode}()||I===d.newValue||d.newValue===d.oldValue?v():setTimeout(v,10)}notifyListeners(d,p){this.localCache[d]=p;const _=this.listeners[d];if(_)for(const v of Array.from(_))v(p&&JSON.parse(p))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((d,p,_)=>{this.onStorageEvent(new StorageEvent("storage",{key:d,oldValue:p,newValue:_}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(d,p){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[d]||(this.listeners[d]=new Set,this.localCache[d]=this.storage.getItem(d)),this.listeners[d].add(p)}_removeListener(d,p){this.listeners[d]&&(this.listeners[d].delete(p),0===this.listeners[d].size&&delete this.listeners[d]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(d,p){var _=()=>super._set,v=this;return(0,D.Z)(function*(){yield _().call(v,d,p),v.localCache[d]=JSON.stringify(p)})()}_get(d){var p=()=>super._get,_=this;return(0,D.Z)(function*(){const v=yield p().call(_,d);return _.localCache[d]=JSON.stringify(v),v})()}_remove(d){var p=()=>super._remove,_=this;return(0,D.Z)(function*(){yield p().call(_,d),delete _.localCache[d]})()}}return f.type="LOCAL",f})(),dn=(()=>{class f extends r0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(d,p){}_removeListener(d,p){}}return f.type="SESSION",f})();let oC=(()=>{class f{constructor(d){this.eventTarget=d,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(d){const p=this.receivers.find(v=>v.isListeningto(d));if(p)return p;const _=new f(d);return this.receivers.push(_),_}isListeningto(d){return this.eventTarget===d}handleEvent(d){var p=this;return(0,D.Z)(function*(){const _=d,{eventId:v,eventType:I,data:R}=_.data,z=p.handlersMap[I];if(!z?.size)return;_.ports[0].postMessage({status:"ack",eventId:v,eventType:I});const Z=Array.from(z).map(function(){var fe=(0,D.Z)(function*(Je){return Je(_.origin,R)});return function(Je){return fe.apply(this,arguments)}}()),ae=yield function a0(f){return Promise.all(f.map(function(){var c=(0,D.Z)(function*(d){try{return{fulfilled:!0,value:yield d}}catch(p){return{fulfilled:!1,reason:p}}});return function(d){return c.apply(this,arguments)}}()))}(Z);_.ports[0].postMessage({status:"done",eventId:v,eventType:I,response:ae})})()}_subscribe(d,p){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[d]||(this.handlersMap[d]=new Set),this.handlersMap[d].add(p)}_unsubscribe(d,p){this.handlersMap[d]&&p&&this.handlersMap[d].delete(p),(!p||0===this.handlersMap[d].size)&&delete this.handlersMap[d],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return f.receivers=[],f})();function wu(f="",c=10){let d="";for(let p=0;p<c;p++)d+=Math.floor(10*Math.random());return f+d}class l0{constructor(c){this.target=c,this.handlers=new Set}removeMessageHandler(c){c.messageChannel&&(c.messageChannel.port1.removeEventListener("message",c.onMessage),c.messageChannel.port1.close()),this.handlers.delete(c)}_send(c,d,p=50){var _=this;return(0,D.Z)(function*(){const v=typeof MessageChannel<"u"?new MessageChannel:null;if(!v)throw new Error("connection_unavailable");let I,R;return new Promise((z,Z)=>{const ae=wu("",20);v.port1.start();const fe=setTimeout(()=>{Z(new Error("unsupported_event"))},p);R={messageChannel:v,onMessage(Je){const Tt=Je;if(Tt.data.eventId===ae)switch(Tt.data.status){case"ack":clearTimeout(fe),I=setTimeout(()=>{Z(new Error("timeout"))},3e3);break;case"done":clearTimeout(I),z(Tt.data.response);break;default:clearTimeout(fe),clearTimeout(I),Z(new Error("invalid_response"))}}},_.handlers.add(R),v.port1.addEventListener("message",R.onMessage),_.target.postMessage({eventType:c,eventId:ae,data:d},[v.port2])}).finally(()=>{R&&_.removeMessageHandler(R)})})()}}function zn(){return window}function Tu(){return typeof zn().WorkerGlobalScope<"u"&&"function"==typeof zn().importScripts}function ts(){return(ts=(0,D.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Xt="firebaseLocalStorageDb",el="firebaseLocalStorage",Yi="fbase_key";class Iu{constructor(c){this.request=c}toPromise(){return new Promise((c,d)=>{this.request.addEventListener("success",()=>{c(this.request.result)}),this.request.addEventListener("error",()=>{d(this.request.error)})})}}function Cu(f,c){return f.transaction([el],c?"readwrite":"readonly").objectStore(el)}function Qi(){const f=indexedDB.open(Xt,1);return new Promise((c,d)=>{f.addEventListener("error",()=>{d(f.error)}),f.addEventListener("upgradeneeded",()=>{const p=f.result;try{p.createObjectStore(el,{keyPath:Yi})}catch(_){d(_)}}),f.addEventListener("success",(0,D.Z)(function*(){const p=f.result;p.objectStoreNames.contains(el)?c(p):(p.close(),yield function Jl(){const f=indexedDB.deleteDatabase(Xt);return new Iu(f).toPromise()}(),c(yield Qi()))}))})}function d0(f,c,d){return Bg.apply(this,arguments)}function Bg(){return(Bg=(0,D.Z)(function*(f,c,d){const p=Cu(f,!0).put({[Yi]:c,value:d});return new Iu(p).toPromise()})).apply(this,arguments)}function Ws(){return(Ws=(0,D.Z)(function*(f,c){const d=Cu(f,!1).get(c),p=yield new Iu(d).toPromise();return void 0===p?null:p.value})).apply(this,arguments)}function Ug(f,c){const d=Cu(f,!0).delete(c);return new Iu(d).toPromise()}const tl=(()=>{class f{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var d=this;return(0,D.Z)(function*(){return d.db||(d.db=yield Qi()),d.db})()}_withRetries(d){var p=this;return(0,D.Z)(function*(){let _=0;for(;;)try{const v=yield p._openDb();return yield d(v)}catch(v){if(_++>3)throw v;p.db&&(p.db.close(),p.db=void 0)}})()}initializeServiceWorkerMessaging(){var d=this;return(0,D.Z)(function*(){return Tu()?d.initializeReceiver():d.initializeSender()})()}initializeReceiver(){var d=this;return(0,D.Z)(function*(){d.receiver=oC._getInstance(function u0(){return Tu()?self:null}()),d.receiver._subscribe("keyChanged",function(){var p=(0,D.Z)(function*(_,v){return{keyProcessed:(yield d._poll()).includes(v.key)}});return function(_,v){return p.apply(this,arguments)}}()),d.receiver._subscribe("ping",function(){var p=(0,D.Z)(function*(_,v){return["keyChanged"]});return function(_,v){return p.apply(this,arguments)}}())})()}initializeSender(){var d=this;return(0,D.Z)(function*(){var p,_;if(d.activeServiceWorker=yield function lC(){return ts.apply(this,arguments)}(),!d.activeServiceWorker)return;d.sender=new l0(d.activeServiceWorker);const v=yield d.sender._send("ping",{},800);v&&null!==(p=v[0])&&void 0!==p&&p.fulfilled&&null!==(_=v[0])&&void 0!==_&&_.value.includes("keyChanged")&&(d.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(d){var p=this;return(0,D.Z)(function*(){if(p.sender&&p.activeServiceWorker&&function c0(){var f;return(null===(f=navigator?.serviceWorker)||void 0===f?void 0:f.controller)||null}()===p.activeServiceWorker)try{yield p.sender._send("keyChanged",{key:d},p.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,D.Z)(function*(){try{if(!indexedDB)return!1;const d=yield Qi();return yield d0(d,Sh,"1"),yield Ug(d,Sh),!0}catch{}return!1})()}_withPendingWrite(d){var p=this;return(0,D.Z)(function*(){p.pendingWrites++;try{yield d()}finally{p.pendingWrites--}})()}_set(d,p){var _=this;return(0,D.Z)(function*(){return _._withPendingWrite((0,D.Z)(function*(){return yield _._withRetries(v=>d0(v,d,p)),_.localCache[d]=p,_.notifyServiceWorker(d)}))})()}_get(d){var p=this;return(0,D.Z)(function*(){const _=yield p._withRetries(v=>function cC(f,c){return Ws.apply(this,arguments)}(v,d));return p.localCache[d]=_,_})()}_remove(d){var p=this;return(0,D.Z)(function*(){return p._withPendingWrite((0,D.Z)(function*(){return yield p._withRetries(_=>Ug(_,d)),delete p.localCache[d],p.notifyServiceWorker(d)}))})()}_poll(){var d=this;return(0,D.Z)(function*(){const p=yield d._withRetries(I=>{const R=Cu(I,!1).getAll();return new Iu(R).toPromise()});if(!p)return[];if(0!==d.pendingWrites)return[];const _=[],v=new Set;if(0!==p.length)for(const{fbase_key:I,value:R}of p)v.add(I),JSON.stringify(d.localCache[I])!==JSON.stringify(R)&&(d.notifyListeners(I,R),_.push(I));for(const I of Object.keys(d.localCache))d.localCache[I]&&!v.has(I)&&(d.notifyListeners(I,null),_.push(I));return _})()}notifyListeners(d,p){this.localCache[d]=p;const _=this.listeners[d];if(_)for(const v of Array.from(_))v(p)}startPolling(){var d=this;this.stopPolling(),this.pollTimer=setInterval((0,D.Z)(function*(){return d._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(d,p){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[d]||(this.listeners[d]=new Set,this._get(d)),this.listeners[d].add(p)}_removeListener(d,p){this.listeners[d]&&(this.listeners[d].delete(p),0===this.listeners[d].size&&delete this.listeners[d]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return f.type="LOCAL",f})(),Ah=1e12;class pC{constructor(c){this.auth=c,this.counter=Ah,this._widgets=new Map}render(c,d){const p=this.counter;return this._widgets.set(p,new p0(c,this.auth.name,d||{})),this.counter++,p}reset(c){var d;const p=c||Ah;null===(d=this._widgets.get(p))||void 0===d||d.delete(),this._widgets.delete(p)}getResponse(c){var d;return(null===(d=this._widgets.get(c||Ah))||void 0===d?void 0:d.getResponse())||""}execute(c){var d=this;return(0,D.Z)(function*(){var p;return null===(p=d._widgets.get(c||Ah))||void 0===p||p.execute(),""})()}}class p0{constructor(c,d,p){this.params=p,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const _="string"==typeof c?document.getElementById(c):c;Q(_,"argument-error",{appName:d}),this.container=_,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Xl(f){const c=[],d="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let p=0;p<f;p++)c.push(d.charAt(Math.floor(62*Math.random())));return c.join("")}(50);const{callback:c,"expired-callback":d}=this.params;if(c)try{c(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,d)try{d()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const jg=$l("rcb"),gC=new Kr(3e4,6e4);class _C{constructor(){var c;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(c=zn().grecaptcha)||void 0===c||!c.render)}load(c,d=""){return Q(function yC(f){return f.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(f)}(d),c,"argument-error"),this.shouldResolveImmediately(d)&&x(zn().grecaptcha)?Promise.resolve(zn().grecaptcha):new Promise((p,_)=>{const v=zn().setTimeout(()=>{_(Ue(c,"network-request-failed"))},gC.get());zn()[jg]=()=>{zn().clearTimeout(v),delete zn()[jg];const R=zn().grecaptcha;if(!R||!x(R))return void _(Ue(c,"internal-error"));const z=R.render;R.render=(Z,ae)=>{const fe=z(Z,ae);return this.counter++,fe},this.hostLanguage=d,p(R)},Pv(`https://www.google.com/recaptcha/api.js??${(0,j.xO)({onload:jg,render:"explicit",hl:d})}`).catch(()=>{clearTimeout(v),_(Ue(c,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(c){var d;return!(null===(d=zn().grecaptcha)||void 0===d||!d.render)&&(c===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class ee{load(c){return(0,D.Z)(function*(){return new pC(c)})()}clearedOneInstance(){}}const wt="recaptcha",Rt={theme:"light",type:"image"};class Nt{constructor(c,d,p=Object.assign({},Rt)){this.parameters=p,this.type=wt,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=mn(c),this.isInvisible="invisible"===this.parameters.size,Q(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const _="string"==typeof d?document.getElementById(d):d;Q(_,this.auth,"argument-error"),this.container=_,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new ee:new _C,this.validateStartingState()}verify(){var c=this;return(0,D.Z)(function*(){c.assertNotDestroyed();const d=yield c.render(),p=c.getAssertedRecaptcha();return p.getResponse(d)||new Promise(v=>{const I=R=>{R&&(c.tokenChangeListeners.delete(I),v(R))};c.tokenChangeListeners.add(I),c.isInvisible&&p.execute(d)})})()}render(){try{this.assertNotDestroyed()}catch(c){return Promise.reject(c)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(c=>{throw this.renderPromise=null,c})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(c=>{this.container.removeChild(c)})}validateStartingState(){Q(!this.parameters.sitekey,this.auth,"argument-error"),Q(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Q(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(c){return d=>{if(this.tokenChangeListeners.forEach(p=>p(d)),"function"==typeof c)c(d);else if("string"==typeof c){const p=zn()[c];"function"==typeof p&&p(d)}}}assertNotDestroyed(){Q(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var c=this;return(0,D.Z)(function*(){if(yield c.init(),!c.widgetId){let d=c.container;if(!c.isInvisible){const p=document.createElement("div");d.appendChild(p),d=p}c.widgetId=c.getAssertedRecaptcha().render(d,c.parameters)}return c.widgetId})()}init(){var c=this;return(0,D.Z)(function*(){Q(ye()&&!Tu(),c.auth,"internal-error"),yield function Ei(){let f=null;return new Promise(c=>{"complete"!==document.readyState?(f=()=>c(),window.addEventListener("load",f)):c()}).catch(c=>{throw f&&window.removeEventListener("load",f),c})}(),c.recaptcha=yield c._recaptchaLoader.load(c.auth,c.auth.languageCode||void 0);const d=yield function Re(f){return ge.apply(this,arguments)}(c.auth);Q(d,c.auth,"internal-error"),c.parameters.sitekey=d})()}getAssertedRecaptcha(){return Q(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Rh{constructor(c,d){this.verificationId=c,this.onConfirmation=d}confirm(c){const d=za._fromVerification(this.verificationId,c);return this.onConfirmation(d)}}function ns(){return(ns=(0,D.Z)(function*(f,c,d){const p=mn(f),_=yield Au(p,c,(0,j.m9)(d));return new Rh(_,v=>mu(p,v))})).apply(this,arguments)}function Su(){return(Su=(0,D.Z)(function*(f,c,d){const p=(0,j.m9)(f);yield bo(!1,p,"phone");const _=yield Au(p.auth,c,(0,j.m9)(d));return new Rh(_,v=>Gs(p,v))})).apply(this,arguments)}function g0(){return(g0=(0,D.Z)(function*(f,c,d){const p=(0,j.m9)(f),_=yield Au(p.auth,c,(0,j.m9)(d));return new Rh(_,v=>Kl(p,v))})).apply(this,arguments)}function Au(f,c,d){return wi.apply(this,arguments)}function wi(){return wi=(0,D.Z)(function*(f,c,d){var p;const _=yield d.verify();try{let v;if(Q("string"==typeof _,f,"argument-error"),Q(d.type===wt,f,"argument-error"),v="string"==typeof c?{phoneNumber:c}:c,"session"in v){const I=v.session;if("phoneNumber"in v)return Q("enroll"===I.type,f,"internal-error"),(yield function nC(f,c){return Ut(f,"POST","/v2/accounts/mfaEnrollment:start",Gt(f,c))}(f,{idToken:I.credential,phoneEnrollmentInfo:{phoneNumber:v.phoneNumber,recaptchaToken:_}})).phoneSessionInfo.sessionInfo;{Q("signin"===I.type,f,"internal-error");const R=(null===(p=v.multiFactorHint)||void 0===p?void 0:p.uid)||v.multiFactorUid;return Q(R,f,"missing-multi-factor-info"),(yield function hC(f,c){return Ut(f,"POST","/v2/accounts/mfaSignIn:start",Gt(f,c))}(f,{mfaPendingCredential:I.credential,mfaEnrollmentId:R,phoneSignInInfo:{recaptchaToken:_}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:I}=yield function qI(f,c){return Ig.apply(this,arguments)}(f,{phoneNumber:v.phoneNumber,recaptchaToken:_});return I}}finally{d._reset()}}),wi.apply(this,arguments)}function Nh(){return(Nh=(0,D.Z)(function*(f,c){yield qa((0,j.m9)(f),c)})).apply(this,arguments)}let qs=(()=>{class f{constructor(d){this.providerId=f.PROVIDER_ID,this.auth=mn(d)}verifyPhoneNumber(d,p){return Au(this.auth,d,(0,j.m9)(p))}static credential(d,p){return za._fromVerification(d,p)}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d)return null;const{phoneNumber:p,temporaryProof:_}=d;return p&&_?za._fromTokenResponse(p,_):null}}return f.PROVIDER_ID="phone",f.PHONE_SIGN_IN_METHOD="phone",f})();function Ji(f,c){return c?Oi(c):(Q(f._popupRedirectResolver,f,"argument-error"),f._popupRedirectResolver)}class Hg extends Gl{constructor(c){super("custom","custom"),this.params=c}_getIdTokenResponse(c){return mo(c,this._buildIdpRequest())}_linkToIdToken(c,d){return mo(c,this._buildIdpRequest(d))}_getReauthenticationResolver(c){return mo(c,this._buildIdpRequest())}_buildIdpRequest(c){const d={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return c&&(d.idToken=c),d}}function m0(f){return Es(f.auth,new Hg(f),f.bypassAuthState)}function bC(f){const{auth:c,user:d}=f;return Q(d,c,"internal-error"),ql(d,new Hg(f),f.bypassAuthState)}function EC(f){return Ru.apply(this,arguments)}function Ru(){return(Ru=(0,D.Z)(function*(f){const{auth:c,user:d}=f;return Q(d,c,"internal-error"),qa(d,new Hg(f),f.bypassAuthState)})).apply(this,arguments)}class xh{constructor(c,d,p,_,v=!1){this.auth=c,this.resolver=p,this.user=_,this.bypassAuthState=v,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(d)?d:[d]}execute(){var c=this;return new Promise(function(){var d=(0,D.Z)(function*(p,_){c.pendingPromise={resolve:p,reject:_};try{c.eventManager=yield c.resolver._initialize(c.auth),yield c.onExecution(),c.eventManager.registerConsumer(c)}catch(v){c.reject(v)}});return function(p,_){return d.apply(this,arguments)}}())}onAuthEvent(c){var d=this;return(0,D.Z)(function*(){const{urlResponse:p,sessionId:_,postBody:v,tenantId:I,error:R,type:z}=c;if(R)return void d.reject(R);const Z={auth:d.auth,requestUri:p,sessionId:_,tenantId:I||void 0,postBody:v||void 0,user:d.user,bypassAuthState:d.bypassAuthState};try{d.resolve(yield d.getIdpTask(z)(Z))}catch(ae){d.reject(ae)}})()}onError(c){this.reject(c)}getIdpTask(c){switch(c){case"signInViaPopup":case"signInViaRedirect":return m0;case"linkViaPopup":case"linkViaRedirect":return EC;case"reauthViaPopup":case"reauthViaRedirect":return bC;default:se(this.auth,"internal-error")}}resolve(c){cn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(c),this.unregisterAndCleanUp()}reject(c){cn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(c),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const _0=new Kr(2e3,1e4);function zg(){return(zg=(0,D.Z)(function*(f,c,d){const p=mn(f);tt(f,c,nt);const _=Ji(p,d);return new Oh(p,"signInViaPopup",c,_).executeNotNull()})).apply(this,arguments)}function Nu(){return(Nu=(0,D.Z)(function*(f,c,d){const p=(0,j.m9)(f);tt(p.auth,c,nt);const _=Ji(p.auth,d);return new Oh(p.auth,"reauthViaPopup",c,_,p).executeNotNull()})).apply(this,arguments)}function Ph(){return(Ph=(0,D.Z)(function*(f,c,d){const p=(0,j.m9)(f);tt(p.auth,c,nt);const _=Ji(p.auth,d);return new Oh(p.auth,"linkViaPopup",c,_,p).executeNotNull()})).apply(this,arguments)}let Oh=(()=>{class f extends xh{constructor(d,p,_,v,I){super(d,p,v,I),this.provider=_,this.authWindow=null,this.pollId=null,f.currentPopupAction&&f.currentPopupAction.cancel(),f.currentPopupAction=this}executeNotNull(){var d=this;return(0,D.Z)(function*(){const p=yield d.execute();return Q(p,d.auth,"internal-error"),p})()}onExecution(){var d=this;return(0,D.Z)(function*(){cn(1===d.filter.length,"Popup operations only handle one event");const p=wu();d.authWindow=yield d.resolver._openPopup(d.auth,d.provider,d.filter[0],p),d.authWindow.associatedEvent=p,d.resolver._originValidation(d.auth).catch(_=>{d.reject(_)}),d.resolver._isIframeWebStorageSupported(d.auth,_=>{_||d.reject(Ue(d.auth,"web-storage-unsupported"))}),d.pollUserCancellation()})()}get eventId(){var d;return(null===(d=this.authWindow)||void 0===d?void 0:d.associatedEvent)||null}cancel(){this.reject(Ue(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,f.currentPopupAction=null}pollUserCancellation(){const d=()=>{var p,_;this.pollId=null!==(_=null===(p=this.authWindow)||void 0===p?void 0:p.window)&&void 0!==_&&_.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Ue(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(d,_0.get())};d()}}return f.currentPopupAction=null,f})();const b0="pendingRedirect",nl=new Map;class wC extends xh{constructor(c,d,p=!1){super(c,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],d,void 0,p),this.eventId=null}execute(){var c=()=>super.execute,d=this;return(0,D.Z)(function*(){let p=nl.get(d.auth._key());if(!p){try{const v=(yield function TC(f,c){return Ti.apply(this,arguments)}(d.resolver,d.auth))?yield c().call(d):null;p=()=>Promise.resolve(v)}catch(_){p=()=>Promise.reject(_)}nl.set(d.auth._key(),p)}return d.bypassAuthState||nl.set(d.auth._key(),()=>Promise.resolve(null)),p()})()}onAuthEvent(c){var d=()=>super.onAuthEvent,p=this;return(0,D.Z)(function*(){if("signInViaRedirect"===c.type)return d().call(p,c);if("unknown"!==c.type){if(c.eventId){const _=yield p.auth._redirectUserForId(c.eventId);if(_)return p.user=_,d().call(p,c);p.resolve(null)}}else p.resolve(null)})()}onExecution(){return(0,D.Z)(function*(){})()}cleanUp(){}}function Ti(){return(Ti=(0,D.Z)(function*(f,c){const d=w0(c),p=E0(f);if(!(yield p._isAvailable()))return!1;const _="true"===(yield p._get(d));return yield p._remove(d),_})).apply(this,arguments)}function wo(f,c){return hn.apply(this,arguments)}function hn(){return(hn=(0,D.Z)(function*(f,c){return E0(f)._set(w0(c),"true")})).apply(this,arguments)}function Wg(f,c){nl.set(f._key(),c)}function E0(f){return Oi(f._redirectPersistence)}function w0(f){return Ua(b0,f.config.apiKey,f.name)}function T0(f,c,d){return function I0(f,c,d){return ec.apply(this,arguments)}(f,c,d)}function ec(){return(ec=(0,D.Z)(function*(f,c,d){const p=mn(f);tt(f,c,nt),yield p._initializationPromise;const _=Ji(p,d);return yield wo(_,p),_._openRedirect(p,c,"signInViaRedirect")})).apply(this,arguments)}function sa(f,c,d){return function CC(f,c,d){return tc.apply(this,arguments)}(f,c,d)}function tc(){return(tc=(0,D.Z)(function*(f,c,d){const p=(0,j.m9)(f);tt(p.auth,c,nt),yield p.auth._initializationPromise;const _=Ji(p.auth,d);yield wo(_,p.auth);const v=yield nc(p);return _._openRedirect(p.auth,c,"reauthViaRedirect",v)})).apply(this,arguments)}function Mh(f,c,d){return function kh(f,c,d){return xu.apply(this,arguments)}(f,c,d)}function xu(){return(xu=(0,D.Z)(function*(f,c,d){const p=(0,j.m9)(f);tt(p.auth,c,nt),yield p.auth._initializationPromise;const _=Ji(p.auth,d);yield bo(!1,p,c.providerId),yield wo(_,p.auth);const v=yield nc(p);return _._openRedirect(p.auth,c,"linkViaRedirect",v)})).apply(this,arguments)}function Fh(){return(Fh=(0,D.Z)(function*(f,c){return yield mn(f)._initializationPromise,Lh(f,c,!1)})).apply(this,arguments)}function Lh(f,c){return oa.apply(this,arguments)}function oa(){return(oa=(0,D.Z)(function*(f,c,d=!1){const p=mn(f),_=Ji(p,c),I=yield new wC(p,_,d).execute();return I&&!d&&(delete I.user._redirectEventId,yield p._persistUserIfCurrent(I.user),yield p._setRedirectUser(null,c)),I})).apply(this,arguments)}function nc(f){return qg.apply(this,arguments)}function qg(){return(qg=(0,D.Z)(function*(f){const c=wu(`${f.uid}:::`);return f._redirectEventId=c,yield f.auth._setRedirectUser(f),yield f.auth._persistUserIfCurrent(f),c})).apply(this,arguments)}class Vh{constructor(c){this.auth=c,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(c){this.consumers.add(c),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,c)&&(this.sendToConsumer(this.queuedRedirectEvent,c),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(c){this.consumers.delete(c)}onEvent(c){if(this.hasEventBeenHandled(c))return!1;let d=!1;return this.consumers.forEach(p=>{this.isEventForConsumer(c,p)&&(d=!0,this.sendToConsumer(c,p),this.saveEventToCache(c))}),this.hasHandledPotentialRedirect||!function SC(f){switch(f.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return D0(f);default:return!1}}(c)||(this.hasHandledPotentialRedirect=!0,d||(this.queuedRedirectEvent=c,d=!0)),d}sendToConsumer(c,d){var p;if(c.error&&!D0(c)){const _=(null===(p=c.error.code)||void 0===p?void 0:p.split("auth/")[1])||"internal-error";d.onError(Ue(this.auth,_))}else d.onAuthEvent(c)}isEventForConsumer(c,d){const p=null===d.eventId||!!c.eventId&&c.eventId===d.eventId;return d.filter.includes(c.type)&&p}hasEventBeenHandled(c){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(DC(c))}saveEventToCache(c){this.cachedEventUids.add(DC(c)),this.lastProcessedEventTime=Date.now()}}function DC(f){return[f.type,f.eventId,f.sessionId,f.tenantId].filter(c=>c).join("-")}function D0({type:f,error:c}){return"unknown"===f&&"auth/no-auth-event"===c?.code}function AC(f){return S0.apply(this,arguments)}function S0(){return(S0=(0,D.Z)(function*(f,c={}){return Ut(f,"GET","/v1/projects",c)})).apply(this,arguments)}const Kg=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Pu=/^https?/;function il(){return(il=(0,D.Z)(function*(f){if(f.config.emulator)return;const{authorizedDomains:c}=yield AC(f);for(const d of c)try{if(Zg(d))return}catch{}se(f,"unauthorized-domain")})).apply(this,arguments)}function Zg(f){const c=un(),{protocol:d,hostname:p}=new URL(c);if(f.startsWith("chrome-extension://")){const I=new URL(f);return""===I.hostname&&""===p?"chrome-extension:"===d&&f.replace("chrome-extension://","")===c.replace("chrome-extension://",""):"chrome-extension:"===d&&I.hostname===p}if(!Pu.test(d))return!1;if(Kg.test(f))return p===f;const _=f.replace(/\./g,"\\.");return new RegExp("^(.+\\."+_+"|"+_+")$","i").test(p)}const Bh=new Kr(3e4,6e4);function NC(){const f=zn().___jsl;if(f?.H)for(const c of Object.keys(f.H))if(f.H[c].r=f.H[c].r||[],f.H[c].L=f.H[c].L||[],f.H[c].r=[...f.H[c].L],f.CP)for(let d=0;d<f.CP.length;d++)f.CP[d]=null}let Ou=null;const Ks=new Kr(5e3,15e3),PC="__/auth/iframe",Uh="emulator/auth/iframe",Yg={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},R0=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function jh(f){const c=f.config;Q(c.authDomain,f,"auth-domain-config-required");const d=c.emulator?bi(c,Uh):`https://${f.config.authDomain}/${PC}`,p={apiKey:c.apiKey,appName:f.name,v:ze.SDK_VERSION},_=R0.get(f.config.apiHost);_&&(p.eid=_);const v=f._getFrameworks();return v.length&&(p.fw=v.join(",")),`${d}?${(0,j.xO)(p).slice(1)}`}function Jg(){return Jg=(0,D.Z)(function*(f){const c=yield function xC(f){return Ou=Ou||function A0(f){return new Promise((c,d)=>{var p,_,v;function I(){NC(),gapi.load("gapi.iframes",{callback:()=>{c(gapi.iframes.getContext())},ontimeout:()=>{NC(),d(Ue(f,"network-request-failed"))},timeout:Bh.get()})}if(null!==(_=null===(p=zn().gapi)||void 0===p?void 0:p.iframes)&&void 0!==_&&_.Iframe)c(gapi.iframes.getContext());else{if(null===(v=zn().gapi)||void 0===v||!v.load){const R=$l("iframefcb");return zn()[R]=()=>{gapi.load?I():d(Ue(f,"network-request-failed"))},Pv(`https://apis.google.com/js/api.js?onload=${R}`).catch(z=>d(z))}I()}}).catch(c=>{throw Ou=null,c})}(f),Ou}(f),d=zn().gapi;return Q(d,f,"internal-error"),c.open({where:document.body,url:jh(f),messageHandlersFilter:d.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Yg,dontclear:!0},p=>new Promise(function(){var _=(0,D.Z)(function*(v,I){yield p.restyle({setHideOnLeave:!1});const R=Ue(f,"network-request-failed"),z=zn().setTimeout(()=>{I(R)},Ks.get());function Z(){zn().clearTimeout(z),v(p)}p.ping(Z).then(Z,()=>{I(R)})});return function(v,I){return _.apply(this,arguments)}}()))}),Jg.apply(this,arguments)}const N0={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Mu{constructor(c){this.window=c,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const M0="__/auth/handler",k0="emulator/auth/handler",ku=encodeURIComponent("fac");function Xg(f,c,d,p,_,v){return Ii.apply(this,arguments)}function Ii(){return(Ii=(0,D.Z)(function*(f,c,d,p,_,v){Q(f.config.authDomain,f,"auth-domain-config-required"),Q(f.config.apiKey,f,"invalid-api-key");const I={apiKey:f.config.apiKey,appName:f.name,authType:d,redirectUrl:p,v:ze.SDK_VERSION,eventId:_};if(c instanceof nt){c.setDefaultLanguage(f.languageCode),I.providerId=c.providerId||"",(0,j.xb)(c.getCustomParameters())||(I.customParameters=JSON.stringify(c.getCustomParameters()));for(const[ae,fe]of Object.entries(v||{}))I[ae]=fe}if(c instanceof Mn){const ae=c.getScopes().filter(fe=>""!==fe);ae.length>0&&(I.scopes=ae.join(","))}f.tenantId&&(I.tid=f.tenantId);const R=I;for(const ae of Object.keys(R))void 0===R[ae]&&delete R[ae];const z=yield f._getAppCheckToken(),Z=z?`#${ku}=${encodeURIComponent(z)}`:"";return`${function kC({config:f}){return f.emulator?bi(f,k0):`https://${f.authDomain}/${M0}`}(f)}?${(0,j.xO)(R).slice(1)}${Z}`})).apply(this,arguments)}const Sn="webStorageSupport",F0=class em{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dn,this._completeRedirectFn=Lh,this._overrideRedirectResult=Wg}_openPopup(c,d,p,_){var v=this;return(0,D.Z)(function*(){var I;cn(null===(I=v.eventManagers[c._key()])||void 0===I?void 0:I.manager,"_initialize() not called before _openPopup()");const R=yield Xg(c,d,p,un(),_);return function rl(f,c,d,p=500,_=600){const v=Math.max((window.screen.availHeight-_)/2,0).toString(),I=Math.max((window.screen.availWidth-p)/2,0).toString();let R="";const z=Object.assign(Object.assign({},N0),{width:p.toString(),height:_.toString(),top:v,left:I}),Z=(0,j.z$)().toLowerCase();d&&(R=Nv(Z)?"_blank":d),oh(Z)&&(c=c||"http://localhost",z.scrollbars="yes");const ae=Object.entries(z).reduce((Je,[Tt,Xi])=>`${Je}${Tt}=${Xi},`,"");if(function sn(f=(0,j.z$)()){var c;return $a(f)&&!(null===(c=window.navigator)||void 0===c||!c.standalone)}(Z)&&"_self"!==R)return function MC(f,c){const d=document.createElement("a");d.href=f,d.target=c;const p=document.createEvent("MouseEvent");p.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),d.dispatchEvent(p)}(c||"",R),new Mu(null);const fe=window.open(c||"",R,ae);Q(fe,f,"popup-blocked");try{fe.focus()}catch{}return new Mu(fe)}(c,R,wu())})()}_openRedirect(c,d,p,_){var v=this;return(0,D.Z)(function*(){return yield v._originValidation(c),function aC(f){zn().location.href=f}(yield Xg(c,d,p,un(),_)),new Promise(()=>{})})()}_initialize(c){const d=c._key();if(this.eventManagers[d]){const{manager:_,promise:v}=this.eventManagers[d];return _?Promise.resolve(_):(cn(v,"If manager is not set, promise should be"),v)}const p=this.initAndGetManager(c);return this.eventManagers[d]={promise:p},p.catch(()=>{delete this.eventManagers[d]}),p}initAndGetManager(c){var d=this;return(0,D.Z)(function*(){const p=yield function Qg(f){return Jg.apply(this,arguments)}(c),_=new Vh(c);return p.register("authEvent",v=>(Q(v?.authEvent,c,"invalid-auth-event"),{status:_.onEvent(v.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),d.eventManagers[c._key()]={manager:_},d.iframes[c._key()]=p,_})()}_isIframeWebStorageSupported(c,d){this.iframes[c._key()].send(Sn,{type:Sn},_=>{var v;const I=null===(v=_?.[0])||void 0===v?void 0:v[Sn];void 0!==I&&d(!!I),se(c,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(c){const d=c._key();return this.originValidationPromises[d]||(this.originValidationPromises[d]=function RC(f){return il.apply(this,arguments)}(c)),this.originValidationPromises[d]}get _shouldInitProactively(){return BI()||ah()||$a()}};class L0{constructor(c){this.factorId=c}_process(c,d,p){switch(d.type){case"enroll":return this._finalizeEnroll(c,d.credential,p);case"signin":return this._finalizeSignIn(c,d.credential);default:return Ht("unexpected MultiFactorSessionType")}}}class To extends L0{constructor(c){super("phone"),this.credential=c}static _fromCredential(c){return new To(c)}_finalizeEnroll(c,d,p){return function Fg(f,c){return Ut(f,"POST","/v2/accounts/mfaEnrollment:finalize",Gt(f,c))}(c,{idToken:d,displayName:p,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(c,d){return function We(f,c){return Ut(f,"POST","/v2/accounts/mfaSignIn:finalize",Gt(f,c))}(c,{mfaPendingCredential:d,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let ic=(()=>{class f{constructor(){}static assertion(d){return To._fromCredential(d)}}return f.FACTOR_ID="phone",f})();var sl="@firebase/auth";class LC{constructor(c){this.auth=c,this.internalListeners=new Map}getUid(){var c;return this.assertAuthConfigured(),(null===(c=this.auth.currentUser)||void 0===c?void 0:c.uid)||null}getToken(c){var d=this;return(0,D.Z)(function*(){return d.assertAuthConfigured(),yield d.auth._initializationPromise,d.auth.currentUser?{accessToken:yield d.auth.currentUser.getIdToken(c)}:null})()}addAuthTokenListener(c){if(this.assertAuthConfigured(),this.internalListeners.has(c))return;const d=this.auth.onIdTokenChanged(p=>{c(p?.stsTokenManager.accessToken||null)});this.internalListeners.set(c,d),this.updateProactiveRefresh()}removeAuthTokenListener(c){this.assertAuthConfigured();const d=this.internalListeners.get(c);d&&(this.internalListeners.delete(c),d(),this.updateProactiveRefresh())}assertAuthConfigured(){Q(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function ol(){return window}(0,j.Pz)("authIdTokenMaxAge"),function pM(f){(0,ze._registerComponent)(new ys.wA("auth",(c,{options:d})=>{const p=c.getProvider("app").getImmediate(),_=c.getProvider("heartbeat"),v=c.getProvider("app-check-internal"),{apiKey:I,authDomain:R}=p.options;Q(I&&!I.includes(":"),"invalid-api-key",{appName:p.name});const z={apiKey:I,authDomain:R,clientPlatform:f,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lh(f)},Z=new qO(p,_,v,z);return function kv(f,c){const d=c?.persistence||[],p=(Array.isArray(d)?d:[d]).map(Oi);c?.errorMap&&f._updateErrorMap(c.errorMap),f._initializeWithPersistence(p,c?.popupRedirectResolver)}(Z,d),Z},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((c,d,p)=>{c.getProvider("auth-internal").initialize()})),(0,ze._registerComponent)(new ys.wA("auth-internal",c=>{const d=mn(c.getProvider("auth").getImmediate());return new LC(d)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,ze.registerVersion)(sl,"1.5.1",function fM(f){switch(f){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(f)),(0,ze.registerVersion)(sl,"1.5.1","esm2017")}("Browser");function nm(){return nm=(0,D.Z)(function*(f,c,d){var p;const{BuildInfo:_}=ol();cn(c.sessionId,"AuthEvent did not contain a session ID");const v=yield function Bu(f){return rm.apply(this,arguments)}(c.sessionId),I={};return $a()?I.ibi=_.packageName:ja()?I.apn=_.packageName:se(f,"operation-not-supported-in-this-environment"),_.displayName&&(I.appDisplayName=_.displayName),I.sessionId=v,Xg(f,d,c.type,void 0,null!==(p=c.eventId)&&void 0!==p?p:void 0,I)}),nm.apply(this,arguments)}function im(){return(im=(0,D.Z)(function*(f){const{BuildInfo:c}=ol(),d={};$a()?d.iosBundleId=c.packageName:ja()?d.androidPackageName=c.packageName:se(f,"operation-not-supported-in-this-environment"),yield AC(f,d)})).apply(this,arguments)}function $h(){return($h=(0,D.Z)(function*(f,c,d){const{cordova:p}=ol();let _=()=>{};try{yield new Promise((v,I)=>{let R=null;function z(){var fe;v();const Je=null===(fe=p.plugins.browsertab)||void 0===fe?void 0:fe.close;"function"==typeof Je&&Je(),"function"==typeof d?.close&&d.close()}function Z(){R||(R=window.setTimeout(()=>{I(Ue(f,"redirect-cancelled-by-user"))},2e3))}function ae(){"visible"===document?.visibilityState&&Z()}c.addPassiveListener(z),document.addEventListener("resume",Z,!1),ja()&&document.addEventListener("visibilitychange",ae,!1),_=()=>{c.removePassiveListener(z),document.removeEventListener("resume",Z,!1),document.removeEventListener("visibilitychange",ae,!1),R&&window.clearTimeout(R)}})}finally{_()}})).apply(this,arguments)}function rm(){return(rm=(0,D.Z)(function*(f){const c=function yM(f){if(cn(/[0-9a-zA-Z]+/.test(f),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(f);const c=new ArrayBuffer(f.length),d=new Uint8Array(c);for(let p=0;p<f.length;p++)d[p]=f.charCodeAt(p);return d}(f),d=yield crypto.subtle.digest("SHA-256",c);return Array.from(new Uint8Array(d)).map(_=>_.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class vM extends Vh{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(c=>{this.resolveInialized=c})}addPassiveListener(c){this.passiveListeners.add(c)}removePassiveListener(c){this.passiveListeners.delete(c)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(c){return this.resolveInialized(),this.passiveListeners.forEach(d=>d(c)),super.onEvent(c)}initialized(){var c=this;return(0,D.Z)(function*(){yield c.initPromise})()}}function al(f){return V0.apply(this,arguments)}function V0(){return(V0=(0,D.Z)(function*(f){const c=yield om()._get(am(f));return c&&(yield om()._remove(am(f))),c})).apply(this,arguments)}function jC(){const f=[];for(let d=0;d<20;d++){const p=Math.floor(62*Math.random());f.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(p))}return f.join("")}function om(){return Oi(Lg)}function am(f){return Ua("authEvent",f.config.apiKey,f.name)}function Gh(f){if(!f?.includes("?"))return{};const[c,...d]=f.split("?");return(0,j.zd)(d.join("?"))}const GC=class zh{constructor(){this._redirectPersistence=dn,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Lh,this._overrideRedirectResult=Wg}_initialize(c){var d=this;return(0,D.Z)(function*(){const p=c._key();let _=d.eventManagers.get(p);return _||(_=new vM(c),d.eventManagers.set(p,_),d.attachCallbackListeners(c,_)),_})()}_openPopup(c){se(c,"operation-not-supported-in-this-environment")}_openRedirect(c,d,p,_){var v=this;return(0,D.Z)(function*(){!function Hh(f){var c,d,p,_,v,I,R,z,Z,ae;const fe=ol();Q("function"==typeof(null===(c=fe?.universalLinks)||void 0===c?void 0:c.subscribe),f,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Q(typeof(null===(d=fe?.BuildInfo)||void 0===d?void 0:d.packageName)<"u",f,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Q("function"==typeof(null===(v=null===(_=null===(p=fe?.cordova)||void 0===p?void 0:p.plugins)||void 0===_?void 0:_.browsertab)||void 0===v?void 0:v.openUrl),f,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Q("function"==typeof(null===(z=null===(R=null===(I=fe?.cordova)||void 0===I?void 0:I.plugins)||void 0===R?void 0:R.browsertab)||void 0===z?void 0:z.isAvailable),f,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Q("function"==typeof(null===(ae=null===(Z=fe?.cordova)||void 0===Z?void 0:Z.InAppBrowser)||void 0===ae?void 0:ae.open),f,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(c);const I=yield v._initialize(c);yield I.initialized(),I.resetRedirect(),function IC(){nl.clear()}(),yield v._originValidation(c);const R=function Nr(f,c,d=null){return{type:c,eventId:d,urlResponse:null,sessionId:jC(),postBody:null,tenantId:f.tenantId,error:Ue(f,"no-auth-event")}}(c,p,_);yield function sm(f,c){return om()._set(am(f),c)}(c,R);const z=yield function li(f,c,d){return nm.apply(this,arguments)}(c,R,d),Z=yield function is(f){const{cordova:c}=ol();return new Promise(d=>{c.plugins.browsertab.isAvailable(p=>{let _=null;p?c.plugins.browsertab.openUrl(f):_=c.InAppBrowser.open(f,function zO(f=(0,j.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(f)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(f)}()?"_blank":"_system","location=yes"),d(_)})})}(z);return function sc(f,c,d){return $h.apply(this,arguments)}(c,I,Z)})()}_isIframeWebStorageSupported(c,d){throw new Error("Method not implemented.")}_originValidation(c){const d=c._key();return this.originValidationPromises[d]||(this.originValidationPromises[d]=function Vu(f){return im.apply(this,arguments)}(c)),this.originValidationPromises[d]}attachCallbackListeners(c,d){const{universalLinks:p,handleOpenURL:_,BuildInfo:v}=ol(),I=setTimeout((0,D.Z)(function*(){yield al(c),d.onEvent(oc())}),500),R=function(){var ae=(0,D.Z)(function*(fe){clearTimeout(I);const Je=yield al(c);let Tt=null;Je&&fe?.url&&(Tt=function B0(f,c){var d,p;const _=function HC(f){const c=Gh(f),d=c.link?decodeURIComponent(c.link):void 0,p=Gh(d).link,_=c.deep_link_id?decodeURIComponent(c.deep_link_id):void 0;return Gh(_).link||_||p||d||f}(c);if(_.includes("/__/auth/callback")){const v=Gh(_),I=v.firebaseError?function $C(f){try{return JSON.parse(f)}catch{return null}}(decodeURIComponent(v.firebaseError)):null,R=null===(p=null===(d=I?.code)||void 0===d?void 0:d.split("auth/"))||void 0===p?void 0:p[1],z=R?Ue(R):null;return z?{type:f.type,eventId:f.eventId,tenantId:f.tenantId,error:z,urlResponse:null,sessionId:null,postBody:null}:{type:f.type,eventId:f.eventId,tenantId:f.tenantId,sessionId:f.sessionId,urlResponse:_,postBody:null}}return null}(Je,fe.url)),d.onEvent(Tt||oc())});return function(Je){return ae.apply(this,arguments)}}();typeof p<"u"&&"function"==typeof p.subscribe&&p.subscribe(null,R);const z=_,Z=`${v.packageName.toLowerCase()}://`;ol().handleOpenURL=function(){var ae=(0,D.Z)(function*(fe){if(fe.toLowerCase().startsWith(Z)&&R({url:fe}),"function"==typeof z)try{z(fe)}catch(Je){console.error(Je)}});return function(fe){return ae.apply(this,arguments)}}()}};function oc(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Ue("no-auth-event")}}function ll(){var f;return(null===(f=self?.location)||void 0===f?void 0:f.protocol)||null}function cm(f=(0,j.z$)()){return!("file:"!==ll()&&"ionic:"!==ll()&&"capacitor:"!==ll()||!f.toLowerCase().match(/iphone|ipad|ipod|android/))}function j0(){try{const f=self.localStorage,c=wu();if(f)return f.setItem(c,"1"),f.removeItem(c),!function Uu(f=(0,j.z$)()){return function KC(){return(0,j.w1)()&&11===document?.documentMode}()||function ac(f=(0,j.z$)()){return/Edge\/\d+/.test(f)}(f)}()||(0,j.hl)()}catch{return $0()&&(0,j.hl)()}return!1}function $0(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Kh(){return(function qh(){return"http:"===ll()||"https:"===ll()}()||(0,j.ru)()||cm())&&!function qC(){return(0,j.b$)()||(0,j.UG)()}()&&j0()&&!$0()}function H0(){return cm()&&typeof document<"u"}function um(){return(um=(0,D.Z)(function*(){return!!H0()&&new Promise(f=>{const c=setTimeout(()=>{f(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(c),f(!0)})})})).apply(this,arguments)}const xr={LOCAL:"local",NONE:"none",SESSION:"session"},la=Q,dm="persistence";function Zh(f){return G0.apply(this,arguments)}function G0(){return(G0=(0,D.Z)(function*(f){yield f._initializationPromise;const c=QC(),d=Ua(dm,f.config.apiKey,f.name);c&&c.setItem(d,f._getPersistence())})).apply(this,arguments)}function QC(){var f;try{return(null===(f=function ZC(){return typeof window<"u"?window:null}())||void 0===f?void 0:f.sessionStorage)||null}catch{return null}}const JC=Q;class ca{constructor(){this.browserResolver=Oi(F0),this.cordovaResolver=Oi(GC),this.underlyingResolver=null,this._redirectPersistence=dn,this._completeRedirectFn=Lh,this._overrideRedirectResult=Wg}_initialize(c){var d=this;return(0,D.Z)(function*(){return yield d.selectUnderlyingResolver(),d.assertedUnderlyingResolver._initialize(c)})()}_openPopup(c,d,p,_){var v=this;return(0,D.Z)(function*(){return yield v.selectUnderlyingResolver(),v.assertedUnderlyingResolver._openPopup(c,d,p,_)})()}_openRedirect(c,d,p,_){var v=this;return(0,D.Z)(function*(){return yield v.selectUnderlyingResolver(),v.assertedUnderlyingResolver._openRedirect(c,d,p,_)})()}_isIframeWebStorageSupported(c,d){this.assertedUnderlyingResolver._isIframeWebStorageSupported(c,d)}_originValidation(c){return this.assertedUnderlyingResolver._originValidation(c)}get _shouldInitProactively(){return H0()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return JC(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var c=this;return(0,D.Z)(function*(){if(c.underlyingResolver)return;const d=yield function bM(){return um.apply(this,arguments)}();c.underlyingResolver=d?c.cordovaResolver:c.browserResolver})()}}function Yh(f){return f.unwrap()}function wM(f){return XC(f)}function XC(f){const{_tokenResponse:c}=f instanceof j.ZR?f.customData:f;if(!c)return null;if(!(f instanceof j.ZR)&&"temporaryProof"in c&&"phoneNumber"in c)return qs.credentialFromResult(f);const d=c.providerId;if(!d||d===fr.PASSWORD)return null;let p;switch(d){case fr.GOOGLE:p=mr;break;case fr.FACEBOOK:p=Wa;break;case fr.GITHUB:p=Ag;break;case fr.TWITTER:p=Cn;break;default:const{oauthIdToken:_,oauthAccessToken:v,oauthTokenSecret:I,pendingToken:R,nonce:z}=c;return v||I||_||R?R?d.startsWith("saml.")?_o._create(d,R):$s._fromParams({providerId:d,signInMethod:d,pendingToken:R,idToken:_,accessToken:v}):new Jn(d).credential({idToken:_,accessToken:v,rawNonce:z}):null}return f instanceof j.ZR?p.credentialFromError(f):p.credentialFromResult(f)}function Pr(f,c){return c.catch(d=>{throw d instanceof j.ZR&&function hm(f,c){var d;const p=null===(d=c.customData)||void 0===d?void 0:d._tokenResponse;if("auth/multi-factor-auth-required"===c?.code)c.resolver=new TM(f,function kg(f,c){var d;const p=(0,j.m9)(f),_=c;return Q(c.customData.operationType,p,"argument-error"),Q(null===(d=_.customData._serverResponse)||void 0===d?void 0:d.mfaPendingCredential,p,"argument-error"),Ih._fromError(p,_)}(f,c));else if(p){const _=XC(c),v=c;_&&(v.credential=_,v.tenantId=p.tenantId||void 0,v.email=p.email||void 0,v.phoneNumber=p.phoneNumber||void 0)}}(f,d),d}).then(d=>{const _=d.user;return{operationType:d.operationType,credential:wM(d),additionalUserInfo:Og(d),user:Io.getOrCreate(_)}})}function W0(f,c){return q0.apply(this,arguments)}function q0(){return(q0=(0,D.Z)(function*(f,c){const d=yield c;return{verificationId:d.verificationId,confirm:p=>Pr(f,d.confirm(p))}})).apply(this,arguments)}class TM{constructor(c,d){this.resolver=d,this.auth=function EM(f){return f.wrapped()}(c)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(c){return Pr(Yh(this.auth),this.resolver.resolveSignIn(c))}}class Io{constructor(c){this._delegate=c,this.multiFactor=function rC(f){const c=(0,j.m9)(f);return Dh.has(c)||Dh.set(c,Ch._fromUser(c)),Dh.get(c)}(c)}static getOrCreate(c){return Io.USER_MAP.has(c)||Io.USER_MAP.set(c,new Io(c)),Io.USER_MAP.get(c)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(c){return this._delegate.getIdTokenResult(c)}getIdToken(c){return this._delegate.getIdToken(c)}linkAndRetrieveDataWithCredential(c){return this.linkWithCredential(c)}linkWithCredential(c){var d=this;return(0,D.Z)(function*(){return Pr(d.auth,Gs(d._delegate,c))})()}linkWithPhoneNumber(c,d){var p=this;return(0,D.Z)(function*(){return W0(p.auth,function $g(f,c,d){return Su.apply(this,arguments)}(p._delegate,c,d))})()}linkWithPopup(c){var d=this;return(0,D.Z)(function*(){return Pr(d.auth,function v0(f,c,d){return Ph.apply(this,arguments)}(d._delegate,c,ca))})()}linkWithRedirect(c){var d=this;return(0,D.Z)(function*(){return yield Zh(mn(d.auth)),Mh(d._delegate,c,ca)})()}reauthenticateAndRetrieveDataWithCredential(c){return this.reauthenticateWithCredential(c)}reauthenticateWithCredential(c){var d=this;return(0,D.Z)(function*(){return Pr(d.auth,Kl(d._delegate,c))})()}reauthenticateWithPhoneNumber(c,d){return W0(this.auth,function vC(f,c,d){return g0.apply(this,arguments)}(this._delegate,c,d))}reauthenticateWithPopup(c){return Pr(this.auth,function y0(f,c,d){return Nu.apply(this,arguments)}(this._delegate,c,ca))}reauthenticateWithRedirect(c){var d=this;return(0,D.Z)(function*(){return yield Zh(mn(d.auth)),sa(d._delegate,c,ca)})()}sendEmailVerification(c){return function iM(f,c){return Eh.apply(this,arguments)}(this._delegate,c)}unlink(c){var d=this;return(0,D.Z)(function*(){return yield function Wl(f,c){return qe.apply(this,arguments)}(d._delegate,c),d})()}updateEmail(c){return function sM(f,c){return gi((0,j.m9)(f),c,null)}(this._delegate,c)}updatePassword(c){return function oM(f,c){return gi((0,j.m9)(f),null,c)}(this._delegate,c)}updatePhoneNumber(c){return function Eo(f,c){return Nh.apply(this,arguments)}(this._delegate,c)}updateProfile(c){return function Ja(f,c){return zs.apply(this,arguments)}(this._delegate,c)}verifyBeforeUpdateEmail(c,d){return function Yv(f,c,d){return Qv.apply(this,arguments)}(this._delegate,c,d)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Io.USER_MAP=new WeakMap;const ua=Q;let ju=(()=>{class f{constructor(d,p){if(this.app=d,p.isInitialized())return this._delegate=p.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:_}=d.options;ua(_,"invalid-api-key",{appName:d.name}),ua(_,"invalid-api-key",{appName:d.name});const v=typeof window<"u"?ca:void 0;this._delegate=p.initialize({options:{persistence:K0(_,d.name),popupRedirectResolver:v}}),this._delegate._updateErrorMap(La),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Io.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(d){this._delegate.languageCode=d}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(d){this._delegate.tenantId=d}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(d,p){!function ve(f,c,d){const p=mn(f);Q(p._canInitEmulator,p,"emulator-config-failed"),Q(/^https?:\/\//.test(c),p,"invalid-emulator-scheme");const _=!!d?.disableWarnings,v=fu(c),{host:I,port:R}=function bg(f){const c=fu(f),d=/(\/\/)?([^?#/]+)/.exec(f.substr(c.length));if(!d)return{host:"",port:null};const p=d[2].split("@").pop()||"",_=/^(\[[^\]]+\])(:|$)/.exec(p);if(_){const v=_[1];return{host:v,port:Hl(p.substr(v.length+1))}}{const[v,I]=p.split(":");return{host:v,port:Hl(I)}}}(c);p.config.emulator={url:`${v}//${I}${null===R?"":`:${R}`}/`},p.settings.appVerificationDisabledForTesting=!0,p.emulatorConfig=Object.freeze({host:I,port:R,protocol:v.replace(":",""),options:Object.freeze({disableWarnings:_})}),_||function HI(){function f(){const c=document.createElement("p"),d=c.style;c.innerText="Running in emulator mode. Do not use with production credentials.",d.position="fixed",d.width="100%",d.backgroundColor="#ffffff",d.border=".1em solid #000000",d.color="#b50000",d.bottom="0px",d.left="0px",d.margin="0px",d.zIndex="10000",d.textAlign="center",c.classList.add("firebase-emulator-warning"),document.body.appendChild(c)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",f):f())}()}(this._delegate,d,p)}applyActionCode(d){return function ws(f,c){return vu.apply(this,arguments)}(this._delegate,d)}checkActionCode(d){return Gv(this._delegate,d)}confirmPasswordReset(d,p){return function Qa(f,c,d){return Zl.apply(this,arguments)}(this._delegate,d,p)}createUserWithEmailAndPassword(d,p){var _=this;return(0,D.Z)(function*(){return Pr(_._delegate,function JI(f,c,d){return zv.apply(this,arguments)}(_._delegate,d,p))})()}fetchProvidersForEmail(d){return this.fetchSignInMethodsForEmail(d)}fetchSignInMethodsForEmail(d){return function nM(f,c){return Zv.apply(this,arguments)}(this._delegate,d)}isSignInWithEmailLink(d){return function XO(f,c){const d=zl.parseLink(c);return"EMAIL_SIGNIN"===d?.operation}(0,d)}getRedirectResult(){var d=this;return(0,D.Z)(function*(){ua(Kh(),d._delegate,"operation-not-supported-in-this-environment");const p=yield function C0(f,c){return Fh.apply(this,arguments)}(d._delegate,ca);return p?Pr(d._delegate,Promise.resolve(p)):{credential:null,user:null}})()}addFrameworkForLogging(d){!function zC(f,c){mn(f)._logFramework(c)}(this._delegate,d)}onAuthStateChanged(d,p,_){const{next:v,error:I,complete:R}=fm(d,p,_);return this._delegate.onAuthStateChanged(v,I,R)}onIdTokenChanged(d,p,_){const{next:v,error:I,complete:R}=fm(d,p,_);return this._delegate.onIdTokenChanged(v,I,R)}sendSignInLinkToEmail(d,p){return function JO(f,c,d){return Wv.apply(this,arguments)}(this._delegate,d,p)}sendPasswordResetEmail(d,p){return function Zi(f,c,d){return yu.apply(this,arguments)}(this._delegate,d,p||void 0)}setPersistence(d){var p=this;return(0,D.Z)(function*(){let _;switch(function YC(f,c){la(Object.values(xr).includes(c),f,"invalid-persistence-type"),(0,j.b$)()?la(c!==xr.SESSION,f,"unsupported-persistence-type"):(0,j.UG)()?la(c===xr.NONE,f,"unsupported-persistence-type"):$0()?la(c===xr.NONE||c===xr.LOCAL&&(0,j.hl)(),f,"unsupported-persistence-type"):la(c===xr.NONE||j0(),f,"unsupported-persistence-type")}(p._delegate,d),d){case xr.SESSION:_=dn;break;case xr.LOCAL:_=(yield Oi(tl)._isAvailable())?tl:Lg;break;case xr.NONE:_=Ba;break;default:return se("argument-error",{appName:p._delegate.name})}return p._delegate.setPersistence(_)})()}signInAndRetrieveDataWithCredential(d){return this.signInWithCredential(d)}signInAnonymously(){return Pr(this._delegate,function gu(f){return pi.apply(this,arguments)}(this._delegate))}signInWithCredential(d){return Pr(this._delegate,mu(this._delegate,d))}signInWithCustomToken(d){return Pr(this._delegate,function $v(f,c){return Xr.apply(this,arguments)}(this._delegate,d))}signInWithEmailAndPassword(d,p){return Pr(this._delegate,function QO(f,c,d){return mu((0,j.m9)(f),Mi.credential(c,d)).catch(function(){var p=(0,D.Z)(function*(_){throw"auth/password-does-not-meet-requirements"===_.code&&Hv(f),_});return function(_){return p.apply(this,arguments)}}())}(this._delegate,d,p))}signInWithEmailLink(d,p){return Pr(this._delegate,function eM(f,c,d){return qv.apply(this,arguments)}(this._delegate,d,p))}signInWithPhoneNumber(d,p){return W0(this._delegate,function Du(f,c,d){return ns.apply(this,arguments)}(this._delegate,d,p))}signInWithPopup(d){var p=this;return(0,D.Z)(function*(){return ua(Kh(),p._delegate,"operation-not-supported-in-this-environment"),Pr(p._delegate,function Gg(f,c,d){return zg.apply(this,arguments)}(p._delegate,d,ca))})()}signInWithRedirect(d){var p=this;return(0,D.Z)(function*(){return ua(Kh(),p._delegate,"operation-not-supported-in-this-environment"),yield Zh(p._delegate),T0(p._delegate,d,ca)})()}updateCurrentUser(d){return this._delegate.updateCurrentUser(d)}verifyPasswordResetCode(d){return function YO(f,c){return Ng.apply(this,arguments)}(this._delegate,d)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return f.Persistence=xr,f})();function fm(f,c,d){let p=f;"function"!=typeof f&&({next:p,error:c,complete:d}=f);const _=p;return{next:I=>_(I&&Io.getOrCreate(I)),error:c,complete:d}}function K0(f,c){const d=function z0(f,c){const d=QC();if(!d)return[];const p=Ua(dm,f,c);switch(d.getItem(p)){case xr.NONE:return[Ba];case xr.LOCAL:return[tl,dn];case xr.SESSION:return[dn];default:return[]}}(f,c);if(typeof self<"u"&&!d.includes(tl)&&d.push(tl),typeof window<"u")for(const p of[Lg,dn])d.includes(p)||d.push(p);return d.includes(Ba)||d.push(Ba),d}class Qh{constructor(){this.providerId="phone",this._delegate=new qs(Yh(Be.Z.auth()))}static credential(c,d){return qs.credential(c,d)}verifyPhoneNumber(c,d){return this._delegate.verifyPhoneNumber(c,d)}unwrap(){return this._delegate}}Qh.PHONE_SIGN_IN_METHOD=qs.PHONE_SIGN_IN_METHOD,Qh.PROVIDER_ID=qs.PROVIDER_ID;const lc=Q;class Z0{constructor(c,d,p=Be.Z.app()){var _;lc(null===(_=p.options)||void 0===_?void 0:_.apiKey,"invalid-api-key",{appName:p.name}),this._delegate=new Nt(p.auth(),c,d),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function Jh(f){f.INTERNAL.registerComponent(new ys.wA("auth-compat",c=>{const d=c.getProvider("app-compat").getImmediate(),p=c.getProvider("auth");return new ju(d,p)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:Mi,FacebookAuthProvider:Wa,GithubAuthProvider:Ag,GoogleAuthProvider:mr,OAuthProvider:Jn,SAMLAuthProvider:vh,PhoneAuthProvider:Qh,PhoneMultiFactorGenerator:ic,RecaptchaVerifier:Z0,TwitterAuthProvider:Cn,Auth:ju,AuthCredential:Gl,Error:j.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),f.registerVersion("@firebase/auth-compat","0.5.1")}(Be.Z)},861:(zr,fi,et)=>{function D(j,ze,rn,Bt,On,si,Dt){try{var $=j[si](Dt),re=$.value}catch(Me){return void rn(Me)}$.done?ze(re):Promise.resolve(re).then(Bt,On)}function Be(j){return function(){var ze=this,rn=arguments;return new Promise(function(Bt,On){var si=j.apply(ze,rn);function Dt(re){D(si,Bt,On,Dt,$,"next",re)}function $(re){D(si,Bt,On,Dt,$,"throw",re)}Dt(void 0)})}}et.d(fi,{Z:()=>Be})}},zr=>{var fi=D=>zr(zr.s=D);fi(614),fi(357)}]);